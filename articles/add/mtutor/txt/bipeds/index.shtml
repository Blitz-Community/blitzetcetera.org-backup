<HTML>
<HEAD>
  <STYLE TYPE="text/css">
  <!--
    A:visited {text-decoration: none; color="#0055FF"; font-weight: bold}
    A:active {text-decoration: underline; color="#0055FF"; font-weight: bold}
    A:link {text-decoration: none; color="#0055FF"; font-weight: bold}
    A:hover {text-decoration: underline; color: #ACACD7; font-weight: bold}
  -->  
  </STYLE>
  <TITLE>Modeling tutorial - Присоединяем модель к скелету в 3D MAX</TITLE>
  <META HTTP-EQUIV="Content-type" CONTENT="text/html; Charset=Windows-1251">
  <META NAME="author" CONTENT="Stanislav Serov (yxo), E-Mail: neotropic@halflife.ru">
  <META NAME="copyright" CONTENT="R.M.C.">
</HEAD>
<BODY BGCOLOR="#4F4958"><FONT FACE="Arial">
<A NAME="up"></A>
<TABLE ALIGN="center" WIDTH="100%" CELLSPACING="0" CELLPADDING="4" BORDER="1" BORDERCOLOR="Silver" HEIGHT="100%">

<TR>
<TD ALIGN="justify" VALIGN="top" BGCOLOR="Black" BORDERCOLOR="Silver">
<FONT SIZE="2" COLOR="White">
  <TABLE CELLSPACING="0" CELLPADDING="0" BORDER="1" WIDTH="100%" BORDERCOLOR="#BFD9DF">
  <TR><TD BGCOLOR="#BFD9DF" ALIGN="center"><FONT SIZE="2"><B>Modeling tutorial - Присоединяем модель к скелету</A></B></FONT></TD>
 </TR>
  </TABLE>
<BR>

<table width=100% border=0 align=center cellspacing=0 cellpadding=20>
<td width=100% >
<p align="center"><font size="3" color="#ACACD7"><strong>КРАТКОЕ ОБЪЯСНЕНИЕ ТЕЛОСЛОЖЕНИЯ ДВУНОГИХ (BIPED)</strong></font></p><FONT SIZE="2" color="#ACACD7">
ВНИМАНИЕ: В данном тексте вся информация написанна под 3D MAX 3 и CHARACTER STUDIO 2.2, если вы используете старые версии этих программ то некоторая информация в тексте вам будет непонятна, очень советую вам поставить последнии версии данного продукта. Хотя принцип работы 
CHARACTER STUDIO новых версий сильно не изменился.
<br>

Далее в тексте слово двуногие будет заменено словом Biped или скелет.<br>
Character Studio состоит из двух необходимых модулей: Biped и Physique. 
Biped - каркасный скелетет, подобный двуногому животному. <br>
Physique - метод присоединения Biped к вашей модели и использования его для лёгкой анимации сеточной модели. Другой пакет позволяющий работать с костями и выполнять почти такие действия как и CHARACTER STUDIO, это 'Bones Pro'. 
<p align="center"><font size="3"><strong>СОЗДАНИЕ BIPED</strong></font></p>
Хорошо, теперь попробуем создать свой собственный скелет Biped. Для простоты можно просто открыть модель со скелетом и удалить оболочку. 
<p align="center"><font size="3"><strong>РАЗМЕЩЕНИЕ BIPED</strong></font></p>
Вообще я настраиваю скелет так, чтобы руки были направленны в стороны, а ноги стояли на ширине плеч, это вам понадобится в будущем для более удобного присоединения вершин оболочки к Biped. 
<p align="center"> <img src="biped.jpg"><p>
Вы должны откорректировать вашу сеточную оболочку так, чтобы она была точно вокруг скелета. <br>
<br>
Чтобы начать настройку скелета под модель (под словом настройка я имел ввиду вращение костей для того чтобы все его члены были точно внутри модели), вы должны активизировать режим фигуры 'Figure mode'. 
Выделите Bip 01. Это - алмаз в центре бедер скелета, либо любую другую кость скелета Biped. 
<p align="center"> <img src="bip01.jpg"><p>
Это - корень Biped и основная кость, с которой связаны все другие кости. 
Half-Life использует эту специфическую кость, чтобы поместить модель в игру. Если сцена содержит много обьектов и вам довольно сложно просто щелчком выделить этот обьект то тогда нажмите кнопку выбора в верхней части 3D MAX: 
<p align="center"> <img src="selecticon.jpg"><p>
Вы увидите список. 
<p align="center"> <img src="selectlist.jpg"><p>
Найдите в списке 'Bip 01' и щёлкните на надпись а потом на кнопку 'Select'.<br> 
СОВЕТ: Чтобы не снимать выделение этого обьекта, вы можете блокировать это, щелкнув на кнопку замок 'padlock' на дне экрана. 
<p align="center"> <img src="padlock.jpg"><p>
Когда эта кнопка активизированна (желтая), вы не сможете выделять обьекты или снимать выделение. 
Теперь нажмите кнопку 'Unicycle' вверху, и вы увидите панель Biped.
<p align="center"> <img src="unicycleicon.jpg"><p>
Немного ниже будет находится строка из трех кнопок. Левая кнопка с изображением человека с вытянутыми руками, она нам и нужна.
<p align="center"> <img src="figureicon.jpg"><p>
Щелкните на неё.<br> 
Это - режим фигуры 'Figure mode' biped. Не волнуйтесь если в режиме 'Figure mode', скелет возвратится от текущий позиции, к позиции и форме в которой он был создан. 
Объяснение: режим фигуры 'Figure mode' позволяет вам корректировать размеры, форму и позицию скелета. Когда режим дезактивирован редактирование размеров скелета невозможно, зато можно создавать анимации скелета.<br><br>
Хорошо, теперь при активизированном режиме 'Figure Mode' вращайте руки и ноги так, чтобы скелет был подстроен под оболочку. 
<br><br>
Некоторые советы: 
Вращения костей Biped работает не так как вращение простых обьектов, кости ограниченны в передвижении и кождая кость крутится относительно той точки в которой она присоедененна к своей родительской кости. 
Попробуйте покрутить руки и ноги относительно разных осей чтобы понять как они движутся.<br>
Как только вы настроили позицию одной руки так как вам нужно, выделите все кости данной руки и нажмите на кнопку 'copy posture'. Вы найдете её на правой панели под полосой, 'Keyframing'. 
<p align="center"> <img src="copyposture.jpg"><p>
... а затем нажмите 'paste opposite' кнопку. 
<p align="center"> <img src="pasteopicon.jpg"><p>
Другая рука будет находится в тойже позиции как и первая. Это позволит вам довольно быстро сделать скелет симметричным. 
Попробуйте сделать тоже самое с ногами. Пока ваш скелет будет не размещен подобно этому: 
<p align="center"> <img src="biped.jpg"><p>
Теперь откорректируйте вашу сеть, так чтобы она была точно настроенна под скелет.<br>
Теперь я буду нуждаться в помощи моего очаровательного помощника, Гордона. 
<p align="center"><font size="3"><strong>ТЕЛОСЛОЖЕНИЕ</strong></font></p>
<p align="center"> <img src="gordonbip.jpg"><p>
Здесь вы видите сеть Гордона, размещенную точно поверх biped. Очевидно он не нуждается в корректировке. <br>
Как только вы убедились, что ваша модель и скелет находятся в правильном месте, выберите сеточную оболочку, нажимая на неё, и примените к ней модификатор Телосложения 'Physique'. Если вы не добавили кнопку к вашим кнопкам модификаторов (см. более раннюю обучающую программу, "Настраиваем Studio MAX"), тогда щелкните на кнопку 'more' вверху панели модификаторов. 
<p align="center"> <img src="modmore.jpg"><p>
Выбирите из списка строку "Physique": 
<p align="center"> <img src="physlist.jpg"><p>
... И нажмите OK. 

Появится панель данного модификатора справа, вот так она выглядит: 
<p align="center"> <img src="physroll.jpg"><p>
Модификатор поможет вам делать большое количество замечательных вещей, но пока нам нужна только кнопка инициализации с изображением паренька с красным животом: 
<p align="center"> <img src="activateicon.jpg"><p>
Приблизте любую область просмотра ближе к талии скелета, так чтобы вы хорошо видели Bip01. 
<p align="center"> <img src="bip01.jpg"><p>
Теперь нажмите кнопку инициализации, и затем нажмите на Bip01 кости Таза. Или выбирете данную кость в списке обьектов сцены. 
Появится вот такое окшко: 
<p align="center"> <img src="physinit1.jpg"><p>
Зададим некоторые параметры для правильного присоединения к скелету: В поле назначение связи вершины 'Vertex Link Assignment'. Поменяйте 'Deformable' на 'Rigid'. 
В поле Смешивать Между Связями 'Blending Between Links', поменяйте 'N Links' на 'No Blending'. 
И отрубите кнопку 'Create Envelopes'. 
Вот так должно выглядеть окно после проделанных махинаций: 
<p align="center"> <img src="physinit2.jpg"><p>
Все те настройки которые мы сейчас задали нужны для того чтобы каждая вершина была назначена исключительно на одну кость. В более расширенных параметрах настройки, возможно совместно использовать вершины с несколькими костями для более гладкой деформации сеточной оболочки, но это не работает в Half-Life, так что это нам ненужно. 
Щелкните на кнопку 'Initialize' в основании. Ваш указатель указатель мыши будет в виде чашки кофе, пока модификатор обдумывает различные вещи. После некоторого времени вы увидите на экране оранжевые лини соеденённые друг с другом расположенные по длинне вашей модели: 
<p align="center"> <img src="gordonphys.jpg"><p>
Мои поздравления, теперь ваша модель прикрепленна к скелету. 
Можете выделить любую конечность biped, и попробуёте покрутить её. Но это еще не конец так как некоторое вершины оболочки обязательно будут неправильно присоеденены. Т. е. когда вы покрутите скажем ногу скелета вы заметите как вершины относящиеся к примеру к колену левой ноги следуют за костями правой. <br>
Ок, теперь важная часть: Выслеживание и переназначение вершин неправильно назначенных к скелету или вообще неназначенных.<br>
Внимание: если вы крутили руки или ноги скелета, обязательно верните их на прежнее место,
нажав кнопку 'Undo' или комбинацию клавиш Ctrl+Z, или вершины которые далее мы начнём их присоединять будут назначенны неправильно.

<p align="center"><font size="3"><strong>РЕДАКТИРОВАНИЕ ВЕРШИН</strong></font></p>
Так теперь мы имеем сетчатую оболочку, которая уже назначенна скелету biped. Итак посмотрим подробней что натворил модификатор 'Physique'. Каждую вершину сети он присоединил к ближайшей связи 'link' (связи - оранжевые линии соеденённые друг с другом, и примерно расположенные также как и части скелета Biped) при этом необязательно что ближайшей к вершине была нужная связь. Если вы посмотрите на ссылку поближе, то увидите что каждая ссылка разделенна маленькими звездами. Это обозначение начала и конца каждой 'ссылки'.<br>  
Убедитесь, что вы находитесь в режиме модификатора ... 
<p align="center"> <img src="modifiericon.jpg"><p>
И ваша модель выбрана. Вы должны видеть панель модификатора телосложения с правой стороны. 
<p align="center"> <img src="physedit.jpg"><p>
Активизируйте кнопку 'sub-object' и в меню выбирайте строку 'Vertex'.
<p align="center"> <img src="subvert.jpg"><p>
Вы должны увидеть все вершины модели, как будто вы редактируете сеть. Также обратите внимание, что оранжевый скелет стал желтым. Прокрутите панель модификатора так, чтобы видеть её всю: 
<p align="center"> <img src="vertexedit.jpg"><p>
Кнопка 'Select' уже активизирована. Если нет, то щелкните на неё, чтобы она была зеленой как показано выше. Также обратите внимание, что кнопки 'Vertex Type' (красная, зелёная и синяя) все выбраны. Эти кнопки означают то, что мы находимся в режиме 'Select', и мы можем выбирать вершины красного, зелёного и синего типа.<br> 
Объяснение: Цвет вершины зависит от того как она назначенна скелету:<br>
Красный цвет вершины означает что она назначена на две или более костей.<br>
Зелёный цвет означает что вершина назначена только на одну кость и называется такая вершина "твёрдой".<br>
Синий цвет означает что вершина не назначена вообще ни на какую либо кость.<br>
При редактировании вершин мы должны назначать их так чтобы они были только зелёного цвета,
и ни в коем случае не должны быть вершины красного или синего цвета.<br><br>
Хорошо, теперь давайте правильно назначим вершины: <br>
Во-первых, в режиме выбора 'select' со всеми тремя активизированными кнопками типов вершин, выделим вершины которые мы хотим присоединить к другой связи щёлкая непосредственно на них с зажатой клавишей CTRL, или зажав туже клавишу CTRL выделить блок вокруг них. 
Выделенные вершины поменяют цвет на тот к типу которого они относятся, в данном случае у нас все вершины должны быть зелёного цвета.
<p align="center"> <img src="vertselect.jpg"><p>
Как только вы убедились что выбрали все нужные вершины тогда переключаем режим выбора на режим присоединения к связи. Ниже кнопки 'Select' будет другая кнопка - присоеденить к связи 'Assign to link', вот её и нажимайте.
<p align="center"> <img src="assignto.jpg"><p>
Щелкнув на эту кнопку вы сразу заметите что кнопки 'Vertex Type' изменились. Только красная кнопка вершины активизирована. 
<p align="center"> <img src="redvert.jpg"><p>
Так как мы используем только зелёные вершины, то щелкните на кнопку с изображением зелёного крестика. 
<p align="center"> <img src="vertextype.jpg"><p>
Находясь в режиме 'Assign to Link' теперь щёлкните на нужной связи к которой вы хотите прикрепить данные вершины. Связь должна поменять цвет на красный. 
<p align="center"> <img src="assigned.jpg"><p>
Да чуть не забыл вам еще понадобится кнопка 'Select by link' щёлкнув на эту кнопку попробуйте выделить любую связь и вы увидите как все вершины присоединённые к ней вершины будут выделенны, это вам поможет выяснить какие из вершин куда присоеденены.<br>
Теперь давайте проверим назначенные вершины, дезактивируйте кнопку под-объект и выбирите руку скелета Biped, покрутите её, вы сразу увидите как те вешины что мы присоединили к руке будут двигатся за неё (незабудте нажать кнопку отмена 'undo' после того как вы покрутили различные части скелета). Далее повторяйте все теже действия для других вершин пока они не будут присоеденены к скелету правильно. <br>
Как только вы назначили вершины как 'твердые' зелёного цвета к их уместным связям, и проверили скелет на любые ошибки, и вам не нужно делать анимации скелета то вы готовы компилировать вашу модель в mdl файл. 

</td></font>
</table>

<TABLE CELLSPACING="0" CELLPADDING="0" BORDER="1" WIDTH="100%" BORDERCOLOR="#BFD9DF">
  <TR>
  <TD WIDTH="100%" ALIGN="center"><FONT SIZE="2" COLOR="White"><A HREF="../../tut.shtml">Назад</A></FONT></TD></TR>
  </TABLE>

</DIV>

</FONT>
</TD>
</TR>
</TABLE>

</BODY>
</HTML>