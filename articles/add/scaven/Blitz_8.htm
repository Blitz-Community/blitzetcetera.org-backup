<html><head><link rel=stylesheet href="scaven.css" Type=Text/css><meta http-equiv=Content-Type content="text/html; charset=windows-1251"><title> Blitz3D Туториал</title></head><body id=t1><div id=t2><table id=t3> <tr id=t55> <td id=t56> <p id=t8><span id=t7>8. Фишки с привязками</span></p> <p id=t8><span id=t9>&nbsp;</span></p> <p id=t8><span id=t9>А вот что можно сделать, если правильно использовать технологию привязок:</span></p> <p id=t8><span id=t9>&nbsp;</span></p> <p id=t8><span id=t9>Алгоритм галактики:</span></p> <p id=t8><span id=t9>&nbsp;</span></p> <table id=t24> <tr id=t46> <td id=t47> <p id=t27><span id=t28>SeedRnd</span><span id=t28> </span><span id=t28>MilliSecs</span><span id=t30>()</span></p> <p id=t27><span id=t30>&nbsp;</span></p> <p id=t27><span id=t28>Graphics3D </span><span id=t29>640</span><span id=t30>,</span><span id=t29>480</span><span id=t30>,</span><span id=t29>16</span><span id=t30>,</span><span id=t29>1</span></p> <p id=t27><span id=t28>SetBuffer BackBuffer</span><span id=t30>()</span></p> <p id=t27><span id=t30>&nbsp;</span></p> <p id=t27><span id=t31>lit</span><span id=t30>=</span><span id=t28>CreateLight</span><span id=t30>()</span></p> <p id=t27><span id=t30>&nbsp;</span></p> <p id=t27><span id=t28>Dim </span><span id=t31>sp</span><span id=t30>(</span><span id=t29>99</span><span id=t30>)</span></p> <p id=t27><span id=t30>&nbsp;</span></p> <p id=t27><span id=t31>center</span><span id=t30>=</span><span id=t28>CreateCube</span><span id=t30>()</span></p> <p id=t27><span id=t30>&nbsp;</span></p> <p id=t27><span id=t28>For </span><span id=t31>i</span><span id=t30>=</span><span id=t29>0 </span><span id=t28>To </span><span id=t29>99</span></p> <p id=t27><span id=t29><span id=t15> </span></span><span id=t31>sp</span><span id=t30>(</span><span id=t31>i</span><span id=t30>)=</span><span id=t28>CreateSphere</span><span id=t30>(</span><span id=t29>8</span><span id=t30>,</span><span id=t31>center</span><span id=t30>)</span></p> <p id=t27><span id=t30><span id=t15> </span></span><span id=t28>ScaleEntity </span><span id=t31>sp</span><span id=t30>(</span><span id=t31>i</span><span id=t30>),.</span><span id=t29>2</span><span id=t30>,.</span><span id=t29>2</span><span id=t30>,.</span><span id=t29>2</span></p> <p id=t27><span id=t29><span id=t15> </span></span><span id=t28>PositionEntity </span><span id=t31>sp</span><span id=t30>(</span><span id=t31>i</span><span id=t30>),</span><span id=t28>Rnd</span><span id=t30>(-</span><span id=t29>20</span><span id=t30>,</span><span id=t29>20</span><span id=t30>),</span><span id=t28>Rnd</span><span id=t30>(-</span><span id=t29>20</span><span id=t30>,</span><span id=t29>20</span><span id=t30>),</span><span id=t28>Rnd</span><span id=t30>(-</span><span id=t29>20</span><span id=t30>,</span><span id=t29>20</span><span id=t30>)</span></p> <p id=t27><span id=t28>Next</span></p> <p id=t27><span id=t28>&nbsp;</span></p> <p id=t27><span id=t31>cam</span><span id=t30>=</span><span id=t28>CreateCamera</span><span id=t30>()</span></p> <p id=t27><span id=t28>PositionEntity </span><span id=t31>cam</span><span id=t30>,</span><span id=t29>0</span><span id=t30>,</span><span id=t29>0</span><span id=t30>,-</span><span id=t29>40</span></p> <p id=t27><span id=t29>&nbsp;</span></p> <p id=t27><span id=t29>&nbsp;</span></p> <p id=t27><span id=t28>Repeat</span></p> <p id=t27><span id=t28><span id=t15> </span></span></p> <p id=t27><span id=t28><span id=t15> </span>TurnEntity </span><span id=t31>center</span><span id=t30>,.</span><span id=t29>0</span><span id=t30>,.</span><span id=t29>5</span><span id=t30>,.</span><span id=t29>5</span></p> <p id=t27><span id=t29><span id=t15> </span></span></p> <p id=t27><span id=t29><span id=t15> </span></span><span id=t28>UpdateWorld</span></p> <p id=t27><span id=t28><span id=t15> </span>RenderWorld</span></p> <p id=t27><span id=t28>&nbsp;</span></p> <p id=t27><span id=t28><span id=t15> </span>Flip</span></p> <p id=t27><span id=t28>&nbsp;</span></p> <p id=t27><span id=t28>Until KeyHit</span><span id=t30>(</span><span id=t29>1</span><span id=t30>)</span></p> <p id=t27><span id=t30>&nbsp;</span></p> <p id=t54><span id=t28>End</span><span id=t33></span></p> </td> </tr> </table> <p id=t8><span id=t9>&nbsp;</span></p> <p id=t8><span id=t9>Если вы запустите этот код, то увидите как шарики делают поступательное движение (летают </span><span id=t10><span id=t11>J</span></span><span id=t9>) вокруг куба по кругу. На самом деле всё проще! Эти шары просто находятся в родительской зависимости от куба, и остаются на месте, а поворачивается только куб – ну, а они вместе с ним! Так, допустим, что нам этот алгоритм понравился, и мы захотели всунуть его в нашу игру, но нас немного смущает этот куб в середине. Конечно, можно его как подобает затекстурировать, и сказать, мол, это наш антигравитационный голографический транс-хренолятор, или сделать сферу, и сказать, что это чёрная дырища (и такое в нашей практике бывает, когда лень чего-нить исправлять </span><span id=t10><span id=t11>J</span></span><span id=t9>), но здесь мы поступим по-другому.</span></p> <p id=t8><span id=t9>Помните, в самом начале я перечислял какими бывают объекты, и упомянул о Пивотах. Так вот – пивот – это просто точка в пространстве, она невидимая, но у неё есть (как и всех остальных объектов) своя система координат, а значит – своё направление. Пивоты – это очень полезные объект, когда дело касается всяких там привязок. Уже догадались, что мы собираемся сделать? Неправильно – мы собираемся заменить этот куб в середине на пивот… А, вы так и подумали?… </span><span id=t10><span id=t11>J</span></span><span id=t9> Ну, тогда, заменим команду сами знаете чего на команду создания пивота:</span></p> <p id=t8><span id=t9>&nbsp;</span></p> <table id=t24> <tr id=t46> <td id=t47> <p id=t48><span id=t31>center</span><span id=t30>=</span><span id=t28>CreatePivot</span><span id=t30>()</span><span id=t33></span></p> </td> </tr> </table> <p id=t8><span id=t9>&nbsp;</span></p> <p id=t8><span id=t9>Всё – теперь мы можем наслаждаться видом крутящегося скопления звёзд без всяких там лишних вещей!</span></p> <p id=t8><span id=t9>&nbsp;</span></p> <p id=t8><span id=t9>Но не обязательно делать такую одинарную привязку - можно привязать один объект к другому, который в свою очередь привязан к третьему – тот к четвёртому, и так далее… Для чего это делать? А вот посмотрите пример:</span></p> <p id=t8><span id=t9>&nbsp;</span></p> <table id=t24> <tr id=t46> <td id=t47> <p id=t27><span id=t28>Graphics3D </span><span id=t29>640</span><span id=t30>,</span><span id=t29>480</span><span id=t30>,</span><span id=t29>16</span><span id=t30>,</span><span id=t29>1</span></p> <p id=t27><span id=t28>SetBuffer BackBuffer</span><span id=t30>()</span></p> <p id=t27><span id=t30>&nbsp;</span></p> <p id=t27><span id=t31>lit</span><span id=t30>=</span><span id=t28>CreateLight</span><span id=t30>()</span></p> <p id=t27><span id=t30>&nbsp;</span></p> <p id=t27><span id=t28>Dim</span><span id=t31> prv</span><span id=t30>(</span><span id=t29>2</span><span id=t30>)</span></p> <p id=t27><span id=t30>&nbsp;</span></p> <p id=t27><span id=t31>prv</span><span id=t30>(</span><span id=t29>0</span><span id=t30>)=</span><span id=t28>CreateCube</span><span id=t30>()</span></p> <p id=t27><span id=t30>&nbsp;</span></p> <p id=t27><span id=t31>prv</span><span id=t30>(</span><span id=t29>1</span><span id=t30>)=</span><span id=t28>CreateCube</span><span id=t30>(</span><span id=t31>prv</span><span id=t30>(</span><span id=t29>0</span><span id=t30>))</span></p> <p id=t27><span id=t28>PositionEntity</span><span id=t31> prv</span><span id=t30>(</span><span id=t29>1</span><span id=t30>),</span><span id=t29>5</span><span id=t30>,</span><span id=t29>0</span><span id=t30>,</span><span id=t29>0</span><span id=t30></span></p> <p id=t27><span id=t31>prv</span><span id=t30>(</span><span id=t29>2</span><span id=t30>)=</span><span id=t28>CreateCube</span><span id=t30>(</span><span id=t31>prv</span><span id=t30>(</span><span id=t29>1</span><span id=t30>))</span></p> <p id=t27><span id=t28>PositionEntity</span><span id=t31> prv</span><span id=t30>(</span><span id=t29>2</span><span id=t30>),</span><span id=t29>5</span><span id=t30>,</span><span id=t29>0</span><span id=t30>,</span><span id=t29>0</span><span id=t30></span></p> <p id=t27><span id=t30>&nbsp;</span></p> <p id=t27><span id=t31>obj</span><span id=t30>=</span><span id=t28>CreateSphere</span><span id=t30>(</span><span id=t29>8</span><span id=t30>,</span><span id=t31>prv</span><span id=t30>(</span><span id=t29>2</span><span id=t30>))</span></p> <p id=t27><span id=t28>PositionEntity</span><span id=t31> obj</span><span id=t30>,</span><span id=t29>5</span><span id=t30>,</span><span id=t29>0</span><span id=t30>,</span><span id=t29>0</span><span id=t30></span></p> <p id=t27><span id=t28>&nbsp;</span></p> <p id=t27><span id=t31>cam</span><span id=t30>=</span><span id=t28>CreateCamera</span><span id=t30>(</span><span id=t29>0</span><span id=t30>)</span></p> <p id=t27><span id=t28>PositionEntity </span><span id=t31>cam</span><span id=t30>,</span><span id=t29>0</span><span id=t30>,</span><span id=t29>0</span><span id=t30>,-</span><span id=t29>30</span></p> <p id=t27><span id=t29>&nbsp;</span></p> <p id=t27><span id=t29>&nbsp;</span></p> <p id=t27><span id=t28>Repeat</span></p> <p id=t27><span id=t28><span id=t15> </span></span></p> <p id=t27><span id=t28><span id=t15> </span>For</span><span id=t31> i</span><span id=t30>=</span><span id=t29>0 </span><span id=t28>To</span><span id=t31> </span><span id=t29>2</span><span id=t30></span></p> <p id=t27><span id=t50><span id=t15>  </span></span><span id=t28>TurnEntity</span><span id=t31> prv</span><span id=t30>(</span><span id=t31>i</span><span id=t30>),</span><span id=t29>0</span><span id=t30>,</span><span id=t29>0</span><span id=t30>,</span><span id=t29>1</span><span id=t30></span></p> <p id=t27><span id=t50><span id=t15> </span></span><span id=t28>Next</span><span id=t50></span></p> <p id=t27><span id=t50><span id=t15> </span></span></p> <p id=t27><span id=t50><span id=t15> </span></span><span id=t28>UpdateWorld</span></p> <p id=t27><span id=t28><span id=t15> </span>RenderWorld</span></p> <p id=t27><span id=t28>&nbsp;</span></p> <p id=t27><span id=t28><span id=t15> </span>Flip</span></p> <p id=t27><span id=t28>&nbsp;</span></p> <p id=t27><span id=t28>Until KeyHit</span><span id=t30>(</span><span id=t29>1</span><span id=t30>)</span></p> <p id=t27><span id=t30>&nbsp;</span></p> <p id=t48><span id=t28>End</span><span id=t33></span></p> </td> </tr> </table> <p id=t8><span id=t9>&nbsp;</span></p> <p id=t8><span id=t9>Как видите, привязки играют очень большую роль в программировании игр, и они очень облегчают жизнь.</span></p> <p id=t8><span id=t9>Несколько дополнений:</span></p> <p id=t8><span id=t9>&nbsp;</span></p> <p id=t8><span id=t9>1) Помните - синтакс команды создания сферы таков: </span><b><span id=t43>CreateSphere </span><span id=t43>( количество сегментов, [родитель] )</span></b><span id=t9> – очень частой ошибкой является то, что в поле, где указывается количество сегментов, вместо них указывают родителя…</span></p> <p id=t8><span id=t9>&nbsp;</span></p> <p id=t8><span id=t9>2) Задать привязку можно не только во время создания объекта, но и после этого – командой </span><b><span id=t43>EntityParent</span><span id=t43> объект, родитель</span></b><span id=t9> – эта команда привязывает заданный объект к заданному родителю. Вместо родителя можно поставить 0 (ноль, если кто не понял </span><span id=t10><span id=t11>J</span></span><span id=t9>) – и это «отвяжет» заданный объект от родителя, каким бы страшным этот родитель ни был </span><span id=t10><span id=t11>J<span id=t11>J<span id=t11>J</span></span></span></span><span id=t9>…</span></p> <p id=t8><span id=t9>&nbsp;</span></p> <p id=t8><span id=t9>Ну, и напоследок – то, что можно сделать, изучив технологию привязок:</span></p> <p id=t8><span id=t9>&nbsp;</span></p> <table id=t24> <tr id=t46> <td id=t47> <p id=t27><span id=t28>Graphics3D </span><span id=t29>640</span><span id=t30>,</span><span id=t29>480</span><span id=t30>,</span><span id=t29>16</span><span id=t30>,</span><span id=t29>1</span></p> <p id=t27><span id=t28>SetBuffer BackBuffer</span><span id=t30>()</span></p> <p id=t27><span id=t30>&nbsp;</span></p> <p id=t27><span id=t31>lit</span><span id=t30>=</span><span id=t28>CreateLight</span><span id=t30>()</span></p> <p id=t27><span id=t30>&nbsp;</span></p> <p id=t27><span id=t28>Dim </span><span id=t31>sp</span><span id=t30>(</span><span id=t29>99</span><span id=t30>)</span></p> <p id=t27><span id=t30>&nbsp;</span></p> <p id=t27><span id=t31>sp</span><span id=t30>(</span><span id=t29>0</span><span id=t30>)=</span><span id=t28>CreateSphere</span><span id=t30>(</span><span id=t29>8</span><span id=t30>)</span></p> <p id=t27><span id=t28>EntityAlpha </span><span id=t31>sp</span><span id=t30>(</span><span id=t29>0</span><span id=t30>),</span><span id=t29>0</span></p> <p id=t27><span id=t29>&nbsp;</span></p> <p id=t27><span id=t28>For </span><span id=t31>i</span><span id=t30>=</span><span id=t29>1 </span><span id=t28>To </span><span id=t29>99</span></p> <p id=t27><span id=t29><span id=t15> </span></span><span id=t31>sp</span><span id=t30>(</span><span id=t31>i</span><span id=t30>)=</span><span id=t28>CreateSphere</span><span id=t30>(</span><span id=t29>8</span><span id=t30>,</span><span id=t31>sp</span><span id=t30>(</span><span id=t31>i</span><span id=t30>-</span><span id=t29>1</span><span id=t30>))</span></p> <p id=t27><span id=t30><span id=t15> </span></span><span id=t28>PositionEntity </span><span id=t31>sp</span><span id=t30>(</span><span id=t31>i</span><span id=t30>),</span><span id=t29>1</span><span id=t30>,</span><span id=t29>1</span><span id=t30>,</span><span id=t29>1</span></p> <p id=t27><span id=t29><span id=t15> </span></span><span id=t28>EntityColor </span><span id=t31>sp</span><span id=t30>(</span><span id=t31>i</span><span id=t30>),</span><span id=t29>250</span><span id=t30>,</span><span id=t29>215</span><span id=t30>,</span><span id=t31>i</span><span id=t30>*</span><span id=t29>2</span></p> <p id=t27><span id=t29><span id=t15> </span></span><span id=t28>EntityAlpha </span><span id=t31>sp</span><span id=t30>(</span><span id=t31>i</span><span id=t30>),(</span><span id=t29>100</span><span id=t30>-</span><span id=t31>i</span><span id=t30>)*.</span><span id=t29>01</span></p> <p id=t27><span id=t28>Next</span></p> <p id=t27><span id=t28>&nbsp;</span></p> <p id=t27><span id=t31>cam</span><span id=t30>=</span><span id=t28>CreateCamera</span><span id=t30>(</span><span id=t29>0</span><span id=t30>)</span></p> <p id=t27><span id=t28>PositionEntity</span><span id=t50> </span><span id=t31>cam</span><span id=t30>,</span><span id=t29>0</span><span id=t30>,</span><span id=t29>30</span><span id=t30>,</span><span id=t29>0</span><span id=t50></span></p> <p id=t27><span id=t29>&nbsp;</span></p> <p id=t27><span id=t29>&nbsp;</span></p> <p id=t27><span id=t28>Repeat</span></p> <p id=t27><span id=t28><span id=t15> </span></span></p> <p id=t27><span id=t28><span id=t15> </span>For </span><span id=t31>i</span><span id=t30>=</span><span id=t29>0 </span><span id=t28>To </span><span id=t29>99</span></p> <p id=t27><span id=t29><span id=t15>  </span></span><span id=t28>TurnEntity </span><span id=t31>sp</span><span id=t30>(</span><span id=t31>i</span><span id=t30>),.</span><span id=t29>1</span><span id=t30>,.</span><span id=t29>2</span><span id=t30>,.</span><span id=t29>3</span></p> <p id=t27><span id=t29><span id=t15> </span></span><span id=t28>Next</span></p> <p id=t27><span id=t28><span id=t15> </span></span></p> <p id=t27><span id=t28><span id=t15> </span>PointEntity </span><span id=t31>cam</span><span id=t30>,</span><span id=t31>sp</span><span id=t30>(</span><span id=t29>99</span><span id=t30>)</span></p> <p id=t27><span id=t30><span id=t15> </span></span></p> <p id=t27><span id=t30><span id=t15> </span></span><span id=t28>UpdateWorld</span></p> <p id=t27><span id=t28><span id=t15> </span>RenderWorld</span></p> <p id=t27><span id=t28>&nbsp;</span></p> <p id=t27><span id=t28><span id=t15> </span>Flip</span></p> <p id=t27><span id=t28>&nbsp;</span></p> <p id=t27><span id=t28>Until KeyHit</span><span id=t30>(</span><span id=t29>1</span><span id=t30>)</span></p> <p id=t27><span id=t30>&nbsp;</span></p> <p id=t48><span id=t28>End</span><span id=t33></span></p> </td> </tr> </table> <p id=t8><span id=t9>&nbsp;</span></p> <p id=t8><span id=t9>Ну, вы поняли, как это работает? Ну, давайте – подумайте! Вы же всё-таки программеры – даже если вы задумали всю жизнь программировать один, вам всё равно придётся читать чужие коды – чтобы понять как работает та или иная фишка. А про команду </span><b><span id=t43>EntityAlpha</span></b><span id=t43> </span><span id=t9>– посмотрите в хелпе, потому что, даже если вы совершенно ничего не знаете в английском – в хелп придётся обращаться очень часто, поэтому, лучше учиться сейчас… </span><span id=t57><span id=t11>J</span></span><span id=t9>.</span></p> <p id=t8><span id=t9>&nbsp;</span></p> <p id=t8>&nbsp;<span id=t9></span></p> </td> <td id=t58> <p id=t8><span id=t9><span id=t15> </span></span><b><span id=t16>Оглавление:</span></b></p> <p id=t8><span id=t9>&nbsp;</span></p> <p id=t17><span id=t18>0.<span id=t19>&nbsp; </span></span><span id=t18><a href="Blitz_0.htm">Введение</a></span></p> <p id=t17><span id=t18>1.<span id=t19>&nbsp; </span></span><span id=t18><a href="Blitz_1.htm">В начале была Тьма</a></span></p> <p id=t17><span id=t18>2.<span id=t19>&nbsp; </span></span><span id=t18><a href="Blitz_2.htm">Есть ли жизнь в <span id=t20>DirectX</span></a></span></p> <p id=t17><span id=t18>3.<span id=t19>&nbsp; </span></span><span id=t18><a href="Blitz_3.htm">Свобода и Власть 3Д (0)</a></span></p> <p id=t17><span id=t18>4.<span id=t19>&nbsp; </span></span><span id=t18><a href="Blitz_4.htm">Свобода и Власть 3Д (1)</a></span></p> <p id=t17><span id=t18>5.<span id=t19>&nbsp; </span></span><span id=t18><a href="Blitz_5.htm">2Д в 3Д</a></span></p> <p id=t17><span id=t18>6.<span id=t19>&nbsp; </span></span><span id=t18><a href="Blitz_6.htm">Трёхмерный курсор</a></span></p> <p id=t17><span id=t18>7.<span id=t19>&nbsp; </span></span><span id=t18><a href="Blitz_7.htm">Родительская зависимость или Привязки</a></span></p> <p id=t17><span id=t18>8.<span id=t19>&nbsp; </span></span><span id=t18><a href="Blitz_8.htm">Фишки с привязками</a></span></p> <p id=t17><span id=t18>9.<span id=t19>&nbsp; </span></span><span id=t18><a href="Blitz_9.htm">Коллизион Детекшн или как устроен мир…</a></span></p> <p id=t21><span id=t18>10.<span id=t19>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span id=t18><a href="Blitz_10.htm">Первая 3Д игра. Часть 0 – основы движка</a></span></p> <p id=t21><span id=t18>11.<span id=t19>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span id=t18><a href="Blitz_11.htm">Первая 3Д игра. Часть 1 – разработка движка</a></span></p> <p id=t21><span id=t18>12.<span id=t19>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span id=t18><a href="Blitz_12.htm">Первая 3Д игра. Часть 2 – устранение багов</a></span></p> <p id=t21><span id=t18>13.<span id=t19>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span id=t18><a href="Blitz_13.htm">Первая 3Д игра. Часть 3 – внешний вид</a></span></p> <p id=t21><span id=t18>14.<span id=t19>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span id=t18><a href="Blitz_14.htm">Первая 3Д игра. Часть 4 – от массива к спискам</a></span></p> <p id=t21><span id=t18>15.<span id=t19>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span id=t18><a href="Blitz_15.htm">Первая 3Д игра. Часть 5 – оптимизация кода</a></span></p> <p id=t21><span id=t18>16.<span id=t19>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span id=t18><a href="Blitz_16.htm">Первая 3Д игра. Часть 6 – завершение</a></span></p> <p id=t21><span id=t18>17.<span id=t19>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span id=t18><a href="Blitz_17.htm">Выведение</a></span></p> <p id=t8><span id=t18>&nbsp;</span></p> <p id=t6><span id=t18>&nbsp;</span></p> <p id=t8>&nbsp;<span id=t18></span></p> </td> </tr></table><p id=t6><span id=t20>&nbsp;</span></p></div></body></html>