<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru" dir="ltr">	
<!-- Mirrored from localhost/index.php/%D0%A3%D0%BF%D0%B0%D0%BA%D0%BE%D0%B2%D0%BA%D0%B0_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85_%D1%81_%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E_TeraBit_DataPak by HTTrack Website Copier/3.x [XR&CO'2007], Sat, 10 Nov 2007 05:16:49 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
<head>		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />				<meta name="keywords" content="Упаковка данных с помощью TeraBit DataPak" />
		<link rel="shortcut icon" href="http://blitzetcetera.org/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="http://blitzetcetera.org/opensearch_desc.php" title="Blitz Et Cetera (Русский)" />
		<title>Упаковка данных с помощью TeraBit DataPak — Blitz Et Cetera</title>		<style type="text/css" media="screen,projection">/*<![CDATA[*/ @import "bvih5rde.css?63"; /*]]>*/</style>		<link rel="stylesheet" type="text/css" media="print" href="gcxktlm6.css?63" />		<link rel="stylesheet" type="text/css" media="handheld" href="zumsslq_.css?63" />		<!--[if lt IE 5.5000]><style type="text/css">@import "/skins/OfflineNew/IE50Fixes.css?63";</style><![endif]-->		<!--[if IE 5.5000]><style type="text/css">@import "/skins/OfflineNew/IE55Fixes.css?63";</style><![endif]-->		<!--[if IE 6]><style type="text/css">@import "/skins/OfflineNew/IE60Fixes.css?63";</style><![endif]-->		<!--[if IE 7]><style type="text/css">@import "/skins/OfflineNew/IE70Fixes.css?63";</style><![endif]-->		<!--[if lt IE 7]><script type="text/javascript" src="/skins/common/IEFixes.js?63"></script>		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->		<script type= "text/javascript">/*<![CDATA[*/
var skin = "OfflineNew";
var stylepath = "/skins";
var wgArticlePath = "/index.php/$1";
var wgScriptPath = "";
var wgServer = "http://blitzetcetera.org/";
var wgCanonicalNamespace = "";
var wgCanonicalSpecialPageName = false;
var wgNamespaceNumber = 0;
var wgPageName = "Упаковка_данных_с_помощью_TeraBit_DataPak";
var wgTitle = "Упаковка данных с помощью TeraBit DataPak";
var wgAction = "view";
var wgArticleId = "762";
var wgIsArticle = true;
var wgUserName = null;
var wgUserGroups = null;
var wgUserLanguage = "ru";
var wgContentLanguage = "ru";
var wgBreakFrames = false;
var wgCurRevisionId = "3586";
/*]]>*/</script>
		<script type="text/javascript" src="2nq-6cel.js?63"><!-- wikibits js --></script>		<script type="text/javascript" src="http://blitzetcetera.org/index.php?title=-&amp;action=raw&amp;gen=js"><!-- site js --></script>		<style type="text/css">/*<![CDATA[*/
@import "http://blitzetcetera.org/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://blitzetcetera.org/index.php?title=MediaWiki:OfflineNew.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://blitzetcetera.org/index.php?title=-&amp;action=raw&amp;gen=css&amp;maxage=18000";
/*]]>*/</style>		<!-- Head Scripts -->	</head><body  class="mediawiki ns-0 ltr page-Упаковка_данных_с_помощью_TeraBit_DataPak">	<div id="globalWrapper">	<div id="logocontainer">		<table align="center">		  <tr>				<td id="blitzetclogo">				</td>			</tr>		</table>	</div>	<div id="magbar">	Журнал о программированнии на языках Blitz3D, BlitzMax, BlitzPlus	</div>		<div id="column-content">	<div id="content">		<a name="top" id="top"></a>				<div id="bodyContent">		<table cellspacing=0 cellpadding=0 width=100%>			<tr>			  <td class="leftside">				</td>				<td class="sheetbody">					<h1 class="sheet">Упаковка данных с помощью TeraBit DataPak</h1>			<h3 id="siteSub">Материал из Blitz Et Cetera.</h3>			<div id="contentSub"></div>			<!-- start content -->			<table id="toc" class="toc" summary="Содержание"><tr><td><div id="toctitle"><h2>Содержание</h2></div>
<ul>
<li class="toclevel-1"><a href="#.D0.92.D0.B2.D0.B5.D0.B4.D0.B5.D0.BD.D0.B8.D0.B5"><span class="tocnumber">1</span> <span class="toctext">Введение</span></a></li>
<li class="toclevel-1"><a href="#.D0.A7.D1.82.D0.BE_.D1.82.D0.B0.D0.BA.D0.BE.D0.B5_Terabit_DataPacker.3F"><span class="tocnumber">2</span> <span class="toctext">Что такое Terabit DataPacker?</span></a></li>
<li class="toclevel-1"><a href="#.D0.9F.D0.BE.D0.B4.D0.B3.D0.BE.D1.82.D0.BE.D0.B2.D0.B8.D1.82.D0.B5.D0.BB.D1.8C.D0.BD.D1.8B.D0.B9_.D1.8D.D1.82.D0.B0.D0.BF"><span class="tocnumber">3</span> <span class="toctext">Подготовительный этап</span></a></li>
<li class="toclevel-1"><a href="#.D0.98.D1.82.D0.B0.D0.BA.2C_.D0.BD.D0.B0.D1.87.D0.BD.D0.B5.D0.BC"><span class="tocnumber">4</span> <span class="toctext">Итак, начнем</span></a></li>
<li class="toclevel-1"><a href="#.D0.A8.D0.B0.D0.B3_.D0.BF.D0.B5.D1.80.D0.B2.D1.8B.D0.B9:_.D0.9F.D0.B8.D1.88.D0.B5.D0.BC_.D1.81.D0.B2.D0.BE.D1.8E_.D0.BF.D1.80.D0.BE.D0.B3.D1.80.D0.B0.D0.BC.D0.BC.D1.83"><span class="tocnumber">5</span> <span class="toctext">Шаг первый: Пишем свою программу</span></a></li>
<li class="toclevel-1"><a href="#.D0.A8.D0.B0.D0.B3_2._.D0.A1.D0.BE.D0.B7.D0.B4.D0.B0.D0.B5.D0.BC_.D1.81.D0.B2.D0.BE.D0.B9_.D1.81.D0.BE.D0.B1.D1.81.D1.82.D0.B2.D0.B5.D0.BD.D0.BD.D1.8B.D0.B9_Data.pak"><span class="tocnumber">6</span> <span class="toctext">Шаг 2. Создаем свой собственный Data.pak</span></a></li>
<li class="toclevel-1"><a href="#.D0.A8.D0.B0.D0.B3_3:_.D0.9C.D0.BE.D0.B4.D0.B8.D1.84.D0.B8.D1.86.D0.B8.D1.80.D1.83.D0.B5.D0.BC_.D0.BD.D0.B0.D1.88.D1.83_.D0.BF.D1.80.D0.BE.D0.B3.D1.80.D0.B0.D0.BC.D0.BC.D1.83"><span class="tocnumber">7</span> <span class="toctext">Шаг 3: Модифицируем нашу программу</span></a></li>
<li class="toclevel-1"><a href="#.D0.97.D0.B0.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B5"><span class="tocnumber">8</span> <span class="toctext">Заключение</span></a></li>
</ul>
</td></tr></table><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "показать"; var tocHideText = "убрать"; showTocToggle(); } </script>
<a name=".D0.92.D0.B2.D0.B5.D0.B4.D0.B5.D0.BD.D0.B8.D0.B5"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A3%D0%BF%D0%B0%D0%BA%D0%BE%D0%B2%D0%BA%D0%B0_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85_%D1%81_%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E_TeraBit_DataPak&amp;action=edit&amp;section=1" title="Править секцию: Введение">править</a>]</span> <span class="mw-headline">Введение</span></h2>
<p>Вы наверняка знаете о том, что разработчики игр часто запаковывают ресурсы своих игр для того чтобы облегчить их распространение и защитить данные от использования посторонними людьми. Один из самых, на мой взгляд, лучших, бесплатных  упаковщиков является Terabit DataPacker от Lee Page. В этой статье я попробую объяснить, как правильно хранить ресурсы вашего проекта.
</p>
<a name=".D0.A7.D1.82.D0.BE_.D1.82.D0.B0.D0.BA.D0.BE.D0.B5_Terabit_DataPacker.3F"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A3%D0%BF%D0%B0%D0%BA%D0%BE%D0%B2%D0%BA%D0%B0_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85_%D1%81_%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E_TeraBit_DataPak&amp;action=edit&amp;section=2" title="Править секцию: Что такое Terabit DataPacker?">править</a>]</span> <span class="mw-headline">Что такое Terabit DataPacker?</span></h2>
<p>Из названия все итак понятно, но вот что говорит сам Lee: "TeraBit DataPacker был разработан для того, чтобы вы могли защищать свои медиа-файлы от похитителей. Это не идеальная защита, но она доставит много неприятностей тем, кто попытается ее взломать. Если вы хотите, чтобы игру могли модифицировать, то просто дайте возможность пользователям создавать свои собственные архивы и раздайте им соответствующие ключи."
</p><p>Некоторые моменты, которые следует помнить:
Рекомендуется  самим стараться делать файлы как можно меньше.
Сам Terabit DataPacker не сжимает их! Обычно файлы изображений хранят в формате PNG. Если у вас большие красочные изображения, которым не нужна прозрачность, то лучше использовать формат JPG. Музыку обычно хранят в OGG или MP3 (но последнее защищено авторскими правами).
</p>
<a name=".D0.9F.D0.BE.D0.B4.D0.B3.D0.BE.D1.82.D0.BE.D0.B2.D0.B8.D1.82.D0.B5.D0.BB.D1.8C.D0.BD.D1.8B.D0.B9_.D1.8D.D1.82.D0.B0.D0.BF"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A3%D0%BF%D0%B0%D0%BA%D0%BE%D0%B2%D0%BA%D0%B0_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85_%D1%81_%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E_TeraBit_DataPak&amp;action=edit&amp;section=3" title="Править секцию: Подготовительный этап">править</a>]</span> <span class="mw-headline">Подготовительный этап</span></h2>
<p>Вам понадобятся следующие файлы:
</p>
<ul><li><a href="http://blitzetcetera.org/images/2/26/PakMaker.zip" class="internal" title="PakMaker.zip">Медиа:PakMaker.zip</a> - Terabit DataPacker (также содержит примеры) 
</li><li>DataPak01.bb - Пример 1 (обычная программа)
</li><li>DataPak02.bb - Пример 2 (Использующая архив data.pak) 
</li><li>DataPak-Grisu.png - небольшое изображение (64x64)
</li></ul>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:DataPak-Grisu.png" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:DataPak-Grisu.png" src="mk5-13mx.png" width="64" height="64" /></a></span></div></div>
<a name=".D0.98.D1.82.D0.B0.D0.BA.2C_.D0.BD.D0.B0.D1.87.D0.BD.D0.B5.D0.BC"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A3%D0%BF%D0%B0%D0%BA%D0%BE%D0%B2%D0%BA%D0%B0_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85_%D1%81_%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E_TeraBit_DataPak&amp;action=edit&amp;section=4" title="Править секцию: Итак, начнем">править</a>]</span> <span class="mw-headline">Итак, начнем</span></h2>
<p>Скачайте и распакуйте архив DATAPAK.ZIP. Нам не нужны все файлы из этого архива, поэтому создайте еще одну папку TUTORIAL, а в ней папку DATA. Скопируйте BONES.BB и PACKMAKER.EXE в TUTORIAL, а GRISU.PNG в папку DATA.
</p><p>Совет: Вам следует всегда хранить файлы ресурсов в папках отличных от директории где вы храните исходники. Это позволяет держать файлы упорядоченными и облегчает запаковку данных. В проектах побольше вы можете создавать еще и поддиректории в папке DATA такие как IMAGES, MEDIA, MUSIC, MODELS. Но для нас сейчас будет достаточно одной папки.
</p>
<a name=".D0.A8.D0.B0.D0.B3_.D0.BF.D0.B5.D1.80.D0.B2.D1.8B.D0.B9:_.D0.9F.D0.B8.D1.88.D0.B5.D0.BC_.D1.81.D0.B2.D0.BE.D1.8E_.D0.BF.D1.80.D0.BE.D0.B3.D1.80.D0.B0.D0.BC.D0.BC.D1.83"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A3%D0%BF%D0%B0%D0%BA%D0%BE%D0%B2%D0%BA%D0%B0_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85_%D1%81_%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E_TeraBit_DataPak&amp;action=edit&amp;section=5" title="Править секцию: Шаг первый: Пишем свою программу">править</a>]</span> <span class="mw-headline"><i><b>Шаг первый: Пишем свою программу</b></i></span></h2>
<p>Для начала нам потребуется программа, которая будет использовать наш архив. Нет ничего проще. Я уже подготовил одну такую:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffee00">;</span><br />
<p><span style="color: #ffee00">; Пример 1: Программа, использующая один рисунок в качестве фонового таила.</span><br />
<span style="color: #ffee00">; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br />
<br />
<span style="color: #ffee00">; [ Переменные ]_____________________________________________</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Global</span> IMGGrisu &nbsp;<span style="color: #ffee00">; переменная хранящая хэндл изображения</span><br />
<span style="color: #aaffff; font-weight: bold;">Global</span> angle#,r# <span style="color: #ffee00">; угол и радиус, используемые для вращения текста</span><br />
<br />
<br />
<span style="color: #ffee00">; [ Loading Data ]__________________________________________</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> LoadData<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
&nbsp; IMGGrisu=<span style="color: #aaffff; font-weight: bold;">LoadImage</span><span style=" ">&#40;</span><span style="color: #00ff66;">&quot;DATA\grisu.png&quot;</span><span style=" ">&#41;</span> <span style="color: #ffee00">; Загружает картинку</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">MaskImage</span> IMGGrisu,<span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span> &nbsp; &nbsp; &nbsp; <span style="color: #ffee00">; Создает маску</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span> <br />
<br />
<span style="color: #ffee00">; [ Main Loop ]_____________________________________________</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Graphics</span> <span style="color: #33ffdd;">640</span>,<span style="color: #33ffdd;">480</span>,<span style="color: #33ffdd;">16</span>,<span style="color: #33ffdd;">2</span> &nbsp;<span style="color: #ffee00">; устанавливаем графический режим</span><br />
<span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">BackBuffer</span><span style=" ">&#40;</span><span style=" ">&#41;</span> <span style="color: #ffee00">; устанавливаем буфер</span><br />
<span style="color: #aaffff; font-weight: bold;">ClsColor</span> <span style="color: #33ffdd;">33</span>,<span style="color: #33ffdd;">57</span>,<span style="color: #33ffdd;">73</span> &nbsp; &nbsp; &nbsp;<span style="color: #ffee00">; Цвет фона</span><br />
angle#=<span style="color: #33ffdd;">0</span>:r#=<span style="color: #33ffdd;">0</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #ffee00">; Обнуляем угол и радиус</span><br />
<br />
LoadData<span style=" ">&#40;</span><span style=" ">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffee00">; Загружаем все данные</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">While</span> <span style="color: #aaffff; font-weight: bold;">Not</span> <span style="color: #aaffff; font-weight: bold;">KeyHit</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span> &nbsp; &nbsp;<span style="color: #ffee00">; Пока не нажата клавиша ESC,&nbsp;:</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Cls</span><br />
<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> IMGGrisu &gt; <span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">TileImage</span> IMGGrisu,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span> <span style="color: #ffee00">; Рисуем картинку если она есть &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br />
<br />
&nbsp; angle=<span style=" ">&#40;</span>angle<span style="color: #33ffdd;">+1</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Mod</span> <span style="color: #33ffdd;">360</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffee00">; Рассчитываем вращение</span><br />
&nbsp; r=<span style=" ">&#40;</span>r<span style="color: #33ffdd;">+0.5</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Mod</span> <span style="color: #33ffdd;">300</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #aaffff; font-weight: bold;">GraphicsWidth</span><span style=" ">&#40;</span><span style=" ">&#41;</span>/<span style="color: #33ffdd;">2</span>+<span style="color: #aaffff; font-weight: bold;">Cos</span><span style=" ">&#40;</span>angle<span style=" ">&#41;</span>*r,<span style="color: #aaffff; font-weight: bold;">GraphicsHeight</span><span style=" ">&#40;</span><span style=" ">&#41;</span>/<span style="color: #33ffdd;">2</span>-<span style="color: #aaffff; font-weight: bold;">Sin</span><span style=" ">&#40;</span>angle<span style=" ">&#41;</span>*r,<span style="color: #00ff66;">&quot;Grisu's Tutorial No. 1&quot;</span>,<span style="color: #33ffdd;">1</span>,<span style="color: #33ffdd;">1</span> <span style="color: #ffee00">; Добавим немного текста</span><br />
<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Flip</span><br />
<span style="color: #aaffff; font-weight: bold;">Wend</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #ffee00">; Конец основного цикла</span><br />
&nbsp;<br />
</p>
<span style="color: #aaffff; font-weight: bold;">End</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffee00">; Выход их программы</span></div>
<p>Программа использует только GRISU.PNG из нашей папки DATA в качестве фонового рисунка. Загрузка файла выполнена с помощью отдельной функции так же, как и в больших проектах. Таким образом, мы сразу делаем рациональную структуру кода.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Function</span> LoadData<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<p><br />
&nbsp; IMGGrisu=<span style="color: #aaffff; font-weight: bold;">LoadImage</span><span style=" ">&#40;</span><span style="color: #00ff66;">&quot;Data\GRISU.PNG&quot;</span><span style=" ">&#41;</span> <span style="color: #ffee00">; Загружает картинку</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">MaskImage</span> IMGGrisu,<span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span> &nbsp; &nbsp; &nbsp; <span style="color: #ffee00">; Создает маску</span><br />
<br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<a name=".D0.A8.D0.B0.D0.B3_2._.D0.A1.D0.BE.D0.B7.D0.B4.D0.B0.D0.B5.D0.BC_.D1.81.D0.B2.D0.BE.D0.B9_.D1.81.D0.BE.D0.B1.D1.81.D1.82.D0.B2.D0.B5.D0.BD.D0.BD.D1.8B.D0.B9_Data.pak"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A3%D0%BF%D0%B0%D0%BA%D0%BE%D0%B2%D0%BA%D0%B0_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85_%D1%81_%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E_TeraBit_DataPak&amp;action=edit&amp;section=6" title="Править секцию: Шаг 2. Создаем свой собственный Data.pak">править</a>]</span> <span class="mw-headline">Шаг 2. Создаем свой собственный Data.pak</span></h2>
<p>Для этого запустим PACKMAKER.EXE. Он будет выглядеть примерно так:
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:DataPak01.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:DataPak01.jpg" src="kh72vn2-.jpg" width="639" height="423" /></a></span></div></div>
<ul><li>Теперь просто выберите файлы, которые вы хотите запаковать, просто щелкнув по ним левой кнопкой мыши. Сейчас нам нужно, что бы был выбран файл DATA\GRISU.PNG
</li><li>Так же нам нужно что бы файл был закодирован, для этого поставьте галочку напротив "Secure my Data with Encryption".
</li><li>Вы можете создавать новый ключ для каждого из ваших проектов или разных ресурсов Для нашего обучения мы будем использовать ключи: 9FAF43FB в качестве "Basic Key" и 629FC914 в качестве "Header Mask". Заметьте что Initialisation Code внизу окна меняется в то время как вы вводите новые ключи.
</li><li>Кликните на "Create Pak Archive", создастся архив DATA.PAK, который будет содержать все выбранные вами файлы.
</li><li>Наконец запишите "Initialisation Code", мы будем использовать его в дальнейшем.
</li></ul>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:DataPak02.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:DataPak02.jpg" src="07ypig28-2.jpg" width="640" height="424" /></a></span></div></div>
<a name=".D0.A8.D0.B0.D0.B3_3:_.D0.9C.D0.BE.D0.B4.D0.B8.D1.84.D0.B8.D1.86.D0.B8.D1.80.D1.83.D0.B5.D0.BC_.D0.BD.D0.B0.D1.88.D1.83_.D0.BF.D1.80.D0.BE.D0.B3.D1.80.D0.B0.D0.BC.D0.BC.D1.83"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A3%D0%BF%D0%B0%D0%BA%D0%BE%D0%B2%D0%BA%D0%B0_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85_%D1%81_%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E_TeraBit_DataPak&amp;action=edit&amp;section=7" title="Править секцию: Шаг 3: Модифицируем нашу программу">править</a>]</span> <span class="mw-headline">Шаг 3: Модифицируем нашу программу</span></h2>
<ul><li>Теперь у нас есть файл DATA.PAK. Но наша программа не сможет прочитать данные хранящиеся внутри него без некоторых изменений в коде.
</li><li>Блитц должен распознавать функции Terabit Packer. Поэтому добавим Include Bones.bb" в начало исходника.
</li><li>Нам также потребуется директория, в которую будут распаковываться файлы:  PakOutputDir="". Она может находится где угодно. По-умолчанию файлы будут распакованы в основную директорию вашей программы.
</li><li>Теперь добавьте код инициализации, который вы только что написали.
</li><li>Установите флаг "PakBulkoverwrite=True", старые файлы данных с одинаковыми именами будут перезаписываться. Полезно когда файлы изменяются во время разработки.
</li></ul>
<p>Весь код заголовка будет выглядеть примерно так:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffee00">;________________________________________</span><br />
<p><span style="color: #aaffff; font-weight: bold;">Include</span> <span style="color: #00ff66;">&quot;Bones.bb&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #ffee00">; Добавим функции упаковщика</span><br />
PakOutputDir <span style="color: #00ff66;">&quot;&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />
PakInit &nbsp; &nbsp; &nbsp;<span style="color: #00ff66;">&quot;Data.pak&quot;</span>, $9FAF43FB, <span style="color: #00ff66;">&quot;TMP&quot;</span>, $629FC914 <span style="color: #ffee00">; Это ваша инициализирующая команда</span><br />
</p>
PakBulkOverWrite = <span style="color: #aaffff; font-weight: bold;">True</span> &nbsp;<span style="color: #ffee00">; Установите это &nbsp;True во время разработки, False при релизе.</span></div>
<p>Теперь наша программа знает как распознавать наш DATA.PAK. Последнее что осталось сделать это изменить функцию LoadData(). Каждый раз когда мы захотим обратиться к DATA.PAK нам будет нужно немного изменить родные функции блица. Для этого  добавьте "PAK(" - ")" к использующимся командам. Помните, что в кавычках должно быть только название файла без остальных параметров функции.
</p><p>Пример:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">Sound=<span style="color: #aaffff; font-weight: bold;">LoadSound</span><span style=" ">&#40;</span>Pak<span style=" ">&#40;</span><span style="color: #00ff66;">&quot;data\crazysound.mp3&quot;</span><span style=" ">&#41;</span><span style=" ">&#41;</span><br />
<p>AnimImg=<span style="color: #aaffff; font-weight: bold;">LoadAnimImage</span><span style=" ">&#40;</span>Pak<span style=" ">&#40;</span><span style="color: #00ff66;">&quot;data\animation.png&quot;</span><span style=" ">&#41;</span>,<span style="color: #33ffdd;">64</span>,<span style="color: #33ffdd;">64</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">10</span><span style=" ">&#41;</span><br />
</p>
Texture=<span style="color: #aaffff; font-weight: bold;">LoadTexture</span><span style=" ">&#40;</span>Pak<span style=" ">&#40;</span><span style="color: #00ff66;">&quot;data\texture.jpg&quot;</span><span style=" ">&#41;</span>,<span style="color: #33ffdd;">56</span><span style=" ">&#41;</span></div>
<p>Все что нам нужно это загрузить картинку. Сделайте следующие изменения:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">IMGGrisu=<span style="color: #aaffff; font-weight: bold;">LoadImage</span><span style=" ">&#40;</span>Pak<span style=" ">&#40;</span><span style="color: #00ff66;">&quot;DATA\GRISU.PNG&quot;</span><span style=" ">&#41;</span><span style=" ">&#41;</span></div>
<p>Программа теперь будет работать без ваших файлов данных. В нашем примере это картинка GRISU.PNG. Но как вы могли заметить, временный файл который распаковывается при использовании ( TMPGRISU.PNG ) все еще назодится в папке DATA. Даже если программа выключается.
</p><p>Каждый раз когда вам понадобятся ресурсы из вашего DATA.PAK вы можете дописывать функцию DlPAK(). Она всегда будет удалять последний распакованный файл.
</p><p>Если вы не хотите каждый раз вызывать эту функцию, то можете написать ее в конце вашего кода. Она удалит все временные файлы.
</p><p>Использование DLPak() может сказаться на производительности если ее часто использовать.
</p><p>Файл DataPak02.bb содержит все текущие изменения:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffee00">;</span><br />
<p><span style="color: #ffee00">; Пример 2: Программа, использующая один рисунок в качестве фонового тайла.</span><br />
<span style="color: #ffee00">; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Использует отдельный архив с ресурсами.</span><br />
<br />
<span style="color: #ffee00">; [ Terabit Packer ]________________________________________</span><br />
<span style="color: #aaffff; font-weight: bold;">Include</span> <span style="color: #00ff66;">&quot;Bones.bb&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #ffee00">; Добавим функции упаковщика</span><br />
PakOutputDir <span style="color: #00ff66;">&quot;&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />
PakInit &nbsp; &nbsp; &nbsp;<span style="color: #00ff66;">&quot;Data.pak&quot;</span>, $9FAF43FB, <span style="color: #00ff66;">&quot;TMP&quot;</span>, $629FC914 <span style="color: #ffee00">; Это ваша инициализирующая команда</span><br />
PakBulkOverWrite = <span style="color: #aaffff; font-weight: bold;">True</span> &nbsp;<span style="color: #ffee00">; Установите это в True во время разработки, в False при релизе.</span><br />
<br />
<span style="color: #ffee00">; [ Переменные ]_____________________________________________</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Global</span> IMGGrisu &nbsp;<span style="color: #ffee00">; переменная хранящая хэндл изображения</span><br />
<span style="color: #aaffff; font-weight: bold;">Global</span> angle#,r# <span style="color: #ffee00">; угол и радиус, используемые для вращения текста</span><br />
<br />
<br />
<br />
<br />
<span style="color: #ffee00">; [ Loading Data ]__________________________________________</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> LoadData<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
&nbsp; IMGGrisu=<span style="color: #aaffff; font-weight: bold;">LoadImage</span><span style=" ">&#40;</span>Pak<span style=" ">&#40;</span><span style="color: #00ff66;">&quot;DATA\GRISU.PNG&quot;</span><span style=" ">&#41;</span><span style=" ">&#41;</span> <span style="color: #ffee00">; Загружает изображение, ничего особенного!</span><br />
&nbsp; &nbsp; DlPak<span style=" ">&#40;</span><span style=" ">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #ffee00">; Удаляет временный файл</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">MaskImage</span> IMGGrisu,<span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span> &nbsp; &nbsp; &nbsp; <span style="color: #ffee00">; Создает маску</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span> <br />
<br />
<br />
<span style="color: #ffee00">; [ Main Loop ]_____________________________________________</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Graphics</span> <span style="color: #33ffdd;">640</span>,<span style="color: #33ffdd;">480</span>,<span style="color: #33ffdd;">16</span>,<span style="color: #33ffdd;">2</span> &nbsp;<span style="color: #ffee00">; устанавливаем графический режим</span><br />
<span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">BackBuffer</span><span style=" ">&#40;</span><span style=" ">&#41;</span> <span style="color: #ffee00">; устанавливаем буфер</span><br />
<span style="color: #aaffff; font-weight: bold;">ClsColor</span> <span style="color: #33ffdd;">33</span>,<span style="color: #33ffdd;">57</span>,<span style="color: #33ffdd;">73</span> &nbsp; &nbsp; &nbsp;<span style="color: #ffee00">; Цвет фона</span><br />
angle#=<span style="color: #33ffdd;">0</span>:r#=<span style="color: #33ffdd;">0</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #ffee00">; Обнуляем угол и радиус</span><br />
<br />
LoadData<span style=" ">&#40;</span><span style=" ">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffee00">; Загружаем все данные</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">While</span> <span style="color: #aaffff; font-weight: bold;">Not</span> <span style="color: #aaffff; font-weight: bold;">KeyHit</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span> &nbsp; &nbsp;<span style="color: #ffee00">; Пока не нажата клавиша ESC,&nbsp;:</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Cls</span><br />
<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> IMGGrisu &gt; <span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">TileImage</span> IMGGrisu,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span> <span style="color: #ffee00">; Рисуем картинку если она есть &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br />
<br />
&nbsp; angle=<span style=" ">&#40;</span>angle<span style="color: #33ffdd;">+1</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Mod</span> <span style="color: #33ffdd;">360</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffee00">; Рассчитываем вращение</span><br />
&nbsp; r=<span style=" ">&#40;</span>r<span style="color: #33ffdd;">+0.5</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Mod</span> <span style="color: #33ffdd;">300</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #aaffff; font-weight: bold;">GraphicsWidth</span><span style=" ">&#40;</span><span style=" ">&#41;</span>/<span style="color: #33ffdd;">2</span>+<span style="color: #aaffff; font-weight: bold;">Cos</span><span style=" ">&#40;</span>angle<span style=" ">&#41;</span>*r,<span style="color: #aaffff; font-weight: bold;">GraphicsHeight</span><span style=" ">&#40;</span><span style=" ">&#41;</span>/<span style="color: #33ffdd;">2</span>-<span style="color: #aaffff; font-weight: bold;">Sin</span><span style=" ">&#40;</span>angle<span style=" ">&#41;</span>*r,<span style="color: #00ff66;">&quot;Grisu's Tutorial No. 1&quot;</span>,<span style="color: #33ffdd;">1</span>,<span style="color: #33ffdd;">1</span> <span style="color: #ffee00">; Добавим немного текста</span><br />
<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Flip</span><br />
<span style="color: #aaffff; font-weight: bold;">Wend</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #ffee00">; Конец основного цикла</span><br />
&nbsp;<br />
PakClean<span style=" ">&#40;</span><span style=" ">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #ffee00">; Удаляет все ранее использованные ресурсы</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">End</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffee00">; Выход</span></div>
<a name=".D0.97.D0.B0.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B5"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A3%D0%BF%D0%B0%D0%BA%D0%BE%D0%B2%D0%BA%D0%B0_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85_%D1%81_%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E_TeraBit_DataPak&amp;action=edit&amp;section=8" title="Править секцию: Заключение">править</a>]</span> <span class="mw-headline">Заключение</span></h2>
<p>Теперь вы можете хранить свои ресурсы в одном большом архиве и использовать его в ваших программах. Если вы захотите запаковывать ваши исполняемые файлы, то для этого можно использовать бесплатную программу UPX Packer.
</p>
<div align="right"><a href="http://blitzetcetera.org/images/f/f3/TeraBit_DataPack.zip" class="internal" title="TeraBit DataPack.zip">скачать архив с файлами к статье</a></div>
<hr />
<p>Автор: Grisu (e-mail: s.sarbok@gmx.de)<br />
Перевод: ZKINNER (e-mail: zkinner@gmail.com)
</p><!-- 
Pre-expand include size: 4608 bytes
Post-expand include size: 332 bytes
Template argument size: 34 bytes
Maximum: 2097152 bytes
-->

<!-- Saved in parser cache with key db1:pcache:idhash:762-0!1!0!!ru!2 and timestamp 20071110040910 -->
<div class="printfooter">
Получено с <a href="874wmq8k.html">http://blitzetcetera.org/index.php/%D0%A3%D0%BF%D0%B0%D0%BA%D0%BE%D0%B2%D0%BA%D0%B0_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85_%D1%81_%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E_TeraBit_DataPak</a></div>
			<!-- end content -->			<div class="visualClear"></div>				</td>				<td class="rightside">				</td>			</tr>		</table>		</div>	</div>		</div>	
		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
</div></body>
<!-- Mirrored from localhost/index.php/%D0%A3%D0%BF%D0%B0%D0%BA%D0%BE%D0%B2%D0%BA%D0%B0_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85_%D1%81_%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E_TeraBit_DataPak by HTTrack Website Copier/3.x [XR&CO'2007], Sat, 10 Nov 2007 05:16:50 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
</html>