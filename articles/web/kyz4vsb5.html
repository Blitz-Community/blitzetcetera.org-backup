<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru" dir="ltr">	
<!-- Mirrored from localhost/index.php/%D0%9B%D0%BE%D0%B3%D0%BE%D1%82%D0%B8%D0%BF_jgs_%D0%B2_100_%D1%81%D1%82%D1%80%D0%BE%D1%87%D0%BA%D0%B0%D1%85_%D0%BA%D0%BE%D0%B4%D0%B0 by HTTrack Website Copier/3.x [XR&CO'2007], Sat, 10 Nov 2007 05:16:12 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
<head>		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />				<meta name="keywords" content="Логотип jgs в 100 строчках кода,Jimon" />
		<link rel="shortcut icon" href="http://blitzetcetera.org/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="http://blitzetcetera.org/opensearch_desc.php" title="Blitz Et Cetera (Русский)" />
		<title>Логотип jgs в 100 строчках кода — Blitz Et Cetera</title>		<style type="text/css" media="screen,projection">/*<![CDATA[*/ @import "bvih5rde.css?63"; /*]]>*/</style>		<link rel="stylesheet" type="text/css" media="print" href="gcxktlm6.css?63" />		<link rel="stylesheet" type="text/css" media="handheld" href="zumsslq_.css?63" />		<!--[if lt IE 5.5000]><style type="text/css">@import "/skins/OfflineNew/IE50Fixes.css?63";</style><![endif]-->		<!--[if IE 5.5000]><style type="text/css">@import "/skins/OfflineNew/IE55Fixes.css?63";</style><![endif]-->		<!--[if IE 6]><style type="text/css">@import "/skins/OfflineNew/IE60Fixes.css?63";</style><![endif]-->		<!--[if IE 7]><style type="text/css">@import "/skins/OfflineNew/IE70Fixes.css?63";</style><![endif]-->		<!--[if lt IE 7]><script type="text/javascript" src="/skins/common/IEFixes.js?63"></script>		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->		<script type= "text/javascript">/*<![CDATA[*/
var skin = "OfflineNew";
var stylepath = "/skins";
var wgArticlePath = "/index.php/$1";
var wgScriptPath = "";
var wgServer = "http://blitzetcetera.org/";
var wgCanonicalNamespace = "";
var wgCanonicalSpecialPageName = false;
var wgNamespaceNumber = 0;
var wgPageName = "Логотип_jgs_в_100_строчках_кода";
var wgTitle = "Логотип jgs в 100 строчках кода";
var wgAction = "view";
var wgArticleId = "671";
var wgIsArticle = true;
var wgUserName = null;
var wgUserGroups = null;
var wgUserLanguage = "ru";
var wgContentLanguage = "ru";
var wgBreakFrames = false;
var wgCurRevisionId = "3556";
/*]]>*/</script>
		<script type="text/javascript" src="2nq-6cel.js?63"><!-- wikibits js --></script>		<script type="text/javascript" src="http://blitzetcetera.org/index.php?title=-&amp;action=raw&amp;gen=js"><!-- site js --></script>		<style type="text/css">/*<![CDATA[*/
@import "http://blitzetcetera.org/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://blitzetcetera.org/index.php?title=MediaWiki:OfflineNew.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://blitzetcetera.org/index.php?title=-&amp;action=raw&amp;gen=css&amp;maxage=18000";
/*]]>*/</style>		<!-- Head Scripts -->	</head><body  class="mediawiki ns-0 ltr page-Логотип_jgs_в_100_строчках_кода">	<div id="globalWrapper">	<div id="logocontainer">		<table align="center">		  <tr>				<td id="blitzetclogo">				</td>			</tr>		</table>	</div>	<div id="magbar">	Журнал о программированнии на языках Blitz3D, BlitzMax, BlitzPlus	</div>		<div id="column-content">	<div id="content">		<a name="top" id="top"></a>				<div id="bodyContent">		<table cellspacing=0 cellpadding=0 width=100%>			<tr>			  <td class="leftside">				</td>				<td class="sheetbody">					<h1 class="sheet">Логотип jgs в 100 строчках кода</h1>			<h3 id="siteSub">Материал из Blitz Et Cetera.</h3>			<div id="contentSub"></div>			<!-- start content -->			<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:JGSLogo.gif" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:JGSLogo.gif" src="4oia6f12.gif" width="465" height="103" /></a></span></div></div>
<p>Почитав про glow эффект, мне самому захотелось его сделать. Итак, начнем&nbsp;!
</p><p>Для начала, инициализируем экран и создадим картинку:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Graphics</span> <span style="color: #33ffdd;">640</span>,<span style="color: #33ffdd;">640</span>,<span style="color: #33ffdd;">32</span>,<span style="color: #33ffdd;">2</span><br />
<p><br />
</p>
tex = <span style="color: #aaffff; font-weight: bold;">CreateImage</span><span style=" ">&#40;</span><span style="color: #33ffdd;">640</span>,<span style="color: #33ffdd;">640</span><span style=" ">&#41;</span></div>
<p>Дальше нарисуем базовую картинку в картинку 
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">ImageBuffer</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><br />
<p><br />
<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">87</span>,<span style="color: #33ffdd;">96</span>,<span style="color: #33ffdd;">251</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> b# = <span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">360</span> <span style="color: #aaffff; font-weight: bold;">Step</span> <span style="color: #33ffdd;">10</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> a# = <span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">360</span> <span style="color: #aaffff; font-weight: bold;">Step</span> <span style="color: #33ffdd;">0.2</span><br />
<span style="color: #aaffff; font-weight: bold;">Plot</span> <span style="color: #33ffdd;">320</span>+<span style="color: #aaffff; font-weight: bold;">Cos</span><span style=" ">&#40;</span>b<span style=" ">&#41;</span>*<span style="color: #aaffff; font-weight: bold;">Cos</span><span style=" ">&#40;</span>a<span style=" ">&#41;</span>*<span style="color: #33ffdd;">60</span>-<span style="color: #aaffff; font-weight: bold;">Sin</span><span style=" ">&#40;</span>b<span style=" ">&#41;</span>*<span style="color: #aaffff; font-weight: bold;">Sin</span><span style=" ">&#40;</span>a<span style=" ">&#41;</span>*<span style="color: #33ffdd;">300</span>,<span style="color: #33ffdd;">320</span> + <span style="color: #aaffff; font-weight: bold;">Sin</span><span style=" ">&#40;</span>b<span style=" ">&#41;</span>*<span style="color: #aaffff; font-weight: bold;">Cos</span><span style=" ">&#40;</span>a<span style=" ">&#41;</span>*<span style="color: #33ffdd;">60</span>+<span style="color: #aaffff; font-weight: bold;">Cos</span><span style=" ">&#40;</span>b<span style=" ">&#41;</span>*<span style="color: #aaffff; font-weight: bold;">Sin</span><span style=" ">&#40;</span>a<span style=" ">&#41;</span>*<span style="color: #33ffdd;">300</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">DebugLog</span> <span style="color: #00ff66;">&quot;generate base image ok&quot;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Flip</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">BackBuffer</span><span style=" ">&#40;</span><span style=" ">&#41;</span></div>
<p>Объясню что за Plot 320+Cos(b)*Cos(a)*60-Sin(b)*Sin(a)*300,320 + Sin(b)*Cos(a)*60+Cos(b)*Sin(a)*300: тут фокус простой, в общем, берем формулу круга через sin,cos&nbsp;: x = cos(alpha)*r, y = sin(alpha)*r и множим потом x и y на матрицу поворота в 2d... получаем такие формулы.
</p><p>Дальше установим буфер на картинку, и создадим временный массив.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">ImageBuffer</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><br />
<p><br />
</p>
<span style="color: #aaffff; font-weight: bold;">Dim</span> buf<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">ImageWidth</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">ImageHeight</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span>,<span style="color: #33ffdd;">3</span><span style=" ">&#41;</span></div>
<p>Ничего сложного, просто считываем значения цветов в буферный массив
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">LockBuffer</span> <span style="color: #aaffff; font-weight: bold;">ImageBuffer</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><br />
<p><span style="color: #aaffff; font-weight: bold;">For</span> x=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #aaffff; font-weight: bold;">ImageWidth</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><span style="color: #33ffdd;">-1</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> y=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #aaffff; font-weight: bold;">ImageHeight</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><span style="color: #33ffdd;">-1</span><br />
ki = <span style="color: #aaffff; font-weight: bold;">ReadPixelFast</span> <span style=" ">&#40;</span>x,y,<span style="color: #aaffff; font-weight: bold;">ImageBuffer</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><span style=" ">&#41;</span><br />
buf<span style=" ">&#40;</span>x,y,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>=ki <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">16</span> <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">24</span> <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">24</span><br />
buf<span style=" ">&#40;</span>x,y,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>=ki <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">8</span> <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">24</span> <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">24</span><br />
buf<span style=" ">&#40;</span>x,y,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>=ki <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">24</span> <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">24</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">UnlockBuffer</span> <span style="color: #aaffff; font-weight: bold;">ImageBuffer</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><br />
<br />
</p>
<span style="color: #aaffff; font-weight: bold;">DebugLog</span> <span style="color: #00ff66;">&quot;get color value ok&quot;</span></div>
<p>Теперь расписываю самое интересное - стадию блюра. Итак, мы будем делать обычный блюр, но с фичей, фича эта - то, что значение цветов умножаются после блюра, это и есть весь glow(bloom) эффект.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">For</span> z = <span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">3</span><br />
<p><span style="color: #aaffff; font-weight: bold;">For</span> x=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #aaffff; font-weight: bold;">ImageWidth</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><span style="color: #33ffdd;">-1</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> y=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #aaffff; font-weight: bold;">ImageHeight</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><span style="color: #33ffdd;">-1</span><br />
<br />
<span style="color: #ffee00">;обычный блюр</span><br />
r#=<span style=" ">&#40;</span>buf<span style=" ">&#40;</span>x,y,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">-1</span>,y,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">+1</span>,y,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x,y<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">-1</span>,y<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span><br />
r#=r#+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">+1</span>,y<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x,y<span style="color: #33ffdd;">+1</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">-1</span>,y<span style="color: #33ffdd;">+1</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">+1</span>,y<span style="color: #33ffdd;">+1</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span><span style=" ">&#41;</span>/<span style="color: #33ffdd;">9</span><br />
g#=<span style=" ">&#40;</span>buf<span style=" ">&#40;</span>x,y,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">-1</span>,y,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">+1</span>,y,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x,y<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">-1</span>,y<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
g#=g#+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">+1</span>,y<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x,y<span style="color: #33ffdd;">+1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">-1</span>,y<span style="color: #33ffdd;">+1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">+1</span>,y<span style="color: #33ffdd;">+1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><span style=" ">&#41;</span>/<span style="color: #33ffdd;">9</span><br />
b#=<span style=" ">&#40;</span>buf<span style=" ">&#40;</span>x,y,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">-1</span>,y,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">+1</span>,y,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x,y<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">-1</span>,y<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><br />
b#=b#+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">+1</span>,y<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x,y<span style="color: #33ffdd;">+1</span>,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">-1</span>,y<span style="color: #33ffdd;">+1</span>,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">+1</span>,y<span style="color: #33ffdd;">+1</span>,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><span style=" ">&#41;</span>/<span style="color: #33ffdd;">9</span><br />
<span style="color: #ffee00">;а весь секрет вот в этом числе bloom effect при blur</span><br />
l# = <span style="color: #33ffdd;">1.35</span><br />
r = r*l<br />
g = g*l<br />
b = b*l<br />
<br />
<span style="color: #aaffff; font-weight: bold;">If</span> r&gt;<span style="color: #33ffdd;">255</span> <span style="color: #aaffff; font-weight: bold;">Then</span> r = <span style="color: #33ffdd;">255</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> g&gt;<span style="color: #33ffdd;">255</span> <span style="color: #aaffff; font-weight: bold;">Then</span> g = <span style="color: #33ffdd;">255</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> b&gt;<span style="color: #33ffdd;">255</span> <span style="color: #aaffff; font-weight: bold;">Then</span> b = <span style="color: #33ffdd;">255</span><br />
<br />
buf<span style=" ">&#40;</span>x,y,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span> = r<br />
buf<span style=" ">&#40;</span>x,y,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span> = g<br />
buf<span style=" ">&#40;</span>x,y,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span> = b<br />
<br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">DebugLog</span> <span style="color: #00ff66;">&quot;blur &quot;</span>+z<br />
</p>
<span style="color: #aaffff; font-weight: bold;">Next</span></div>
<p>В общем, никаких сложностей - 4 прохода блюра каждый раз множим на 1.35 и следим чтобы числа невылазили за 255
вот вам и эффект свечения.
</p><p>Дальше мелочи - записать значение цветов обратно в картинку, здесь я использовал writepixelfast и быстрый перевод цветов в ARGB.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">LockBuffer</span> <span style="color: #aaffff; font-weight: bold;">ImageBuffer</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><br />
<p><span style="color: #aaffff; font-weight: bold;">For</span> x=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #aaffff; font-weight: bold;">Imagewidth</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><span style="color: #33ffdd;">-1</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> y=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #aaffff; font-weight: bold;">ImageHeight</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><span style="color: #33ffdd;">-1</span><br />
<span style="color: #aaffff; font-weight: bold;">WritePixelFast</span> x,y,buf<span style=" ">&#40;</span>x,y,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">16</span>+buf<span style=" ">&#40;</span>x,y,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">8</span>+buf<span style=" ">&#40;</span>x,y,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">UnlockBuffer</span> <span style="color: #aaffff; font-weight: bold;">ImageBuffer</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">DebugLog</span> <span style="color: #00ff66;">&quot;write image pixels ok&quot;</span></div>
<p>Теперь ставим буфер обратно, и рисуем картинку:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">BackBuffer</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<p><span style="color: #aaffff; font-weight: bold;">Cls</span><br />
<span style="color: #aaffff; font-weight: bold;">DrawImage</span> tex,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">Flip</span><br />
<span style="color: #aaffff; font-weight: bold;">WaitKey</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">End</span></div>
<p>Вот и все, дети. Эффект считает, правда, долго, у меня - секунд 10.
</p><p>Полный сорс:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Graphics</span> <span style="color: #33ffdd;">640</span>,<span style="color: #33ffdd;">640</span>,<span style="color: #33ffdd;">32</span>,<span style="color: #33ffdd;">2</span><br />
<p><br />
tex = <span style="color: #aaffff; font-weight: bold;">CreateImage</span><span style=" ">&#40;</span><span style="color: #33ffdd;">640</span>,<span style="color: #33ffdd;">640</span><span style=" ">&#41;</span> <br />
<br />
<span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">ImageBuffer</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">87</span>,<span style="color: #33ffdd;">96</span>,<span style="color: #33ffdd;">251</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> b# = <span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">360</span> <span style="color: #aaffff; font-weight: bold;">Step</span> <span style="color: #33ffdd;">10</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> a# = <span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">360</span> <span style="color: #aaffff; font-weight: bold;">Step</span> <span style="color: #33ffdd;">0.2</span><br />
<span style="color: #aaffff; font-weight: bold;">Plot</span> <span style="color: #33ffdd;">320</span>+<span style="color: #aaffff; font-weight: bold;">Cos</span><span style=" ">&#40;</span>b<span style=" ">&#41;</span>*<span style="color: #aaffff; font-weight: bold;">Cos</span><span style=" ">&#40;</span>a<span style=" ">&#41;</span>*<span style="color: #33ffdd;">60</span>-<span style="color: #aaffff; font-weight: bold;">Sin</span><span style=" ">&#40;</span>b<span style=" ">&#41;</span>*<span style="color: #aaffff; font-weight: bold;">Sin</span><span style=" ">&#40;</span>a<span style=" ">&#41;</span>*<span style="color: #33ffdd;">300</span>,<span style="color: #33ffdd;">320</span> + <span style="color: #aaffff; font-weight: bold;">Sin</span><span style=" ">&#40;</span>b<span style=" ">&#41;</span>*<span style="color: #aaffff; font-weight: bold;">Cos</span><span style=" ">&#40;</span>a<span style=" ">&#41;</span>*<span style="color: #33ffdd;">60</span>+<span style="color: #aaffff; font-weight: bold;">Cos</span><span style=" ">&#40;</span>b<span style=" ">&#41;</span>*<span style="color: #aaffff; font-weight: bold;">Sin</span><span style=" ">&#40;</span>a<span style=" ">&#41;</span>*<span style="color: #33ffdd;">300</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">DebugLog</span> <span style="color: #00ff66;">&quot;generate base image ok&quot;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Flip</span><br />
<span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">BackBuffer</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">ImageBuffer</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> buf<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">ImageWidth</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">ImageHeight</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span>,<span style="color: #33ffdd;">3</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">LockBuffer</span> <span style="color: #aaffff; font-weight: bold;">ImageBuffer</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> x=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #aaffff; font-weight: bold;">ImageWidth</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><span style="color: #33ffdd;">-1</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> y=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #aaffff; font-weight: bold;">ImageHeight</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><span style="color: #33ffdd;">-1</span><br />
ki = <span style="color: #aaffff; font-weight: bold;">ReadPixelFast</span> <span style=" ">&#40;</span>x,y,<span style="color: #aaffff; font-weight: bold;">ImageBuffer</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><span style=" ">&#41;</span><br />
buf<span style=" ">&#40;</span>x,y,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>=ki <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">16</span> <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">24</span> <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">24</span><br />
buf<span style=" ">&#40;</span>x,y,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>=ki <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">8</span> <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">24</span> <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">24</span><br />
buf<span style=" ">&#40;</span>x,y,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>=ki <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">24</span> <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">24</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">UnlockBuffer</span> <span style="color: #aaffff; font-weight: bold;">ImageBuffer</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">DebugLog</span> <span style="color: #00ff66;">&quot;get color value ok&quot;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">For</span> z = <span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">3</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> x=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #aaffff; font-weight: bold;">ImageWidth</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><span style="color: #33ffdd;">-1</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> y=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #aaffff; font-weight: bold;">ImageHeight</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><span style="color: #33ffdd;">-1</span><br />
<br />
<span style="color: #ffee00">;обычный блюр</span><br />
r#=<span style=" ">&#40;</span>buf<span style=" ">&#40;</span>x,y,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">-1</span>,y,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">+1</span>,y,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x,y<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span><br />
r#=r#+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">-1</span>,y<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">+1</span>,y<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x,y<span style="color: #33ffdd;">+1</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">-1</span>,y<span style="color: #33ffdd;">+1</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">+1</span>,y<span style="color: #33ffdd;">+1</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span><span style=" ">&#41;</span>/<span style="color: #33ffdd;">9</span><br />
g#=<span style=" ">&#40;</span>buf<span style=" ">&#40;</span>x,y,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">-1</span>,y,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">+1</span>,y,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x,y<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
g#=g#+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">-1</span>,y<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">+1</span>,y<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x,y<span style="color: #33ffdd;">+1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">-1</span>,y<span style="color: #33ffdd;">+1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">+1</span>,y<span style="color: #33ffdd;">+1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><span style=" ">&#41;</span>/<span style="color: #33ffdd;">9</span><br />
b#=<span style=" ">&#40;</span>buf<span style=" ">&#40;</span>x,y,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">-1</span>,y,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">+1</span>,y,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x,y<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><br />
b#=b#+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">-1</span>,y<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">+1</span>,y<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x,y<span style="color: #33ffdd;">+1</span>,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">-1</span>,y<span style="color: #33ffdd;">+1</span>,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>+buf<span style=" ">&#40;</span>x<span style="color: #33ffdd;">+1</span>,y<span style="color: #33ffdd;">+1</span>,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><span style=" ">&#41;</span>/<span style="color: #33ffdd;">9</span><br />
<span style="color: #ffee00">;а весь секрет вот в этом числе &nbsp;bloom effect при blur</span><br />
l# = <span style="color: #33ffdd;">1.35</span><br />
r = r*l<br />
g = g*l<br />
b = b*l<br />
<br />
<span style="color: #aaffff; font-weight: bold;">If</span> r&gt;<span style="color: #33ffdd;">255</span> <span style="color: #aaffff; font-weight: bold;">Then</span> r = <span style="color: #33ffdd;">255</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> g&gt;<span style="color: #33ffdd;">255</span> <span style="color: #aaffff; font-weight: bold;">Then</span> g = <span style="color: #33ffdd;">255</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> b&gt;<span style="color: #33ffdd;">255</span> <span style="color: #aaffff; font-weight: bold;">Then</span> b = <span style="color: #33ffdd;">255</span><br />
<br />
buf<span style=" ">&#40;</span>x,y,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span> = r<br />
buf<span style=" ">&#40;</span>x,y,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span> = g<br />
buf<span style=" ">&#40;</span>x,y,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span> = b<br />
<br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">DebugLog</span> <span style="color: #00ff66;">&quot;blur &quot;</span>+z<br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">LockBuffer</span> <span style="color: #aaffff; font-weight: bold;">ImageBuffer</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> x=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #aaffff; font-weight: bold;">ImageWidth</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><span style="color: #33ffdd;">-1</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> y=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #aaffff; font-weight: bold;">ImageHeight</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><span style="color: #33ffdd;">-1</span><br />
<span style="color: #aaffff; font-weight: bold;">WritePixelFast</span> x,y,buf<span style=" ">&#40;</span>x,y,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">16</span>+buf<span style=" ">&#40;</span>x,y,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">8</span>+buf<span style=" ">&#40;</span>x,y,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">UnlockBuffer</span> <span style="color: #aaffff; font-weight: bold;">ImageBuffer</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">DebugLog</span> <span style="color: #00ff66;">&quot;write image pixels ok&quot;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">BackBuffer</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Cls</span><br />
<span style="color: #aaffff; font-weight: bold;">DrawImage</span> tex,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">Flip</span><br />
<span style="color: #aaffff; font-weight: bold;">WaitKey</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">End</span></div>
<div align="right"><a href="http://blitzetcetera.org/images/3/33/JGSLogo.bb" class="internal" title="JGSLogo.bb">скачать исходный код</a></div>
<hr />
<p>Автор: <a href="http://blitzetcetera.org/index.php?title=%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Jimon&amp;action=edit" class="new" title="Участник:Jimon">Jimon</a> (e-mail: jimon.j1m0n@gmail.com)
</p><!-- 
Pre-expand include size: 2171 bytes
Post-expand include size: 257 bytes
Template argument size: 17 bytes
Maximum: 2097152 bytes
-->

<!-- Saved in parser cache with key db1:pcache:idhash:671-0!1!0!!ru!2 and timestamp 20071110033620 -->
<div class="printfooter">
Получено с <a href="kyz4vsb5.html">http://blitzetcetera.org/index.php/%D0%9B%D0%BE%D0%B3%D0%BE%D1%82%D0%B8%D0%BF_jgs_%D0%B2_100_%D1%81%D1%82%D1%80%D0%BE%D1%87%D0%BA%D0%B0%D1%85_%D0%BA%D0%BE%D0%B4%D0%B0</a></div>
			<!-- end content -->			<div class="visualClear"></div>				</td>				<td class="rightside">				</td>			</tr>		</table>		</div>	</div>		</div>	
		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
</div></body>
<!-- Mirrored from localhost/index.php/%D0%9B%D0%BE%D0%B3%D0%BE%D1%82%D0%B8%D0%BF_jgs_%D0%B2_100_%D1%81%D1%82%D1%80%D0%BE%D1%87%D0%BA%D0%B0%D1%85_%D0%BA%D0%BE%D0%B4%D0%B0 by HTTrack Website Copier/3.x [XR&CO'2007], Sat, 10 Nov 2007 05:16:12 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
</html>