<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru" dir="ltr">	
<!-- Mirrored from localhost/index.php/Tokamak_DLL by HTTrack Website Copier/3.x [XR&CO'2007], Sat, 10 Nov 2007 05:16:41 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
<head>		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />				<meta name="keywords" content="Tokamak DLL" />
		<link rel="shortcut icon" href="http://blitzetcetera.org/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="http://blitzetcetera.org/opensearch_desc.php" title="Blitz Et Cetera (Русский)" />
		<title>Tokamak DLL — Blitz Et Cetera</title>		<style type="text/css" media="screen,projection">/*<![CDATA[*/ @import "bvih5rde.css?63"; /*]]>*/</style>		<link rel="stylesheet" type="text/css" media="print" href="gcxktlm6.css?63" />		<link rel="stylesheet" type="text/css" media="handheld" href="zumsslq_.css?63" />		<!--[if lt IE 5.5000]><style type="text/css">@import "/skins/OfflineNew/IE50Fixes.css?63";</style><![endif]-->		<!--[if IE 5.5000]><style type="text/css">@import "/skins/OfflineNew/IE55Fixes.css?63";</style><![endif]-->		<!--[if IE 6]><style type="text/css">@import "/skins/OfflineNew/IE60Fixes.css?63";</style><![endif]-->		<!--[if IE 7]><style type="text/css">@import "/skins/OfflineNew/IE70Fixes.css?63";</style><![endif]-->		<!--[if lt IE 7]><script type="text/javascript" src="/skins/common/IEFixes.js?63"></script>		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->		<script type= "text/javascript">/*<![CDATA[*/
var skin = "OfflineNew";
var stylepath = "/skins";
var wgArticlePath = "/index.php/$1";
var wgScriptPath = "";
var wgServer = "http://blitzetcetera.org/";
var wgCanonicalNamespace = "";
var wgCanonicalSpecialPageName = false;
var wgNamespaceNumber = 0;
var wgPageName = "Tokamak_DLL";
var wgTitle = "Tokamak DLL";
var wgAction = "view";
var wgArticleId = "461";
var wgIsArticle = true;
var wgUserName = null;
var wgUserGroups = null;
var wgUserLanguage = "ru";
var wgContentLanguage = "ru";
var wgBreakFrames = false;
var wgCurRevisionId = "3415";
/*]]>*/</script>
		<script type="text/javascript" src="2nq-6cel.js?63"><!-- wikibits js --></script>		<script type="text/javascript" src="http://blitzetcetera.org/index.php?title=-&amp;action=raw&amp;gen=js"><!-- site js --></script>		<style type="text/css">/*<![CDATA[*/
@import "http://blitzetcetera.org/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://blitzetcetera.org/index.php?title=MediaWiki:OfflineNew.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://blitzetcetera.org/index.php?title=-&amp;action=raw&amp;gen=css&amp;maxage=18000";
/*]]>*/</style>		<!-- Head Scripts -->	</head><body  class="mediawiki ns-0 ltr page-Tokamak_DLL">	<div id="globalWrapper">	<div id="logocontainer">		<table align="center">		  <tr>				<td id="blitzetclogo">				</td>			</tr>		</table>	</div>	<div id="magbar">	Журнал о программированнии на языках Blitz3D, BlitzMax, BlitzPlus	</div>		<div id="column-content">	<div id="content">		<a name="top" id="top"></a>				<div id="bodyContent">		<table cellspacing=0 cellpadding=0 width=100%>			<tr>			  <td class="leftside">				</td>				<td class="sheetbody">					<h1 class="sheet">Tokamak DLL</h1>			<h3 id="siteSub">Материал из Blitz Et Cetera.</h3>			<div id="contentSub"></div>			<!-- start content -->			<a name=".D0.A7.D1.82.D0.BE_.D1.82.D0.B0.D0.BA.D0.BE.D0.B5_Blitz-Tokamak.3F"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Tokamak_DLL&amp;action=edit&amp;section=1" title="Править секцию: Что такое Blitz-Tokamak?">править</a>]</span> <span class="mw-headline">Что такое Blitz-Tokamak?</span></h2>
<p>Blitz Tokamak это отличный врапер физической библиотеки Tokamak DLL, написанный Sweenie.
</p><p>Вы можете взять врапер <a href="http://www.freewebs.com/sweenie/" class="external text" title="http://www.freewebs.com/sweenie/" rel="nofollow">здесь</a> и Tokamak DLL <a href="http://www.tokamakphysics.com/" class="external text" title="http://www.tokamakphysics.com/" rel="nofollow">отсюда</a>.
</p><p>Все dll-ки положите в папку с system32 или в папку с программой (рекомендуется ложить в system32, и только при финальной сборке программы поместить dll в папку программы). 
</p>
<a name=".D0.A7.D1.82.D0.BE_.D0.BE.D0.B7.D0.BD.D0.B0.D1.87.D0.B0.D1.8E.D1.82_.D0.B2.D1.81.D0.B5_TOK.2A.2A.2A_.D0.BA.D0.BE.D0.BC.D0.B0.D0.BD.D0.B4.D1.8B:"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Tokamak_DLL&amp;action=edit&amp;section=2" title="Править секцию: Что означают все TOK*** команды:">править</a>]</span> <span class="mw-headline">Что означают все TOK*** команды:</span></h2>
<p>Для начала все команды делятся на основные разделы:
</p>
<ul><li>TOKSIM - команды симулятора tokamak. Эти команды в основном устанавливают глобальные переменные симулятора.
</li><li>TOKRB - команды для жестких тел. Это вещи, которые нас окружают. Для их использования можно использовать только 3 примитива - box, cylinder, и sphere, но вы можете объединять их с помощью операций конъюнкций и делать более сложные объекты, такие как стул или стол.
</li><li>TOKAB - эти команды для движущихся тел. На них не действует физика, а двигать и вращать их должна ваша программа. Эти объекты создаются так же, как и жесткие тела - из примитивов. Используйте объекты этого типа для создания движущихся платформ, дверей, ловушек и т.п.
</li><li>TOKGEOM - эти команды предназначены для модификации параметров предыдущих двух групп.
</li><li>TOKJOINT - эти команды используются для создания шарниров, к которым присоединяются жесткие тела. Используйте их для создания тряпичных кукол, ловушек, оборудования и т.п.
</li></ul>
<p><br />
</p>
<a name=".D0.9A.D0.B0.D0.BA_.D0.BD.D0.B0.D0.BF.D0.B8.D1.81.D0.B0.D1.82.D1.8C_.D0.BF.D1.80.D0.BE.D0.B3.D1.80.D0.B0.D0.BC.D0.BC.D1.83_.D0.B8.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D1.83.D1.8E.D1.89.D1.83.D1.8E_tokamak.3F"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Tokamak_DLL&amp;action=edit&amp;section=3" title="Править секцию: Как написать программу использующую tokamak?">править</a>]</span> <span class="mw-headline">Как написать программу использующую tokamak?</span></h2>
<p>Первое что вы должны сделать это установить симулятор подобно этому:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">TOKSIM_CreateSimulator<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">-10</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span></div>
<p>Здесь мы включаем tokamak и устанавливаем вектор гравитации. В этом случае гравитация направлена вниз и равна 10. По умолчанию tokamak немного ограничен в количестве объектов и, думаю, полезно будет узнать несколько команд для настройки ограничений:
</p>
<ul><li>TOKSIM_SetRigidBodiesCount - максимальное количество жестких тел. По умолчанию 50. Далее в квадратных скобках.
</li><li>TOKSIM_SetAnimatedBodiesCount - максимальное количество движущихся тел.[50]
</li><li>TOKSIM_SetRigidParticleCount - количество жестких частиц.[50]
</li><li>TOKSIM_SetControllersCount - количество контроллеров.[50]
</li><li>TOKSIM_SetOverlappedPairsCount - Количество возможных перекрытых пар. По умолчанию 1225. Это будет максимум при количестве объектов равным 100. Если вы используете другое количество объектов воспользуйтесь формулой (TBodies*(TBodies-1))/2 где TBodies - количество объектов. Вы конечно можете установить меньшее значение для экономии памяти.
</li><li>TOKSIM_SetGeometriesCount - количество, использующееся в жестких и подвижных объектах.[50]
</li><li>TOKSIM_SetConstraintsCount - количество ограничений в симуляции.[100]
</li><li>TOKSIM_SetConstraintSetsCount - Номер ограничения, устанавливается в в симуляции. Если вы неопытный пользователь, то просто пропустите это.
</li><li>TOKSIM_SetConstraintBufferSize - размер буфера решающего устройства ограничения (понимайте как хотите я не понял).[2000]
</li><li>TOKSIM_SetStaticMeshNodesStartCount - количество узлов хранящих треугольники местности.
</li><li>TOKSIM_SetStaticMeshNodesGrowByCount - Вообщем не понял я что это, если кто знает скажите. Устал уже переводить&nbsp;:(....
</li></ul>
<p>Вот что мы пока имеем:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Const</span> Rigid_Bodies=<span style="color: #33ffdd;">100</span>,Animated_Bodies=<span style="color: #33ffdd;">5</span>,Rigid_Particles=<span style="color: #33ffdd;">0</span><br />
<p><br />
TOKSIM_SetRigidBodiesCount Rigid_Bodies<br />
TOKSIM_SetAnimatedBodiesCount Animated_Bodies<br />
TOKSIM_SetRigidParticleCount Rigid_Particles<br />
TOKSIM_SetControllersCount <span style="color: #33ffdd;">0</span><br />
TOKSIM_SetGeometriesCount Rigid_bodies+Animated_Bodies <span style="color: #ffee00">;Assuming each one</span><br />
<span style="color: #ffee00">;only has one geometry. Not true with more complex rigid bodies and animated bodies.</span><br />
<br />
</p>
TOKSIM_CreateSimulator<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">-10</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span></div>
<p>Мы установили здесь подходящие настройки. Здесь мы создаем сцену:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Graphics3D</span> <span style="color: #33ffdd;">800</span>,<span style="color: #33ffdd;">600</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">2</span><br />
<p><span style="color: #aaffff; font-weight: bold;">Const</span> fps=<span style="color: #33ffdd;">60</span><br />
<span style="color: #aaffff; font-weight: bold;">Global</span> cam = <span style="color: #aaffff; font-weight: bold;">CreateCamera</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> cam,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">-50</span><br />
l=<span style="color: #aaffff; font-weight: bold;">CreateLight</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
centerpoint=<span style="color: #aaffff; font-weight: bold;">CreatePivot</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
ground = <span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EntityColor</span> ground,<span style="color: #33ffdd;">5</span>,<span style="color: #33ffdd;">5</span>,<span style="color: #33ffdd;">55</span> <br />
<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> ground,<span style="color: #33ffdd;">50</span>,<span style="color: #33ffdd;">5</span>,<span style="color: #33ffdd;">50</span> <br />
</p>
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> ground,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">-5</span>,<span style="color: #33ffdd;">0</span></div>
<p>Так - теперь мы установим подвижное тело для земли. (Хотя в действительности мы ее двигать не будем)
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">abground = TOKAB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<p>TOKAB_AddBox<span style=" ">&#40;</span>abground,<span style="color: #33ffdd;">100.0</span>,<span style="color: #33ffdd;">10.0</span>,<span style="color: #33ffdd;">100.0</span><span style=" ">&#41;</span><br />
TOKAB_SetPosition<span style=" ">&#40;</span>abground,<span style="color: #33ffdd;">0.0</span>,<span style="color: #33ffdd;">-5.0</span>,<span style="color: #33ffdd;">0.0</span><span style=" ">&#41;</span><br />
<br />
TOKAB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span> - Создает подвижное тело и возвращает указатель на него.<br />
TOKAB_AddBox<span style=" ">&#40;</span>AnimatedBody,Width,Height,Depth<span style=" ">&#41;</span> - описывает параллелограмм вокруг созданного тела.<br />
</p>
TOKAB_SetPosition<span style=" ">&#40;</span>AnimatedBody, X, Y, Z<span style=" ">&#41;</span> - устанавливает позицию тела.</div>
<p>Вот код создания остальных стен:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">wall1 = <span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<p><span style="color: #aaffff; font-weight: bold;">EntityColor</span> wall1,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">55</span> <br />
<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> wall1,<span style="color: #33ffdd;">2</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">50</span> <br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> wall1,<span style="color: #33ffdd;">50</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
abwall1 = TOKAB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
TOKAB_AddBox<span style=" ">&#40;</span>abwall1,<span style="color: #33ffdd;">4.0</span>,<span style="color: #33ffdd;">20.0</span>,<span style="color: #33ffdd;">100.0</span><span style=" ">&#41;</span><br />
TOKAB_SetPosition<span style=" ">&#40;</span>abwall1,<span style="color: #33ffdd;">50.0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0.0</span><span style=" ">&#41;</span><br />
<br />
wall2 = <span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EntityColor</span> wall2,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">55</span> <br />
<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> wall2,<span style="color: #33ffdd;">2</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">50</span> <br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> wall2,<span style="color: #33ffdd;">-50</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
abwall2 = TOKAB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
TOKAB_AddBox<span style=" ">&#40;</span>abwall2,<span style="color: #33ffdd;">4.0</span>,<span style="color: #33ffdd;">20.0</span>,<span style="color: #33ffdd;">100.0</span><span style=" ">&#41;</span><br />
TOKAB_SetPosition<span style=" ">&#40;</span>abwall2,<span style="color: #33ffdd;">-50.0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0.0</span><span style=" ">&#41;</span><br />
<br />
wall3 = <span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EntityColor</span> wall3,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">55</span> <br />
<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> wall3,<span style="color: #33ffdd;">50</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">2</span> <br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> wall3,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">-50</span><br />
abwall3 = TOKAB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
TOKAB_AddBox<span style=" ">&#40;</span>abwall3,<span style="color: #33ffdd;">100.0</span>,<span style="color: #33ffdd;">20.0</span>,<span style="color: #33ffdd;">4.0</span><span style=" ">&#41;</span><br />
TOKAB_SetPosition<span style=" ">&#40;</span>abwall3,<span style="color: #33ffdd;">0.0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">-50.0</span><span style=" ">&#41;</span><br />
<br />
wall4 = <span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EntityColor</span> wall4,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">55</span> <br />
<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> wall4,<span style="color: #33ffdd;">50</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">2</span> <br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> wall4,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">50</span><br />
abwall4 = TOKAB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
TOKAB_AddBox<span style=" ">&#40;</span>abwall4,<span style="color: #33ffdd;">100.0</span>,<span style="color: #33ffdd;">20.0</span>,<span style="color: #33ffdd;">4.0</span><span style=" ">&#41;</span><br />
</p>
TOKAB_SetPosition<span style=" ">&#40;</span>abwall4,<span style="color: #33ffdd;">0.0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">50.0</span><span style=" ">&#41;</span></div>
<p>Сейчас мы создадим жесткие тела:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Dim</span> obj<span style=" ">&#40;</span>Rigid_Bodies<span style=" ">&#41;</span><br />
<p><span style="color: #aaffff; font-weight: bold;">Dim</span> rb<span style=" ">&#40;</span>Rigid_Bodies<span style=" ">&#41;</span><br />
<br />
i=<span style="color: #33ffdd;">1</span><br />
<br />
obj<span style=" ">&#40;</span>i<span style=" ">&#41;</span> = <span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> obj<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">2</span>,<span style="color: #33ffdd;">1</span>,<span style="color: #33ffdd;">1</span> <br />
rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span> = TOKRB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
TOKRB_AddBox rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">4.0</span>,<span style="color: #33ffdd;">2.0</span>,<span style="color: #33ffdd;">2.0</span><br />
TOKRB_SetPosition rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">0</span><br />
TOKRB_SetLinearDamping rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">0.001</span><br />
TOKRB_SetAngularDamping rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">0.02</span> <br />
TOKRB_SetMass rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">2.0</span><br />
</p>
TOKRB_SetBoxInertiaTensor rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">4.0</span>,<span style="color: #33ffdd;">2.0</span>,<span style="color: #33ffdd;">2.0</span>,<span style="color: #33ffdd;">2.0</span></div>
<p>В массиве мы сохраняем указатели на объекты созданные с помощью команды TOKRB_Create(). Команда TOKRB_AddBox добавляет коробку к объекту. Обратите внимание, что описываем для описания мы используем цифры большие чем в ScaleEntity - это связано с тем, что блитц создает куб размером не 1x1x1, а размером 2x2x2. 
Далее мы устанавливаем позицию объекта. TOKRB_SetLinearDamping и TOKRBAngularDamping устанавливает линейное и угловое торможение соответственно. TOKRB_SetMass - устанавливает массу объекта. TOKRB_SetBoxInertiaTensor - sets the inertia tensor of an object. If you only have one geometry in your mesh, use this command, except with the specified object. (Не смог понять - если кто знает, напишите мне). Если у вас была, например, сфера то использовать нужно было бы TOKRB_SetSphereInertiaTensor. Сейчас мы изменим предыдущий кусочек кода и создадим большое количество кубиков, расположенных и направленных случайно.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">For</span> i=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> Rigid_Bodies<br />
<p>obj<span style=" ">&#40;</span>i<span style=" ">&#41;</span> = <span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> obj<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">1</span>,<span style="color: #33ffdd;">1</span>,<span style="color: #33ffdd;">1</span> <br />
rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>=TOKRB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
TOKRB_AddBox rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">2.0</span>,<span style="color: #33ffdd;">2.0</span>,<span style="color: #33ffdd;">2.0</span><br />
TOKRB_SetPosition rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-40</span>,<span style="color: #33ffdd;">40</span><span style=" ">&#41;</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-40</span>,<span style="color: #33ffdd;">40</span><span style=" ">&#41;</span><br />
TOKRB_SetLinearDamping rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">0.001</span><br />
TOKRB_SetAngularDamping rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">0.02</span> <br />
TOKRB_SetMass rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">2.0</span><br />
TOKRB_SetBoxInertiaTensor rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">4.0</span>,<span style="color: #33ffdd;">2.0</span>,<span style="color: #33ffdd;">2.0</span>,<span style="color: #33ffdd;">2.0</span><br />
TOKRB_SetVelocity rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
TOKRB_SetTorque rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">Next</span></div>
<p>Команды TOKRB_SetVelocity и TOKRB_SetTorque устанавливают линейную и угловую скорость жесткого тела. Теперь мы напишем скелет основного цикла:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">While</span> <span style="color: #aaffff; font-weight: bold;">Not</span> <span style="color: #aaffff; font-weight: bold;">KeyHit</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<p><span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
elapsed=<span style="color: #aaffff; font-weight: bold;">MilliSecs</span><span style=" ">&#40;</span><span style=" ">&#41;</span>-time<br />
<span style="color: #aaffff; font-weight: bold;">Until</span> elapsed<br />
<br />
ticks=elapsed/period<br />
tween#=<span style="color: #aaffff; font-weight: bold;">Float</span><span style=" ">&#40;</span>elapsed <span style="color: #aaffff; font-weight: bold;">Mod</span> period<span style=" ">&#41;</span>/<span style="color: #aaffff; font-weight: bold;">Float</span><span style=" ">&#40;</span>period<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> k=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> ticks<br />
time=time+period<br />
<span style="color: #aaffff; font-weight: bold;">If</span> k=ticks <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">CaptureWorld</span><br />
<span style="color: #aaffff; font-weight: bold;">UpdateWorld</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
camx#=<span style="color: #aaffff; font-weight: bold;">Cos</span><span style=" ">&#40;</span>rot#<span style=" ">&#41;</span>*<span style="color: #33ffdd;">50</span><br />
camz#=<span style="color: #aaffff; font-weight: bold;">Sin</span><span style=" ">&#40;</span>rot#<span style=" ">&#41;</span>*<span style="color: #33ffdd;">50</span><br />
<br />
rot#=rot#<span style="color: #33ffdd;">+0.05</span>+<span style="color: #aaffff; font-weight: bold;">MouseXSpeed</span><span style=" ">&#40;</span><span style=" ">&#41;</span>/<span style="color: #33ffdd;">5.0</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">If</span> rot#&gt;<span style="color: #33ffdd;">360</span> <span style="color: #aaffff; font-weight: bold;">Then</span> rot#=<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> cam,camx#,<span style="color: #33ffdd;">40</span>,camz#<br />
<span style="color: #aaffff; font-weight: bold;">PointEntity</span> cam,centerpoint<br />
<br />
<span style="color: #aaffff; font-weight: bold;">RenderWorld</span> tween<br />
<span style="color: #aaffff; font-weight: bold;">Flip</span> <span style="color: #aaffff; font-weight: bold;">False</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">Wend</span></div>
<p>Тут, думаю, все понятно. К Tokamak это никакого отношения не имеет. А вот здесь уже появляется наш Tokamak:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">For</span> k=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> ticks<br />
<p>time=time+period<br />
<span style="color: #aaffff; font-weight: bold;">If</span> k=ticks <span style="color: #aaffff; font-weight: bold;">Then</span><br />
<span style="color: #aaffff; font-weight: bold;">CaptureWorld</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> i=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> Rigid_Bodies<br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> obj<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,TOKRB_GetX#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,TOKRB_GetY#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,TOKRB_GetZ#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span> <br />
<span style="color: #aaffff; font-weight: bold;">RotateEntity</span> obj<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,TOKRB_GetPitch#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,TOKRB_GetYaw#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,TOKRB_GetRoll#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">False</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">KeyDown</span><span style=" ">&#40;</span><span style="color: #33ffdd;">57</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
TOKRB_ApplyImpulse2 rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>-.<span style="color: #33ffdd;">3</span>,.<span style="color: #33ffdd;">3</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-1.5</span>,<span style="color: #33ffdd;">3.0</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>-.<span style="color: #33ffdd;">3</span>,.<span style="color: #33ffdd;">3</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>-.<span style="color: #33ffdd;">05</span>,.<span style="color: #33ffdd;">05</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>.<span style="color: #33ffdd;">05</span>,.<span style="color: #33ffdd;">05</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>-.<span style="color: #33ffdd;">05</span>,.<span style="color: #33ffdd;">05</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EndIf</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">EndIf</span> <br />
TOKSIM_Advance<span style=" ">&#40;</span><span style="color: #33ffdd;">1.5</span>/FPS,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">UpdateWorld</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">Next</span></div>
<p>Здесь мы изменили цикл предыдущего куска кода. Команда TOKSIM_Advance моделирует физику. Первый параметр является шагом времени - это может быть полезным для создания эффекта замедления. Второй параметр устанавливает число суб-шагов. От этого зависит точность обработки физики.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">PositionEntity</span> obj<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,TOKRB_GetX#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,TOKRB_GetY#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,TOKRB_GetZ#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span> <br />
<span style="color: #aaffff; font-weight: bold;">RotateEntity</span> obj<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,TOKRB_GetPitch#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,TOKRB_GetYaw#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,TOKRB_GetRoll#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">False</span></div>
<p>Вращает у устанавливает новое положение жестких тел.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">KeyDown</span><span style=" ">&#40;</span><span style="color: #33ffdd;">57</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
<p>TOKRB_ApplyImpulse2 rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>-.<span style="color: #33ffdd;">3</span>,.<span style="color: #33ffdd;">3</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-1.5</span>,<span style="color: #33ffdd;">3.0</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>-.<span style="color: #33ffdd;">3</span>,.<span style="color: #33ffdd;">3</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>-.<span style="color: #33ffdd;">05</span>,.<span style="color: #33ffdd;">05</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>.<span style="color: #33ffdd;">05</span>,.<span style="color: #33ffdd;">05</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>-.<span style="color: #33ffdd;">05</span>,.<span style="color: #33ffdd;">05</span><span style=" ">&#41;</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">EndIf</span></div>
<p>Здесь мы задали произвольное вращение и движение объектам. TOKRB_ApplyImpulse2 - устанавливает импульс движения и вращения объекта.
Наконец, мы уничтожаем симулятор и заканчиваем программу.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">TOKSIM_DestroySimulator<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End</span></div>
<p>Вот вам полный код демки:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Const</span> Rigid_Bodies=<span style="color: #33ffdd;">100</span>,Animated_Bodies=<span style="color: #33ffdd;">5</span>,Rigid_Particles=<span style="color: #33ffdd;">0</span><br />
<p><br />
TOKSIM_SetRigidBodiesCount Rigid_Bodies<br />
TOKSIM_SetAnimatedBodiesCount Animated_Bodies<br />
TOKSIM_SetRigidParticleCount Rigid_Particles<br />
TOKSIM_SetControllersCount <span style="color: #33ffdd;">0</span><br />
TOKSIM_SetGeometriesCount Rigid_bodies+Animated_Bodies <span style="color: #ffee00">;Assuming each one</span><br />
<span style="color: #ffee00">;only has one geometry. Not true with more complex rigid bodies and animated bodies.</span><br />
<br />
TOKSIM_CreateSimulator<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">-10</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Graphics3D</span> <span style="color: #33ffdd;">800</span>,<span style="color: #33ffdd;">600</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">2</span><br />
<span style="color: #aaffff; font-weight: bold;">Const</span> FPS=<span style="color: #33ffdd;">60</span><br />
<span style="color: #aaffff; font-weight: bold;">Global</span> cam = <span style="color: #aaffff; font-weight: bold;">CreateCamera</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> cam,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">-50</span><br />
<br />
l=<span style="color: #aaffff; font-weight: bold;">CreateLight</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
centerpoint=<span style="color: #aaffff; font-weight: bold;">CreatePivot</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
ground = <span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EntityColor</span> ground,<span style="color: #33ffdd;">5</span>,<span style="color: #33ffdd;">5</span>,<span style="color: #33ffdd;">55</span> <br />
<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> ground,<span style="color: #33ffdd;">50</span>,<span style="color: #33ffdd;">5</span>,<span style="color: #33ffdd;">50</span> <br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> ground,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">-5</span>,<span style="color: #33ffdd;">0</span><br />
abground = TOKAB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
TOKAB_AddBox<span style=" ">&#40;</span>abground,<span style="color: #33ffdd;">100.0</span>,<span style="color: #33ffdd;">10.0</span>,<span style="color: #33ffdd;">100.0</span><span style=" ">&#41;</span><br />
TOKAB_SetPosition<span style=" ">&#40;</span>abground,<span style="color: #33ffdd;">0.0</span>,<span style="color: #33ffdd;">-5.0</span>,<span style="color: #33ffdd;">0.0</span><span style=" ">&#41;</span><br />
<br />
wall1 = <span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EntityColor</span> wall1,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">55</span> <br />
<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> wall1,<span style="color: #33ffdd;">2</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">50</span> <br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> wall1,<span style="color: #33ffdd;">50</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
abwall1 = TOKAB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
TOKAB_AddBox<span style=" ">&#40;</span>abwall1,<span style="color: #33ffdd;">4.0</span>,<span style="color: #33ffdd;">20.0</span>,<span style="color: #33ffdd;">100.0</span><span style=" ">&#41;</span><br />
TOKAB_SetPosition<span style=" ">&#40;</span>abwall1,<span style="color: #33ffdd;">50.0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0.0</span><span style=" ">&#41;</span><br />
<br />
wall2 = <span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EntityColor</span> wall2,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">55</span> <br />
<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> wall2,<span style="color: #33ffdd;">2</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">50</span> <br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> wall2,<span style="color: #33ffdd;">-50</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
abwall2 = TOKAB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
TOKAB_AddBox<span style=" ">&#40;</span>abwall2,<span style="color: #33ffdd;">4.0</span>,<span style="color: #33ffdd;">20.0</span>,<span style="color: #33ffdd;">100.0</span><span style=" ">&#41;</span><br />
TOKAB_SetPosition<span style=" ">&#40;</span>abwall2,<span style="color: #33ffdd;">-50.0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0.0</span><span style=" ">&#41;</span><br />
<br />
wall3 = <span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EntityColor</span> wall3,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">55</span> <br />
<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> wall3,<span style="color: #33ffdd;">50</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">2</span> <br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> wall3,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">-50</span><br />
abwall3 = TOKAB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
TOKAB_AddBox<span style=" ">&#40;</span>abwall3,<span style="color: #33ffdd;">100.0</span>,<span style="color: #33ffdd;">20.0</span>,<span style="color: #33ffdd;">4.0</span><span style=" ">&#41;</span><br />
TOKAB_SetPosition<span style=" ">&#40;</span>abwall3,<span style="color: #33ffdd;">0.0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">-50.0</span><span style=" ">&#41;</span><br />
<br />
wall4 = <span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EntityColor</span> wall4,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">55</span> <br />
<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> wall4,<span style="color: #33ffdd;">50</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">2</span> <br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> wall4,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">50</span><br />
abwall4 = TOKAB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
TOKAB_AddBox<span style=" ">&#40;</span>abwall4,<span style="color: #33ffdd;">100.0</span>,<span style="color: #33ffdd;">20.0</span>,<span style="color: #33ffdd;">4.0</span><span style=" ">&#41;</span><br />
TOKAB_SetPosition<span style=" ">&#40;</span>abwall4,<span style="color: #33ffdd;">0.0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">50.0</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> obj<span style=" ">&#40;</span>Rigid_Bodies<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> rb<span style=" ">&#40;</span>Rigid_Bodies<span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">For</span> i=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> Rigid_Bodies<br />
obj<span style=" ">&#40;</span>i<span style=" ">&#41;</span> = <span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> obj<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">1</span>,<span style="color: #33ffdd;">1</span>,<span style="color: #33ffdd;">1</span> <br />
rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>=TOKRB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
TOKRB_AddBox rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">2.0</span>,<span style="color: #33ffdd;">2.0</span>,<span style="color: #33ffdd;">2.0</span><br />
TOKRB_SetPosition rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-40</span>,<span style="color: #33ffdd;">40</span><span style=" ">&#41;</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-40</span>,<span style="color: #33ffdd;">40</span><span style=" ">&#41;</span><br />
TOKRB_SetLinearDamping rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">0.001</span><br />
TOKRB_SetAngularDamping rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">0.02</span> <br />
TOKRB_SetMass rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">2.0</span><br />
TOKRB_SetBoxInertiaTensor rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">4.0</span>,<span style="color: #33ffdd;">2.0</span>,<span style="color: #33ffdd;">2.0</span>,<span style="color: #33ffdd;">2.0</span><br />
TOKRB_SetVelocity rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-10</span>,<span style="color: #33ffdd;">10</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-10</span>,<span style="color: #33ffdd;">10</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-10</span>,<span style="color: #33ffdd;">10</span><span style=" ">&#41;</span><br />
TOKRB_SetTorque rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-10</span>,<span style="color: #33ffdd;">10</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-10</span>,<span style="color: #33ffdd;">10</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-10</span>,<span style="color: #33ffdd;">10</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
period=<span style="color: #33ffdd;">1000</span>/FPS<br />
time=<span style="color: #aaffff; font-weight: bold;">MilliSecs</span><span style=" ">&#40;</span><span style=" ">&#41;</span>-period<br />
<br />
imptime=<span style="color: #aaffff; font-weight: bold;">MilliSecs</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">While</span> <span style="color: #aaffff; font-weight: bold;">Not</span> <span style="color: #aaffff; font-weight: bold;">KeyHit</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
elapsed=<span style="color: #aaffff; font-weight: bold;">MilliSecs</span><span style=" ">&#40;</span><span style=" ">&#41;</span>-time<br />
<span style="color: #aaffff; font-weight: bold;">Until</span> elapsed<br />
<br />
ticks=elapsed/period<br />
tween#=<span style="color: #aaffff; font-weight: bold;">Float</span><span style=" ">&#40;</span>elapsed <span style="color: #aaffff; font-weight: bold;">Mod</span> period<span style=" ">&#41;</span>/<span style="color: #aaffff; font-weight: bold;">Float</span><span style=" ">&#40;</span>period<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> k=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> ticks<br />
time=time+period<br />
<span style="color: #aaffff; font-weight: bold;">If</span> k=ticks <span style="color: #aaffff; font-weight: bold;">Then</span><br />
<span style="color: #aaffff; font-weight: bold;">CaptureWorld</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> i=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> Rigid_Bodies<br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> obj<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,TOKRB_GetX#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,TOKRB_GetY#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,TOKRB_GetZ#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span> <br />
<span style="color: #aaffff; font-weight: bold;">RotateEntity</span> obj<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,TOKRB_GetPitch#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,TOKRB_GetYaw#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,TOKRB_GetRoll#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">False</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">KeyDown</span><span style=" ">&#40;</span><span style="color: #33ffdd;">57</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
TOKRB_ApplyImpulse2 rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>-.<span style="color: #33ffdd;">3</span>,.<span style="color: #33ffdd;">3</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-1.5</span>,<span style="color: #33ffdd;">3.0</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>-.<span style="color: #33ffdd;">3</span>,.<span style="color: #33ffdd;">3</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>-.<span style="color: #33ffdd;">05</span>,.<span style="color: #33ffdd;">05</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>.<span style="color: #33ffdd;">05</span>,.<span style="color: #33ffdd;">05</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>-.<span style="color: #33ffdd;">05</span>,.<span style="color: #33ffdd;">05</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EndIf</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">EndIf</span> <br />
TOKSIM_Advance<span style=" ">&#40;</span><span style="color: #33ffdd;">1.5</span>/FPS,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">UpdateWorld</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
camx#=<span style="color: #aaffff; font-weight: bold;">Cos</span><span style=" ">&#40;</span>rot#<span style=" ">&#41;</span>*<span style="color: #33ffdd;">50</span><br />
camz#=<span style="color: #aaffff; font-weight: bold;">Sin</span><span style=" ">&#40;</span>rot#<span style=" ">&#41;</span>*<span style="color: #33ffdd;">50</span><br />
<br />
rot#=rot#<span style="color: #33ffdd;">+0.05</span>+<span style="color: #aaffff; font-weight: bold;">MouseXSpeed</span><span style=" ">&#40;</span><span style=" ">&#41;</span>/<span style="color: #33ffdd;">5.0</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">If</span> rot#&gt;<span style="color: #33ffdd;">360</span> <span style="color: #aaffff; font-weight: bold;">Then</span> rot#=<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> cam,camx#,<span style="color: #33ffdd;">40</span>,camz#<br />
<span style="color: #aaffff; font-weight: bold;">PointEntity</span> cam,centerpoint<br />
<br />
<span style="color: #aaffff; font-weight: bold;">RenderWorld</span> tween<br />
<span style="color: #aaffff; font-weight: bold;">Flip</span> <span style="color: #aaffff; font-weight: bold;">False</span><br />
<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<br />
TOKSIM_DestroySimulator<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">End</span></div>
<p>PS Данная статья является переводом статьи с blitzcoder.com. Если вы нашли какие то недочеты в статье или я что-то неправильно перевел то пишите мне на AmirL@mail.ru.
</p>
<hr />
<p>Перевод: Amir (e-mail: AmirL@mail.ru)
</p>
<!-- Saved in parser cache with key db1:pcache:idhash:461-0!1!0!!ru!2 and timestamp 20071110040709 -->
<div class="printfooter">
Получено с <a href="54w2qc_x.html">http://blitzetcetera.org/index.php/Tokamak_DLL</a></div>
			<!-- end content -->			<div class="visualClear"></div>				</td>				<td class="rightside">				</td>			</tr>		</table>		</div>	</div>		</div>	
		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
</div></body>
<!-- Mirrored from localhost/index.php/Tokamak_DLL by HTTrack Website Copier/3.x [XR&CO'2007], Sat, 10 Nov 2007 05:16:41 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
</html>