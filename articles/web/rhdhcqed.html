<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru" dir="ltr">	
<!-- Mirrored from localhost/index.php/%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D1%84%D0%BE%D1%80%D0%BC%D1%83%D0%BB_%D0%BB%D0%BE%D0%B3%D0%B8%D0%BA%D0%B8 by HTTrack Website Copier/3.x [XR&CO'2007], Sat, 10 Nov 2007 05:16:43 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
<head>		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />				<meta name="keywords" content="Использование формул логики,Matt Merkulov" />
		<link rel="shortcut icon" href="http://blitzetcetera.org/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="http://blitzetcetera.org/opensearch_desc.php" title="Blitz Et Cetera (Русский)" />
		<title>Использование формул логики — Blitz Et Cetera</title>		<style type="text/css" media="screen,projection">/*<![CDATA[*/ @import "bvih5rde.css?63"; /*]]>*/</style>		<link rel="stylesheet" type="text/css" media="print" href="gcxktlm6.css?63" />		<link rel="stylesheet" type="text/css" media="handheld" href="zumsslq_.css?63" />		<!--[if lt IE 5.5000]><style type="text/css">@import "/skins/OfflineNew/IE50Fixes.css?63";</style><![endif]-->		<!--[if IE 5.5000]><style type="text/css">@import "/skins/OfflineNew/IE55Fixes.css?63";</style><![endif]-->		<!--[if IE 6]><style type="text/css">@import "/skins/OfflineNew/IE60Fixes.css?63";</style><![endif]-->		<!--[if IE 7]><style type="text/css">@import "/skins/OfflineNew/IE70Fixes.css?63";</style><![endif]-->		<!--[if lt IE 7]><script type="text/javascript" src="/skins/common/IEFixes.js?63"></script>		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->		<script type= "text/javascript">/*<![CDATA[*/
var skin = "OfflineNew";
var stylepath = "/skins";
var wgArticlePath = "/index.php/$1";
var wgScriptPath = "";
var wgServer = "http://blitzetcetera.org/";
var wgCanonicalNamespace = "";
var wgCanonicalSpecialPageName = false;
var wgNamespaceNumber = 0;
var wgPageName = "Использование_формул_логики";
var wgTitle = "Использование формул логики";
var wgAction = "view";
var wgArticleId = "144";
var wgIsArticle = true;
var wgUserName = null;
var wgUserGroups = null;
var wgUserLanguage = "ru";
var wgContentLanguage = "ru";
var wgBreakFrames = false;
var wgCurRevisionId = "3190";
/*]]>*/</script>
		<script type="text/javascript" src="2nq-6cel.js?63"><!-- wikibits js --></script>		<script type="text/javascript" src="http://blitzetcetera.org/index.php?title=-&amp;action=raw&amp;gen=js"><!-- site js --></script>		<style type="text/css">/*<![CDATA[*/
@import "http://blitzetcetera.org/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://blitzetcetera.org/index.php?title=MediaWiki:OfflineNew.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://blitzetcetera.org/index.php?title=-&amp;action=raw&amp;gen=css&amp;maxage=18000";
/*]]>*/</style>		<!-- Head Scripts -->	</head><body  class="mediawiki ns-0 ltr page-Использование_формул_логики">	<div id="globalWrapper">	<div id="logocontainer">		<table align="center">		  <tr>				<td id="blitzetclogo">				</td>			</tr>		</table>	</div>	<div id="magbar">	Журнал о программированнии на языках Blitz3D, BlitzMax, BlitzPlus	</div>		<div id="column-content">	<div id="content">		<a name="top" id="top"></a>				<div id="bodyContent">		<table cellspacing=0 cellpadding=0 width=100%>			<tr>			  <td class="leftside">				</td>				<td class="sheetbody">					<h1 class="sheet">Использование формул логики</h1>			<h3 id="siteSub">Материал из Blitz Et Cetera.</h3>			<div id="contentSub"></div>			<!-- start content -->			<table id="toc" class="toc" summary="Содержание"><tr><td><div id="toctitle"><h2>Содержание</h2></div>
<ul>
<li class="toclevel-1"><a href="#.D0.92.D0.B2.D0.B5.D0.B4.D0.B5.D0.BD.D0.B8.D0.B5"><span class="tocnumber">1</span> <span class="toctext">Введение</span></a></li>
<li class="toclevel-1"><a href="#.D0.A3.D0.BC.D0.BD.D0.BE.D0.B6.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B8_.D0.B4.D0.B5.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5"><span class="tocnumber">2</span> <span class="toctext">Умножение и деление</span></a></li>
<li class="toclevel-1"><a href="#.D0.97.D0.B0.D1.86.D0.B8.D0.BA.D0.BB.D0.B8.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5"><span class="tocnumber">3</span> <span class="toctext">Зацикливание</span></a></li>
<li class="toclevel-1"><a href="#.D0.A3.D0.BF.D0.B0.D0.BA.D0.BE.D0.B2.D0.BA.D0.B0_.D0.B4.D0.B0.D0.BD.D0.BD.D1.8B.D1.85"><span class="tocnumber">4</span> <span class="toctext">Упаковка данных</span></a></li>
<li class="toclevel-1"><a href="#.D0.A3.D0.BF.D1.80.D0.BE.D1.89.D0.B5.D0.BD.D0.B8.D0.B5_.D1.84.D0.BE.D1.80.D0.BC.D1.83.D0.BB"><span class="tocnumber">5</span> <span class="toctext">Упрощение формул</span></a></li>
</ul>
</td></tr></table><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "показать"; var tocHideText = "убрать"; showTocToggle(); } </script>
<a name=".D0.92.D0.B2.D0.B5.D0.B4.D0.B5.D0.BD.D0.B8.D0.B5"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D1%84%D0%BE%D1%80%D0%BC%D1%83%D0%BB_%D0%BB%D0%BE%D0%B3%D0%B8%D0%BA%D0%B8&amp;action=edit&amp;section=1" title="Править секцию: Введение">править</a>]</span> <span class="mw-headline">Введение</span></h2>
<p>В этой статье речь пойдет о применении формул логики для оптимизации программ, а также упаковки данных. Формулы логики оперируют только с целыми числами, числа с плавающей точкой округляются.
</p><p>Сначала - о двоичном исчислением, для тех кто с ним не знаком. В обычной, десятичной системе счисления, которую мы используем, для записи чисел используются десять знаков - 0123456789. Любое число можно разложить на разряды следующим образом: a * 10<sup>n</sup> + b * 10<sup>n-1</sup> + ... + x * 10<sup>2</sup> + y * 10 + z. Например: 956 = 9 * 10<sup>2</sup> + 5 * 10<sup>1</sup> + 6 * 10<sup>0</sup>. Число 10 называется ОСНОВАНИЕМ системы. Двоичная система счисления имеет основание 2, то есть любое чило может быть представлено так: a * 2<sup>n</sup> + b * 2<sup>n-1</sup> + ... + x * 2<sup>2</sup> + y * 2 + z, например: 1011 = 1*2<sup>3</sup> + 0 * 2<sup>2</sup> + 1 * 2<sup>1</sup> + 1 * 2<sup>0</sup>. Легко посчитать, что в десятичной системе счисления это число равно 8 + 2 + 1 = 11. Для записи чисел в двоичной системе счисления используются два знака - 0 и 1.
</p><p>Классические формулы логики оперируют переменными только с двумя значениями - ИСТИНА (1) и ЛОЖЬ (0):
</p>
<table align="center" border="2">
<tr>
<td>  A
</td><td>  B
</td><td> NOT A
</td><td> A AND B
</td><td> A OR B
</td><td> A XOR B
</td></tr>
<tr align="center">
<td> 0
</td><td> 0
</td><td> 1
</td><td> 0
</td><td> 0
</td><td> 0
</td></tr>
<tr align="center">
<td> 0
</td><td> 1
</td><td> 1
</td><td> 0
</td><td> 1
</td><td> 1
</td></tr>
<tr align="center">
<td> 1
</td><td> 0
</td><td> 0
</td><td> 0
</td><td> 1
</td><td> 1
</td></tr>
<tr align="center">
<td> 1
</td><td> 1
</td><td> 0
</td><td> 1
</td><td> 1
</td><td> 0
</td></tr></table>
<p>Логические операции над числами (которые имеют 32 бита) можно представить, так:
</p><p><br />
</p>
<table align="center" border="1">
<tr>
<td> A)
</td><td>   0...01010110
</td><td>   0...01010110
</td><td>   0...01010110
</td></tr>
<tr>
<td> B)
</td><td>   0...00100111
</td><td>   0...00100111
</td><td>   0...00100111
</td></tr>
<tr>
<td>
</td><td>   <hr />
</td><td>   <hr />
</td><td>   <hr />
</td></tr>
<tr>
<td>
</td><td>   0...00000110
</td><td>   0...01110111
</td><td>   0...01110001
</td></tr>
<tr align="center">
<td>
</td><td> A AND B
</td><td> A OR B
</td><td> A XOR B
</td></tr></table>
<p><br />
Как Вы видите, операция производится над битами, находящимися в одинаковых столбцах, а результат записывается  в новое число в бит того же столбца. Операция NOT действует иным образом: результат равен 1, если число (а не бит) равно 0, если же число отлично от 0, то результат равен 0. Для представления числа в двоичном виде в Blitz существует функция BIN$. Например, BIN$(51) дает строку "000000000000000000000000000000110011". Преобразовывать числа из двоичной системы в десятичную поможет идентификатор % (%110011=51).
</p>
<a name=".D0.A3.D0.BC.D0.BD.D0.BE.D0.B6.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B8_.D0.B4.D0.B5.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D1%84%D0%BE%D1%80%D0%BC%D1%83%D0%BB_%D0%BB%D0%BE%D0%B3%D0%B8%D0%BA%D0%B8&amp;action=edit&amp;section=2" title="Править секцию: Умножение и деление">править</a>]</span> <span class="mw-headline">Умножение и деление</span></h2>
<p>Команды "a SHL n" и "a SHR n" осуществляют побитовый сдвиг в числе a на n бит. SHR - вправо, SHL - влево. Скажем, 43(101011) SHR 1 = 21(10101), 5(101) SHL 3 = 40(101000). Как видите, SHR уничтожает значения крайних битов, а SHL дополняет число нулями. Нижеследующие эквиваленты очень полезны, т. к. логические операции гораздо быстрее арифметических, пытайтесь по возможности максимально широко использовать логические.
</p>
<ul><li>a * 2<sup>n</sup> = a SHL n
</li><li>FLOOR(a / 2<sup>n</sup>) = a SHR n
</li></ul>
<a name=".D0.97.D0.B0.D1.86.D0.B8.D0.BA.D0.BB.D0.B8.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D1%84%D0%BE%D1%80%D0%BC%D1%83%D0%BB_%D0%BB%D0%BE%D0%B3%D0%B8%D0%BA%D0%B8&amp;action=edit&amp;section=3" title="Править секцию: Зацикливание">править</a>]</span> <span class="mw-headline">Зацикливание</span></h2>
<p>Очень часто в программе требуется "зациклить" какую-нибудь переменную. Например, игрок с координатами (X, Y) находится на карте NxN клеток, где каждая клетка имеет координаты (0...n-1, 0...n-1). Он может перемещаться вверх / вниз / вправо / влево, соответвственно меняются координаты (Y = Y - 1 / Y = Y + 1 / X = X + 1 / X = X - 1). Необходимо сделать так, чтобы при выходе за пределы карты, он появлялся с другой стороны, то есть, если координата X равна 0, а игрок делает шаг влево, то она становится равной не -1, а n-1 (противоположный край карты). Все бы ничего, да на карте есть локация с сапогами-скороходами, позволяющими перемещаться в любую сторону на случайное расстояние, которое может быть в несколько раз больше n. Соответственно, надо учитывать, что игрок может "промотать" за один ход несколько кругов по карте, в том числе и уменьшая координату. Самый простой (и самый медленный) способ выглядит так:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffee00">;Функция уменьшает или увеличивает переменную на n, пока она не окажется в</span><br />
<p><span style="color: #ffee00">;пределах (0...n - 1)</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> LoopNum<span style=" ">&#40;</span>x, n<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> v &lt; n <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; v = v + n<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">ElseIf</span> v &gt;= n <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; v = v - n<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Return</span> v<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
<span style="color: #aaffff; font-weight: bold;">Forever</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<p>Хорошо, если это только один игрок, а если это подконтрольные компьютеру существа, которых тысячи? Еще пара способов, более скоростных:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffee00">;Этот способ использует остаток от деления на n. Число &quot;5&quot; означает максимальное</span><br />
<p><span style="color: #ffee00">;количество кругов, которое переменная может &quot;промотать&quot; назад.</span><br />
x = <span style=" ">&#40;</span>x + n * <span style="color: #33ffdd;">5</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Mod</span> n<br />
<span style="color: #ffee00">;Более аккуратный способ - вычитание излишка / прибавление недостатка</span><br />
</p>
x = x - <span style="color: #aaffff; font-weight: bold;">Floor</span><span style=" ">&#40;</span>x / n<span style=" ">&#41;</span> * n</div>
<p>Но самый быстрый способ можно применить, если n = 2<sup>m</sup> (m &gt;= 1), тогда:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">x = x <span style="color: #aaffff; font-weight: bold;">And</span> <span style=" ">&#40;</span>n<span style="color: #33ffdd;">-1</span><span style=" ">&#41;</span></div>
<p>Вот и все! Но давайте разберемся, как это работает. Число 2<sup>m</sup> в двоичной системе счисления выглядит так: 1000...0, где нулей ровно m. А если от него отнять единицу, то получим число 1111...1, в котором будет m единиц. Операция AND отсекает ненужные биты, образующиеся при выходе переменной за рамки (0...n - 1). Например, n AND (n - 1) = 0, а -1(11111...11111 - 32 единицы) AND (n - 1) = n - 1, что, собственно, и требовалось.
</p>
<a name=".D0.A3.D0.BF.D0.B0.D0.BA.D0.BE.D0.B2.D0.BA.D0.B0_.D0.B4.D0.B0.D0.BD.D0.BD.D1.8B.D1.85"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D1%84%D0%BE%D1%80%D0%BC%D1%83%D0%BB_%D0%BB%D0%BE%D0%B3%D0%B8%D0%BA%D0%B8&amp;action=edit&amp;section=4" title="Править секцию: Упаковка данных">править</a>]</span> <span class="mw-headline">Упаковка данных</span></h2>
<p>А вот проблема, возникающая при работе с большими картами во многих типах программ: приходится к каждой клетке большой карты привязывать несколько параметров. Ну, например, создается мега-аркада с огромной картой, 1000 на 1000 клеток. Каждая клетка содержит следующую информацию: номер тайла (изображения клетки) (0-999), проходимость (0 - да, 1 - нет), 2 дополнительных изображения (следы крови, сажа) в диапазоне от 0 до 59, уровень заполненности водой (0-15), предмет (0-11). Если идти стандартным путем, то для хранения всей этой информации понадобится 6 массивов, и вся карта будет занимать 28MB. Может показаться, что трата памяти сейчас практически не проблема, но если карта представляет огромный мир и в несколько десятков раз больше? Сколько будут занимать и загружаться сохраненные игры? Есть способ свести данные в один массив, то есть уменьшить их объем в 7 раз в данном случае. Для начала, попробуем определить, сколько бит занимает каждая из составляющих:
</p>
<ul><li>Номер тайла: 10 бит (2<sup>9</sup>(512) &lt; 1000 &lt; 2<sup>10</sup>(1024))
</li><li>Проходимость: 1 бит
</li><li>Дополнительные изображения: 2 х 6 бит (2<sup>5</sup>(32) &lt; 60 &lt; 2<sup>6</sup>(64))
</li><li>Уровень воды: 4 бит (16=2<sup>4</sup>)
</li><li>Предмет: 4 бит (2<sup>3</sup>(8) &lt; 12 &lt; 2<sup>4</sup>(16))
</li><li>Итого: 31 бит &gt; 32 бит
</li></ul>
<p>Теперь разобъем биты переменной на части:
</p>
<table align="center" border="2">
<tr>
<td align="right"> Данные:
</td><td>
</td><td> Тайл
</td><td> Пр.
</td><td> Доп. из. 1
</td><td> Доп. из. 2
</td><td> Вода
</td><td> Предмет
</td></tr>
<tr align="center">
<td align="right"> Число:
</td><td> 0
</td><td> 0000000000
</td><td> 0
</td><td> 000000
</td><td> 000000
</td><td> 0000
</td><td> 0000
</td></tr>
<tr align="center">
<td align="right"> Положение:
</td><td> 31
</td><td> 21-30
</td><td> 20
</td><td> 14-19
</td><td> 9-13
</td><td> 4-8
</td><td> 0-3
</td></tr></table>
<p>Теперь можно работать с массивом:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffee00">;Если все составляющие известны, то формируется массив следующим образом: </span><br />
<p><span style="color: #ffee00">; каждая переменная сдвигается на свою позицию, и все они складываются </span><br />
map<span style=" ">&#40;</span>x,y<span style=" ">&#41;</span>=tile <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">21</span>+movethru <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">20</span>+i1 <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">14</span>+i2 <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">9</span>+water <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">4</span>+obj<br />
<span style="color: #ffee00">;Для замены одной из составляющих, нужно сначала обнулить ее в массиве </span><br />
<span style="color: #ffee00">;(обратите внимание, что в двоичном числе нули стоят на позициях, занимаемых </span><br />
<span style="color: #ffee00">; переменной), а затем добавить, предварительно сдвинув: </span><br />
map<span style=" ">&#40;</span>x,y<span style=" ">&#41;</span>=map<span style=" ">&#40;</span>x,y<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">And</span> %<span style="color: #33ffdd;">01111111111100001111111111111111</span>+i1 <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">14</span><br />
<span style="color: #ffee00">;Чтение переменной проще: сначала сдвигаем число назад, чтобы она оказалась </span><br />
<span style="color: #ffee00">; справа, а затем отсекаем левую часть (количество единиц в двоичном числе </span><br />
<span style="color: #ffee00">; равно количеству бит, занимаемых переменной): </span><br />
i2=map<span style=" ">&#40;</span>x,y<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">14</span> <span style="color: #aaffff; font-weight: bold;">And</span> %<span style="color: #33ffdd;">1111</span><br />
<span style="color: #ffee00">;А вот так можно легко поменять значение флага (однобитной переменной) на </span><br />
<span style="color: #ffee00">; противоположное (если использовать команду OR, то флаг будет включен): </span><br />
map<span style=" ">&#40;</span>x,y<span style=" ">&#41;</span>=map<span style=" ">&#40;</span>x,y<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Xor</span> %<span style="color: #33ffdd;">00000000000100000000000000000000</span><br />
</p>
<span style="color: #ffee00">;Двоичные числа можно сразу преобразовывать в десятичные</span></div>
<p>В программе реализации игры "Жизнь" такая упаковка данных еще и ускоряет работу.
</p>
<a name=".D0.A3.D0.BF.D1.80.D0.BE.D1.89.D0.B5.D0.BD.D0.B8.D0.B5_.D1.84.D0.BE.D1.80.D0.BC.D1.83.D0.BB"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D1%84%D0%BE%D1%80%D0%BC%D1%83%D0%BB_%D0%BB%D0%BE%D0%B3%D0%B8%D0%BA%D0%B8&amp;action=edit&amp;section=5" title="Править секцию: Упрощение формул">править</a>]</span> <span class="mw-headline">Упрощение формул</span></h2>
<p>Вот, например одна из часто возникающих задач: переменная A принимает определенные значения (1, 3, 9, 10, 15), переменная B, в зависимости от того, какое значение приняла первая, должна принять значение из другого набора (2, 6, 3, 5, 11). К примеру, если A=1, то B=2, если A=3, то B=6. Самый простой и наглядный способ - это использовать оператор SELECT:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Select</span> A<br />
<p>&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">1</span>: B=<span style="color: #33ffdd;">2</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">3</span>: B=<span style="color: #33ffdd;">6</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">9</span>: B=<span style="color: #33ffdd;">3</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">10</span>: B=<span style="color: #33ffdd;">5</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">15</span>: B=<span style="color: #33ffdd;">11</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Select</span></div>
<p>Еще один способ - более медленный и менее наглядный, но компактен и позволяет присваивать значения строковым переменным:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">B=<span style="color: #aaffff; font-weight: bold;">MID</span>$<span style=" ">&#40;</span><span style="color: #00ff66;">&quot; 02..06.......0305........11&quot;</span>,A*<span style="color: #33ffdd;">2</span>,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span></div>
<p>Способ, использующий логические выражения, нагляден и компактен, но уступает первым двум по скорости:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">B=<span style=" ">&#40;</span>A=<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>*<span style="color: #33ffdd;">2</span>+<span style=" ">&#40;</span>A=<span style="color: #33ffdd;">3</span><span style=" ">&#41;</span>*<span style="color: #33ffdd;">9</span>+<span style=" ">&#40;</span>A=<span style="color: #33ffdd;">9</span><span style=" ">&#41;</span>*<span style="color: #33ffdd;">3</span>+<span style=" ">&#40;</span>A=<span style="color: #33ffdd;">10</span><span style=" ">&#41;</span>*<span style="color: #33ffdd;">5</span>+<span style=" ">&#40;</span>A=<span style="color: #33ffdd;">15</span><span style=" ">&#41;</span>*<span style="color: #33ffdd;">11</span></div>
<hr />
<p>Автор: <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Matt_Merkulov" title="Участник:Matt Merkulov">Матвей Меркулов</a> (E-mail: MattMerk@mail.ru, ICQ: 392-274-050)
</p>
<!-- Saved in parser cache with key db1:pcache:idhash:144-0!1!0!!ru!2 and timestamp 20071110040746 -->
<div class="printfooter">
Получено с <a href="rhdhcqed.html">http://blitzetcetera.org/index.php/%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D1%84%D0%BE%D1%80%D0%BC%D1%83%D0%BB_%D0%BB%D0%BE%D0%B3%D0%B8%D0%BA%D0%B8</a></div>
			<!-- end content -->			<div class="visualClear"></div>				</td>				<td class="rightside">				</td>			</tr>		</table>		</div>	</div>		</div>	
		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
</div></body>
<!-- Mirrored from localhost/index.php/%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D1%84%D0%BE%D1%80%D0%BC%D1%83%D0%BB_%D0%BB%D0%BE%D0%B3%D0%B8%D0%BA%D0%B8 by HTTrack Website Copier/3.x [XR&CO'2007], Sat, 10 Nov 2007 05:16:43 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
</html>