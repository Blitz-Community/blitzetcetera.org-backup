<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru" dir="ltr">	
<!-- Mirrored from localhost/index.php/%D0%A2%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2%D0%B0%D1%8F_%D0%B8%D0%B3%D1%80%D0%B0_%D0%BD%D0%B0_BlitzMax by HTTrack Website Copier/3.x [XR&CO'2007], Sat, 10 Nov 2007 05:15:11 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
<head>		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />				<meta name="keywords" content="Тайловая игра на BlitzMax,Dimanche13" />
		<link rel="shortcut icon" href="http://blitzetcetera.org/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="http://blitzetcetera.org/opensearch_desc.php" title="Blitz Et Cetera (Русский)" />
		<title>Тайловая игра на BlitzMax — Blitz Et Cetera</title>		<style type="text/css" media="screen,projection">/*<![CDATA[*/ @import "bvih5rde.css?63"; /*]]>*/</style>		<link rel="stylesheet" type="text/css" media="print" href="gcxktlm6.css?63" />		<link rel="stylesheet" type="text/css" media="handheld" href="zumsslq_.css?63" />		<!--[if lt IE 5.5000]><style type="text/css">@import "/skins/OfflineNew/IE50Fixes.css?63";</style><![endif]-->		<!--[if IE 5.5000]><style type="text/css">@import "/skins/OfflineNew/IE55Fixes.css?63";</style><![endif]-->		<!--[if IE 6]><style type="text/css">@import "/skins/OfflineNew/IE60Fixes.css?63";</style><![endif]-->		<!--[if IE 7]><style type="text/css">@import "/skins/OfflineNew/IE70Fixes.css?63";</style><![endif]-->		<!--[if lt IE 7]><script type="text/javascript" src="/skins/common/IEFixes.js?63"></script>		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->		<script type= "text/javascript">/*<![CDATA[*/
var skin = "OfflineNew";
var stylepath = "/skins";
var wgArticlePath = "/index.php/$1";
var wgScriptPath = "";
var wgServer = "http://blitzetcetera.org/";
var wgCanonicalNamespace = "";
var wgCanonicalSpecialPageName = false;
var wgNamespaceNumber = 0;
var wgPageName = "Тайловая_игра_на_BlitzMax";
var wgTitle = "Тайловая игра на BlitzMax";
var wgAction = "view";
var wgArticleId = "779";
var wgIsArticle = true;
var wgUserName = null;
var wgUserGroups = null;
var wgUserLanguage = "ru";
var wgContentLanguage = "ru";
var wgBreakFrames = false;
var wgCurRevisionId = "3531";
/*]]>*/</script>
		<script type="text/javascript" src="2nq-6cel.js?63"><!-- wikibits js --></script>		<script type="text/javascript" src="http://blitzetcetera.org/index.php?title=-&amp;action=raw&amp;gen=js"><!-- site js --></script>		<style type="text/css">/*<![CDATA[*/
@import "http://blitzetcetera.org/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://blitzetcetera.org/index.php?title=MediaWiki:OfflineNew.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://blitzetcetera.org/index.php?title=-&amp;action=raw&amp;gen=css&amp;maxage=18000";
/*]]>*/</style>		<!-- Head Scripts -->	</head><body  class="mediawiki ns-0 ltr page-Тайловая_игра_на_BlitzMax">	<div id="globalWrapper">	<div id="logocontainer">		<table align="center">		  <tr>				<td id="blitzetclogo">				</td>			</tr>		</table>	</div>	<div id="magbar">	Журнал о программированнии на языках Blitz3D, BlitzMax, BlitzPlus	</div>		<div id="column-content">	<div id="content">		<a name="top" id="top"></a>				<div id="bodyContent">		<table cellspacing=0 cellpadding=0 width=100%>			<tr>			  <td class="leftside">				</td>				<td class="sheetbody">					<h1 class="sheet">Тайловая игра на BlitzMax</h1>			<h3 id="siteSub">Материал из Blitz Et Cetera.</h3>			<div id="contentSub"></div>			<!-- start content -->			<table id="toc" class="toc" summary="Содержание"><tr><td><div id="toctitle"><h2>Содержание</h2></div>
<ul>
<li class="toclevel-1"><a href="#.D0.92.D0.B2.D0.B5.D0.B4.D0.B5.D0.BD.D0.B8.D0.B5"><span class="tocnumber">1</span> <span class="toctext">Введение</span></a></li>
<li class="toclevel-1"><a href="#.D0.A2.D0.B0.D0.B9.D0.BB.D0.BE.D0.B2.D1.8B.D0.B5_.D0.BA.D0.B0.D1.80.D1.82.D1.8B"><span class="tocnumber">2</span> <span class="toctext">Тайловые карты</span></a></li>
<li class="toclevel-1"><a href="#.D0.91.D0.BE.D0.BD.D1.83.D1.81.D1.8B"><span class="tocnumber">3</span> <span class="toctext">Бонусы</span></a></li>
<li class="toclevel-1"><a href="#.D0.94.D0.B2.D0.B8.D0.B6.D0.B5.D0.BD.D0.B8.D0.B5"><span class="tocnumber">4</span> <span class="toctext">Движение</span></a></li>
<li class="toclevel-1"><a href="#.D0.9E.D0.B4.D0.B8.D0.BD_.D1.81.D0.BF.D0.B8.D1.81.D0.BE.D0.BA"><span class="tocnumber">5</span> <span class="toctext">Один список</span></a></li>
<li class="toclevel-1"><a href="#.D0.92.D1.8B.D0.B2.D0.B5.D0.B4.D0.B5.D0.BD.D0.B8.D0.B5"><span class="tocnumber">6</span> <span class="toctext">Выведение</span></a></li>
</ul>
</td></tr></table><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "показать"; var tocHideText = "убрать"; showTocToggle(); } </script>
<a name=".D0.92.D0.B2.D0.B5.D0.B4.D0.B5.D0.BD.D0.B8.D0.B5"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A2%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2%D0%B0%D1%8F_%D0%B8%D0%B3%D1%80%D0%B0_%D0%BD%D0%B0_BlitzMax&amp;action=edit&amp;section=1" title="Править секцию: Введение">править</a>]</span> <span class="mw-headline">Введение</span></h2>
<p>Привет! Этот тутор поможет вам понять, как строятся игры на основе плиток (далее - тайлов). Надеюсь, что приведенная здесь информация будет полезной для начинающих гейм-девелоперов.
</p><p>Я не претендую на абсолютное знание предмета и всех его тонкостей, это, так сказать, мой взгляд на данную тему. Многое, что здесь написано, взято не с потолка, а уже много лет используется другими людьми, я лишь адаптировал код под BlitzMax, конечно, добавив некоторые моменты и от себя. Вот главные ресурсы, с которых была взята информация по данной теме:
</p><p><br />
</p>
<ul><li><a href="http://www.tonypa.pri.ee/tbw/start.html" class="external free" title="http://www.tonypa.pri.ee/tbw/start.html" rel="nofollow">http://www.tonypa.pri.ee/tbw/start.html</a> пожалуй, это главная ссылка, здесь приведены основные принципы построения тайловых игр, исходники для FlashMX2004 (ver7).
</li><li><a href="http://www.dionaholding.ru/news/articles/tbg_flash?PHPSESSID=2fecc224531c56dbee2ef2954fc6ed07" class="external free" title="http://www.dionaholding.ru/news/articles/tbg_flash?PHPSESSID=2fecc224531c56dbee2ef2954fc6ed07" rel="nofollow">http://www.dionaholding.ru/news/articles/tbg_flash?PHPSESSID=2fecc224531c56dbee2ef2954fc6ed07</a>  - это тоже самое, только переведенное на русский язык, исходники те же
</li><li><a href="http://jnrdev.72dpiarmy.com/" class="external free" title="http://jnrdev.72dpiarmy.com" rel="nofollow">http://jnrdev.72dpiarmy.com</a> - еще один сайт по данной тематике, исходники для С++ движок SDL.
</li></ul>
<p>Это далеко не всё, есть и другие источники, можете накопать еще что-нибудь в Интернете.
</p><p>Сразу хочу заметить несколько моментов:
</p>
<ul><li>Я пишу программы с директивой SuperStrict. Где-то читал, что эта директива заставляет программу работать быстрее, каких-то документальных подтверждений этой теории я не нашел, но если это правда, то почему бы ей и не пользоваться. А использую я ее лишь для того, чтобы избежать ошибок в правильном написании переменных и чтобы видеть к каким типам они принадлежат.
</li><li>Я не использую всякие значки типа $, % и т.д. в объявлении переменных. И все параметры функций заключены в скобки ( ). Так уж у меня повелось, и это единственное обоснование.
</li><li>В названии типа я всегда ставлю вначале букву T , так если хочу создать тип Level, то я называю его TLevel,(буква T от слова Type).
</li><li>Функцию создания любого объекта, я называю Create() и она всегда находится внутри типа, для которого используется. Доступ к ней производится через точку. Например: TLevel.Create() .
</li><li>Функция, в которой происходит рисование объекта на экране, всегда называется Draw().
</li><li>Функция, в которой происходит изменение состояния объекта, изменение размеров, перемещение и другие действия, всегда называется Update().
</li><li>Я не утверждаю, что надо делать так и только так. Вовсе нет, каждый сам хозяин своего кода. Но на протяжении всего тутора, я буду придерживаться своих правил, поэтому и считаю правильным заранее вас об этом предупредить.
</li></ul>
<a name=".D0.A2.D0.B0.D0.B9.D0.BB.D0.BE.D0.B2.D1.8B.D0.B5_.D0.BA.D0.B0.D1.80.D1.82.D1.8B"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A2%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2%D0%B0%D1%8F_%D0%B8%D0%B3%D1%80%D0%B0_%D0%BD%D0%B0_BlitzMax&amp;action=edit&amp;section=2" title="Править секцию: Тайловые карты">править</a>]</span> <span class="mw-headline">Тайловые карты</span></h2>
<p>Что же такое тайл? Тайл в переводе с англицкого - это плитка. В нашем случае это прямоугольник (чаще - квадрат, реже - шестиугольник) с картинкой. Вы когда-нибудь собирали пазл? Одну большую картинку из множества кусочков. Каждый из кусочков не имел никакой ценности. Помните, что нельзя было понять, что изображено на каждом кусочке, и только соединив несколько соседних можно было увидеть часть рисунка или картины. Так же и в играх, разработчики дробят весь уровень игры (или карту)  на маленькие равные кусочки. Вы ,конечно, спросите, а зачем они это делают? Попытаюсь объяснить подоходчивей. Даже имея 5 разных тайлов, можно нарисовать приличную карту для игры. Просто размещая эти тайлы в нужном вам порядке. Гляньте:
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:TileGame1-01.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:TileGame1-01.jpg" src="f3b23faa.jpg" width="432" height="301" /></a></span></div></div>
<p>Мои художественные способности оставляют желать лучшего, так что эта карта - ради объяснения принципа, а не ради красоты. Видите, слева я нарисовал тайлы, которые использую в своей карте, а справа карта, собранная из этих тайлов. Думаю, всё наглядно и понятно. Зачем рисовать новую большую карту, затратив при этом много усилий, когда можно собрать ее по кусочкам, за несколько минут. Разработчики  просто рисуют набор тайлов для карты и нумеруют их. Например так: трава - 0, вода - 1, деревцо - 2, дом - 3, куст - 4. И тогда в памяти компьютера карту можно представить так&nbsp;:
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:TileGame1-02.gif" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:TileGame1-02.gif" src="kb9524bq.gif" width="398" height="301" /></a></span></div></div>
<p>Думаю всем очевидны преимущества данного метода: можно собрать множество разных карт с помощью ограниченного набора тайлов. Тайлы обычно бывают квадратными с размерами (ширина х высота)&nbsp;: 16х16, 24х24, 32х32, 64х64, т.е. ширина = высоте. Но вас никто не ограничивает и вы можете делать тайлы, например, 16х8 или другого размера, всё зависит лишь от вашей фантазии и движка вашей игры. Я использую такие тайлы лишь потому, что наборы тайлов таких размеров легко можно найти в интернете, чтобы не рисовать самому(мои худ. способности вы видели выше). Хорошо, с этим мы разобрались. Но есть и еще один параметр тайла. Этот параметр - проходимость. То есть, сможет ли игрок пройти по этому тайлу. Допустим, в вашей игре можно идти по тайлам, обозначающим траву, дорогу или песок, а по другим тайлам идти нельзя, таким как дерево или куст, стена или еще что-то. Так что, договоримся , что для каждого тайла установим параметр &lt;проходимость&gt;! Который будет принимать значения &lt;Да&gt; и &lt;Нет&gt;, разные для каждого тайла.(?) Посмотрите на нашу карту:
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:TileGame1-03.gif" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:TileGame1-03.gif" src="z0qzm20z.gif" width="398" height="301" /></a></span></div></div>
<p>Она имеет размеры: 6 тайлов в ширину (от 0 до 5) и 7 тайлов в высоту (от 0 до 6). Или по-другому - 6х7 тайлов. Теперь мы можем видеть, что тайлы по координатам (1,3)&nbsp;; (3,3)  и (4,6) содержат цифру 3, то есть тайл - дом, ну и так далее. Видите: все очень просто. Итак, перечислим все параметры для нашего тайла. Это: ширина и высота тайла, его координаты на тайловой карте, координаты на экране, проходимость и номер картинки в нашем наборе тайлов.
</p><p>Так будет выглядеть тип тайла в Блитце:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">Type</span> TTile<br />
<p>&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> width &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #B1E7EB;">' ширина тайла</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> height &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #B1E7EB;">' высота тайла</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> xTile,yTile &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #B1E7EB;">' координаты на карте(тайловые координаты)</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> x,y &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #B1E7EB;">' координаты на экране</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> walkable &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #B1E7EB;">' проходимость</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> image &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #B1E7EB;">' картинка</span><br />
</p>
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">type</span></div>
<p>Постойте, я ничего не рассказывал про экранные координаты. Ладно, тут дело состоит в том, что у нас пока имеются только координаты тайла в карте, но не на экране. Как их перевести в экранные? Давайте подумаем. Допустим размеры тайла 32х32.
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:TileGame1-04.gif" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:TileGame1-04.gif" src="n7127eyp.gif" width="286" height="222" /></a></span></div></div>
<p>Тайл по координатам (0,0) - это трава, следующий за ним тайл (1,0) - это куст, дальше (2,0) - опять трава и т. д. Допустим, первый тайл рисуется прямо с левого верхнего угла экрана, т.е. его х и у равны 0, второй тайл будет рисоваться сразу за первым, правильно. Третий будет рисоваться начиная с окончания второго. Ладно смотрите:
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:TileGame1-05.gif" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:TileGame1-05.gif" src="7qkmyk6k.gif" width="286" height="222" /></a></span></div></div>
<p>Я изобразил три тайла, идущих друг за другом, разного цвета, для наглядности примера.
</p><p>Ок. Перевод тайловых координат в экранные очень прост. Давайте домножать тайловые координаты на ширину тайла. Смотрите сами первый тайл (0,0) домножим на 32 - экранные координаты стали (0,0) потому что умножение на 0 дает 0, дальше интереснее - второй тайл (1,0) домножим на 32 (1*32, 0*32) , экранные координаты - (32, 0), третий тайл -(2*32,0*32) - экранные координаты (64, 0). А теперь посмотрите на картинку выше. Ого! Так оно и есть - первый тайл (синенький) начинается с (0,0)&nbsp;; второй(зелененький) - начинается с (32,0), третий(малиновый) - (64,0). Итак повторю, чтобы перейти от тайловых координат к экранным надо домножать на РАЗМЕР ТАЙЛА. Вот так:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;">x = xTile * Tile_Width<br />
y = yTile * Tile_Height</div>
<p>ну ,соответственно, если ширина и высота тайла равны, то проще:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;">x = xTile * TileSize<br />
y = yTile * TileSize</div>
<p>Ну теперь нам ничего не стоит сделать функцию создания тайла, но для начала создадим список(или лист) в котором будут содержаться(храниться) все созданные нами тайлы, не буду ничего придумывать и назову лист так: TileList.
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">Global</span> TileList:<span style="color: #ffff00; font-weight: bold;">TList</span> = <span style="color: #ffff00; font-weight: bold;">CreateList</span><span style=" ">&#40;</span><span style=" ">&#41;</span></div>
<p>А теперь функция создания тайла:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">Function</span> Create<span style=" ">&#40;</span>sx:<span style="color: #ffff00; font-weight: bold;">Int</span>, sy:<span style="color: #ffff00; font-weight: bold;">Int</span>, WB:<span style="color: #ffff00; font-weight: bold;">Byte</span><span style=" ">&#41;</span><br />
<p>&nbsp; <span style="color: #ffff00; font-weight: bold;">Local</span> TT:TTile = <span style="color: #ffff00; font-weight: bold;">New</span> TTile<br />
&nbsp; &nbsp; TT.<span style="">width</span> &nbsp;= TiLESIZE<br />
&nbsp; &nbsp; TT.<span style="">height</span> = TiLESIZE<br />
&nbsp; &nbsp; TT.<span style="">xTile</span> = sx<br />
&nbsp; &nbsp; TT.<span style="">yTile</span> = sy<br />
&nbsp; &nbsp; TT.<span style="">x</span> = TT.<span style="">xTile</span> * TT.<span style="">width</span><br />
&nbsp; &nbsp; TT.<span style="">y</span> = TT.<span style="">yTile</span> * TT.<span style="">height</span><br />
&nbsp; &nbsp; TT.<span style="">Walkable</span> = WB<br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">ListAddLast</span><span style=" ">&#40;</span>ALLGameObjList , TT<span style=" ">&#41;</span><br />
</p>
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Function</span></div>
<p>Инициализацию картинки сделаете сами, ведь это не сложно. Так же сами напишите метод рисования тайла на экране ( method Draw() ), никаких сложностей возникнуть не должно. До этого я писал, про тайловые карты с видом сверху, но хочу заметить, что также все это относится и к аркадам, у которых вид сбоку. Таким как Марио, Соник и им подобные. Так вот посмотрите еще раз на рисунок карты: как проще ее хранить? Ну конечно же в массиве. Если перевести нашу карту в массив языка Блиц, то получим что-то наподобие этого:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">Global</span> TileMap:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#91;</span><span style=" ">&#93;</span> =<br />
<p><span style=" ">&#91;</span><span style="color: #FFFFFF;">0</span>, <span style="color: #FFFFFF;">4</span>, <span style="color: #FFFFFF;">0</span>, <span style="color: #FFFFFF;">1</span>, <span style="color: #FFFFFF;">2</span>, <span style="color: #FFFFFF;">0</span>, ..<br />
&nbsp;<span style="color: #FFFFFF;">1</span>, <span style="color: #FFFFFF;">1</span>, <span style="color: #FFFFFF;">1</span>, <span style="color: #FFFFFF;">1</span>, <span style="color: #FFFFFF;">1</span>, <span style="color: #FFFFFF;">1</span>, ..<br />
&nbsp;<span style="color: #FFFFFF;">0</span>, <span style="color: #FFFFFF;">0</span>, <span style="color: #FFFFFF;">2</span>, <span style="color: #FFFFFF;">0</span>, <span style="color: #FFFFFF;">0</span>, <span style="color: #FFFFFF;">0</span>, ..<br />
&nbsp;<span style="color: #FFFFFF;">0</span>, <span style="color: #FFFFFF;">3</span>, <span style="color: #FFFFFF;">0</span>, <span style="color: #FFFFFF;">3</span>, <span style="color: #FFFFFF;">0</span>, <span style="color: #FFFFFF;">0</span>, ..<br />
&nbsp;<span style="color: #FFFFFF;">4</span>, <span style="color: #FFFFFF;">0</span>, <span style="color: #FFFFFF;">0</span>, <span style="color: #FFFFFF;">0</span>, <span style="color: #FFFFFF;">4</span>, <span style="color: #FFFFFF;">0</span>, ..<br />
&nbsp;<span style="color: #FFFFFF;">0</span>, <span style="color: #FFFFFF;">2</span>, <span style="color: #FFFFFF;">0</span>, <span style="color: #FFFFFF;">0</span>, <span style="color: #FFFFFF;">0</span>, <span style="color: #FFFFFF;">4</span>, ..<br />
</p>
&nbsp;<span style="color: #FFFFFF;">0</span>, <span style="color: #FFFFFF;">0</span>, <span style="color: #FFFFFF;">0</span>, <span style="color: #FFFFFF;">4</span>, <span style="color: #FFFFFF;">3</span>, <span style="color: #FFFFFF;">0</span><span style=" ">&#93;</span></div>
<p>Ну, теперь создадим наш главный тип - УРОВЕНЬ! Он будет читать карту из массива, создаст на основе этой карты тайлы и затем уже нарисует нашу тайловую карту!
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">Type</span> TLevel<br />
<p>&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Width&nbsp;: <span style="color: #ffff00; font-weight: bold;">Byte</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Height&nbsp;: <span style="color: #ffff00; font-weight: bold;">Byte</span><br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Map:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#91;</span>,<span style=" ">&#93;</span><br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Function</span> Create:TLevel<span style=" ">&#40;</span>MyMap:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#91;</span><span style=" ">&#93;</span>,map_width:<span style="color: #ffff00; font-weight: bold;">int</span>,map_height:<span style="color: #ffff00; font-weight: bold;">int</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Local</span> TM&nbsp;: TLevel = <span style="color: #ffff00; font-weight: bold;">New</span> TLevel<br />
&nbsp; &nbsp; TM.<span style="">Width</span> &nbsp;= map_width &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #B1E7EB;">' ширина карты в тайлах</span><br />
&nbsp; &nbsp; TM.<span style="">Height</span> = map_height &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #B1E7EB;">' высота карты в тайлах</span><br />
<br />
&nbsp; &nbsp; TM.<span style="">map</span> = <span style="color: #ffff00; font-weight: bold;">New</span> <span style="color: #ffff00; font-weight: bold;">Int</span> <span style=" ">&#91;</span>TM.<span style="">Width</span>, TM.<span style="">Height</span><span style=" ">&#93;</span><br />
&nbsp; &nbsp; TM.<span style="">load</span><span style=" ">&#40;</span>myMap<span style=" ">&#41;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Return</span> TM<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Function</span><br />
</p>
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">type</span></div>
<p>Для карты я специально использовал одномерный массив (TileMap:Int[]), но в типе TLevel этот массив будет переведен в двумерный, я сделал так, а вы делайте, как пожелаете, хоть грузите из файла на диске или прочитайте из DefData, это, опять же, зависит от вашей фантазии. Функция &lt;Create&gt; принимает в параметрах одномерный массив карты и ее размеры - ширину и высоту. Для нашего случая это будет так:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;">MyLevel:TLevel = TLevel.<span style="">Create</span><span style=" ">&#40;</span>TileMap, <span style="color: #FFFFFF;">6</span>, <span style="color: #FFFFFF;">7</span><span style=" ">&#41;</span></div>
<p>Теперь напишем метод load, который грузит нашу карту в двумерный массив Мар , создает нужные тайлы и заносит их в список объектов.
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">Method</span> Load<span style=" ">&#40;</span>arrMap:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#91;</span><span style=" ">&#93;</span><span style=" ">&#41;</span><br />
<p>&nbsp; <span style="color: #ffff00; font-weight: bold;">For</span> <span style="color: #ffff00; font-weight: bold;">Local</span> i:<span style="color: #ffff00; font-weight: bold;">Int</span> = <span style="color: #FFFFFF;">0</span> <span style="color: #ffff00; font-weight: bold;">Until</span> Height<br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">For</span> <span style="color: #ffff00; font-weight: bold;">Local</span> j:<span style="color: #ffff00; font-weight: bold;">Int</span> = <span style="color: #FFFFFF;">0</span> <span style="color: #ffff00; font-weight: bold;">Until</span> Width<br />
&nbsp; &nbsp; &nbsp; Map<span style=" ">&#91;</span>j , i<span style=" ">&#93;</span> = arrMap<span style=" ">&#91;</span>j + <span style=" ">&#40;</span>i * Width<span style=" ">&#41;</span><span style=" ">&#93;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">If</span> Map<span style=" ">&#91;</span>j , i<span style=" ">&#93;</span> &lt; <span style="color: #FFFFFF;">15</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; TTile.<span style="">Create</span><span style=" ">&#40;</span>j , i , <span style="color: #ffff00; font-weight: bold;">true</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Else</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; TTile.<span style="">Create</span><span style=" ">&#40;</span>j , i , <span style="color: #ffff00; font-weight: bold;">false</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">if</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Next</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Next</span><br />
</p>
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span></div>
<p>Что же, ничего хитрого в этой функции тоже нет, мы проходим по всему одномерному массиву и заполняем значениями двумерный массив, а заодно и создаем на этих местах тайлы уже известной нам функцией Create, которую мы писали ранее в типе TTile. Здесь стоит заметить, что я разделил тайлы на две группы: одни проходимы (true), а другие нет (false). Разделение произошло в условном операторе (if): первые тайлы, до 15, все проходимы, а остальные - не проходимы. Думаю, это понятно. Кстати, если вы переписали функцию Create в TTile, чтобы еще и загружалась картинка, то надо переделать и эту функцию, чтобы кол-во параметров совпадало. Например так:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;">TTile.<span style="">Create</span><span style=" ">&#40;</span>j , i , <span style="color: #ffff00; font-weight: bold;">true</span>, tileSet <span style=" ">&#93;</span><span style=" ">&#41;</span></div>
<p>Но это, опять же, зависит от вашего кода и полностью на ваше усмотрение. Ок. Теперь давайте перейдем непосредственно к созданию нашего тайлового уровня. До этого момента мы только создали (инициализировали) наши тайлы и поместили их в отдельный список (лист), теперь их надо нарисовать. Я не буду использовать никакие картинки, я буду использовать простые квадраты рисуемые БлитцМаксом функцией DrawRect (x,y,width,height). А чтобы отличать проходимые тайлы от непроходимых, я сделаю их разноцветными. Вот так: зеленый - проходимые (true), а непроходимые (false) - красный.
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:TileGame1-06.gif" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:TileGame1-06.gif" src="-3_909-6.gif" width="286" height="147" /></a></span></div></div>
<p>Тип TTile остается прежним, просто добавим 2 метода Update и Draw:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">Method</span> Update<span style=" ">&#40;</span><span style=" ">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #B1E7EB;">' здесь установим цвет тайла</span><br />
<p>&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">If</span> Walkable = <span style="color: #ffff00; font-weight: bold;">false</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">SetColor</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">255</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span><span style=" ">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #B1E7EB;">'red</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Else</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">SetColor</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">255</span> , <span style="color: #FFFFFF;">0</span><span style=" ">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #B1E7EB;">'green</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">EndIf</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span><br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> Draw<span style=" ">&#40;</span><span style=" ">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #B1E7EB;">' здесь нарисуем</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">DrawRect</span><span style=" ">&#40;</span>x , y , Width , Height<span style=" ">&#41;</span><br />
</p>
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span></div>
<p>Теперь приступим к самому волнительному моменту: нарисуем уровень, то есть все созданные тайлы, на экране. Для этого в типе TLevel сделаем функцию Render(), которая и нарисует все тайлы.
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">Method</span> Render<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<p>&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">For</span> <span style="color: #ffff00; font-weight: bold;">Local</span> CurTile:TTile = <span style="color: #ffff00; font-weight: bold;">EachIn</span> TileList &nbsp;<span style="color: #B1E7EB;">' пройти по всему листу тайлов</span><br />
&nbsp; &nbsp; &nbsp; CurTile.<span style="">Update</span><span style=" ">&#40;</span><span style=" ">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #B1E7EB;">' установить цвет текущего тайла</span><br />
&nbsp; &nbsp; &nbsp; CurTile.<span style="">Draw</span><span style=" ">&#40;</span><span style=" ">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #B1E7EB;">' нарисовать текущий тайл</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Next</span><br />
</p>
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span></div>
<p>Уровень я рисовал прямо в массиве. Вот он:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">Global</span> LevMap:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#91;</span><span style=" ">&#93;</span> = <span style=" ">&#91;</span><span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span><span style=" ">&#93;</span><br />
<br />
</p>
<span style="color: #ffff00; font-weight: bold;">Global</span> Level&nbsp;: TLevel = <span style="color: #ffff00; font-weight: bold;">New</span> TLevel.<span style="">Create</span><span style=" ">&#40;</span>LevMap , <span style="color: #FFFFFF;">20</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span></div>
<p>А вот главный цикл всей программы:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">Graphics</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">640</span>, <span style="color: #FFFFFF;">480</span><span style=" ">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #B1E7EB;">' установить видеорежим 640х480</span><br />
<p><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Repeat</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #B1E7EB;">' повторять ..</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Cls</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #B1E7EB;">' очистить экран</span><br />
<br />
&nbsp; &nbsp; Level.<span style="">Render</span><span style=" ">&#40;</span><span style=" ">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #B1E7EB;">' рисовать уровень в буфер</span><br />
<br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Flip</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #B1E7EB;">' поместить буфер на экран</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Until</span> <span style="color: #ffff00; font-weight: bold;">KeyDown</span><span style=" ">&#40;</span>KEY_ESCAPE<span style=" ">&#41;</span> <span style="color: #ffff00; font-weight: bold;">Or</span> <span style="color: #ffff00; font-weight: bold;">AppTerminate</span><span style=" ">&#40;</span><span style=" ">&#41;</span> &nbsp;<span style="color: #B1E7EB;">' .. пока не нажат ESC или крестик окна</span><br />
<br />
</p>
<span style="color: #ffff00; font-weight: bold;">End</span></div>
<p>Если у вас не получилось, то вот исходник:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">SuperStrict</span><br />
<p><br />
<span style="color: #ffff00; font-weight: bold;">Global</span> ScrWidth&nbsp;: <span style="color: #ffff00; font-weight: bold;">Int</span> &nbsp;= <span style="color: #FFFFFF;">640</span><br />
<span style="color: #ffff00; font-weight: bold;">Global</span> ScrHeight&nbsp;: <span style="color: #ffff00; font-weight: bold;">Int</span> = <span style="color: #FFFFFF;">480</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Global</span> TileList:<span style="color: #ffff00; font-weight: bold;">TList</span> = <span style="color: #ffff00; font-weight: bold;">CreateList</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Const</span> TILESIZE:<span style="color: #ffff00; font-weight: bold;">Int</span> &nbsp; = <span style="color: #FFFFFF;">32</span> <br />
<br />
<span style="color: #ffff00; font-weight: bold;">Type</span> TTile<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> x:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> y:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> xTile:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> yTile:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Width:<span style="color: #ffff00; font-weight: bold;">Byte</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Height:<span style="color: #ffff00; font-weight: bold;">Byte</span><br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Walkable:<span style="color: #ffff00; font-weight: bold;">Byte</span><br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Function</span> Create<span style=" ">&#40;</span>sx:<span style="color: #ffff00; font-weight: bold;">Int</span>, sy:<span style="color: #ffff00; font-weight: bold;">Int</span>, WB:<span style="color: #ffff00; font-weight: bold;">Byte</span><span style=" ">&#41;</span> <br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Local</span> TT:TTile = <span style="color: #ffff00; font-weight: bold;">New</span> TTile<br />
&nbsp; &nbsp; &nbsp; TT.<span style="">width</span> &nbsp;= TILESIZE<br />
&nbsp; &nbsp; &nbsp; TT.<span style="">height</span> = TILESIZE<br />
&nbsp; &nbsp; &nbsp; TT.<span style="">xTile</span> = sx<br />
&nbsp; &nbsp; &nbsp; TT.<span style="">yTile</span> = sy<br />
&nbsp; &nbsp; &nbsp; TT.<span style="">x</span> = TT.<span style="">xTile</span> * TT.<span style="">width</span><br />
&nbsp; &nbsp; &nbsp; TT.<span style="">y</span> = TT.<span style="">yTile</span> * TT.<span style="">height</span><br />
&nbsp; &nbsp; &nbsp; TT.<span style="">Walkable</span> = WB<br />
<br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">ListAddLast</span><span style=" ">&#40;</span>TileList , TT<span style=" ">&#41;</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Function</span> &nbsp;<br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> update<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">If</span> &nbsp; &nbsp;walkable &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #B1E7EB;">'walkable</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">SetColor</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">255</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span><span style=" ">&#41;</span> &nbsp;<span style="color: #B1E7EB;">'red</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Else</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #B1E7EB;">'NOT walkable</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">SetColor</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">255</span> , <span style="color: #FFFFFF;">0</span><span style=" ">&#41;</span> <span style="color: #B1E7EB;">'green</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">If</span> &nbsp;<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span> &nbsp; &nbsp; &nbsp;<br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> Draw<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">DrawRect</span><span style=" ">&#40;</span>x,y,Width,Height<span style=" ">&#41;</span> &nbsp;<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Type</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Type</span> TLevel<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Width&nbsp;: <span style="color: #ffff00; font-weight: bold;">Byte</span> <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Height&nbsp;: <span style="color: #ffff00; font-weight: bold;">Byte</span><br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Map:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#91;</span>,<span style=" ">&#93;</span><br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Function</span> Create:TLevel<span style=" ">&#40;</span>MyMap:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#91;</span><span style=" ">&#93;</span>,map_width:<span style="color: #ffff00; font-weight: bold;">Int</span>,map_height:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Local</span> TM&nbsp;: TLevel = <span style="color: #ffff00; font-weight: bold;">New</span> TLevel &nbsp;<br />
&nbsp; &nbsp; TM.<span style="">Width</span> &nbsp;= map_width<br />
&nbsp; &nbsp; TM.<span style="">Height</span> = map_height<br />
<br />
&nbsp; &nbsp; TM.<span style="">map</span> = <span style="color: #ffff00; font-weight: bold;">New</span> <span style="color: #ffff00; font-weight: bold;">Int</span> <span style=" ">&#91;</span>TM.<span style="">Width</span>, TM.<span style="">Height</span><span style=" ">&#93;</span><br />
&nbsp; &nbsp; TM.<span style="">load</span><span style=" ">&#40;</span>myMap<span style=" ">&#41;</span><br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Return</span> TM &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Function</span> &nbsp;<br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> Load<span style=" ">&#40;</span>arrMap:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#91;</span><span style=" ">&#93;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">For</span> <span style="color: #ffff00; font-weight: bold;">Local</span> i:<span style="color: #ffff00; font-weight: bold;">Int</span> = <span style="color: #FFFFFF;">0</span> <span style="color: #ffff00; font-weight: bold;">Until</span> Height<br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">For</span> <span style="color: #ffff00; font-weight: bold;">Local</span> j:<span style="color: #ffff00; font-weight: bold;">Int</span> = <span style="color: #FFFFFF;">0</span> <span style="color: #ffff00; font-weight: bold;">Until</span> Width<br />
&nbsp; &nbsp; &nbsp; &nbsp; Map<span style=" ">&#91;</span>j , i<span style=" ">&#93;</span> = arrMap<span style=" ">&#91;</span>j + <span style=" ">&#40;</span>i * Width<span style=" ">&#41;</span><span style=" ">&#93;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">If</span> Map<span style=" ">&#91;</span>j , i<span style=" ">&#93;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;TTile.<span style="">Create</span><span style=" ">&#40;</span>j , i , <span style="color: #ffff00; font-weight: bold;">True</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Else</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;TTile.<span style="">Create</span><span style=" ">&#40;</span>j , i , <span style="color: #ffff00; font-weight: bold;">False</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">If</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Next</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Next</span> &nbsp; &nbsp;<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span> &nbsp;<br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> Render<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">For</span> <span style="color: #ffff00; font-weight: bold;">Local</span> CurTile:TTile = <span style="color: #ffff00; font-weight: bold;">EachIn</span> TileList<br />
&nbsp; &nbsp; &nbsp; CurTile.<span style="">Update</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; CurTile.<span style="">Draw</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Next</span> &nbsp;<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span><br />
&nbsp; <br />
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Type</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Global</span> LevMap:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#91;</span><span style=" ">&#93;</span> = <span style=" ">&#91;</span><span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span><span style=" ">&#93;</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Global</span> MyLevel&nbsp;: TLevel = <span style="color: #ffff00; font-weight: bold;">New</span> TLevel.<span style="">Create</span><span style=" ">&#40;</span>LevMap , <span style="color: #FFFFFF;">20</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Graphics</span><span style=" ">&#40;</span>ScrWidth, ScrHeight<span style=" ">&#41;</span> <br />
<br />
<span style="color: #ffff00; font-weight: bold;">Repeat</span><br />
&nbsp; &nbsp;<span style="color: #ffff00; font-weight: bold;">Cls</span><br />
<br />
&nbsp; &nbsp; MyLevel.<span style="">Render</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp;<span style="color: #ffff00; font-weight: bold;">Flip</span> <br />
<span style="color: #ffff00; font-weight: bold;">Until</span> <span style="color: #ffff00; font-weight: bold;">KeyDown</span><span style=" ">&#40;</span>KEY_ESCAPE<span style=" ">&#41;</span> <span style="color: #ffff00; font-weight: bold;">Or</span> <span style="color: #ffff00; font-weight: bold;">AppTerminate</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
</p>
<span style="color: #ffff00; font-weight: bold;">End</span></div>
<a name=".D0.91.D0.BE.D0.BD.D1.83.D1.81.D1.8B"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A2%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2%D0%B0%D1%8F_%D0%B8%D0%B3%D1%80%D0%B0_%D0%BD%D0%B0_BlitzMax&amp;action=edit&amp;section=3" title="Править секцию: Бонусы">править</a>]</span> <span class="mw-headline">Бонусы</span></h2>
<p>Ладно, худо-бедно, уровень нарисован , но какой-то он однообразный, давайте что-ли добавим сюда еще парочку элементов. Ну какая игра, скажите мне, будет без бонусов? Всевозможных монеток, кристаллов, и т. д. Предлагаю поместить их и на нашем уровне. Для этого напишем еще один тип TBonus
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">Type</span> TBonus<br />
<p>&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> x:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> y:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> width:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> height:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
<br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> points:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> miny:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> maxy:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> diry:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> speed:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> AnimDelay:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
</p>
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">type</span></div>
<p>Вообще-то (у меня) и бонус тоже будет прямоугольником, только желтого цвета (при хорошем воображении можно представить, что это слиток золота). Он меньше, чем тайл, естественно. Его размеры будут: 16х6. И помните - бонус должен находиться только в проходимом тайле, а иначе как его возьмет игрок? Посмотрите повнимательнее на свойства (переменные) нашего нового типа. Первые 4 понятны и так. А про остальные надо рассказать отдельно:
</p>
<ul><li>points - это очки, которые получит игрок при подборе(?) этого бонуса,
</li><li>miny и maxy - наш бонус не просто будет висеть в воздухе, а будет раскачиваться вверх-вниз, т.е . двигаться по оси Y, как это часто бывает в играх. Так вот эти переменные указывают амплитуду раскачивания, смотрите рисунок:
</li></ul>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:TileGame1-07.gif" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:TileGame1-07.gif" src="mo7ktyce.gif" width="290" height="230" /></a></span></div></div>
<ul><li>Diry - это направление движения при раскачивании бонуса &lt;-1&gt; означает, что бонус движется вверх, а &lt;+1&gt; - соответственно, вниз. (При Diry = 0 бонус двигаться не будет.)
</li><li>Speed - скорость, с которой двигается бонус, то есть на сколько пикселей вверх/вниз он переместится.
</li><li>AnimDelay - это задержка, с которой раскачивается бонус. Регулируя эту переменную, можно регулировать скорость раскачивания.
</li></ul>
<p>Да, кстати , не забудем создать список для хранения наших бонусов:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">Global</span> BonusList:<span style="color: #ffff00; font-weight: bold;">TList</span> = <span style="color: #ffff00; font-weight: bold;">CreateList</span><span style=" ">&#40;</span><span style=" ">&#41;</span> &nbsp; &nbsp; &nbsp; <span style="color: #B1E7EB;">' вот так</span></div>
<p>Теперь перейдем непосредственно к функции Create для типа TBonus. Эта функция будет создавать бонус на указанном тайле, и заполнит все поля типа(которые я тока что описал) нужной информацией, надо только указать координаты на тайловой карте и очки за этот бонус:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">Function</span> Create<span style=" ">&#40;</span>sx:<span style="color: #ffff00; font-weight: bold;">Int</span>,sy:<span style="color: #ffff00; font-weight: bold;">Int</span>,pts:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#41;</span><br />
<p>&nbsp; <span style="color: #ffff00; font-weight: bold;">Local</span> TB&nbsp;: TBonus = <span style="color: #ffff00; font-weight: bold;">New</span> TBonus<br />
&nbsp; &nbsp; TB.<span style="">Width</span> = <span style="color: #FFFFFF;">6</span><br />
&nbsp; &nbsp; TB.<span style="">Height</span> = <span style="color: #FFFFFF;">16</span><br />
&nbsp; &nbsp; TB.<span style="">x</span> = sx * TILESIZE + <span style=" ">&#40;</span><span style=" ">&#40;</span>TILESIZE - TB.<span style="">width</span><span style=" ">&#41;</span> / <span style="color: #FFFFFF;">2</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; TB.<span style="">y</span> = sy * TILESIZE + <span style=" ">&#40;</span><span style=" ">&#40;</span>TILESIZE - TB.<span style="">height</span><span style=" ">&#41;</span> / <span style="color: #FFFFFF;">2</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; TB.<span style="">points</span> = pts<br />
&nbsp; &nbsp; TB.<span style="">miny</span> = TB.<span style="">y</span> - <span style="color: #FFFFFF;">4</span><br />
&nbsp; &nbsp; TB.<span style="">maxy</span> = TB.<span style="">y</span> + TB.<span style="">Height</span> + <span style="color: #FFFFFF;">4</span><br />
&nbsp; &nbsp; TB.<span style="">speed</span> = <span style="color: #FFFFFF;">1</span><br />
&nbsp; &nbsp; TB.<span style="">diry</span> = <span style="color: #FFFFFF;">-1</span><br />
&nbsp; &nbsp; TB.<span style="">AnimDelay</span> = <span style="color: #FFFFFF;">5</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">ListAddLast</span><span style=" ">&#40;</span>BonusList ,TB<span style=" ">&#41;</span><br />
</p>
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Function</span></div>
<p>Вот картинка, которая поможет вам в понимании вышеизложенной функции:
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:TileGame1-08.gif" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:TileGame1-08.gif" src="r8pn83c_.gif" width="290" height="230" /></a></span></div></div>
<p>Из кода и приведенной картинки все становится очевидным и доходчивым, переводим тайловые координаты в экранные, помещаем бонус в центре тайла и раскачиваем его на 4 пикселя вверх и 4 пикселя вниз, скорость (speed) = 1, начальное направление  вверх (diry = -1). Да, чуть не забыл, при достижении бонусом miny или maxy, мы должны поменять направление раскачивания, учтем это при написании нашего кода. А вот и он:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">Method</span> Update<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<p>&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">If</span><span style=" ">&#40;</span>Animdelay &lt; <span style="color: #FFFFFF;">0</span><span style=" ">&#41;</span><br />
<br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">If</span> <span style=" ">&#40;</span> miny &gt; <span style=" ">&#40;</span>y<span style=" ">&#41;</span> <span style="color: #ffff00; font-weight: bold;">Or</span> maxy &lt; <span style=" ">&#40;</span>y + height - <span style="color: #FFFFFF;">1</span><span style=" ">&#41;</span> <span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; diry = -diry<br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">If</span><br />
<br />
&nbsp; &nbsp; &nbsp; y = y + speed * diry<br />
<br />
&nbsp; &nbsp; &nbsp; AnimDelay = <span style="color: #FFFFFF;">5</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">If</span><br />
<br />
&nbsp; &nbsp; AnimDelay&nbsp;:- <span style="color: #FFFFFF;">1</span><br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span><br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> Draw<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">SetColor</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">255</span> , <span style="color: #FFFFFF;">255</span> , <span style="color: #FFFFFF;">0</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">DrawRect</span><span style=" ">&#40;</span>x,y,Width,Height<span style=" ">&#41;</span><br />
</p>
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span></div>
<p>В методе &lt;Draw&gt; ничего примечательного нет. Там устанавливается желтый цвет и рисуется прямоугольник, то есть наш воображаемый бонус. А метод &lt;Update&gt; рассмотрим поподробнее. Здесь как раз и будет происходить раскачивание бонуса , а точнее в строке
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;">y = y + speed * diry</div>
<p>новое положение по оси &lt;у&gt; вычисляется как прибавление к старому значению и скорости (speed) домноженной на направление (diry), как я говорил раньше, diry может принимать только 2 значения - &lt;-1&gt; и &lt;+1&gt;, а потому произведение &lt;speed * diry&gt; дает разные ПО ЗНАКУ значения speed, что в свою очередь влияет на то, будет ли скорость вычитаться  или прибавляться к текущей координате. Например: текущая позиция по y = 5, направление - вверх , то есть diry = -1 и скорость (speed) =1, тогда новое значение у:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;">y = <span style="color: #FFFFFF;">5</span> + <span style="color: #FFFFFF;">1</span> * <span style=" ">&#40;</span><span style="color: #FFFFFF;">-1</span><span style=" ">&#41;</span> = <span style="color: #FFFFFF;">5</span> - <span style="color: #FFFFFF;">1</span> = <span style="color: #FFFFFF;">4</span></div>
<p>если diry = +1 ,то есть направление вниз:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;">y = <span style="color: #FFFFFF;">5</span> + <span style="color: #FFFFFF;">1</span> * <span style="color: #FFFFFF;">1</span> = <span style="color: #FFFFFF;">5</span> + <span style="color: #FFFFFF;">1</span> = <span style="color: #FFFFFF;">6</span></div>
<p>вот так diry влияет на вычисление новой позиции нашего бонуса. Нет, мы ,конечно, могли бы сделать и так: если двигаемся вверх, то вычитать скорость, а если вниз ,то прибавлять.
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">If</span> diry = <span style="color: #FFFFFF;">1</span><br />
<p>&nbsp; y = y + speed<br />
<span style="color: #ffff00; font-weight: bold;">else</span> <span style="color: #ffff00; font-weight: bold;">if</span> diry = <span style="color: #FFFFFF;">-1</span><br />
&nbsp; y = y - speed<br />
</p>
<span style="color: #ffff00; font-weight: bold;">end</span> <span style="color: #ffff00; font-weight: bold;">if</span></div>
<p>Но этот способ мне кажется более громоздким, по сравнению с изяществом первого. Впрочем, вы можете использовать любой. Теперь надо ограничить наши движения maxy и miny. Первое что приходит в голову это сделать так:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">If</span> <span style=" ">&#40;</span>y =&lt; miny<span style=" ">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #B1E7EB;">' если достигли верха</span><br />
<p>&nbsp; &nbsp; diry = <span style="color: #FFFFFF;">1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #B1E7EB;">' направить вниз</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">end</span> <span style="color: #ffff00; font-weight: bold;">if</span><br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">if</span> <span style=" ">&#40;</span>y + height &gt;= maxy<span style=" ">&#41;</span> &nbsp; &nbsp; <span style="color: #B1E7EB;">' если достигли низа</span><br />
&nbsp; &nbsp; diry = <span style="color: #FFFFFF;">-1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #B1E7EB;">' направить вверх</span><br />
</p>
&nbsp; <span style="color: #ffff00; font-weight: bold;">end</span> <span style="color: #ffff00; font-weight: bold;">if</span></div>
<p>Но я сделаю чуть иначе:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">If</span> <span style=" ">&#40;</span> miny &gt;= <span style=" ">&#40;</span>y<span style=" ">&#41;</span> <span style="color: #ffff00; font-weight: bold;">Or</span> maxy =&lt; <span style=" ">&#40;</span>y + height<span style=" ">&#41;</span> <span style=" ">&#41;</span><br />
<p>&nbsp; &nbsp; diry = -diry<br />
</p>
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">If</span></div>
<p>Строка diry = -diry означает изменить знак diry, то есть если diry был -1, то -(-1) = +1, а если diry = +1 ,то -(+1) = -1. Говоря по-другому ,что важно для нас - эта строка, меняет направление движения на противоположное.
</p><p>Я привел оба эти варианта для того ,чтобы показать, что одну задачу можно решить двумя разными способами, тремя и даже больше. Так что не бывает правильного и не правильного кода, хорошего или плохого. Бывает код ,который работает, то есть выполняет свою прямую задачу, и код ,который не работает! Главное ,чтобы вы сами понимали, то что пишете. А уж потом, когда заматереете в программинге, можно модернизировать и оптимизировать свой код.
</p><p>Вот в общем-то и всё. А нет, не всё! У нас ведь еще введена задержка анимации (AnimDelay). Не каждый вызов метода Update() приводит к перемещению нашего бонуса, а лишь тот, когда AnimDelay &lt; 0 . Ну а если больше нуля, то от задержки отнимается единица, через пять циклов условие соблюдается и движение бонуса происходит. Нехитрый способ задержки, думаю вы его переделаете со временем. Итак, у нас есть функция создания бонусов (Create), метод качания (Update) и метод рисования (Draw). Так чего же мы ждем? Давайте разместим наши бонусы на карте и нарисуем их!
</p><p>Для инициализации их на карте я создал отдельную функцию:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">Function</span> Init_All_Bonuses<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<p>&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">15</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">100</span><span style=" ">&#41;</span><br />
&nbsp; Tbonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">7</span> , <span style="color: #FFFFFF;">4</span> , <span style="color: #FFFFFF;">100</span><span style=" ">&#41;</span><br />
&nbsp; Tbonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">25</span><span style=" ">&#41;</span><br />
&nbsp; Tbonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">3</span> , <span style="color: #FFFFFF;">8</span> , <span style="color: #FFFFFF;">25</span><span style=" ">&#41;</span><br />
&nbsp; Tbonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">4</span> , <span style="color: #FFFFFF;">8</span> , <span style="color: #FFFFFF;">25</span><span style=" ">&#41;</span><br />
&nbsp; Tbonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">5</span> , <span style="color: #FFFFFF;">8</span> , <span style="color: #FFFFFF;">25</span><span style=" ">&#41;</span><br />
&nbsp; Tbonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">9</span> , <span style="color: #FFFFFF;">7</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span><br />
&nbsp; Tbonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">4</span> , <span style="color: #FFFFFF;">6</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span><br />
&nbsp; Tbonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">9</span> , <span style="color: #FFFFFF;">2</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span><br />
&nbsp; Tbonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">14</span> , <span style="color: #FFFFFF;">7</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span><br />
&nbsp; Tbonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">17</span> , <span style="color: #FFFFFF;">6</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span><br />
&nbsp; Tbonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">17</span> , <span style="color: #FFFFFF;">4</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span><br />
&nbsp; Tbonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">18</span> , <span style="color: #FFFFFF;">4</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span><br />
&nbsp; Tbonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">3</span> , <span style="color: #FFFFFF;">3</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span><br />
</p>
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Function</span></div>
<p>Здесь 14 бонусов, 2 по 100 очков, 4 по 25 и остальные по 10 очков. Ну теперь осталось отобразить их все на экране. Вы тоже можете создать для этого отдельную функцию, ну а я решил впихнуть всё это в Tlevel.Render(), сразу после рисования тайлов:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">For</span> <span style="color: #ffff00; font-weight: bold;">Local</span> CurBonus:Tbonus= <span style="color: #ffff00; font-weight: bold;">EachIn</span> BonusList<br />
<p>&nbsp; CurBonus.<span style="">Update</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; CurBonus.<span style="">Draw</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
</p>
<span style="color: #ffff00; font-weight: bold;">Next</span></div>
<p>Запускаем и любуемся. Если не получилось, смотрите исходник:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">SuperStrict</span><br />
<p><br />
<span style="color: #ffff00; font-weight: bold;">Global</span> ScrWidth&nbsp;: <span style="color: #ffff00; font-weight: bold;">Int</span> &nbsp;= <span style="color: #FFFFFF;">640</span><br />
<span style="color: #ffff00; font-weight: bold;">Global</span> ScrHeight&nbsp;: <span style="color: #ffff00; font-weight: bold;">Int</span> = <span style="color: #FFFFFF;">480</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Global</span> TileList:<span style="color: #ffff00; font-weight: bold;">TList</span> = <span style="color: #ffff00; font-weight: bold;">CreateList</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #ffff00; font-weight: bold;">Global</span> BonusList:<span style="color: #ffff00; font-weight: bold;">TList</span> = <span style="color: #ffff00; font-weight: bold;">CreateList</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Const</span> TILESIZE:<span style="color: #ffff00; font-weight: bold;">Int</span> &nbsp; = <span style="color: #FFFFFF;">32</span> <br />
<br />
<span style="color: #ffff00; font-weight: bold;">Type</span> TTile<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> x:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> y:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> xTBle:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> yTBle:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Width:<span style="color: #ffff00; font-weight: bold;">Byte</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Height:<span style="color: #ffff00; font-weight: bold;">Byte</span><br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Walkable:<span style="color: #ffff00; font-weight: bold;">Byte</span><br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Function</span> Create<span style=" ">&#40;</span>sx:<span style="color: #ffff00; font-weight: bold;">Int</span>, sy:<span style="color: #ffff00; font-weight: bold;">Int</span>, WB:<span style="color: #ffff00; font-weight: bold;">Byte</span><span style=" ">&#41;</span> <br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Local</span> TT:TTile = <span style="color: #ffff00; font-weight: bold;">New</span> TTile<br />
&nbsp; &nbsp; &nbsp; TT.<span style="">width</span> &nbsp;= TiLESIZE &nbsp; &nbsp;<br />
&nbsp; &nbsp; &nbsp; TT.<span style="">height</span> = TiLESIZE &nbsp; &nbsp;<br />
&nbsp; &nbsp; &nbsp; TT.<span style="">xTBle</span> = sx &nbsp; &nbsp; &nbsp; <br />
&nbsp; &nbsp; &nbsp; TT.<span style="">yTBle</span> = sy &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp; &nbsp; &nbsp; TT.<span style="">x</span> = TT.<span style="">xTBle</span> * TT.<span style="">width</span> &nbsp; &nbsp;<br />
&nbsp; &nbsp; &nbsp; TT.<span style="">y</span> = TT.<span style="">yTBle</span> * TT.<span style="">height</span> &nbsp; <br />
&nbsp; &nbsp; &nbsp; TT.<span style="">Walkable</span> = WB &nbsp; &nbsp; &nbsp; &nbsp;<br />
<br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">ListAddLast</span><span style=" ">&#40;</span>TileList , TT<span style=" ">&#41;</span> &nbsp;<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Function</span> &nbsp;<br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> update<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">If</span> &nbsp; &nbsp;walkable &nbsp; &nbsp; &nbsp; <span style="color: #B1E7EB;">'walkable</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">SetColor</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">255</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span><span style=" ">&#41;</span> &nbsp;<span style="color: #B1E7EB;">'red</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Else</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #B1E7EB;">'NOT walkable</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">SetColor</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">255</span> , <span style="color: #FFFFFF;">0</span><span style=" ">&#41;</span> &nbsp; <span style="color: #B1E7EB;">'green</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">If</span> &nbsp;<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span> &nbsp; &nbsp; &nbsp;<br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> Draw<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">DrawRect</span><span style=" ">&#40;</span>x,y,Width,Height<span style=" ">&#41;</span> &nbsp;<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Type</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Type</span> TLevel<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Width&nbsp;: <span style="color: #ffff00; font-weight: bold;">Byte</span> <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Height&nbsp;: <span style="color: #ffff00; font-weight: bold;">Byte</span><br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Map:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#91;</span>,<span style=" ">&#93;</span><br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Function</span> Create:TLevel<span style=" ">&#40;</span>MyMap:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#91;</span><span style=" ">&#93;</span>,map_width:<span style="color: #ffff00; font-weight: bold;">Int</span>,map_height:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Local</span> TM&nbsp;: TLevel = <span style="color: #ffff00; font-weight: bold;">New</span> TLevel &nbsp;<br />
&nbsp; &nbsp; TM.<span style="">Width</span> &nbsp;= map_width<br />
&nbsp; &nbsp; TM.<span style="">Height</span> = map_height<br />
<br />
&nbsp; &nbsp; TM.<span style="">map</span> = <span style="color: #ffff00; font-weight: bold;">New</span> <span style="color: #ffff00; font-weight: bold;">Int</span> <span style=" ">&#91;</span>TM.<span style="">Width</span>, TM.<span style="">Height</span><span style=" ">&#93;</span><br />
&nbsp; &nbsp; TM.<span style="">load</span><span style=" ">&#40;</span>myMap<span style=" ">&#41;</span><br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Return</span> TM &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Function</span> &nbsp;<br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> Load<span style=" ">&#40;</span>arrMap:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#91;</span><span style=" ">&#93;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">For</span> <span style="color: #ffff00; font-weight: bold;">Local</span> i:<span style="color: #ffff00; font-weight: bold;">Int</span> = <span style="color: #FFFFFF;">0</span> <span style="color: #ffff00; font-weight: bold;">Until</span> Height<br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">For</span> <span style="color: #ffff00; font-weight: bold;">Local</span> j:<span style="color: #ffff00; font-weight: bold;">Int</span> = <span style="color: #FFFFFF;">0</span> <span style="color: #ffff00; font-weight: bold;">Until</span> Width<br />
&nbsp; &nbsp; &nbsp; &nbsp; Map<span style=" ">&#91;</span>j , i<span style=" ">&#93;</span> = arrMap<span style=" ">&#91;</span>j + <span style=" ">&#40;</span>i * Width<span style=" ">&#41;</span><span style=" ">&#93;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">If</span> Map<span style=" ">&#91;</span>j , i<span style=" ">&#93;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;TTile.<span style="">Create</span><span style=" ">&#40;</span>j , i , <span style="color: #ffff00; font-weight: bold;">True</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Else</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;TTile.<span style="">Create</span><span style=" ">&#40;</span>j , i , <span style="color: #ffff00; font-weight: bold;">False</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">If</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Next</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Next</span> &nbsp; &nbsp;<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span> &nbsp;<br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> Render<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">For</span> <span style="color: #ffff00; font-weight: bold;">Local</span> CurTile:TTile = <span style="color: #ffff00; font-weight: bold;">EachIn</span> TileList<br />
&nbsp; &nbsp; &nbsp; CurTile.<span style="">Update</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; CurTile.<span style="">Draw</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Next</span> &nbsp;<br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">For</span> <span style="color: #ffff00; font-weight: bold;">Local</span> CurBonus:TBonus= <span style="color: #ffff00; font-weight: bold;">EachIn</span> BonusList<br />
&nbsp; &nbsp; &nbsp; CurBonus.<span style="">Update</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; CurBonus.<span style="">Draw</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Next</span> &nbsp; &nbsp; &nbsp;<br />
&nbsp; &nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span><br />
&nbsp; <br />
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Type</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Type</span> TBonus <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> x:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> y:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> width:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> height:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> points:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> miny:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> maxy:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> diry:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> speed:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> AnimDelay:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Function</span> Create<span style=" ">&#40;</span>sx:<span style="color: #ffff00; font-weight: bold;">Int</span>,sy:<span style="color: #ffff00; font-weight: bold;">Int</span>,pts:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Local</span> TB&nbsp;: TBonus = <span style="color: #ffff00; font-weight: bold;">New</span> TBonus<br />
&nbsp; &nbsp; &nbsp; TB.<span style="">Width</span> = <span style="color: #FFFFFF;">6</span><br />
&nbsp; &nbsp; &nbsp; TB.<span style="">Height</span> = <span style="color: #FFFFFF;">16</span><br />
&nbsp; &nbsp; &nbsp; TB.<span style="">x</span> = sx * TiLESIZE + <span style=" ">&#40;</span><span style=" ">&#40;</span>TiLESIZE - TB.<span style="">width</span><span style=" ">&#41;</span> / <span style="color: #FFFFFF;">2</span><span style=" ">&#41;</span> &nbsp;<span style="color: #B1E7EB;">'center it</span><br />
&nbsp; &nbsp; &nbsp; TB.<span style="">y</span> = sy * TiLESIZE + <span style=" ">&#40;</span><span style=" ">&#40;</span>TiLESIZE - TB.<span style="">height</span><span style=" ">&#41;</span> / <span style="color: #FFFFFF;">2</span><span style=" ">&#41;</span> <span style="color: #B1E7EB;">'center it</span><br />
&nbsp; &nbsp; &nbsp; TB.<span style="">points</span> = pts<br />
&nbsp; &nbsp; &nbsp; TB.<span style="">miny</span> = TB.<span style="">y</span> - <span style="color: #FFFFFF;">4</span><br />
&nbsp; &nbsp; &nbsp; TB.<span style="">maxy</span> = TB.<span style="">y</span> + TB.<span style="">Height</span> + <span style="color: #FFFFFF;">4</span><br />
&nbsp; &nbsp; &nbsp; TB.<span style="">diry</span> = <span style="color: #FFFFFF;">-1</span><br />
&nbsp; &nbsp; &nbsp; TB.<span style="">speed</span> = <span style="color: #FFFFFF;">1</span><br />
&nbsp; &nbsp; &nbsp; TB.<span style="">AnimDelay</span> = <span style="color: #FFFFFF;">5</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">ListAddLast</span><span style=" ">&#40;</span>BonusList ,TB<span style=" ">&#41;</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Function</span> &nbsp;<br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> Update<span style=" ">&#40;</span><span style=" ">&#41;</span> <br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">If</span><span style=" ">&#40;</span>Animdelay &lt; <span style="color: #FFFFFF;">0</span><span style=" ">&#41;</span><br />
<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #ffff00; font-weight: bold;">If</span> <span style=" ">&#40;</span> miny &gt; <span style=" ">&#40;</span>y<span style=" ">&#41;</span> <span style="color: #ffff00; font-weight: bold;">Or</span> maxy &lt; <span style=" ">&#40;</span>y + height - <span style="color: #FFFFFF;">1</span><span style=" ">&#41;</span> <span style=" ">&#41;</span> <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;diry = -diry<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">If</span><br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;y = y + speed * diry<br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;AnimDelay = <span style="color: #FFFFFF;">5</span><br />
<br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">If</span> &nbsp;<br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp; AnimDelay&nbsp;:- <span style="color: #FFFFFF;">1</span><br />
&nbsp; &nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span><br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> Draw<span style=" ">&#40;</span><span style=" ">&#41;</span> <br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">SetColor</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">255</span> , <span style="color: #FFFFFF;">255</span> , <span style="color: #FFFFFF;">0</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">DrawRect</span><span style=" ">&#40;</span>x,y,Width,Height<span style=" ">&#41;</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span> &nbsp;<br />
&nbsp; <br />
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Type</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Global</span> LevMap:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#91;</span><span style=" ">&#93;</span> = <span style=" ">&#91;</span><span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span><span style=" ">&#93;</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Global</span> MyLevel&nbsp;: TLevel = <span style="color: #ffff00; font-weight: bold;">New</span> TLevel.<span style="">Create</span><span style=" ">&#40;</span>LevMap , <span style="color: #FFFFFF;">20</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Function</span> Init_All_Bonuses<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">25</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">3</span> , <span style="color: #FFFFFF;">8</span> , <span style="color: #FFFFFF;">25</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">4</span> , <span style="color: #FFFFFF;">8</span> , <span style="color: #FFFFFF;">25</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">5</span> , <span style="color: #FFFFFF;">8</span> , <span style="color: #FFFFFF;">25</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">15</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">100</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">7</span> , <span style="color: #FFFFFF;">4</span> , <span style="color: #FFFFFF;">100</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">9</span> , <span style="color: #FFFFFF;">7</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">4</span> , <span style="color: #FFFFFF;">6</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">9</span> , <span style="color: #FFFFFF;">2</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">14</span> , <span style="color: #FFFFFF;">7</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">17</span> , <span style="color: #FFFFFF;">6</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">17</span> , <span style="color: #FFFFFF;">4</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">18</span> , <span style="color: #FFFFFF;">4</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">3</span> , <span style="color: #FFFFFF;">3</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span> <br />
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Function</span> &nbsp;<br />
<br />
<span style="color: #B1E7EB;">'----------------------------- main loop -----------------------------</span><br />
<span style="color: #ffff00; font-weight: bold;">Graphics</span><span style=" ">&#40;</span>ScrWidth, ScrHeight<span style=" ">&#41;</span> <br />
<br />
Init_All_Bonuses<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Repeat</span><br />
&nbsp; &nbsp;<span style="color: #ffff00; font-weight: bold;">Cls</span><br />
<br />
&nbsp; &nbsp; MyLevel.<span style="">Render</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp;<span style="color: #ffff00; font-weight: bold;">Flip</span> <br />
<span style="color: #ffff00; font-weight: bold;">Until</span> <span style="color: #ffff00; font-weight: bold;">KeyDown</span><span style=" ">&#40;</span>KEY_ESCAPE<span style=" ">&#41;</span> <span style="color: #ffff00; font-weight: bold;">Or</span> <span style="color: #ffff00; font-weight: bold;">AppTerminate</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
</p>
<span style="color: #ffff00; font-weight: bold;">End</span></div>
<a name=".D0.94.D0.B2.D0.B8.D0.B6.D0.B5.D0.BD.D0.B8.D0.B5"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A2%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2%D0%B0%D1%8F_%D0%B8%D0%B3%D1%80%D0%B0_%D0%BD%D0%B0_BlitzMax&amp;action=edit&amp;section=4" title="Править секцию: Движение">править</a>]</span> <span class="mw-headline">Движение</span></h2>
<p>Долго смотрел на эти бонусы, летающие вверх  вниз и чуть не загипнотизировался. Скукота. Надо бы еще что-нибудь сделать. Без чего там еще аркад не бывает? Я бы добавил в игру еще платформы, на которые игрок может запрыгнуть и проехать. Это неотъемлемая часть любой аркады. Стоп. Сначала давайте определимся с терминами. Объект ,который может двигаться вверх/вниз (ось у) я буду называть ЛИФТ, а объект , который двигается влево / вправо (ось х) - ПЛАТФОРМА. Ок, для начала я предлагаю создать платформу. Что нам для этого нужно. Надо указать ее начальное расположение, указать конечные точки пути и направление.
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:TileGame1-09.gif" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:TileGame1-09.gif" src="u2uwne-9.gif" width="307" height="264" /></a></span></div></div>
<p>Я тут изобразил кусочек тайловой карты размером 6х4. А серенький квадрат с белой линией вверху- это платформа. Как вы видите, ее начальные координаты (2,2) и по моей задумке, она должна двигаться влево до (0,2) и вправо до (5,2), красные стрелочки. Или если сказать иначе, то на две клетки влево и на три клетки вправо, от своей начальной позиции. Если принять начальную позицию за ноль(смотрим на цифры снизу), то 2 тайла влево соответствуют &lt;-2&gt;, а 3 вправо - соответствуют &lt;+3&gt;. Мне кажется более удачным задавать перемещение именно так, в относительных координатах, нежели в координатах карты. Договорились? Ок, договорились. Кто не согласен - пишет свой код, кто согласен - читает дальше. Создадим новый тип TmovingX&nbsp;:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">Type</span> TmovingX<br />
<p>&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> x:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> y:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> width:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> height:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> speed:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> dirx:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> mindir:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> maxdir:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
</p>
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">type</span></div>
<p>Так , первые 4 поля нам знакомы, мы все про них знаем.
</p>
<ul><li>Speed - ну это понятно, скорость. То есть на сколько пикселей двигать платформу при передвижении.
</li><li>Dirx - тут как в бонусах, направление движения: dirx = -1, это влево , а dirx = 1 это вправо.
</li><li>Mindir и maxdir - ну это и так понятно
</li></ul>
<p>Забыл добавить: платформа движется только по оси х, тогда y-координату вообще можем отбросить, учтем ее только при задании начальных координат для создания платформы. Кстати, вот так бы выглядела функция создания (Create) для платформы, которая на рисунке выше:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;">TmovingX.<span style="">Create</span><span style=" ">&#40;</span> <span style="color: #FFFFFF;">2</span> , <span style="color: #FFFFFF;">2</span> , <span style="color: #FFFFFF;">-2</span> , <span style="color: #FFFFFF;">3</span> , <span style="color: #FFFFFF;">-1</span><span style=" ">&#41;</span></div>
<p>Как вы наверное догадались, первые два параметра - тайловые координаты платформы на карте, затем - на сколько клеток она может перемещаться влево, следующий параметр -  на сколько тайлов вправо, и последний параметр - начальное направление (влево). Вот сама  функция&nbsp;:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">Function</span> Create<span style=" ">&#40;</span>xt:<span style="color: #ffff00; font-weight: bold;">Int</span> , yt:<span style="color: #ffff00; font-weight: bold;">Int</span> , mn:<span style="color: #ffff00; font-weight: bold;">Int</span> , mx:<span style="color: #ffff00; font-weight: bold;">Int</span>, d:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#41;</span><br />
<p>&nbsp; <span style="color: #ffff00; font-weight: bold;">Local</span> TMX:TmovingX = <span style="color: #ffff00; font-weight: bold;">New</span> TmovingX<br />
<br />
&nbsp; TMX.<span style="">x</span> = xt * TILESIZE<br />
&nbsp; TMX.<span style="">y</span> = yt * TILESIZE<br />
<br />
&nbsp; TMX.<span style="">width</span> = TILESIZE<br />
&nbsp; TMX.<span style="">height</span> = TILESIZE<br />
<br />
&nbsp; TMX.<span style="">speed</span> = <span style="color: #FFFFFF;">1</span><br />
<br />
&nbsp; TMX.<span style="">dirx</span> = d<br />
<br />
&nbsp; TMX.<span style="">mindir</span> = <span style=" ">&#40;</span>mn + xt<span style=" ">&#41;</span> * TILESIZE<br />
&nbsp; TMX.<span style="">maxdir</span> = <span style=" ">&#40;</span>mx + xt + <span style="color: #FFFFFF;">1</span><span style=" ">&#41;</span> * TILESIZE<br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">ListAddLast</span><span style=" ">&#40;</span>MovingXList , TMX<span style=" ">&#41;</span><br />
</p>
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Function</span></div>
<p>Да , проницательные мои, вы сразу заметили ,что я еще не объявил список для хранения всех платформ. Устраняю упущение:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">Global</span> MovingXList:<span style="color: #ffff00; font-weight: bold;">Tlist</span> = <span style="color: #ffff00; font-weight: bold;">CreateList</span><span style=" ">&#40;</span><span style=" ">&#41;</span> <span style="color: #B1E7EB;">'напишите это сверху, то есть до объявления типа</span></div>
<p>Ну теперь порядок.
</p><p>Метод рисования платформы. Засуну все свои художественные замыслы куда-нибудь поглубже, и сделаю платформу все тем же прямоугольником, но теперь уже серого цвета и с белою полоской сверху.
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">Method</span> Draw<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<p>&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">SetColor</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">128</span> , <span style="color: #FFFFFF;">128</span> , <span style="color: #FFFFFF;">128</span><span style=" ">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #B1E7EB;">' установить серый цвет</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">DrawRect</span><span style=" ">&#40;</span>x , y , Width , Height<span style=" ">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #B1E7EB;">' нарисовать платформу</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">SetColor</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">255</span> , <span style="color: #FFFFFF;">255</span> , <span style="color: #FFFFFF;">255</span><span style=" ">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #B1E7EB;">' установить белый цвет</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">DrawLine</span><span style=" ">&#40;</span>x , y , x + width - <span style="color: #FFFFFF;">1</span> , y<span style=" ">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #B1E7EB;">' нарисовать линию сверху</span><br />
</p>
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span></div>
<p>Ну, это было для вас не сложно, ведь правда? А вот и функция перемещения нашей платформы, на нее поглядите внимательнее:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">Method</span> Update<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<p><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">If</span><span style=" ">&#40;</span> mindir &gt;= x <span style="color: #ffff00; font-weight: bold;">Or</span> maxdir &lt;= <span style=" ">&#40;</span>x + width<span style=" ">&#41;</span> <span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; dirx = - dirx<br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">EndIf</span><br />
<br />
&nbsp; &nbsp; x = x + speed * dirx<br />
<br />
</p>
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">method</span></div>
<p>Не находите ничего знакомого? Бааа, да это ж брат или точнее сестра Tbonus.Update() только там было перемещение вверх / вниз и внутри тайла, а здесь наша платформа перемещается на бОльшие расстояния и вправо/влево. Но код остался на 90% таким же. Только у поменялся на х. Разве не здорово? Лишь нет задержки анимации (AnimDelay), я решил , что здесь она ни к чему. Но вы можете добавить сюда и этот параметр.
</p><p>Итак нам осталось создать где-нибудь нашу платформу и нарисовать ее на экране. Предлагаю сделать так:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;">TmovingX.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">13</span> , <span style="color: #FFFFFF;">3</span> , - <span style="color: #FFFFFF;">2</span> , <span style="color: #FFFFFF;">5</span> , <span style="color: #FFFFFF;">1</span><span style=" ">&#41;</span></div>
<p>Рисуем как обычно, проходим по всему списку, перемещаем и отображаем каждую платформу.
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">For</span> <span style="color: #ffff00; font-weight: bold;">Local</span> CurMovingX:TmovingX = <span style="color: #ffff00; font-weight: bold;">EachIn</span> MovingXList<br />
<p>&nbsp; &nbsp; CurMovingX.<span style="">Update</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; CurMovingX.<span style="">Draw</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
</p>
&nbsp; <span style="color: #ffff00; font-weight: bold;">Next</span></div>
<p>Вы можете создать для этого отдельную функцию и назвать ее, например, Draw_All_Platforms(), а мне что-то неохота, и потому я опять пихну все в Tlevel.Render(), пусть рисуются  в одном месте тайлы, бонусы и платформы. Зато главный цикл будет поменьше. Вот исходник:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">SuperStrict</span><br />
<p><br />
<span style="color: #ffff00; font-weight: bold;">Global</span> ScrWidth&nbsp;: <span style="color: #ffff00; font-weight: bold;">Int</span> &nbsp;= <span style="color: #FFFFFF;">640</span><br />
<span style="color: #ffff00; font-weight: bold;">Global</span> ScrHeight&nbsp;: <span style="color: #ffff00; font-weight: bold;">Int</span> = <span style="color: #FFFFFF;">480</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Global</span> TileList:<span style="color: #ffff00; font-weight: bold;">TList</span> = <span style="color: #ffff00; font-weight: bold;">CreateList</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #ffff00; font-weight: bold;">Global</span> BonusList:<span style="color: #ffff00; font-weight: bold;">TList</span> = <span style="color: #ffff00; font-weight: bold;">CreateList</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #ffff00; font-weight: bold;">Global</span> MovingXList:<span style="color: #ffff00; font-weight: bold;">TList</span> = <span style="color: #ffff00; font-weight: bold;">CreateList</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Const</span> TILESIZE:<span style="color: #ffff00; font-weight: bold;">Int</span> &nbsp; = <span style="color: #FFFFFF;">32</span> <br />
<br />
<span style="color: #ffff00; font-weight: bold;">Type</span> TTile<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> x:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> y:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> xTile:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> yTile:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Width:<span style="color: #ffff00; font-weight: bold;">Byte</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Height:<span style="color: #ffff00; font-weight: bold;">Byte</span><br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Walkable:<span style="color: #ffff00; font-weight: bold;">Byte</span><br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Function</span> Create<span style=" ">&#40;</span>sx:<span style="color: #ffff00; font-weight: bold;">Int</span>, sy:<span style="color: #ffff00; font-weight: bold;">Int</span>, WB:<span style="color: #ffff00; font-weight: bold;">Byte</span><span style=" ">&#41;</span> <br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Local</span> TT:TTile = <span style="color: #ffff00; font-weight: bold;">New</span> TTile<br />
&nbsp; &nbsp; &nbsp; TT.<span style="">width</span> &nbsp;= TiLESIZE &nbsp; &nbsp;<br />
&nbsp; &nbsp; &nbsp; TT.<span style="">height</span> = TiLESIZE &nbsp; &nbsp;<br />
&nbsp; &nbsp; &nbsp; TT.<span style="">xTile</span> = sx &nbsp; &nbsp; &nbsp; <br />
&nbsp; &nbsp; &nbsp; TT.<span style="">yTile</span> = sy &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp; &nbsp; &nbsp; TT.<span style="">x</span> = TT.<span style="">xTile</span> * TT.<span style="">width</span> &nbsp; &nbsp;<br />
&nbsp; &nbsp; &nbsp; TT.<span style="">y</span> = TT.<span style="">yTile</span> * TT.<span style="">height</span> &nbsp; <br />
&nbsp; &nbsp; &nbsp; TT.<span style="">Walkable</span> = WB &nbsp; &nbsp; &nbsp; &nbsp;<br />
<br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">ListAddLast</span><span style=" ">&#40;</span>TileList , TT<span style=" ">&#41;</span> &nbsp;<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Function</span> &nbsp;<br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> update<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">If</span> &nbsp; &nbsp;walkable &nbsp; &nbsp; &nbsp; <span style="color: #B1E7EB;">'walkable</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">SetColor</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">255</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span><span style=" ">&#41;</span> &nbsp;<span style="color: #B1E7EB;">'red</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Else</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #B1E7EB;">'NOT walkable</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">SetColor</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">255</span> , <span style="color: #FFFFFF;">0</span><span style=" ">&#41;</span> &nbsp; <span style="color: #B1E7EB;">'green</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">If</span> &nbsp;<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span> &nbsp; &nbsp; &nbsp;<br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> Draw<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">DrawRect</span><span style=" ">&#40;</span>x,y,Width,Height<span style=" ">&#41;</span> &nbsp;<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Type</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Type</span> TLevel<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Width&nbsp;: <span style="color: #ffff00; font-weight: bold;">Byte</span> <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Height&nbsp;: <span style="color: #ffff00; font-weight: bold;">Byte</span><br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Map:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#91;</span>,<span style=" ">&#93;</span><br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Function</span> Create:TLevel<span style=" ">&#40;</span>MyMap:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#91;</span><span style=" ">&#93;</span>,map_width:<span style="color: #ffff00; font-weight: bold;">Int</span>,map_height:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Local</span> TM&nbsp;: TLevel = <span style="color: #ffff00; font-weight: bold;">New</span> TLevel &nbsp;<br />
&nbsp; &nbsp; TM.<span style="">Width</span> &nbsp;= map_width<br />
&nbsp; &nbsp; TM.<span style="">Height</span> = map_height<br />
<br />
&nbsp; &nbsp; TM.<span style="">map</span> = <span style="color: #ffff00; font-weight: bold;">New</span> <span style="color: #ffff00; font-weight: bold;">Int</span> <span style=" ">&#91;</span>TM.<span style="">Width</span>, TM.<span style="">Height</span><span style=" ">&#93;</span><br />
&nbsp; &nbsp; TM.<span style="">load</span><span style=" ">&#40;</span>myMap<span style=" ">&#41;</span><br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Return</span> TM &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Function</span> &nbsp;<br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> Load<span style=" ">&#40;</span>arrMap:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#91;</span><span style=" ">&#93;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">For</span> <span style="color: #ffff00; font-weight: bold;">Local</span> i:<span style="color: #ffff00; font-weight: bold;">Int</span> = <span style="color: #FFFFFF;">0</span> <span style="color: #ffff00; font-weight: bold;">Until</span> Height<br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">For</span> <span style="color: #ffff00; font-weight: bold;">Local</span> j:<span style="color: #ffff00; font-weight: bold;">Int</span> = <span style="color: #FFFFFF;">0</span> <span style="color: #ffff00; font-weight: bold;">Until</span> Width<br />
&nbsp; &nbsp; &nbsp; &nbsp; Map<span style=" ">&#91;</span>j , i<span style=" ">&#93;</span> = arrMap<span style=" ">&#91;</span>j + <span style=" ">&#40;</span>i * Width<span style=" ">&#41;</span><span style=" ">&#93;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">If</span> Map<span style=" ">&#91;</span>j , i<span style=" ">&#93;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;TTile.<span style="">Create</span><span style=" ">&#40;</span>j , i , <span style="color: #ffff00; font-weight: bold;">True</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Else</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;TTile.<span style="">Create</span><span style=" ">&#40;</span>j , i , <span style="color: #ffff00; font-weight: bold;">False</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">If</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Next</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Next</span> &nbsp; &nbsp;<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span> &nbsp;<br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> Render<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">For</span> <span style="color: #ffff00; font-weight: bold;">Local</span> CurTile:TTile = <span style="color: #ffff00; font-weight: bold;">EachIn</span> TileList<br />
&nbsp; &nbsp; &nbsp; CurTile.<span style="">Update</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; CurTile.<span style="">Draw</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Next</span> &nbsp;<br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">For</span> <span style="color: #ffff00; font-weight: bold;">Local</span> CurBonus:TBonus = <span style="color: #ffff00; font-weight: bold;">EachIn</span> BonusList<br />
&nbsp; &nbsp; &nbsp; CurBonus.<span style="">Update</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; CurBonus.<span style="">Draw</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Next</span> &nbsp; &nbsp; &nbsp;<br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">For</span> <span style="color: #ffff00; font-weight: bold;">Local</span> CurMovingX:TMovingX = <span style="color: #ffff00; font-weight: bold;">EachIn</span> MovingXList<br />
&nbsp; &nbsp; &nbsp; CurMovingX.<span style="">Update</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; CurMovingX.<span style="">Draw</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Next</span> &nbsp; &nbsp; &nbsp; &nbsp;<br />
&nbsp; &nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span><br />
&nbsp; <br />
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Type</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Type</span> TBonus <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> x:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> y:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> width:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> height:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> points:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> miny:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> maxy:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> diry:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> speed:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> AnimDelay:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Function</span> Create<span style=" ">&#40;</span>sx:<span style="color: #ffff00; font-weight: bold;">Int</span>,sy:<span style="color: #ffff00; font-weight: bold;">Int</span>,pts:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Local</span> TB&nbsp;: TBonus = <span style="color: #ffff00; font-weight: bold;">New</span> TBonus<br />
&nbsp; &nbsp; &nbsp; TB.<span style="">Width</span> = <span style="color: #FFFFFF;">6</span><br />
&nbsp; &nbsp; &nbsp; TB.<span style="">Height</span> = <span style="color: #FFFFFF;">16</span><br />
&nbsp; &nbsp; &nbsp; TB.<span style="">x</span> = sx * TiLESIZE + <span style=" ">&#40;</span><span style=" ">&#40;</span>TiLESIZE - TB.<span style="">width</span><span style=" ">&#41;</span> / <span style="color: #FFFFFF;">2</span><span style=" ">&#41;</span> &nbsp;<span style="color: #B1E7EB;">'center it</span><br />
&nbsp; &nbsp; &nbsp; TB.<span style="">y</span> = sy * TiLESIZE + <span style=" ">&#40;</span><span style=" ">&#40;</span>TiLESIZE - TB.<span style="">height</span><span style=" ">&#41;</span> / <span style="color: #FFFFFF;">2</span><span style=" ">&#41;</span> <span style="color: #B1E7EB;">'center it</span><br />
&nbsp; &nbsp; &nbsp; TB.<span style="">points</span> = pts<br />
&nbsp; &nbsp; &nbsp; TB.<span style="">miny</span> = TB.<span style="">y</span> - <span style="color: #FFFFFF;">4</span><br />
&nbsp; &nbsp; &nbsp; TB.<span style="">maxy</span> = TB.<span style="">y</span> + TB.<span style="">Height</span> + <span style="color: #FFFFFF;">4</span><br />
&nbsp; &nbsp; &nbsp; TB.<span style="">diry</span> = <span style="color: #FFFFFF;">-1</span><br />
&nbsp; &nbsp; &nbsp; TB.<span style="">speed</span> = <span style="color: #FFFFFF;">1</span><br />
&nbsp; &nbsp; &nbsp; TB.<span style="">AnimDelay</span> = <span style="color: #FFFFFF;">5</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">ListAddLast</span><span style=" ">&#40;</span>BonusList ,TB<span style=" ">&#41;</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Function</span> &nbsp;<br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> Update<span style=" ">&#40;</span><span style=" ">&#41;</span> <br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">If</span><span style=" ">&#40;</span>Animdelay &lt; <span style="color: #FFFFFF;">0</span><span style=" ">&#41;</span><br />
<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #ffff00; font-weight: bold;">If</span> <span style=" ">&#40;</span> miny &gt;= <span style=" ">&#40;</span>y<span style=" ">&#41;</span> <span style="color: #ffff00; font-weight: bold;">Or</span> maxy &lt;= <span style=" ">&#40;</span>y + height<span style=" ">&#41;</span> <span style=" ">&#41;</span> <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;diry = -diry<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">If</span><br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;y = y + speed * diry<br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;AnimDelay = <span style="color: #FFFFFF;">5</span><br />
<br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">If</span> &nbsp;<br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp; AnimDelay&nbsp;:- <span style="color: #FFFFFF;">1</span><br />
&nbsp; &nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span><br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> Draw<span style=" ">&#40;</span><span style=" ">&#41;</span> <br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">SetColor</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">255</span> , <span style="color: #FFFFFF;">255</span> , <span style="color: #FFFFFF;">0</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">DrawRect</span><span style=" ">&#40;</span>x,y,Width,Height<span style=" ">&#41;</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span> &nbsp;<br />
&nbsp; <br />
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Type</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Type</span> TMovingX <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> x:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> y:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> width:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> height:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> mindir:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> maxdir:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> dirx:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> speed:<span style="color: #ffff00; font-weight: bold;">Int</span> <br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Function</span> Create<span style=" ">&#40;</span>xt:<span style="color: #ffff00; font-weight: bold;">Int</span> , yt:<span style="color: #ffff00; font-weight: bold;">Int</span> , mn:<span style="color: #ffff00; font-weight: bold;">Int</span> , mx:<span style="color: #ffff00; font-weight: bold;">Int</span> , d:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Local</span> TMX:TMovingX = <span style="color: #ffff00; font-weight: bold;">New</span> TMovingX<br />
<br />
&nbsp; &nbsp; &nbsp; TMX.<span style="">x</span> = xt * TILESIZE<br />
&nbsp; &nbsp; &nbsp; TMX.<span style="">y</span> = yt * TILESIZE<br />
<br />
&nbsp; &nbsp; &nbsp; TMX.<span style="">width</span> = TILESIZE <br />
&nbsp; &nbsp; &nbsp; TMX.<span style="">height</span> = TILESIZE<br />
<br />
&nbsp; &nbsp; &nbsp; TMX.<span style="">speed</span> = <span style="color: #FFFFFF;">1</span><br />
<br />
&nbsp; &nbsp; &nbsp; TMX.<span style="">dirx</span> = d<br />
<br />
&nbsp; &nbsp; &nbsp; TMX.<span style="">mindir</span> = <span style=" ">&#40;</span>mn + xt<span style=" ">&#41;</span> * TILESIZE <br />
&nbsp; &nbsp; &nbsp; TMX.<span style="">maxdir</span> = <span style=" ">&#40;</span>mx + xt + <span style="color: #FFFFFF;">1</span><span style=" ">&#41;</span> * TILESIZE &nbsp; <br />
<br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">ListAddLast</span><span style=" ">&#40;</span>MovingXList, TMX<span style=" ">&#41;</span> <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Function</span><br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> Update<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">If</span><span style=" ">&#40;</span> mindir &gt;= x <span style="color: #ffff00; font-weight: bold;">Or</span> maxdir &lt;= <span style=" ">&#40;</span>x + width<span style=" ">&#41;</span> <span style=" ">&#41;</span> &nbsp;<br />
&nbsp; &nbsp; &nbsp; &nbsp; dirx = - dirx<br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">EndIf</span><br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp; &nbsp; x&nbsp;:+ speed * dirx<br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span> &nbsp;<br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> Draw<span style=" ">&#40;</span><span style=" ">&#41;</span> <br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">SetColor</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">128</span> , <span style="color: #FFFFFF;">128</span> , <span style="color: #FFFFFF;">128</span><span style=" ">&#41;</span> &nbsp;<span style="color: #B1E7EB;">' gray</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">DrawRect</span><span style=" ">&#40;</span>x , y , Width , Height<span style=" ">&#41;</span> &nbsp;<br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">SetColor</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">255</span> , <span style="color: #FFFFFF;">255</span> , <span style="color: #FFFFFF;">255</span><span style=" ">&#41;</span> &nbsp;<span style="color: #B1E7EB;">' white line</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">DrawLine</span><span style=" ">&#40;</span>x , y , x + width - <span style="color: #FFFFFF;">1</span> , y<span style=" ">&#41;</span> <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Type</span> &nbsp; &nbsp;<br />
&nbsp; <br />
&nbsp; &nbsp; <br />
<span style="color: #ffff00; font-weight: bold;">Global</span> LevMap:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#91;</span><span style=" ">&#93;</span> = <span style=" ">&#91;</span><span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span><span style=" ">&#93;</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Global</span> MyLevel&nbsp;: TLevel = <span style="color: #ffff00; font-weight: bold;">New</span> TLevel.<span style="">Create</span><span style=" ">&#40;</span>LevMap , <span style="color: #FFFFFF;">20</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Function</span> Init_All_Bonuses<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">25</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">3</span> , <span style="color: #FFFFFF;">8</span> , <span style="color: #FFFFFF;">25</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">4</span> , <span style="color: #FFFFFF;">8</span> , <span style="color: #FFFFFF;">25</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">5</span> , <span style="color: #FFFFFF;">8</span> , <span style="color: #FFFFFF;">25</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">15</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">100</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">7</span> , <span style="color: #FFFFFF;">4</span> , <span style="color: #FFFFFF;">100</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">9</span> , <span style="color: #FFFFFF;">7</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">4</span> , <span style="color: #FFFFFF;">6</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">9</span> , <span style="color: #FFFFFF;">2</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">14</span> , <span style="color: #FFFFFF;">7</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">17</span> , <span style="color: #FFFFFF;">6</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">17</span> , <span style="color: #FFFFFF;">4</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">18</span> , <span style="color: #FFFFFF;">4</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">3</span> , <span style="color: #FFFFFF;">3</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span> <br />
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Function</span> &nbsp;<br />
<br />
TMovingX.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">13</span> , <span style="color: #FFFFFF;">3</span> , - <span style="color: #FFFFFF;">2</span> , <span style="color: #FFFFFF;">5</span> , <span style="color: #FFFFFF;">1</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #B1E7EB;">'----------------------------- main loop -----------------------------</span><br />
<span style="color: #ffff00; font-weight: bold;">Graphics</span><span style=" ">&#40;</span>ScrWidth, ScrHeight<span style=" ">&#41;</span> <br />
<br />
Init_All_Bonuses<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Repeat</span><br />
&nbsp; &nbsp;<span style="color: #ffff00; font-weight: bold;">Cls</span><br />
<br />
&nbsp; &nbsp; MyLevel.<span style="">Render</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp;<span style="color: #ffff00; font-weight: bold;">Flip</span> <br />
<span style="color: #ffff00; font-weight: bold;">Until</span> <span style="color: #ffff00; font-weight: bold;">KeyDown</span><span style=" ">&#40;</span>KEY_ESCAPE<span style=" ">&#41;</span> <span style="color: #ffff00; font-weight: bold;">Or</span> <span style="color: #ffff00; font-weight: bold;">AppTerminate</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
</p>
<span style="color: #ffff00; font-weight: bold;">End</span></div>
<p>Можете поэкспериментировать с размерами платформы, сделать ее уже, типа рейки, уменьшить ширину, задать другие координаты и т.д. Кстати, эксперименты с чужим (да и своим) кодом дают большее понимание того, что в нем происходит. А теперь ответственное задание. Сделайте лифт (TmovingY). Ну чтобы вверх/вниз ездил. Думаю того, что я рассказал, достаточно для этого. Дерзайте и всё у вас получится!
</p>
<a name=".D0.9E.D0.B4.D0.B8.D0.BD_.D1.81.D0.BF.D0.B8.D1.81.D0.BE.D0.BA"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A2%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2%D0%B0%D1%8F_%D0%B8%D0%B3%D1%80%D0%B0_%D0%BD%D0%B0_BlitzMax&amp;action=edit&amp;section=5" title="Править секцию: Один список">править</a>]</span> <span class="mw-headline">Один список</span></h2>
<p>Блин, что-то мне не нравится. И не нравится вот что. При добавлении нового типа в игру. Надо не только его описать, но и создать список для хранения объектов этого типа. А потом еще крутить вертеть все эти списки по очереди, чтобы всё проапдейтить и нарисовать. Вот было бы здорово иметь ОДИН список, для объектов всех типов. А? Потом просто разок пройтись по этому списку в цикле и всё, красотаааа. И в BlitzMaxе есть такая возможность! Нам поможет механизм наследования. Так, что это вы сразу отворачиваетесь и краснеете? Кто не вкурил руководство от Wave, кто думал что обойдется без этого? Кто у нас слабое звено? Ладно, попытаюсь объяснить. Но начнем по порядку. Стираем на фиг, все списки для хранения тайлов, бонусов и платформ. И создаем один&nbsp;:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">Global</span> ALLGameObjList&nbsp;: <span style="color: #ffff00; font-weight: bold;">TList</span> = <span style="color: #ffff00; font-weight: bold;">CreateList</span><span style=" ">&#40;</span><span style=" ">&#41;</span></div>
<p>Вот так, гордо и пафосно, я назвал новый список, в котором будут содержаться все объекты. Соответственно в каждой функции создания нового объекта Create() надо добавлять созданный объект уже в этот список.
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">ListAddLast</span><span style=" ">&#40;</span>ALLGameObjList , Tobj<span style=" ">&#41;</span></div>
<p>Сделали? Теперь все объекты будут в одном списке! А в циклах отрисовки бонусов и платформ, замените прошлые листы на наш супер-мега-пупер-лист. Для бонуса, это будет например так:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">For</span> <span style="color: #ffff00; font-weight: bold;">Local</span> CurBonus:TBonus = <span style="color: #ffff00; font-weight: bold;">EachIn</span> ALLGameObjList<br />
<p>&nbsp; &nbsp; CurBonus.<span style="">Update</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; CurBonus.<span style="">Draw</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
</p>
&nbsp; <span style="color: #ffff00; font-weight: bold;">Next</span></div>
<p>Компилим: клево работает!!! Блин, а чего мы выиграли-то? 2 строчки кода (((. Хоть и список у нас теперь один, а так и осталось - для каждого типа свой цикл. Думаем дальше: Вот если бы все объекты были одного типа, то было бы достаточно прокрутить с ним список один раз. То есть сделать один единственный цикл! И нам в этом поможет наследство. Плотнее товарищи, не вижу улыбок на лицах. Наследование - это один из важнейших принципов ООП. И кстати самый благозвучный, остальные без пол-литра не выговоришь. Давайте посмотрим по внимательнее на наши типы, а точнее на их свойства (Field). У них всех есть одинаковые параметры: x, y, width, height. Предлагаю сделать еще один тип - базовый или ,если угодно, родительский. Куда мы их и вынесем&nbsp;:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">Type</span> TParent<br />
<p>&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> x:<span style="color: #ffff00; font-weight: bold;">int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> y:<span style="color: #ffff00; font-weight: bold;">int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> width:<span style="color: #ffff00; font-weight: bold;">int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> height:<span style="color: #ffff00; font-weight: bold;">int</span><br />
</p>
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">type</span></div>
<p>А для чего я это сделал? Представьте, как было бы здорово не писать каждый раз эти одинаковые параметры в новый тип. А взять их из отдельного места. Из другого типа. Или другими словами &lt;унаследовать&gt; их. Я не зря назвал тип &lt;TParent&gt;, то есть &lt;родитель&gt;. Ведь типы, которые от него наследуют параметры, будут его детьми. Это как одна дружная семья типов. И как это сделать, да очень просто. Вот, к примеру, как ваше имя - отчество? Ну, к примеру, зовут вас Иван Сергеевич. Это значит что ваше имя - Ваня, а имя вашего отца (родителя) - Сергей. Вы не поверите, но в Блице это ни чуть не сложнее чем в жизни:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">Type</span> MyName <span style="color: #ffff00; font-weight: bold;">Extends</span> FatherName &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #B1E7EB;">'Type Иван Extends Сергеевич</span></div>
<p>То есть пишется сначала имя наследника и через Extends имя родителя. И это означает, что вы, то есть ваш тип, теперь обладает теми же параметрами, что и родитель. Тут надо заметить, что параметры имеют только одинаковые названия, но данные в разных типах не одинаковы. Как говорят в Одессе, это две большие разницы. Ну, теория теорией, а я предпочитаю практику. Закомментируем во всех наших типах поля &lt;x&gt;, &lt;y&gt;, &lt;width&gt; и &lt;height&gt;. И давайте первым делом &lt;усыновим&gt; тип TTile, как вы уже догадались, это будет выглядеть так:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">Type</span> TTile <span style="color: #ffff00; font-weight: bold;">Extends</span> TParent</div>
<p>На примере этого типа &lt;усыновите&gt; и остальные(TBonus и TMovingX). Компильте скорее! Все идет. А для чего мы все это делали? Нет, конечно, хорошо, что мы вынесли общие для наших типов параметры в отдельный тип. Но не это самое главное, а то, что теперь все наши типы имеют одного предка, то есть это &lt;дети&gt; одного отца. И имя ему - &lt;TParent&gt;. Ну что, уловили полет мысли?  Ага, мы будем крутить цикл с базовым типом, вот так:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">For</span> <span style="color: #ffff00; font-weight: bold;">Local</span> CurObj:TBase = <span style="color: #ffff00; font-weight: bold;">EachIn</span> ALLGameObjList<br />
<p>&nbsp; &nbsp; CurObj.<span style="">Update</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; CurObj.<span style="">Draw</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
</p>
&nbsp; <span style="color: #ffff00; font-weight: bold;">Next</span></div>
<p>А уж он будет обращаться, ко всем своим родственникам в нашем супер-пупер-мега-списке. То есть он пройдет и по TTile и по TBonus и по TMovingX - объектам, если вы их, конечно, усыновили. Компилим:и&nbsp;: опс, не работает. А что пишет-то? Мол, нет у типа TParent метода Update(). Да согласен - нет. У этого типа вообще нет ни одного метода. Мы хотим, чтобы методы Update() и Draw() вызывались не базового типа, а его наследников, так если CurObj - это Bonus, то и вызывать надо Bonus.Update() и так далее. Аналогично дело обстоит и с методом Draw(). Мы-то знаем, что хотим, но BlitzMax не знает. Для того? чтобы он это понял, надо все-таки объявить эти два метода в нашем базовом типе, НО не писать никакого кода, а сделать их АБСТРАКТНЫМИ или по-другому виртуальными:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">Method</span> Update<span style=" ">&#40;</span><span style=" ">&#41;</span> &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Abstract</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> Draw<span style=" ">&#40;</span><span style=" ">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #ffff00; font-weight: bold;">Abstract</span></div>
<p>Как раз это ключевое слово (Abstract) и подсказывает BlitzMax-у, чтобы он обращался не к методам предка, а к методам его производных типов. Это называется полиморфизм, второй из важнейших признаков ООП. Цитата: &lt;Полиморфизм реализуется с помощью наследования классов (в BlitzMaxe - типов). Класс-потомок наследует сигнатуры методов класса-родителя, но реализация этих методов может быть другой, соответствующей специфике класса-потомка. Это называется переопределением метода.&gt;(Wikipedia). То есть в зависимости от того, к какому типу принадлежит текущий объект, метод такого типа и вызывается - это как раз то, чего мы хотели. Ну, надеюсь, вы поняли. А если нет, то курите, други мои, руководство от Wave, а я пошел пивка попью. Ах, да, теперь все, компилим и радуемся. Вот исходник:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">SuperStrict</span><br />
<p><br />
<span style="color: #ffff00; font-weight: bold;">Global</span> ScrWidth&nbsp;: <span style="color: #ffff00; font-weight: bold;">Int</span> &nbsp;= <span style="color: #FFFFFF;">640</span><br />
<span style="color: #ffff00; font-weight: bold;">Global</span> ScrHeight&nbsp;: <span style="color: #ffff00; font-weight: bold;">Int</span> = <span style="color: #FFFFFF;">480</span><br />
<br />
<span style="color: #B1E7EB;">'Global TileList:TList = CreateList()</span><br />
<span style="color: #B1E7EB;">'Global BonusList:TList = CreateList()</span><br />
<span style="color: #B1E7EB;">'Global MovingXList:TList = CreateList()</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Global</span> ALLGameObjList&nbsp;: <span style="color: #ffff00; font-weight: bold;">TList</span> = <span style="color: #ffff00; font-weight: bold;">CreateList</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Const</span> TILESIZE:<span style="color: #ffff00; font-weight: bold;">Int</span> &nbsp; = <span style="color: #FFFFFF;">32</span> <br />
<br />
<span style="color: #ffff00; font-weight: bold;">Type</span> TBase<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> x:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> y:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Width:<span style="color: #ffff00; font-weight: bold;">Byte</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Height:<span style="color: #ffff00; font-weight: bold;">Byte</span><br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> update<span style=" ">&#40;</span><span style=" ">&#41;</span> <span style="color: #ffff00; font-weight: bold;">Abstract</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> draw<span style=" ">&#40;</span><span style=" ">&#41;</span> <span style="color: #ffff00; font-weight: bold;">Abstract</span><br />
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Type</span> &nbsp;<br />
<br />
<span style="color: #ffff00; font-weight: bold;">Type</span> TTile <span style="color: #ffff00; font-weight: bold;">Extends</span> TBase<br />
<span style="color: #B1E7EB;">' Field x:Int</span><br />
<span style="color: #B1E7EB;">' Field y:Int</span><br />
<span style="color: #B1E7EB;">' Field Width:Byte</span><br />
<span style="color: #B1E7EB;">' Field Height:Byte</span><br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> xTile:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> yTile:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Walkable:<span style="color: #ffff00; font-weight: bold;">Byte</span><br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Function</span> Create<span style=" ">&#40;</span>sx:<span style="color: #ffff00; font-weight: bold;">Int</span>, sy:<span style="color: #ffff00; font-weight: bold;">Int</span>, WB:<span style="color: #ffff00; font-weight: bold;">Byte</span><span style=" ">&#41;</span> <br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Local</span> TT:TTile = <span style="color: #ffff00; font-weight: bold;">New</span> TTile<br />
&nbsp; &nbsp; &nbsp; TT.<span style="">width</span> &nbsp;= TiLESIZE &nbsp; &nbsp;<br />
&nbsp; &nbsp; &nbsp; TT.<span style="">height</span> = TiLESIZE &nbsp; &nbsp;<br />
&nbsp; &nbsp; &nbsp; TT.<span style="">xTile</span> = sx &nbsp; &nbsp; &nbsp; <br />
&nbsp; &nbsp; &nbsp; TT.<span style="">yTile</span> = sy &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp; &nbsp; &nbsp; TT.<span style="">x</span> = TT.<span style="">xTile</span> * TT.<span style="">width</span> &nbsp; &nbsp;<br />
&nbsp; &nbsp; &nbsp; TT.<span style="">y</span> = TT.<span style="">yTile</span> * TT.<span style="">height</span> &nbsp; <br />
&nbsp; &nbsp; &nbsp; TT.<span style="">Walkable</span> = WB &nbsp; &nbsp; &nbsp; &nbsp;<br />
<br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">ListAddLast</span><span style=" ">&#40;</span>ALLGameObjList , TT<span style=" ">&#41;</span> &nbsp;<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Function</span> &nbsp;<br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> update<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">If</span> &nbsp; &nbsp;walkable &nbsp; &nbsp; &nbsp; <span style="color: #B1E7EB;">'not walkable</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">SetColor</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">255</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span><span style=" ">&#41;</span> &nbsp;<span style="color: #B1E7EB;">'red</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Else</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #B1E7EB;">' walkable</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">SetColor</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">255</span> , <span style="color: #FFFFFF;">0</span><span style=" ">&#41;</span> &nbsp; <span style="color: #B1E7EB;">'green</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">If</span> &nbsp;<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span> &nbsp; &nbsp; &nbsp;<br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> Draw<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">DrawRect</span><span style=" ">&#40;</span>x,y,Width,Height<span style=" ">&#41;</span> &nbsp;<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Type</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Type</span> TLevel<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Width&nbsp;: <span style="color: #ffff00; font-weight: bold;">Byte</span> <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Height&nbsp;: <span style="color: #ffff00; font-weight: bold;">Byte</span><br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> Map:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#91;</span>,<span style=" ">&#93;</span><br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Function</span> Create:TLevel<span style=" ">&#40;</span>MyMap:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#91;</span><span style=" ">&#93;</span>,map_width:<span style="color: #ffff00; font-weight: bold;">Int</span>,map_height:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Local</span> TM&nbsp;: TLevel = <span style="color: #ffff00; font-weight: bold;">New</span> TLevel &nbsp;<br />
&nbsp; &nbsp; TM.<span style="">Width</span> &nbsp;= map_width<br />
&nbsp; &nbsp; TM.<span style="">Height</span> = map_height<br />
<br />
&nbsp; &nbsp; TM.<span style="">map</span> = <span style="color: #ffff00; font-weight: bold;">New</span> <span style="color: #ffff00; font-weight: bold;">Int</span> <span style=" ">&#91;</span>TM.<span style="">Width</span>, TM.<span style="">Height</span><span style=" ">&#93;</span><br />
&nbsp; &nbsp; TM.<span style="">load</span><span style=" ">&#40;</span>myMap<span style=" ">&#41;</span><br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Return</span> TM &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Function</span> &nbsp;<br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> Load<span style=" ">&#40;</span>arrMap:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#91;</span><span style=" ">&#93;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">For</span> <span style="color: #ffff00; font-weight: bold;">Local</span> i:<span style="color: #ffff00; font-weight: bold;">Int</span> = <span style="color: #FFFFFF;">0</span> <span style="color: #ffff00; font-weight: bold;">Until</span> Height<br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">For</span> <span style="color: #ffff00; font-weight: bold;">Local</span> j:<span style="color: #ffff00; font-weight: bold;">Int</span> = <span style="color: #FFFFFF;">0</span> <span style="color: #ffff00; font-weight: bold;">Until</span> Width<br />
&nbsp; &nbsp; &nbsp; &nbsp; Map<span style=" ">&#91;</span>j , i<span style=" ">&#93;</span> = arrMap<span style=" ">&#91;</span>j + <span style=" ">&#40;</span>i * Width<span style=" ">&#41;</span><span style=" ">&#93;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">If</span> Map<span style=" ">&#91;</span>j , i<span style=" ">&#93;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;TTile.<span style="">Create</span><span style=" ">&#40;</span>j , i , <span style="color: #ffff00; font-weight: bold;">True</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Else</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;TTile.<span style="">Create</span><span style=" ">&#40;</span>j , i , <span style="color: #ffff00; font-weight: bold;">False</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">If</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Next</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Next</span> &nbsp; &nbsp;<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span> &nbsp;<br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> Render<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <br />
<span style="color: #B1E7EB;">' &nbsp; For Local CurTile:TTile = EachIn ALLGameObjList</span><br />
<span style="color: #B1E7EB;">' &nbsp; &nbsp; CurTile.Update()</span><br />
<span style="color: #B1E7EB;">' &nbsp; &nbsp; CurTile.Draw()</span><br />
<span style="color: #B1E7EB;">' &nbsp; Next &nbsp;</span><br />
<span style="color: #B1E7EB;">' &nbsp; </span><br />
<span style="color: #B1E7EB;">' &nbsp; For Local CurBonus:TBonus = EachIn ALLGameObjList</span><br />
<span style="color: #B1E7EB;">' &nbsp; &nbsp; CurBonus.Update()</span><br />
<span style="color: #B1E7EB;">' &nbsp; &nbsp; CurBonus.Draw()</span><br />
<span style="color: #B1E7EB;">' &nbsp; Next &nbsp; &nbsp; &nbsp;</span><br />
<span style="color: #B1E7EB;">' &nbsp; </span><br />
<span style="color: #B1E7EB;">' &nbsp; For Local CurMovingX:TMovingX = EachIn ALLGameObjList</span><br />
<span style="color: #B1E7EB;">' &nbsp; &nbsp; CurMovingX.Update()</span><br />
<span style="color: #B1E7EB;">' &nbsp; &nbsp; CurMovingX.Draw()</span><br />
<span style="color: #B1E7EB;">' &nbsp; Next &nbsp; &nbsp; &nbsp; &nbsp;</span><br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">For</span> <span style="color: #ffff00; font-weight: bold;">Local</span> CurObj:TBase = <span style="color: #ffff00; font-weight: bold;">EachIn</span> ALLGameObjList<br />
&nbsp; &nbsp; &nbsp; CurObj.<span style="">Update</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; CurObj.<span style="">Draw</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Next</span> &nbsp;<br />
&nbsp; &nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span><br />
&nbsp; <br />
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Type</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Type</span> TBonus <span style="color: #ffff00; font-weight: bold;">Extends</span> TBase<br />
<span style="color: #B1E7EB;">' Field x:Int</span><br />
<span style="color: #B1E7EB;">' Field y:Int</span><br />
<span style="color: #B1E7EB;">' Field width:Int</span><br />
<span style="color: #B1E7EB;">' Field height:Int</span><br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> points:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> miny:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> maxy:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> diry:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> speed:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> AnimDelay:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Function</span> Create<span style=" ">&#40;</span>sx:<span style="color: #ffff00; font-weight: bold;">Int</span>,sy:<span style="color: #ffff00; font-weight: bold;">Int</span>,pts:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Local</span> TB&nbsp;: TBonus = <span style="color: #ffff00; font-weight: bold;">New</span> TBonus<br />
&nbsp; &nbsp; &nbsp; TB.<span style="">Width</span> = <span style="color: #FFFFFF;">6</span><br />
&nbsp; &nbsp; &nbsp; TB.<span style="">Height</span> = <span style="color: #FFFFFF;">16</span><br />
&nbsp; &nbsp; &nbsp; TB.<span style="">x</span> = sx * TiLESIZE + <span style=" ">&#40;</span><span style=" ">&#40;</span>TiLESIZE - TB.<span style="">width</span><span style=" ">&#41;</span> / <span style="color: #FFFFFF;">2</span><span style=" ">&#41;</span> &nbsp;<span style="color: #B1E7EB;">'center it</span><br />
&nbsp; &nbsp; &nbsp; TB.<span style="">y</span> = sy * TiLESIZE + <span style=" ">&#40;</span><span style=" ">&#40;</span>TiLESIZE - TB.<span style="">height</span><span style=" ">&#41;</span> / <span style="color: #FFFFFF;">2</span><span style=" ">&#41;</span> <span style="color: #B1E7EB;">'center it</span><br />
&nbsp; &nbsp; &nbsp; TB.<span style="">points</span> = pts<br />
&nbsp; &nbsp; &nbsp; TB.<span style="">miny</span> = TB.<span style="">y</span> - <span style="color: #FFFFFF;">4</span><br />
&nbsp; &nbsp; &nbsp; TB.<span style="">maxy</span> = TB.<span style="">y</span> + TB.<span style="">Height</span> + <span style="color: #FFFFFF;">4</span><br />
&nbsp; &nbsp; &nbsp; TB.<span style="">diry</span> = <span style="color: #FFFFFF;">-1</span><br />
&nbsp; &nbsp; &nbsp; TB.<span style="">speed</span> = <span style="color: #FFFFFF;">1</span><br />
&nbsp; &nbsp; &nbsp; TB.<span style="">AnimDelay</span> = <span style="color: #FFFFFF;">5</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">ListAddLast</span><span style=" ">&#40;</span>ALLGameObjList , TB<span style=" ">&#41;</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Function</span> &nbsp;<br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> Update<span style=" ">&#40;</span><span style=" ">&#41;</span> <br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">If</span><span style=" ">&#40;</span>Animdelay &lt; <span style="color: #FFFFFF;">0</span><span style=" ">&#41;</span><br />
<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #ffff00; font-weight: bold;">If</span> <span style=" ">&#40;</span> miny &gt;= <span style=" ">&#40;</span>y<span style=" ">&#41;</span> <span style="color: #ffff00; font-weight: bold;">Or</span> maxy &lt;= <span style=" ">&#40;</span>y + height<span style=" ">&#41;</span> <span style=" ">&#41;</span> <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;diry = -diry<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">If</span><br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;y = y + speed * diry<br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;AnimDelay = <span style="color: #FFFFFF;">5</span><br />
<br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">If</span> &nbsp;<br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp; AnimDelay&nbsp;:- <span style="color: #FFFFFF;">1</span><br />
&nbsp; &nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span><br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> Draw<span style=" ">&#40;</span><span style=" ">&#41;</span> <br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">SetColor</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">255</span> , <span style="color: #FFFFFF;">255</span> , <span style="color: #FFFFFF;">0</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">DrawRect</span><span style=" ">&#40;</span>x,y,Width,Height<span style=" ">&#41;</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span> &nbsp;<br />
&nbsp; <br />
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Type</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Type</span> TMovingX <span style="color: #ffff00; font-weight: bold;">Extends</span> TBase<br />
<span style="color: #B1E7EB;">' Field x:Int</span><br />
<span style="color: #B1E7EB;">' Field y:Int</span><br />
<span style="color: #B1E7EB;">' Field width:Int</span><br />
<span style="color: #B1E7EB;">' Field height:Int</span><br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> mindir:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> maxdir:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> dirx:<span style="color: #ffff00; font-weight: bold;">Int</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Field</span> speed:<span style="color: #ffff00; font-weight: bold;">Int</span> <br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Function</span> Create<span style=" ">&#40;</span>xt:<span style="color: #ffff00; font-weight: bold;">Int</span> , yt:<span style="color: #ffff00; font-weight: bold;">Int</span> , mn:<span style="color: #ffff00; font-weight: bold;">Int</span> , mx:<span style="color: #ffff00; font-weight: bold;">Int</span> , d:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Local</span> TMX:TMovingX = <span style="color: #ffff00; font-weight: bold;">New</span> TMovingX<br />
<br />
&nbsp; &nbsp; &nbsp; TMX.<span style="">x</span> = xt * TILESIZE<br />
&nbsp; &nbsp; &nbsp; TMX.<span style="">y</span> = yt * TILESIZE<br />
<br />
&nbsp; &nbsp; &nbsp; TMX.<span style="">width</span> = TILESIZE <br />
&nbsp; &nbsp; &nbsp; TMX.<span style="">height</span> = TILESIZE<br />
<br />
&nbsp; &nbsp; &nbsp; TMX.<span style="">speed</span> = <span style="color: #FFFFFF;">1</span><br />
<br />
&nbsp; &nbsp; &nbsp; TMX.<span style="">dirx</span> = d<br />
<br />
&nbsp; &nbsp; &nbsp; TMX.<span style="">mindir</span> = <span style=" ">&#40;</span>mn + xt<span style=" ">&#41;</span> * TILESIZE <br />
&nbsp; &nbsp; &nbsp; TMX.<span style="">maxdir</span> = <span style=" ">&#40;</span>mx + xt + <span style="color: #FFFFFF;">1</span><span style=" ">&#41;</span> * TILESIZE &nbsp; <br />
<br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">ListAddLast</span><span style=" ">&#40;</span>ALLGameObjList , TMX<span style=" ">&#41;</span> <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Function</span><br />
<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> Update<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">If</span><span style=" ">&#40;</span> mindir &gt;= x <span style="color: #ffff00; font-weight: bold;">Or</span> maxdir &lt;= <span style=" ">&#40;</span>x + width<span style=" ">&#41;</span> <span style=" ">&#41;</span> &nbsp;<br />
&nbsp; &nbsp; &nbsp; &nbsp; dirx = - dirx<br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">EndIf</span><br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp; &nbsp; x&nbsp;:+ speed * dirx<br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span> &nbsp;<br />
&nbsp; <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Method</span> Draw<span style=" ">&#40;</span><span style=" ">&#41;</span> <br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">SetColor</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">128</span> , <span style="color: #FFFFFF;">128</span> , <span style="color: #FFFFFF;">128</span><span style=" ">&#41;</span> &nbsp;<span style="color: #B1E7EB;">' gray</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">DrawRect</span><span style=" ">&#40;</span>x , y , Width , Height<span style=" ">&#41;</span> &nbsp;<br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">SetColor</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">255</span> , <span style="color: #FFFFFF;">255</span> , <span style="color: #FFFFFF;">255</span><span style=" ">&#41;</span> &nbsp;<span style="color: #B1E7EB;">' white line</span><br />
&nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">DrawLine</span><span style=" ">&#40;</span>x , y , x + width - <span style="color: #FFFFFF;">1</span> , y<span style=" ">&#41;</span> <br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Method</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Type</span> &nbsp; &nbsp;<br />
&nbsp; <br />
&nbsp; &nbsp; <br />
<span style="color: #ffff00; font-weight: bold;">Global</span> LevMap:<span style="color: #ffff00; font-weight: bold;">Int</span><span style=" ">&#91;</span><span style=" ">&#93;</span> = <span style=" ">&#91;</span><span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">0</span> , <span style="color: #FFFFFF;">1</span> , ..<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span><span style=" ">&#93;</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Global</span> MyLevel&nbsp;: TLevel = <span style="color: #ffff00; font-weight: bold;">New</span> TLevel.<span style="">Create</span><span style=" ">&#40;</span>LevMap , <span style="color: #FFFFFF;">20</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Function</span> Init_All_Bonuses<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">25</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">3</span> , <span style="color: #FFFFFF;">8</span> , <span style="color: #FFFFFF;">25</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">4</span> , <span style="color: #FFFFFF;">8</span> , <span style="color: #FFFFFF;">25</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">5</span> , <span style="color: #FFFFFF;">8</span> , <span style="color: #FFFFFF;">25</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">15</span> , <span style="color: #FFFFFF;">1</span> , <span style="color: #FFFFFF;">100</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">7</span> , <span style="color: #FFFFFF;">4</span> , <span style="color: #FFFFFF;">100</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">9</span> , <span style="color: #FFFFFF;">7</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">4</span> , <span style="color: #FFFFFF;">6</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">9</span> , <span style="color: #FFFFFF;">2</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">14</span> , <span style="color: #FFFFFF;">7</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">17</span> , <span style="color: #FFFFFF;">6</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">17</span> , <span style="color: #FFFFFF;">4</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">18</span> , <span style="color: #FFFFFF;">4</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span> <br />
&nbsp; TBonus.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">3</span> , <span style="color: #FFFFFF;">3</span> , <span style="color: #FFFFFF;">10</span><span style=" ">&#41;</span> <br />
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Function</span> &nbsp;<br />
<br />
TMovingX.<span style="">Create</span><span style=" ">&#40;</span><span style="color: #FFFFFF;">13</span> , <span style="color: #FFFFFF;">3</span> , - <span style="color: #FFFFFF;">2</span> , <span style="color: #FFFFFF;">5</span> , <span style="color: #FFFFFF;">1</span><span style=" ">&#41;</span><br />
<br />
<br />
<span style="color: #B1E7EB;">'----------------------------- main loop -----------------------------</span><br />
<span style="color: #ffff00; font-weight: bold;">Graphics</span><span style=" ">&#40;</span>ScrWidth, ScrHeight<span style=" ">&#41;</span> <br />
<br />
Init_All_Bonuses<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Repeat</span><br />
&nbsp; &nbsp;<span style="color: #ffff00; font-weight: bold;">Cls</span><br />
<br />
&nbsp; &nbsp; MyLevel.<span style="">Render</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp;<span style="color: #ffff00; font-weight: bold;">Flip</span> <br />
<span style="color: #ffff00; font-weight: bold;">Until</span> <span style="color: #ffff00; font-weight: bold;">KeyDown</span><span style=" ">&#40;</span>KEY_ESCAPE<span style=" ">&#41;</span> <span style="color: #ffff00; font-weight: bold;">Or</span> <span style="color: #ffff00; font-weight: bold;">AppTerminate</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
</p>
<span style="color: #ffff00; font-weight: bold;">End</span></div>
<p>Так, на протяжении этой главы, мы создавали себе трудности и сами же их героически преодолевали, в этом и заключается программирование.
</p>
<a name=".D0.92.D1.8B.D0.B2.D0.B5.D0.B4.D0.B5.D0.BD.D0.B8.D0.B5"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A2%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2%D0%B0%D1%8F_%D0%B8%D0%B3%D1%80%D0%B0_%D0%BD%D0%B0_BlitzMax&amp;action=edit&amp;section=6" title="Править секцию: Выведение">править</a>]</span> <span class="mw-headline">Выведение</span></h2>
<p>Прошу строго не судить, ведь это моя первая статья. В следующей статье (если она будет) мы поместим на наш уровень героя, которого научим бегать, прыгать, стрелять, запрыгивать и ездить на платформах, а так же собирать бонусы. Все пожелания, а также сообщения об опечатках и багах в коде, пишите мне на почтовый ящик.
</p>
<div align="right"><a href="http://blitzetcetera.org/images/0/00/Tile_Game.zip" class="internal" title="Tile Game.zip">скачать архив с файлами к статье</a></div>
<hr />
<p>Автор: <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Dimanche13" title="Участник:Dimanche13">Dimanche13</a> (e-mail: dimanche13@rambler.ru)
</p><!-- 
Pre-expand include size: 19832 bytes
Post-expand include size: 418 bytes
Template argument size: 20 bytes
Maximum: 2097152 bytes
-->

<!-- Saved in parser cache with key db1:pcache:idhash:779-0!1!0!!ru!2 and timestamp 20071110032239 -->
<div class="printfooter">
Получено с <a href="7vzb20zb.html">http://blitzetcetera.org/index.php/%D0%A2%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2%D0%B0%D1%8F_%D0%B8%D0%B3%D1%80%D0%B0_%D0%BD%D0%B0_BlitzMax</a></div>
			<!-- end content -->			<div class="visualClear"></div>				</td>				<td class="rightside">				</td>			</tr>		</table>		</div>	</div>		</div>	
		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
</div></body>
<!-- Mirrored from localhost/index.php/%D0%A2%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2%D0%B0%D1%8F_%D0%B8%D0%B3%D1%80%D0%B0_%D0%BD%D0%B0_BlitzMax by HTTrack Website Copier/3.x [XR&CO'2007], Sat, 10 Nov 2007 05:15:13 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
</html>