<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru" dir="ltr">	
<!-- Mirrored from localhost/index.php/%D0%9E%D1%81%D0%BD%D0%BE%D0%B2%D1%8B_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D1%8F_%D1%81%D0%B5%D1%82%D0%B5%D0%B2%D1%8B%D1%85_%D0%B8%D0%B3%D1%80_%D1%81_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%D0%BC_DirectPlay by HTTrack Website Copier/3.x [XR&CO'2007], Sat, 10 Nov 2007 05:16:45 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
<head>		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />				<meta name="keywords" content="Основы создания сетевых игр с использованием DirectPlay,Tadeus" />
		<link rel="shortcut icon" href="http://blitzetcetera.org/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="http://blitzetcetera.org/opensearch_desc.php" title="Blitz Et Cetera (Русский)" />
		<title>Основы создания сетевых игр с использованием DirectPlay — Blitz Et Cetera</title>		<style type="text/css" media="screen,projection">/*<![CDATA[*/ @import "bvih5rde.css?63"; /*]]>*/</style>		<link rel="stylesheet" type="text/css" media="print" href="gcxktlm6.css?63" />		<link rel="stylesheet" type="text/css" media="handheld" href="zumsslq_.css?63" />		<!--[if lt IE 5.5000]><style type="text/css">@import "/skins/OfflineNew/IE50Fixes.css?63";</style><![endif]-->		<!--[if IE 5.5000]><style type="text/css">@import "/skins/OfflineNew/IE55Fixes.css?63";</style><![endif]-->		<!--[if IE 6]><style type="text/css">@import "/skins/OfflineNew/IE60Fixes.css?63";</style><![endif]-->		<!--[if IE 7]><style type="text/css">@import "/skins/OfflineNew/IE70Fixes.css?63";</style><![endif]-->		<!--[if lt IE 7]><script type="text/javascript" src="/skins/common/IEFixes.js?63"></script>		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->		<script type= "text/javascript">/*<![CDATA[*/
var skin = "OfflineNew";
var stylepath = "/skins";
var wgArticlePath = "/index.php/$1";
var wgScriptPath = "";
var wgServer = "http://blitzetcetera.org/";
var wgCanonicalNamespace = "";
var wgCanonicalSpecialPageName = false;
var wgNamespaceNumber = 0;
var wgPageName = "Основы_создания_сетевых_игр_с_использованием_DirectPlay";
var wgTitle = "Основы создания сетевых игр с использованием DirectPlay";
var wgAction = "view";
var wgArticleId = "780";
var wgIsArticle = true;
var wgUserName = null;
var wgUserGroups = null;
var wgUserLanguage = "ru";
var wgContentLanguage = "ru";
var wgBreakFrames = false;
var wgCurRevisionId = "3255";
/*]]>*/</script>
		<script type="text/javascript" src="2nq-6cel.js?63"><!-- wikibits js --></script>		<script type="text/javascript" src="http://blitzetcetera.org/index.php?title=-&amp;action=raw&amp;gen=js"><!-- site js --></script>		<style type="text/css">/*<![CDATA[*/
@import "http://blitzetcetera.org/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://blitzetcetera.org/index.php?title=MediaWiki:OfflineNew.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://blitzetcetera.org/index.php?title=-&amp;action=raw&amp;gen=css&amp;maxage=18000";
/*]]>*/</style>		<!-- Head Scripts -->	</head><body  class="mediawiki ns-0 ltr page-Основы_создания_сетевых_игр_с_использованием_DirectPlay">	<div id="globalWrapper">	<div id="logocontainer">		<table align="center">		  <tr>				<td id="blitzetclogo">				</td>			</tr>		</table>	</div>	<div id="magbar">	Журнал о программированнии на языках Blitz3D, BlitzMax, BlitzPlus	</div>		<div id="column-content">	<div id="content">		<a name="top" id="top"></a>				<div id="bodyContent">		<table cellspacing=0 cellpadding=0 width=100%>			<tr>			  <td class="leftside">				</td>				<td class="sheetbody">					<h1 class="sheet">Основы создания сетевых игр с использованием DirectPlay</h1>			<h3 id="siteSub">Материал из Blitz Et Cetera.</h3>			<div id="contentSub"></div>			<!-- start content -->			<p>Итак, вы решили, что достаточно круты для создания сетевой игры? Значит, вы пришли по адресу. В этом руководстве я постараюсь подробно описать, как сделать сие чудо. Что собой представляет сетевая игра? Есть как минимум два компьютера - сервер и клиент. Сервер - это тот, кто создает игру, а клиент, соответственно, тот, кто к ней подключается. Причем, на одном компьютере можно запустить несколько игровых сеансов, но вот скорость, с которой они будут работать - это уже вопрос отдельный. Далее, каждый компьютер имеет свой адрес, именуемый IP-адресом. IP-адрес выглядит, например, вот так: "77.122.56.45". Чтобы подключится к серверу, клиент должен ввести его IP-адрес, однако тут есть один маленький нюанс, который может сильно подпортить жизнь. Это, так называемые, прокси. Прокси - это когда один компьютер имеет доступ в Интернет через другой компьютер. И подключенных к Интернету таким способом может быть хоть вся локальная сеть. Однако, они все имеют один IP-адрес - IP-адрес сервера. Видите проблему? Если сеанс создан на подключенным таким образом компьютером, к нему подключится нельзя. Впрочем, этот компьютер может подключаться к другим в сети. Но, к сожалению, к Blitz'у это не относится. И в первом и во втором случае он банально выдает ошибку. Я до сих пор ищу решение этой проблемы внутренними средствами. А вот внешние есть - например, спец. библиотеки, написанные на других языках.Например, K-Net Lib. Мы же будем использовать средство Blitz'а именуемое DirectPlay. Но не беспокойтесь - даже, если у вас Интернет через прокси (кстати, Интернет может быть через прокси провайдера), то вы сможете опробовать игру в оффлайне.
</p><p>Дело в том, что есть очень полезные специальные адреса. Один из них, именуемый "loopback" всегда подразумевает под собой IP-адрес машины, на котором запущена игра. Этот IP-адрес - "127.0.0.1". Запомните его, потому что он понадобится вам очень часто.
</p><p>После длинной теории, наверняка вам не терпится приступить к практике. Если вы хорошо прочитали и запомнили теорию, то можно приступать. Итак, смело вбиваем:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">NetGame=<span style="color: #aaffff; font-weight: bold;">StartNetGame</span><span style=" ">&#40;</span><span style=" ">&#41;</span></div>
<p>Что же делает эта команда? Она вызывает диалоговое окно, в котором вы выбираем тип подключения, вводим IP-адрес сервера и, конечно, выбираем нужный нам сеанс. Некоторых сбивает это с толку, впрочем, я объясню. Сначала выбираете тип соединения в верхнем списке. Для локальной сети и Интернета рекомендую пункт с TCP/IP. Затем при выборе последнего выскакивает окно с просьбой ввести IP сервера. Если вы сервер - оставляйте пустым, если клиент - введите адрес сервера. В остальных случаях придется вводить параметры СОМ-порта, либо номер телефона для модемного соединения. Если мы клиент - в нижнем поле вводим имя сеанса и нажимаем кнопочку "Create New game" и смело идем в игру. Если же мы клиент - то двойным кликом щелкаем на нужном сеансе. Как видите, все довольно просто.
</p><p>Эта функция возвращает 0 - подключение/создание сеанса не удалось, 1 - удачно подключились, 2 - удачно создали сеанс. Прервать сеанс можно прервать командой StopNetGame. Разрывается сеанс только на локальной машине! Причем, если сервер выходил из игры, то сервером становится другой игрок. И второму отправляется системное сообщение типа 102. Впрочем, о типах сообщений попозже.
</p><p>Есть еще две функции, заменающие ее. Это HostNetGame и JoinNetGame. Первая запускает сеанс (нужно указать имя) и возвращает 2 при удаче, 0 - при неудаче. Вторая подключается к сеансу (нужно указать имя и IP) и возвращает 1 при удаче и 0 - при неудаче.
</p><p>Далее, одна из самых важных команд - СreateNetPlayer. В скобках надо указать имя игрока. Обычно указывается имя, введенное с клавиатуры. Внимание! Это создает локального игрока! И только локального. Когда кто-то другой создает своего игрока, то остальным отправляется сообщение с типом 100. Поэтому надо добавлять имена, IDы, а также всю остальную информацию о игроках в типы. Рекомендуется именно в типы, так как  в таком случае не будет ограничений по количеству игроков. Функция возвращает ID созданного игрока. Запишите его в секцию про свое alter ego.
</p><p>Дальше - DeleteNetPlayer. Удаляет локального игрока по IDу. Может встать вопрос - а почему собственно, может быть несколько игроков на одном ПК? А в некоторых играх может быть так, что несколько игроков играют вот так за одним компьютером.
</p><p>RecvNetMsg. Без нее вы не сможете получать никаких сообщений. Она возвращает  True, если пришло сообщение и False, если нет.
</p><p>NetMsgType. Возвращает тип сообщения. О, вот мы и добрались до типов. Итак, повторим, и скажу про новые. 100 - новый игрок(приходит от пришедшего игрока), 101 - игрок ушел (приходит от ушедшего игрока), 102 - теперь мы сервер, 200 - сеанс накрылся медным тазом. Сообщения в диапазоне 1 - 99 - пользовательские. Некоторые могут спросить - а зачем много типов сообщений? А для того, чтобы не путать сообщения с 3Д-координатами, и сообщения чата.
</p><p>NetMsgFrom. Возвращает ID игрока, пославшего последнее сообщение.
</p><p>NetMsgTo. Возвращает ID игрока, которому слали сообщение.
</p><p>NetMsgData. Возвращает содержание сообщения. ВНИМАНИЕ! Обьединяйте данные в одну строку! Во-первых, вы избежите жутких тормозов, а во-вторых сократите траффик.
</p><p>NetPlayerName. Возвращает имя игрока по его ID.
</p><p>NetPlayerLocal. Возвращает True, если указанный ID игрока совпадает с нашим и False иначе.
</p><p>SendNetMsg. Первый параметр - тип сообщения, второй - содержание, третье - наш ID, четвертое - ID получателя (0 если всем), пятое (необязательный параметр) -  приоритет сообщений. Правда, если приоритет высокий, то скорость посылки сообщения низкая. Рекомендуется для чата.
</p><p>Вот мы и разобрали, что есть что. Если вам нужны более точные сведения, то посмотрите справку, или мой перевод ее на Boolean.name -&gt; Blitz3D -&gt; Переводы -&gt; Перевод раздела DirectPlay. И хотя там довольно много ошибок и неточностей, он понятен.
</p><p>Далее, сделаем небольшую игру про кубики. Итак.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Type</span> Player<br />
<p>&nbsp; <span style="color: #aaffff; font-weight: bold;">Field</span> name$,id,ent<br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Type</span></div>
<p>Создаем тип игрока, который будет содержать его имя, ID и ссылку на кубик.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Global</span> cam<br />
<p><span style="color: #aaffff; font-weight: bold;">Global</span> myent<br />
<span style="color: #aaffff; font-weight: bold;">Global</span> myid<br />
</p>
<span style="color: #aaffff; font-weight: bold;">Global</span> myname$</div>
<p>Инициализируем глобальные переменные: для камеры, ссылку на свой кубик, ссылку на свой ID, ссылку на свое имя.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Graphics3D</span> <span style="color: #33ffdd;">800</span>,<span style="color: #33ffdd;">600</span>,<span style="color: #33ffdd;">32</span>,<span style="color: #33ffdd;">2</span><br />
<p><span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">BackBuffer</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
jng=<span style="color: #aaffff; font-weight: bold;">JoinNetGame</span><span style=" ">&#40;</span><span style="color: #00ff66;">&quot;World Arena&quot;</span>,<span style="color: #00ff66;">&quot;127.0.0.1&quot;</span><span style=" ">&#41;</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">Not</span> jng <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">HostNetGame</span><span style=" ">&#40;</span><span style="color: #00ff66;">&quot;World Arena&quot;</span><span style=" ">&#41;</span></div>
<p>Инициализируем графику и создаем игру. Заметьте - мы сначала пробуем подключится к сеансу на своем компьютере, а если его нет - создаем. Это очень удобно для тестирования и отладки. Я надеюсь, вы не забыли loopback?
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">p.Player=<span style="color: #aaffff; font-weight: bold;">New</span> Player<br />
<p>p\name=<span style="color: #aaffff; font-weight: bold;">Input</span><span style=" ">&#40;</span><span style="color: #00ff66;">&quot;Enter your name:&quot;</span><span style=" ">&#41;</span><br />
p\id=<span style="color: #aaffff; font-weight: bold;">CreateNetPlayer</span><span style=" ">&#40;</span>p\name<span style=" ">&#41;</span><br />
p\ent=<span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
myname=p\name<br />
myid=p\id<br />
</p>
myent=p\ent</div>
<p>Создаем игрока. Также даем значения ссылкам на будущее. Рекомендую вам тоже так делать.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">cam=<span style="color: #aaffff; font-weight: bold;">CreateCamera</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> cam,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">2</span>,<span style="color: #33ffdd;">-5</span></div>
<p>Создаем и располагаем камеру - трудно не догадаться&nbsp;:).
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">While</span> <span style="color: #aaffff; font-weight: bold;">Not</span> <span style="color: #aaffff; font-weight: bold;">KeyHit</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<p>&nbsp; UpdatePlayer<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; UpdateNetwork<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">RenderWorld</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Flip</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">Wend</span></div>
<p>Цикл - сердце игры&nbsp;:) Далее, приведу функции.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Function</span> UpdatePlayer<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<p>&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">KeyDown</span><span style=" ">&#40;</span><span style="color: #33ffdd;">17</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">MoveEntity</span> myent,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,.<span style="color: #33ffdd;">1</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">KeyDown</span><span style=" ">&#40;</span><span style="color: #33ffdd;">31</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">MoveEntity</span> myent,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,-.<span style="color: #33ffdd;">1</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">KeyDown</span><span style=" ">&#40;</span><span style="color: #33ffdd;">30</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">TurnEntity</span> myent,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">1</span>,<span style="color: #33ffdd;">0</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">KeyDown</span><span style=" ">&#40;</span><span style="color: #33ffdd;">32</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">TurnEntity</span> myent,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">0</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">SendNetMsg</span> <span style="color: #33ffdd;">2</span>,PackMsg$<span style=" ">&#40;</span>myent<span style=" ">&#41;</span>,myid,<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> UpdateNetwork<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">While</span> <span style="color: #aaffff; font-weight: bold;">RecvNetMsg</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Select</span> <span style="color: #aaffff; font-weight: bold;">NetMsgType</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">100</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; p.Player=<span style="color: #aaffff; font-weight: bold;">New</span> Player<br />
&nbsp; &nbsp; &nbsp; &nbsp; p\id=<span style="color: #aaffff; font-weight: bold;">NetMsgFrom</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; p\name=<span style="color: #aaffff; font-weight: bold;">NetPlayerName</span><span style=" ">&#40;</span>p\id<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; p\ent=<span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">101</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; p.Player=FindPlayer<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">NetMsgFrom</span><span style=" ">&#40;</span><span style=" ">&#41;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">FreeEntity</span> p\ent<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Delete</span> p<br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">2</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; p.Player=FindPlayer<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">NetMsgFrom</span><span style=" ">&#40;</span><span style=" ">&#41;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; UnpackMsg<span style=" ">&#40;</span>p\ent,<span style="color: #aaffff; font-weight: bold;">NetMsgData</span>$<span style=" ">&#40;</span><span style=" ">&#41;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">End Select</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> FindPlayer.Player<span style=" ">&#40;</span> id <span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> p.Player=<span style="color: #aaffff; font-weight: bold;">Each</span> Player<br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> p\id=id <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Return</span> p<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> PackMsg$<span style=" ">&#40;</span>ent<span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Return</span> <span style="color: #aaffff; font-weight: bold;">EntityX</span><span style=" ">&#40;</span>ent<span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;|&quot;</span>+<span style="color: #aaffff; font-weight: bold;">EntityZ</span><span style=" ">&#40;</span>ent<span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;|&quot;</span>+<span style="color: #aaffff; font-weight: bold;">EntityYaw</span><span style=" ">&#40;</span>ent<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> UnpackMsg<span style=" ">&#40;</span>ent,dat$<span style=" ">&#41;</span><br />
&nbsp; xp=<span style="color: #aaffff; font-weight: bold;">Instr</span><span style=" ">&#40;</span>dat$,<span style="color: #00ff66;">&quot;|&quot;</span><span style=" ">&#41;</span><br />
&nbsp; x=<span style="color: #aaffff; font-weight: bold;">Float</span><span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Left</span><span style=" ">&#40;</span>dat$,xp<span style=" ">&#41;</span><span style=" ">&#41;</span><br />
&nbsp; dat$=<span style="color: #aaffff; font-weight: bold;">Right</span><span style=" ">&#40;</span>dat$,<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>dat$<span style=" ">&#41;</span>-xp<span style=" ">&#41;</span><br />
&nbsp; zp=<span style="color: #aaffff; font-weight: bold;">Instr</span><span style=" ">&#40;</span>dat$,<span style="color: #00ff66;">&quot;|&quot;</span><span style=" ">&#41;</span><br />
&nbsp; z=<span style="color: #aaffff; font-weight: bold;">Float</span><span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Left</span><span style=" ">&#40;</span>dat$,zp<span style=" ">&#41;</span><span style=" ">&#41;</span><br />
&nbsp; dat$=<span style="color: #aaffff; font-weight: bold;">Right</span><span style=" ">&#40;</span>dat$,<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>dat$<span style=" ">&#41;</span>-zp<span style=" ">&#41;</span><br />
&nbsp; yaw=<span style="color: #aaffff; font-weight: bold;">Float</span><span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Left</span><span style=" ">&#40;</span>dat$,<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>dat$<span style=" ">&#41;</span><span style=" ">&#41;</span><span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">PositionEntity</span> ent,x,<span style="color: #33ffdd;">0</span>,z<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">RotateEntity</span> ent,<span style="color: #33ffdd;">0</span>,yaw,<span style="color: #33ffdd;">0</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<p>Первая обеспечивает управление кубиком, вторая - проверяет, есть ли новые сообщение и реагирует на них. Третья - ищет игрока по типу, четвертая - объединяет данные в одно. Как я уже говорил, это делается для экономии трафика, и чтобы не было тормозов. Пятая - распаковывает запакованное&nbsp;:). Ну а также перемещает нужный кубик куда надо.
</p><p>Как видите, создавать сетевые игры - это не так сложно как, возможно, кажется на первый взгляд. А может быть когда-нибудь вы сделаете супер-пупер ММОРПГ?&nbsp;:). В любом случае, желаю удачи.
</p>
<hr />
<p>Автор: <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Tadeus" title="Участник:Tadeus">Волошин Леонид аka Tadeus</a>
</p>
<!-- Saved in parser cache with key db1:pcache:idhash:780-0!1!0!!ru!2 and timestamp 20071110040838 -->
<div class="printfooter">
Получено с <a href="au8d7g02.html">http://blitzetcetera.org/index.php/%D0%9E%D1%81%D0%BD%D0%BE%D0%B2%D1%8B_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D1%8F_%D1%81%D0%B5%D1%82%D0%B5%D0%B2%D1%8B%D1%85_%D0%B8%D0%B3%D1%80_%D1%81_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%D0%BC_DirectPlay</a></div>
			<!-- end content -->			<div class="visualClear"></div>				</td>				<td class="rightside">				</td>			</tr>		</table>		</div>	</div>		</div>	
		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
</div></body>
<!-- Mirrored from localhost/index.php/%D0%9E%D1%81%D0%BD%D0%BE%D0%B2%D1%8B_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D1%8F_%D1%81%D0%B5%D1%82%D0%B5%D0%B2%D1%8B%D1%85_%D0%B8%D0%B3%D1%80_%D1%81_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%D0%BC_DirectPlay by HTTrack Website Copier/3.x [XR&CO'2007], Sat, 10 Nov 2007 05:16:45 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
</html>