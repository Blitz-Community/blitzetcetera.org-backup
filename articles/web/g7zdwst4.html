<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru" dir="ltr">	
<!-- Mirrored from localhost/index.php/%D0%92%D0%B2%D0%BE%D0%B4_%D1%82%D0%B5%D0%BA%D1%81%D1%82%D0%B0_%D1%81_%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B_%D0%B2_%D0%B3%D1%80%D0%B0%D1%84%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%BC_%D1%80%D0%B5%D0%B6%D0%B8%D0%BC%D0%B5 by HTTrack Website Copier/3.x [XR&CO'2007], Sat, 10 Nov 2007 05:16:22 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
<head>		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />				<meta name="keywords" content="Ввод текста с клавиатуры в графическом режиме,Grover" />
		<link rel="shortcut icon" href="http://blitzetcetera.org/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="http://blitzetcetera.org/opensearch_desc.php" title="Blitz Et Cetera (Русский)" />
		<title>Ввод текста с клавиатуры в графическом режиме — Blitz Et Cetera</title>		<style type="text/css" media="screen,projection">/*<![CDATA[*/ @import "bvih5rde.css?63"; /*]]>*/</style>		<link rel="stylesheet" type="text/css" media="print" href="gcxktlm6.css?63" />		<link rel="stylesheet" type="text/css" media="handheld" href="zumsslq_.css?63" />		<!--[if lt IE 5.5000]><style type="text/css">@import "/skins/OfflineNew/IE50Fixes.css?63";</style><![endif]-->		<!--[if IE 5.5000]><style type="text/css">@import "/skins/OfflineNew/IE55Fixes.css?63";</style><![endif]-->		<!--[if IE 6]><style type="text/css">@import "/skins/OfflineNew/IE60Fixes.css?63";</style><![endif]-->		<!--[if IE 7]><style type="text/css">@import "/skins/OfflineNew/IE70Fixes.css?63";</style><![endif]-->		<!--[if lt IE 7]><script type="text/javascript" src="/skins/common/IEFixes.js?63"></script>		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->		<script type= "text/javascript">/*<![CDATA[*/
var skin = "OfflineNew";
var stylepath = "/skins";
var wgArticlePath = "/index.php/$1";
var wgScriptPath = "";
var wgServer = "http://blitzetcetera.org/";
var wgCanonicalNamespace = "";
var wgCanonicalSpecialPageName = false;
var wgNamespaceNumber = 0;
var wgPageName = "Ввод_текста_с_клавиатуры_в_графическом_режиме";
var wgTitle = "Ввод текста с клавиатуры в графическом режиме";
var wgAction = "view";
var wgArticleId = "1656";
var wgIsArticle = true;
var wgUserName = null;
var wgUserGroups = null;
var wgUserLanguage = "ru";
var wgContentLanguage = "ru";
var wgBreakFrames = false;
var wgCurRevisionId = "3237";
/*]]>*/</script>
		<script type="text/javascript" src="2nq-6cel.js?63"><!-- wikibits js --></script>		<script type="text/javascript" src="http://blitzetcetera.org/index.php?title=-&amp;action=raw&amp;gen=js"><!-- site js --></script>		<style type="text/css">/*<![CDATA[*/
@import "http://blitzetcetera.org/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://blitzetcetera.org/index.php?title=MediaWiki:OfflineNew.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://blitzetcetera.org/index.php?title=-&amp;action=raw&amp;gen=css&amp;maxage=18000";
/*]]>*/</style>		<!-- Head Scripts -->	</head><body  class="mediawiki ns-0 ltr page-Ввод_текста_с_клавиатуры_в_графическом_режиме">	<div id="globalWrapper">	<div id="logocontainer">		<table align="center">		  <tr>				<td id="blitzetclogo">				</td>			</tr>		</table>	</div>	<div id="magbar">	Журнал о программированнии на языках Blitz3D, BlitzMax, BlitzPlus	</div>		<div id="column-content">	<div id="content">		<a name="top" id="top"></a>				<div id="bodyContent">		<table cellspacing=0 cellpadding=0 width=100%>			<tr>			  <td class="leftside">				</td>				<td class="sheetbody">					<h1 class="sheet">Ввод текста с клавиатуры в графическом режиме</h1>			<h3 id="siteSub">Материал из Blitz Et Cetera.</h3>			<div id="contentSub"></div>			<!-- start content -->			<p>Этот урок научит работать со строками и кодами клавиш в среде Blitz.
</p><p>На сколько я знаю, в Blitz3D нет функции ввода текста с клавиатуры. Конечно, есть команда Input, но она некрасивая и очень тугая. Я предлагаю сделать свою функцию ввода с клавиатуры: красивую и с рамочкой.&nbsp;:)
</p><p>Поставим задачу:
</p>
<ul><li> В точке, где кликнули мышью, появляется окошечко для ввода текста. После ввода текст отображается на экране.
</li></ul>
<p>Вот такая простая задача! Начнем с простого – с мыши и окошка:
Назовем функцию ввода&nbsp;: My_Input()
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffee00">; Устанавливаем графический режим</span><br />
<p><br />
<span style="color: #aaffff; font-weight: bold;">Graphics3D</span> <span style="color: #33ffdd;">800</span>,<span style="color: #33ffdd;">600</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">2</span><br />
<span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">BackBuffer</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #ffee00">; Устанавливаем шрифт, ибо красиво должно быть.</span><br />
<br />
font=<span style="color: #aaffff; font-weight: bold;">LoadFont</span><span style=" ">&#40;</span><span style="color: #00ff66;">&quot;Times New Roman&quot;</span>,<span style="color: #33ffdd;">20</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">SetFont</span> font<br />
<br />
<span style="color: #ffee00">;Создаем текстовую переменную, которую будем отображать на экране</span><br />
<span style="color: #ffee00">; Значок доллара указывает на то, что переменная текстовая</span><br />
Label$=<span style="color: #00ff66;">&quot;Hello World&quot;</span><br />
<br />
<span style="color: #ffee00">; Как обычно &lt;Пока не нажата клавиша Esc выполнять все до оператора Wend&gt;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">While</span> <span style="color: #aaffff; font-weight: bold;">Not</span> <span style="color: #aaffff; font-weight: bold;">KeyHit</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #ffee00">; Очистка экрана</span><br />
<span style="color: #aaffff; font-weight: bold;">Cls</span><br />
<span style="color: #ffee00">; Выставляем цвет текста</span><br />
<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span><br />
<span style="color: #ffee00">; Выводим на экран значение нашей переменной и просьбу нажать на кнопку мыши</span><br />
<span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #33ffdd;">20</span>,<span style="color: #33ffdd;">20</span>,<span style="color: #00ff66;">&quot;Click The Mouse Button On A Screen...&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #33ffdd;">20</span>,<span style="color: #33ffdd;">60</span>,<span style="color: #00ff66;">&quot;Label = &quot;</span>+Label<br />
<span style="color: #ffee00">; Если нажата левая кнопка мыши, тогда…</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">MouseHit</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
<span style="color: #ffee00">; Нашей переменной Label присваиваем значение функции my_input()</span><br />
Label=my_input<span style=" ">&#40;</span>Label$,<span style="color: #aaffff; font-weight: bold;">MouseX</span><span style=" ">&#40;</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">MouseY</span><span style=" ">&#40;</span><span style=" ">&#41;</span>,<span style="color: #33ffdd;">150</span>,<span style="color: #33ffdd;">40</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EndIf</span><br />
<span style="color: #ffee00">; Обновить содержимое экрана</span><br />
<span style="color: #aaffff; font-weight: bold;">Flip</span><br />
<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<span style="color: #aaffff; font-weight: bold;">End</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> my_input$<span style=" ">&#40;</span>s$,x#,y#,dx#,dy#<span style=" ">&#41;</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<p>Можно запустить и увидеть на экране две строчки текста. В первой написано «Жми мышью на экран» (вольный перевод), а во второй «Hello World» - это значение переменной Label.
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:TextInput01.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:TextInput01.jpg" src="aym16r49.jpg" width="400" height="310" /></a></span></div></div>
<p>При клике мышью пропадает значение переменной (становится равной 0). Это потому, что функция My_Input() пуста, а ее значение, соответственно, равно нулю.
Исправим это:
Как Вы уже заметили, у функции есть 5 входных параметров:
</p>
<ul><li>x#, y# - координаты верхнего левого угла окошка;
</li><li>dx#, dy# - ширина и высота окошка;
</li><li>s$ - это значение по умолчанию, т.е. какой текст уже будет введен при создании окошка.
</li></ul>
<p>Чтобы присвоить функции какое-либо значение, используется команда Return. Впишем в тело функции строку:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Function</span> my_input$<span style=" ">&#40;</span>s$,x#,y#,dx#,dy#<span style=" ">&#41;</span><br />
<p><span style="color: #aaffff; font-weight: bold;">Return</span> s$<br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<p>Теперь при клике на экран, значение переменной не обнуляется.
Пора рисовать само окошко. Для этого впишем в тело функции после строки Function my_input$(s$,x#,y#,dx#,dy#) следующее:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">While</span> <span style="color: #aaffff; font-weight: bold;">Not</span> <span style="color: #aaffff; font-weight: bold;">KeyHit</span><span style=" ">&#40;</span><span style="color: #33ffdd;">28</span><span style=" ">&#41;</span><br />
<p><span style="color: #aaffff; font-weight: bold;">Cls</span><br />
<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">200</span>,<span style="color: #33ffdd;">200</span>,<span style="color: #33ffdd;">200</span><br />
<span style="color: #aaffff; font-weight: bold;">Rect</span> x,y,dx,dy,<span style="color: #33ffdd;">1</span><br />
<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">Rect</span> x<span style="color: #33ffdd;">+2</span>,y<span style="color: #33ffdd;">+2</span>,dx<span style="color: #33ffdd;">-4</span>,dy<span style="color: #33ffdd;">-4</span>,<span style="color: #33ffdd;">0</span><br />
view_text= s<br />
<span style="color: #aaffff; font-weight: bold;">Text</span> x+dx/<span style="color: #33ffdd;">2</span>,y+dy/<span style="color: #33ffdd;">2</span>,view_text,<span style="color: #33ffdd;">1</span>,<span style="color: #33ffdd;">1</span><br />
<span style="color: #aaffff; font-weight: bold;">Flip</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">Wend</span></div>
<p>Запускаем и кликаем в любое место экрана. Там где мы был произведен клик, появляется окошко с текстом, равным значению переменной Label. Окно не исчезает до тех пор, пока не будет нажата клавиша Enter (код 28).
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:TextInput02.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:TextInput02.jpg" src="eyby7eit.jpg" width="400" height="310" /></a></span></div></div>
<p>Окошко работает нормально. Переходим к этапу ввода текста с клавиатуры.
Для того, чтобы узнать какая клавиша была нажата, в Blitz используются несколько функций. Нам подойдет функция WaitKey(). Эта функция останавливает работу программы до тех пор, пока не будет нажата клавиша, и возвращает код этой клавиши.
</p><p>ВНИМАНИЕ&nbsp;!!! Существует стандартная таблица символов, в которой перечислены все символы и клавиши и их коды (называется ASCII). В Blitz есть своя такая таблица, но с другими кодами (Scancodes). Важно не перепутать к какой таблице обращается функция. Например: В таблице Blitz клавиша Esc имеет код 1, а в стандартной таблице (ASCII) клавиша Esc под кодом 27. Обе таблицы можно найти нажав на иконку «Домик» на панели управления среды Blitz. Затем нажимаем на ссылку «Command Reference». Слева в списке категорий найдете таблицы ASCII и Scancodes. Функция WaitKey работает с таблицей ASCII.
В нашу функцию после строки Flip добавляем код:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">k=<span style="color: #aaffff; font-weight: bold;">WaitKey</span><span style=" ">&#40;</span><span style=" ">&#41;</span></div>
<p>Теперь программа будет останавливаться на этой строке и ждать нажатия на клавишу. Код нажатой клавиши сохранится в переменной k.
</p><p>Чтобы добавить нажатую клавишу к выводимой строке, допишем:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">s$= s$+<span style="color: #aaffff; font-weight: bold;">Chr</span><span style=" ">&#40;</span>k<span style=" ">&#41;</span></div>
<p>Текст функции на данный момент:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Function</span> my_input$<span style=" ">&#40;</span>s$,x#,y#,dx#,dy#<span style=" ">&#41;</span><br />
<p><span style="color: #aaffff; font-weight: bold;">While</span> <span style="color: #aaffff; font-weight: bold;">Not</span> <span style="color: #aaffff; font-weight: bold;">KeyHit</span><span style=" ">&#40;</span><span style="color: #33ffdd;">28</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Cls</span><br />
<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">200</span>,<span style="color: #33ffdd;">200</span>,<span style="color: #33ffdd;">200</span><br />
<span style="color: #aaffff; font-weight: bold;">Rect</span> x,y,dx,dy,<span style="color: #33ffdd;">1</span><br />
<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">Rect</span> x<span style="color: #33ffdd;">+2</span>,y<span style="color: #33ffdd;">+2</span>,dx<span style="color: #33ffdd;">-4</span>,dy<span style="color: #33ffdd;">-4</span>,<span style="color: #33ffdd;">0</span><br />
view_text$=s<br />
<span style="color: #aaffff; font-weight: bold;">Text</span> x+dx/<span style="color: #33ffdd;">2</span>,y+dy/<span style="color: #33ffdd;">2</span>,view_text,<span style="color: #33ffdd;">1</span>,<span style="color: #33ffdd;">1</span><br />
<span style="color: #aaffff; font-weight: bold;">Flip</span><br />
k=<span style="color: #aaffff; font-weight: bold;">WaitKey</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
s$=s$+<span style="color: #aaffff; font-weight: bold;">Chr</span><span style=" ">&#40;</span>k<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<span style="color: #aaffff; font-weight: bold;">Return</span> s$<br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<p>Запускаем и проверяем. Любая нажатая клавиша добавляется к нашей строке. Сразу заметьте, что при нажатии на клавиши, не содержащие букв или цифр, к строке добавляется какой-то квадратик. Дело в том, что, если к коду не прикреплен символ, то программа рисует квадратик. Это надо исправлять:
</p><p>Посмотрев внимательно в таблицу кодов ASCII, заметим, что коды букв, цифр и спецзнаков лежат в диапазоне от 32 до 126. Воспользуемся этим и поставим условие на добавление символа к строке: Если код нажатой клавиши в диапазоне от 32 до 126, то …
Наша функция примет вид:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Function</span> my_input$<span style=" ">&#40;</span>s$,x#,y#,dx#,dy#<span style=" ">&#41;</span><br />
<p><span style="color: #aaffff; font-weight: bold;">While</span> <span style="color: #aaffff; font-weight: bold;">Not</span> <span style="color: #aaffff; font-weight: bold;">KeyHit</span><span style=" ">&#40;</span><span style="color: #33ffdd;">28</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Cls</span><br />
<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">200</span>,<span style="color: #33ffdd;">200</span>,<span style="color: #33ffdd;">200</span><br />
<span style="color: #aaffff; font-weight: bold;">Rect</span> x,y,dx,dy,<span style="color: #33ffdd;">1</span><br />
<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">Rect</span> x<span style="color: #33ffdd;">+2</span>,y<span style="color: #33ffdd;">+2</span>,dx<span style="color: #33ffdd;">-4</span>,dy<span style="color: #33ffdd;">-4</span>,<span style="color: #33ffdd;">0</span><br />
view_text$=s<br />
<span style="color: #aaffff; font-weight: bold;">Text</span> x+dx/<span style="color: #33ffdd;">2</span>,y+dy/<span style="color: #33ffdd;">2</span>,view_text,<span style="color: #33ffdd;">1</span>,<span style="color: #33ffdd;">1</span><br />
<span style="color: #aaffff; font-weight: bold;">Flip</span><br />
k=<span style="color: #aaffff; font-weight: bold;">WaitKey</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> <span style=" ">&#40;</span>k&gt;<span style="color: #33ffdd;">31</span><span style=" ">&#41;</span><span style="color: #aaffff; font-weight: bold;">And</span><span style=" ">&#40;</span>k&lt;<span style="color: #33ffdd;">127</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
s$=s$+<span style="color: #aaffff; font-weight: bold;">Chr</span><span style=" ">&#40;</span>k<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EndIf</span><br />
<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<span style="color: #aaffff; font-weight: bold;">Return</span> s$<br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<p>Вот теперь лишних квадратиков не появляется.
Теперь добавим возможность удалять символы из строки. Используем тот же способ проверки кода клавиши. Клавиша BackSpace имеет код 8. Для работы над строками нам понадобятся три функции Left(), Right(), Mid().
</p>
<ul><li>Left() – Возвращает указанное количество символов, начиная с начала строки.
</li><li>Right() – Возвращает указанное количество символов, начиная с конца строки.
</li><li>Mid() - Возвращает указанное количество символов, начиная с указанного символа.
</li></ul>
<p>Примеры по использованию этих функций смотри в справке Blitz.
</p><p>Перед строкой Wend добавляем код:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">If</span> k=<span style="color: #33ffdd;">8</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
<p>s= <span style="color: #aaffff; font-weight: bold;">Left</span><span style=" ">&#40;</span>s,<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>s<span style=" ">&#41;</span><span style="color: #33ffdd;">-1</span><span style=" ">&#41;</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">EndIf</span></div>
<p>Запускаем, проверяем. При нажатии на клавишу BackSpace, символы стираются с конца строки. Нам не хватает курсора!!! Сейчас будет. Только функция немного изменится. В качестве курсора будем использовать знак «&nbsp;|&nbsp;». Чтобы курсор не становился частью строки, а только выводился на экран, я заранее ввел переменную View_Text$.
Еще нам понадобится переменная Cur_Pos – значение этой переменной будет содержать позицию курсора в строке. Управление курсором осуществляется клавишами влево и вправо, коды 31 и 30 соответственно.
</p><p>СОВЕТ: Чтобы не искать код той или иной клавиши в таблице ASCII, создайте новый лист и наберите маленькую программку:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">While</span> <span style="color: #aaffff; font-weight: bold;">Not</span> <span style="color: #aaffff; font-weight: bold;">KeyHit</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<p>k=<span style="color: #aaffff; font-weight: bold;">WaitKey</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Print</span> k<br />
</p>
<span style="color: #aaffff; font-weight: bold;">Wend</span></div>
<p>Эта программа выводит на экран код нажатой клавиши.
</p><p>После доработки наша функция выглядит так:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Function</span> my_input$<span style=" ">&#40;</span>s$,x#,y#,dx#,dy#<span style=" ">&#41;</span><br />
<p>cur_pos%=<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>s<span style=" ">&#41;</span><br />
view_text$=<span style="color: #00ff66;">&quot;&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">While</span> <span style="color: #aaffff; font-weight: bold;">Not</span> <span style="color: #aaffff; font-weight: bold;">KeyHit</span><span style=" ">&#40;</span><span style="color: #33ffdd;">28</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Cls</span><br />
<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">200</span>,<span style="color: #33ffdd;">200</span>,<span style="color: #33ffdd;">200</span><br />
<span style="color: #aaffff; font-weight: bold;">Rect</span> x,y,dx,dy,<span style="color: #33ffdd;">1</span><br />
<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">Rect</span> x<span style="color: #33ffdd;">+2</span>,y<span style="color: #33ffdd;">+2</span>,dx<span style="color: #33ffdd;">-4</span>,dy<span style="color: #33ffdd;">-4</span>,<span style="color: #33ffdd;">0</span><br />
view_text=<span style="color: #aaffff; font-weight: bold;">Left</span><span style=" ">&#40;</span>s,cur_pos<span style=" ">&#41;</span><br />
view_text=view_text+<span style="color: #00ff66;">&quot;|&quot;</span><br />
view_text=view_text+<span style="color: #aaffff; font-weight: bold;">Right</span><span style=" ">&#40;</span>s,<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>s<span style=" ">&#41;</span>-cur_pos<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Text</span> x+dx/<span style="color: #33ffdd;">2</span>,y+dy/<span style="color: #33ffdd;">2</span>,view_text,<span style="color: #33ffdd;">1</span>,<span style="color: #33ffdd;">1</span><br />
<span style="color: #aaffff; font-weight: bold;">Flip</span><br />
k=<span style="color: #aaffff; font-weight: bold;">WaitKey</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> <span style=" ">&#40;</span>k&gt;<span style="color: #33ffdd;">31</span><span style=" ">&#41;</span><span style="color: #aaffff; font-weight: bold;">And</span><span style=" ">&#40;</span>k&lt;<span style="color: #33ffdd;">127</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
temp$=s<br />
s$=<span style="color: #aaffff; font-weight: bold;">Left</span><span style=" ">&#40;</span>temp$,cur_pos<span style=" ">&#41;</span>+<span style="color: #aaffff; font-weight: bold;">Chr</span><span style=" ">&#40;</span>k<span style=" ">&#41;</span>+<span style="color: #aaffff; font-weight: bold;">Right</span><span style=" ">&#40;</span>temp$,<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>temp$<span style=" ">&#41;</span>-cur_pos<span style=" ">&#41;</span><br />
cur_pos=cur_pos<span style="color: #33ffdd;">+1</span><br />
<span style="color: #aaffff; font-weight: bold;">EndIf</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> k=<span style="color: #33ffdd;">8</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> cur_pos&lt;&gt;<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
temp$=s$<br />
s= <span style="color: #aaffff; font-weight: bold;">Left</span><span style=" ">&#40;</span>temp$,cur_pos<span style="color: #33ffdd;">-1</span><span style=" ">&#41;</span>+<span style="color: #aaffff; font-weight: bold;">Right</span><span style=" ">&#40;</span>temp$,<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>temp$<span style=" ">&#41;</span>-cur_pos<span style=" ">&#41;</span><br />
cur_pos=cur_pos<span style="color: #33ffdd;">-1</span><br />
<span style="color: #aaffff; font-weight: bold;">EndIf</span><br />
<span style="color: #aaffff; font-weight: bold;">EndIf</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> k=<span style="color: #33ffdd;">4</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> cur_pos&lt;&gt;Len<span style=" ">&#40;</span>s<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
temp$=s<br />
s= <span style="color: #aaffff; font-weight: bold;">Left</span><span style=" ">&#40;</span>temp$,cur_pos<span style=" ">&#41;</span>+<span style="color: #aaffff; font-weight: bold;">Right</span><span style=" ">&#40;</span>temp$,<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>temp$<span style=" ">&#41;</span>-cur_pos<span style="color: #33ffdd;">-1</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EndIf</span><br />
<span style="color: #aaffff; font-weight: bold;">EndIf</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> k=<span style="color: #33ffdd;">31</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
cur_pos=cur_pos<span style="color: #33ffdd;">-1</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> cur_pos&lt;<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span> cur_pos=<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">EndIf</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> k=<span style="color: #33ffdd;">30</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
cur_pos=cur_pos<span style="color: #33ffdd;">+1</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> cur_pos&gt;Len<span style=" ">&#40;</span>s<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> cur_pos=<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>s<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EndIf</span><br />
<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<span style="color: #aaffff; font-weight: bold;">Return</span> s$<br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<p>Теперь Мы можем перемещать курсор по строке и удалять символы перед и после курсора, как во всех редакторах.
Перед дальнейшим улучшением нашей функции, оптимизируем уже имеющийся код.
Заменим наши условия оператором Case:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Function</span> my_input$<span style=" ">&#40;</span>s$,x#,y#,dx#,dy#<span style=" ">&#41;</span><br />
<p>cur_pos%=<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>s<span style=" ">&#41;</span><br />
view_text$=<span style="color: #00ff66;">&quot;&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">While</span> <span style="color: #aaffff; font-weight: bold;">Not</span> <span style="color: #aaffff; font-weight: bold;">KeyHit</span><span style=" ">&#40;</span><span style="color: #33ffdd;">28</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Cls</span><br />
<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">200</span>,<span style="color: #33ffdd;">200</span>,<span style="color: #33ffdd;">200</span><br />
<span style="color: #aaffff; font-weight: bold;">Rect</span> x,y,dx,dy,<span style="color: #33ffdd;">1</span><br />
<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">Rect</span> x<span style="color: #33ffdd;">+2</span>,y<span style="color: #33ffdd;">+2</span>,dx<span style="color: #33ffdd;">-4</span>,dy<span style="color: #33ffdd;">-4</span>,<span style="color: #33ffdd;">0</span><br />
view_text=<span style="color: #aaffff; font-weight: bold;">Left</span><span style=" ">&#40;</span>s,cur_pos<span style=" ">&#41;</span><br />
view_text=view_text+<span style="color: #00ff66;">&quot;|&quot;</span><br />
view_text=view_text+<span style="color: #aaffff; font-weight: bold;">Right</span><span style=" ">&#40;</span>s,<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>s<span style=" ">&#41;</span>-cur_pos<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Text</span> x+dx/<span style="color: #33ffdd;">2</span>,y+dy/<span style="color: #33ffdd;">2</span>,view_text,<span style="color: #33ffdd;">1</span>,<span style="color: #33ffdd;">1</span><br />
<span style="color: #aaffff; font-weight: bold;">Flip</span><br />
k=<span style="color: #aaffff; font-weight: bold;">WaitKey</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Select</span> <span style="color: #aaffff; font-weight: bold;">True</span><br />
<span style="color: #aaffff; font-weight: bold;">Case</span> <span style=" ">&#40;</span>k&gt;<span style="color: #33ffdd;">31</span><span style=" ">&#41;</span><span style="color: #aaffff; font-weight: bold;">And</span><span style=" ">&#40;</span>k&lt;<span style="color: #33ffdd;">127</span><span style=" ">&#41;</span><br />
temp$=s<br />
s$=<span style="color: #aaffff; font-weight: bold;">Left</span><span style=" ">&#40;</span>temp$,cur_pos<span style=" ">&#41;</span>+<span style="color: #aaffff; font-weight: bold;">Chr</span><span style=" ">&#40;</span>k<span style=" ">&#41;</span>+<span style="color: #aaffff; font-weight: bold;">Right</span><span style=" ">&#40;</span>temp$,<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>temp$<span style=" ">&#41;</span>-cur_pos<span style=" ">&#41;</span><br />
cur_pos=cur_pos<span style="color: #33ffdd;">+1</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Case</span> k=<span style="color: #33ffdd;">8</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> cur_pos&lt;&gt;<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
temp$=s$<br />
s= <span style="color: #aaffff; font-weight: bold;">Left</span><span style=" ">&#40;</span>temp$,cur_pos<span style="color: #33ffdd;">-1</span><span style=" ">&#41;</span>+<span style="color: #aaffff; font-weight: bold;">Right</span><span style=" ">&#40;</span>temp$,<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>temp$<span style=" ">&#41;</span>-cur_pos<span style=" ">&#41;</span><br />
cur_pos=cur_pos<span style="color: #33ffdd;">-1</span><br />
<span style="color: #aaffff; font-weight: bold;">EndIf</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Case</span> k=<span style="color: #33ffdd;">4</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> cur_pos&lt;&gt;Len<span style=" ">&#40;</span>s<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
temp$=s<br />
s= <span style="color: #aaffff; font-weight: bold;">Left</span><span style=" ">&#40;</span>temp$,cur_pos<span style=" ">&#41;</span>+<span style="color: #aaffff; font-weight: bold;">Right</span><span style=" ">&#40;</span>temp$,<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>temp$<span style=" ">&#41;</span>-cur_pos<span style="color: #33ffdd;">-1</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EndIf</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Case</span> k=<span style="color: #33ffdd;">31</span><br />
cur_pos=cur_pos<span style="color: #33ffdd;">-1</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> cur_pos&lt;<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span> cur_pos=<span style="color: #33ffdd;">0</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Case</span> k=<span style="color: #33ffdd;">30</span><br />
cur_pos=cur_pos<span style="color: #33ffdd;">+1</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> cur_pos&gt;Len<span style=" ">&#40;</span>s<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> cur_pos=<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>s<span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">End Select</span><br />
<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<span style="color: #aaffff; font-weight: bold;">Return</span> s$<br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<p>Так намного красивее, а главное - быстрее. В нашей программе разницу в скорости Вы не заметите, а в огромных проектах или играх разница существенна.
</p><p>Для удобства добавим обработку клавиш Home и End, в начало или конец строки:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Case</span> k=<span style="color: #33ffdd;">1</span><br />
<p>cur_pos=<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">Case</span> k=<span style="color: #33ffdd;">2</span><br />
</p>
cur_pos=<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>s<span style=" ">&#41;</span></div>
<p>Надеюсь, что понятно, куда дописать эти строки.
</p><p>Остался только один Bug. И этот недостаток заключается в том, что Строка в окошке может выходить за его пределы – это не хорошо, но исправимо.
Воспользуемся командой ViewPort(), которая ограничивает зону вывода на экран.
Добавив ограничение вывода на экран, получим окончательный вариант функции.
Вот текст всей программы вместе с последними добавлениями:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Graphics3D</span> <span style="color: #33ffdd;">800</span>,<span style="color: #33ffdd;">600</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">2</span><br />
<p><span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">BackBuffer</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
font=<span style="color: #aaffff; font-weight: bold;">LoadFont</span><span style=" ">&#40;</span><span style="color: #00ff66;">&quot;Times New Roman&quot;</span>,<span style="color: #33ffdd;">20</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">SetFont</span> font<br />
<br />
Label$=<span style="color: #00ff66;">&quot;Hello World&quot;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">While</span> <span style="color: #aaffff; font-weight: bold;">Not</span> <span style="color: #aaffff; font-weight: bold;">KeyHit</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Cls</span><br />
<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span><br />
<span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #33ffdd;">20</span>,<span style="color: #33ffdd;">20</span>,<span style="color: #00ff66;">&quot;Click The Mouse Button On A Screen...&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #33ffdd;">20</span>,<span style="color: #33ffdd;">60</span>,<span style="color: #00ff66;">&quot;Label = &quot;</span>+Label<br />
<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">MouseHit</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> Label=my_input<span style=" ">&#40;</span>Label$,<span style="color: #aaffff; font-weight: bold;">MouseX</span><span style=" ">&#40;</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">MouseY</span><span style=" ">&#40;</span><span style=" ">&#41;</span>,<span style="color: #33ffdd;">150</span>,<span style="color: #33ffdd;">40</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Flip</span><br />
<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<span style="color: #aaffff; font-weight: bold;">End</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> my_input$<span style=" ">&#40;</span>s$,x#,y#,dx#,dy#<span style=" ">&#41;</span><br />
cur_pos%=<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>s<span style=" ">&#41;</span><br />
view_text$=<span style="color: #00ff66;">&quot;&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">While</span> <span style="color: #aaffff; font-weight: bold;">Not</span> <span style="color: #aaffff; font-weight: bold;">KeyHit</span><span style=" ">&#40;</span><span style="color: #33ffdd;">28</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Cls</span><br />
<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">200</span>,<span style="color: #33ffdd;">200</span>,<span style="color: #33ffdd;">200</span><br />
<span style="color: #aaffff; font-weight: bold;">Rect</span> x,y,dx,dy,<span style="color: #33ffdd;">1</span><br />
<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">Rect</span> x<span style="color: #33ffdd;">+2</span>,y<span style="color: #33ffdd;">+2</span>,dx<span style="color: #33ffdd;">-4</span>,dy<span style="color: #33ffdd;">-4</span>,<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">Viewport</span> x<span style="color: #33ffdd;">+2</span>,y<span style="color: #33ffdd;">+2</span>,dx<span style="color: #33ffdd;">-4</span>,dy<span style="color: #33ffdd;">-4</span><br />
view_text=<span style="color: #aaffff; font-weight: bold;">Left</span><span style=" ">&#40;</span>s,cur_pos<span style=" ">&#41;</span><br />
view_text=view_text+<span style="color: #00ff66;">&quot;|&quot;</span><br />
view_text=view_text+<span style="color: #aaffff; font-weight: bold;">Right</span><span style=" ">&#40;</span>s,<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>s<span style=" ">&#41;</span>-cur_pos<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Text</span> x+dx/<span style="color: #33ffdd;">2</span>,y+dy/<span style="color: #33ffdd;">2</span>,view_text,<span style="color: #33ffdd;">1</span>,<span style="color: #33ffdd;">1</span><br />
<span style="color: #aaffff; font-weight: bold;">Flip</span><br />
k=<span style="color: #aaffff; font-weight: bold;">WaitKey</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Select</span> <span style="color: #aaffff; font-weight: bold;">True</span><br />
<span style="color: #aaffff; font-weight: bold;">Case</span> <span style=" ">&#40;</span>k&gt;<span style="color: #33ffdd;">31</span><span style=" ">&#41;</span><span style="color: #aaffff; font-weight: bold;">And</span><span style=" ">&#40;</span>k&lt;<span style="color: #33ffdd;">127</span><span style=" ">&#41;</span><br />
temp$=s<br />
s$=<span style="color: #aaffff; font-weight: bold;">Left</span><span style=" ">&#40;</span>temp$,cur_pos<span style=" ">&#41;</span>+<span style="color: #aaffff; font-weight: bold;">Chr</span><span style=" ">&#40;</span>k<span style=" ">&#41;</span>+<span style="color: #aaffff; font-weight: bold;">Right</span><span style=" ">&#40;</span>temp$,<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>temp$<span style=" ">&#41;</span>-cur_pos<span style=" ">&#41;</span><br />
cur_pos=cur_pos<span style="color: #33ffdd;">+1</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Case</span> k=<span style="color: #33ffdd;">8</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> cur_pos&lt;&gt;<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
temp$=s$<br />
s= <span style="color: #aaffff; font-weight: bold;">Left</span><span style=" ">&#40;</span>temp$,cur_pos<span style="color: #33ffdd;">-1</span><span style=" ">&#41;</span>+<span style="color: #aaffff; font-weight: bold;">Right</span><span style=" ">&#40;</span>temp$,<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>temp$<span style=" ">&#41;</span>-cur_pos<span style=" ">&#41;</span><br />
cur_pos=cur_pos<span style="color: #33ffdd;">-1</span><br />
<span style="color: #aaffff; font-weight: bold;">EndIf</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Case</span> k=<span style="color: #33ffdd;">4</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> cur_pos&lt;&gt;Len<span style=" ">&#40;</span>s<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
temp$=s<br />
s= <span style="color: #aaffff; font-weight: bold;">Left</span><span style=" ">&#40;</span>temp$,cur_pos<span style=" ">&#41;</span>+<span style="color: #aaffff; font-weight: bold;">Right</span><span style=" ">&#40;</span>temp$,<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>temp$<span style=" ">&#41;</span>-cur_pos<span style="color: #33ffdd;">-1</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EndIf</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Case</span> k=<span style="color: #33ffdd;">31</span><br />
cur_pos=cur_pos<span style="color: #33ffdd;">-1</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> cur_pos&lt;<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span> cur_pos=<span style="color: #33ffdd;">0</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Case</span> k=<span style="color: #33ffdd;">30</span><br />
cur_pos=cur_pos<span style="color: #33ffdd;">+1</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> cur_pos&gt;Len<span style=" ">&#40;</span>s<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> cur_pos=<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>s<span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Case</span> k=<span style="color: #33ffdd;">1</span><br />
cur_pos=<span style="color: #33ffdd;">0</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Case</span> k=<span style="color: #33ffdd;">2</span><br />
cur_pos=<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>s<span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">End Select</span><br />
<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<span style="color: #aaffff; font-weight: bold;">Viewport</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #aaffff; font-weight: bold;">GraphicsWidth</span><span style=" ">&#40;</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">GraphicsHeight</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Return</span> s$<br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<p>Полученную функцию можно подогнать под Вашу программу и использовать. Основной принцип я объяснил.
</p><p>Удачного кодинга!
</p>
<hr />
<p>Автор: <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Grover" title="Участник:Grover">Grover</a> (e-mail: mail_grover@mail.ru)
</p>
<!-- Saved in parser cache with key db1:pcache:idhash:1656-0!1!0!!ru!2 and timestamp 20071110033638 -->
<div class="printfooter">
Получено с <a href="g7zdwst4.html">http://blitzetcetera.org/index.php/%D0%92%D0%B2%D0%BE%D0%B4_%D1%82%D0%B5%D0%BA%D1%81%D1%82%D0%B0_%D1%81_%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B_%D0%B2_%D0%B3%D1%80%D0%B0%D1%84%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%BC_%D1%80%D0%B5%D0%B6%D0%B8%D0%BC%D0%B5</a></div>
			<!-- end content -->			<div class="visualClear"></div>				</td>				<td class="rightside">				</td>			</tr>		</table>		</div>	</div>		</div>	
		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
</div></body>
<!-- Mirrored from localhost/index.php/%D0%92%D0%B2%D0%BE%D0%B4_%D1%82%D0%B5%D0%BA%D1%81%D1%82%D0%B0_%D1%81_%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B_%D0%B2_%D0%B3%D1%80%D0%B0%D1%84%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%BC_%D1%80%D0%B5%D0%B6%D0%B8%D0%BC%D0%B5 by HTTrack Website Copier/3.x [XR&CO'2007], Sat, 10 Nov 2007 05:16:23 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
</html>