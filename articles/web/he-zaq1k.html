<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru" dir="ltr">	
<!-- Mirrored from localhost/index.php/%D0%91%D0%B0%D0%BD%D0%BA%2C_%D0%BA%D0%B0%D0%BA_%D0%B4%D0%B8%D0%BD%D0%B0%D0%BC%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9_%D0%BC%D0%B0%D1%81%D1%81%D0%B8%D0%B2 by HTTrack Website Copier/3.x [XR&CO'2007], Sat, 10 Nov 2007 05:16:43 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
<head>		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />				<meta name="keywords" content="Банк, как динамический массив,Matt Merkulov" />
		<link rel="shortcut icon" href="http://blitzetcetera.org/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="http://blitzetcetera.org/opensearch_desc.php" title="Blitz Et Cetera (Русский)" />
		<title>Банк, как динамический массив — Blitz Et Cetera</title>		<style type="text/css" media="screen,projection">/*<![CDATA[*/ @import "bvih5rde.css?63"; /*]]>*/</style>		<link rel="stylesheet" type="text/css" media="print" href="gcxktlm6.css?63" />		<link rel="stylesheet" type="text/css" media="handheld" href="zumsslq_.css?63" />		<!--[if lt IE 5.5000]><style type="text/css">@import "/skins/OfflineNew/IE50Fixes.css?63";</style><![endif]-->		<!--[if IE 5.5000]><style type="text/css">@import "/skins/OfflineNew/IE55Fixes.css?63";</style><![endif]-->		<!--[if IE 6]><style type="text/css">@import "/skins/OfflineNew/IE60Fixes.css?63";</style><![endif]-->		<!--[if IE 7]><style type="text/css">@import "/skins/OfflineNew/IE70Fixes.css?63";</style><![endif]-->		<!--[if lt IE 7]><script type="text/javascript" src="/skins/common/IEFixes.js?63"></script>		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->		<script type= "text/javascript">/*<![CDATA[*/
var skin = "OfflineNew";
var stylepath = "/skins";
var wgArticlePath = "/index.php/$1";
var wgScriptPath = "";
var wgServer = "http://blitzetcetera.org/";
var wgCanonicalNamespace = "";
var wgCanonicalSpecialPageName = false;
var wgNamespaceNumber = 0;
var wgPageName = "Банк,_как_динамический_массив";
var wgTitle = "Банк, как динамический массив";
var wgAction = "view";
var wgArticleId = "145";
var wgIsArticle = true;
var wgUserName = null;
var wgUserGroups = null;
var wgUserLanguage = "ru";
var wgContentLanguage = "ru";
var wgBreakFrames = false;
var wgCurRevisionId = "3561";
/*]]>*/</script>
		<script type="text/javascript" src="2nq-6cel.js?63"><!-- wikibits js --></script>		<script type="text/javascript" src="http://blitzetcetera.org/index.php?title=-&amp;action=raw&amp;gen=js"><!-- site js --></script>		<style type="text/css">/*<![CDATA[*/
@import "http://blitzetcetera.org/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://blitzetcetera.org/index.php?title=MediaWiki:OfflineNew.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://blitzetcetera.org/index.php?title=-&amp;action=raw&amp;gen=css&amp;maxage=18000";
/*]]>*/</style>		<!-- Head Scripts -->	</head><body  class="mediawiki ns-0 ltr page-Банк_как_динамический_массив">	<div id="globalWrapper">	<div id="logocontainer">		<table align="center">		  <tr>				<td id="blitzetclogo">				</td>			</tr>		</table>	</div>	<div id="magbar">	Журнал о программированнии на языках Blitz3D, BlitzMax, BlitzPlus	</div>		<div id="column-content">	<div id="content">		<a name="top" id="top"></a>				<div id="bodyContent">		<table cellspacing=0 cellpadding=0 width=100%>			<tr>			  <td class="leftside">				</td>				<td class="sheetbody">					<h1 class="sheet">Банк, как динамический массив</h1>			<h3 id="siteSub">Материал из Blitz Et Cetera.</h3>			<div id="contentSub"></div>			<!-- start content -->			<p>Представим ситуацию, когда необходимо создать массив, где периодически появляются новые объекты и исчезают старые. Это, конечно, можно легко сделать с помощью типов, но рассмотрим вариант, когда максимум объектов определен и их порядок не имеет значения. В этом случае можно ускорить работу программы за счет использования банка вместо типов. Пусть длина одной записи равна константе reclen. Введем переменную-указатель, обозначающую последний элемент записи, изначально она равна -reclen, т.к. в банке нет элементов. При занесении нового элемента, указатель увеличивается на reclen и в этот адрес заносится новая запись. При удалении элемента, на место удаляемой записи копируются данные последней записи в банке и указатель уменьшается на reclen. Для примера, рассмотрим программу, имитирующую снегопад:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffee00">;Maxrec - максимальное количество записей, reclen - длина записи в байтах (в</span><br />
<p><span style="color: #ffee00">; данном примере запись содержит координаты: x(int), y(float), приращения:</span><br />
<span style="color: #ffee00">; dx(Float), dy(Float), цвет с(byte) - 17 байт)</span><br />
<span style="color: #aaffff; font-weight: bold;">Const</span> maxrec=<span style="color: #33ffdd;">120000</span>, reclen=<span style="color: #33ffdd;">17</span><br />
<span style="color: #ffee00">;Создаем банк</span><br />
bnk=<span style="color: #aaffff; font-weight: bold;">CreateBank</span><span style=" ">&#40;</span>maxrec*reclen<span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Адрес последнего элемента в банке</span><br />
addr=-reclen<br />
<br />
<span style="color: #aaffff; font-weight: bold;">Graphics</span> <span style="color: #33ffdd;">800</span>,<span style="color: #33ffdd;">600</span>,<span style="color: #33ffdd;">32</span><br />
<br />
<span style="color: #ffee00">;Массив для хранения значений цветов (градаций серого)</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> col<span style=" ">&#40;</span><span style="color: #33ffdd;">255</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">255</span><br />
&nbsp;col<span style=" ">&#40;</span>n<span style=" ">&#41;</span>=n*<span style="color: #33ffdd;">65793</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">BackBuffer</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp;<span style="color: #ffee00">;Добавляем 400 снежинок</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">400</span><br />
&nbsp; addr=addr+reclen<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">PokeFloat</span> bnk,addr,<span style="color: #aaffff; font-weight: bold;">Rand</span><span style=" ">&#40;</span><span style="color: #33ffdd;">800</span><span style=" ">&#41;</span><span style="color: #ffee00">;координата x</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">PokeFloat</span> bnk,addr<span style="color: #33ffdd;">+4</span>,<span style="color: #33ffdd;">0</span><span style="color: #ffee00">;координата y</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">PokeFloat</span> bnk,addr<span style="color: #33ffdd;">+8</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><span style="color: #ffee00">;приращение по x</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">PokeFloat</span> bnk,addr<span style="color: #33ffdd;">+12</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">2</span>,<span style="color: #33ffdd;">10</span><span style=" ">&#41;</span><span style="color: #ffee00">;приращение по y</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">PokeByte</span> bnk,addr<span style="color: #33ffdd;">+16</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">64</span>,<span style="color: #33ffdd;">255</span><span style=" ">&#41;</span><span style="color: #ffee00">;номер цвета</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Cls</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">LockBuffer</span> <span style="color: #aaffff; font-weight: bold;">BackBuffer</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
&nbsp;<span style="color: #ffee00">;Цикл по всем снежинкам в банке</span><br />
&nbsp;n=<span style="color: #33ffdd;">0</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">While</span> n&lt;=addr<br />
&nbsp; <span style="color: #ffee00">;Добавляем приращения к координатам</span><br />
&nbsp; x#=<span style="color: #aaffff; font-weight: bold;">PeekFloat</span><span style=" ">&#40;</span>bnk,n<span style=" ">&#41;</span>+<span style="color: #aaffff; font-weight: bold;">PeekFloat</span><span style=" ">&#40;</span>bnk,n<span style="color: #33ffdd;">+8</span><span style=" ">&#41;</span><br />
&nbsp; y#=<span style="color: #aaffff; font-weight: bold;">PeekFloat</span><span style=" ">&#40;</span>bnk,n<span style="color: #33ffdd;">+4</span><span style=" ">&#41;</span>+<span style="color: #aaffff; font-weight: bold;">PeekFloat</span><span style=" ">&#40;</span>bnk,n<span style="color: #33ffdd;">+12</span><span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> x&lt;<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Or</span> x&gt;<span style="color: #33ffdd;">799</span> <span style="color: #aaffff; font-weight: bold;">Or</span> y#&gt;<span style="color: #33ffdd;">599</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">;Если снежинка вышла за край экрана - удаляем ее из банка</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">CopyBank</span> bnk,addr,bnk,n,reclen<br />
&nbsp; &nbsp;addr=addr-reclen<br />
&nbsp; &nbsp;<span style="color: #ffee00">;Так как на ее место стала последняя, то адрес не увеличивается </span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">;Иначе - отображаем на экране и обновляем координаты</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">WritePixelFast</span> x#,y#,col<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">PeekByte</span><span style=" ">&#40;</span>bnk,n<span style="color: #33ffdd;">+12</span><span style=" ">&#41;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">PokeFloat</span> bnk,n,x#<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">PokeFloat</span> bnk,n<span style="color: #33ffdd;">+4</span>,y#<br />
&nbsp; &nbsp;<span style="color: #ffee00">;Переходим к следующей снежинке</span><br />
&nbsp; &nbsp;n=n+reclen<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">UnlockBuffer</span> <span style="color: #aaffff; font-weight: bold;">BackBuffer</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Flip</span><br />
<br />
</p>
<span style="color: #aaffff; font-weight: bold;">Until</span> <span style="color: #aaffff; font-weight: bold;">KeyHit</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span></div>
<p><br />
</p>
<div align="right"><a href="http://blitzetcetera.org/images/0/0c/BankAsDynamicArray.bb" class="internal" title="BankAsDynamicArray.bb">скачать исходный код</a></div>
<hr />
<p>Автор: <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Matt_Merkulov" title="Участник:Matt Merkulov">Матвей Меркулов</a> (E-mail: MattMerk@mail.ru, ICQ: 392-274-050)
</p><!-- 
Pre-expand include size: 2505 bytes
Post-expand include size: 359 bytes
Template argument size: 28 bytes
Maximum: 2097152 bytes
-->

<!-- Saved in parser cache with key db1:pcache:idhash:145-0!1!0!!ru!2 and timestamp 20071110040742 -->
<div class="printfooter">
Получено с <a href="he-zaq1k.html">http://blitzetcetera.org/index.php/%D0%91%D0%B0%D0%BD%D0%BA%2C_%D0%BA%D0%B0%D0%BA_%D0%B4%D0%B8%D0%BD%D0%B0%D0%BC%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9_%D0%BC%D0%B0%D1%81%D1%81%D0%B8%D0%B2</a></div>
			<!-- end content -->			<div class="visualClear"></div>				</td>				<td class="rightside">				</td>			</tr>		</table>		</div>	</div>		</div>	
		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
</div></body>
<!-- Mirrored from localhost/index.php/%D0%91%D0%B0%D0%BD%D0%BA%2C_%D0%BA%D0%B0%D0%BA_%D0%B4%D0%B8%D0%BD%D0%B0%D0%BC%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9_%D0%BC%D0%B0%D1%81%D1%81%D0%B8%D0%B2 by HTTrack Website Copier/3.x [XR&CO'2007], Sat, 10 Nov 2007 05:16:43 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
</html>