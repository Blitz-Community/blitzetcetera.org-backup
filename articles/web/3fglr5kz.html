<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru" dir="ltr">	
<!-- Mirrored from localhost/index.php/%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BC%D0%B5%D0%BD%D1%8E_%D0%B2_BlitzPlus by HTTrack Website Copier/3.x [XR&CO'2007], Sat, 10 Nov 2007 05:16:33 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
<head>		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />				<meta name="keywords" content="Создание меню в BlitzPlus,Matt Merkulov" />
		<link rel="shortcut icon" href="http://blitzetcetera.org/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="http://blitzetcetera.org/opensearch_desc.php" title="Blitz Et Cetera (Русский)" />
		<title>Создание меню в BlitzPlus — Blitz Et Cetera</title>		<style type="text/css" media="screen,projection">/*<![CDATA[*/ @import "bvih5rde.css?63"; /*]]>*/</style>		<link rel="stylesheet" type="text/css" media="print" href="gcxktlm6.css?63" />		<link rel="stylesheet" type="text/css" media="handheld" href="zumsslq_.css?63" />		<!--[if lt IE 5.5000]><style type="text/css">@import "/skins/OfflineNew/IE50Fixes.css?63";</style><![endif]-->		<!--[if IE 5.5000]><style type="text/css">@import "/skins/OfflineNew/IE55Fixes.css?63";</style><![endif]-->		<!--[if IE 6]><style type="text/css">@import "/skins/OfflineNew/IE60Fixes.css?63";</style><![endif]-->		<!--[if IE 7]><style type="text/css">@import "/skins/OfflineNew/IE70Fixes.css?63";</style><![endif]-->		<!--[if lt IE 7]><script type="text/javascript" src="/skins/common/IEFixes.js?63"></script>		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->		<script type= "text/javascript">/*<![CDATA[*/
var skin = "OfflineNew";
var stylepath = "/skins";
var wgArticlePath = "/index.php/$1";
var wgScriptPath = "";
var wgServer = "http://blitzetcetera.org/";
var wgCanonicalNamespace = "";
var wgCanonicalSpecialPageName = false;
var wgNamespaceNumber = 0;
var wgPageName = "Создание_меню_в_BlitzPlus";
var wgTitle = "Создание меню в BlitzPlus";
var wgAction = "view";
var wgArticleId = "669";
var wgIsArticle = true;
var wgUserName = null;
var wgUserGroups = null;
var wgUserLanguage = "ru";
var wgContentLanguage = "ru";
var wgBreakFrames = false;
var wgCurRevisionId = "3581";
/*]]>*/</script>
		<script type="text/javascript" src="2nq-6cel.js?63"><!-- wikibits js --></script>		<script type="text/javascript" src="http://blitzetcetera.org/index.php?title=-&amp;action=raw&amp;gen=js"><!-- site js --></script>		<style type="text/css">/*<![CDATA[*/
@import "http://blitzetcetera.org/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://blitzetcetera.org/index.php?title=MediaWiki:OfflineNew.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://blitzetcetera.org/index.php?title=-&amp;action=raw&amp;gen=css&amp;maxage=18000";
/*]]>*/</style>		<!-- Head Scripts -->	</head><body  class="mediawiki ns-0 ltr page-Создание_меню_в_BlitzPlus">	<div id="globalWrapper">	<div id="logocontainer">		<table align="center">		  <tr>				<td id="blitzetclogo">				</td>			</tr>		</table>	</div>	<div id="magbar">	Журнал о программированнии на языках Blitz3D, BlitzMax, BlitzPlus	</div>		<div id="column-content">	<div id="content">		<a name="top" id="top"></a>				<div id="bodyContent">		<table cellspacing=0 cellpadding=0 width=100%>			<tr>			  <td class="leftside">				</td>				<td class="sheetbody">					<h1 class="sheet">Создание меню в BlitzPlus</h1>			<h3 id="siteSub">Материал из Blitz Et Cetera.</h3>			<div id="contentSub"></div>			<!-- start content -->			<p>Те, кто только начинает программировать графический интерфейс в BlitzPlus, обычно делают меню так:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">mw=WindowMenu<span style=" ">&#40;</span>win<span style=" ">&#41;</span><br />
<p>m=CreateMenu<span style=" ">&#40;</span><span style="color: #00ff66;">&quot;File&quot;</span>,<span style="color: #33ffdd;">0</span>,mw<span style=" ">&#41;</span><br />
CreateMenu<span style=" ">&#40;</span><span style="color: #00ff66;">&quot;New&quot;</span>,<span style="color: #33ffdd;">1</span>,m<span style=" ">&#41;</span><br />
CreateMenu<span style=" ">&#40;</span><span style="color: #00ff66;">&quot;Open&quot;</span>,<span style="color: #33ffdd;">2</span>,m<span style=" ">&#41;</span><br />
...<br />
m=CreateMenu<span style=" ">&#40;</span><span style="color: #00ff66;">&quot;Help&quot;</span>,<span style="color: #33ffdd;">0</span>,mw<span style=" ">&#41;</span><br />
CreateMenu<span style=" ">&#40;</span><span style="color: #00ff66;">&quot;Index&quot;</span>,<span style="color: #33ffdd;">11</span>,m<span style=" ">&#41;</span><br />
CreateMenu<span style=" ">&#40;</span><span style="color: #00ff66;">&quot;About&quot;</span>,<span style="color: #33ffdd;">12</span>,m<span style=" ">&#41;</span><br />
...<br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Select</span> WaitEvent<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> $<span style="color: #33ffdd;">1001</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Select</span> EventData<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">case</span> <span style="color: #33ffdd;">1</span><span style="color: #ffee00">;New</span><br />
&nbsp; &nbsp; &nbsp;...<br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">case</span> <span style="color: #33ffdd;">2</span><span style="color: #ffee00">;Open</span><br />
&nbsp; &nbsp; &nbsp;...<br />
&nbsp; &nbsp; &nbsp;...<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End Select</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> $<span style="color: #33ffdd;">803</span>:<span style="color: #aaffff; font-weight: bold;">Exit</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">End Select</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">Forever</span></div>
<p>Неудобства этого метода очевидны: раздражающая глаза масса "CreateMenu" и необходимость запоминать под каким номером какой элемент. Впрочем, последний недочет можно исправить:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Const</span> MenuNew=<span style="color: #33ffdd;">1</span>,MenuOpen=<span style="color: #33ffdd;">2</span>,...<br />
<p><span style="color: #aaffff; font-weight: bold;">Const</span> MenuIndex=<span style="color: #33ffdd;">11</span>,MenuAbout=<span style="color: #33ffdd;">12</span><br />
<br />
mw=WindowMenu<span style=" ">&#40;</span>win<span style=" ">&#41;</span><br />
m=CreateMenu<span style=" ">&#40;</span><span style="color: #00ff66;">&quot;File&quot;</span>,<span style="color: #33ffdd;">0</span>,mw<span style=" ">&#41;</span><br />
CreateMenu<span style=" ">&#40;</span><span style="color: #00ff66;">&quot;New&quot;</span>,MenuNew,m<span style=" ">&#41;</span><br />
CreateMenu<span style=" ">&#40;</span><span style="color: #00ff66;">&quot;Open&quot;</span>,MenuOpen,m<span style=" ">&#41;</span><br />
...<br />
m=CreateMenu<span style=" ">&#40;</span><span style="color: #00ff66;">&quot;Help&quot;</span>,<span style="color: #33ffdd;">0</span>,mw<span style=" ">&#41;</span><br />
CreateMenu<span style=" ">&#40;</span><span style="color: #00ff66;">&quot;Index&quot;</span>,MenuIndex,m<span style=" ">&#41;</span><br />
CreateMenu<span style=" ">&#40;</span><span style="color: #00ff66;">&quot;About&quot;</span>,MenuAbout,m<span style=" ">&#41;</span><br />
...<br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Select</span> WaitEvent<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> $<span style="color: #33ffdd;">1001</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Select</span> EventData<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">case</span> MenuNew<br />
&nbsp; &nbsp; &nbsp;...<br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">case</span> MenuOpen<br />
&nbsp; &nbsp; &nbsp;...<br />
&nbsp; &nbsp; &nbsp;...<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End Select</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> $<span style="color: #33ffdd;">803</span>:<span style="color: #aaffff; font-weight: bold;">Exit</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">End Select</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">Forever</span></div>
<p>Но все еще остаются "CreateMenu" плюс добавляются константы. Я предлагаю третий вариант - хранить названия элементов меню в типах, автоматически сопоставляя им индексы, а затем по выданному WaitEvent+EventData индексу искать название и выбирать соответствующее действие в структуре Select-End Select по названию. То есть, вообще не трогать индексы в главной программе. Вот модуль для работы с меню:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Type</span> menuitem<br />
<p>&nbsp;<span style="color: #aaffff; font-weight: bold;">Field</span> name$<br />
<span style="color: #aaffff; font-weight: bold;">End Type</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> Menu_Create<span style=" ">&#40;</span>w<span style=" ">&#41;</span><br />
wmenu=WindowMenu<span style=" ">&#40;</span>w<span style=" ">&#41;</span><br />
parent=wmenu<br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Read</span> m$<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Select</span> m$<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;{&quot;</span>: parent=old<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;}&quot;</span>: parent=wmenu<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;===Конец===&quot;</span>: <span style="color: #aaffff; font-weight: bold;">Exit</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Default</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> parent&lt;&gt;wmenu <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; i=i<span style="color: #33ffdd;">+1</span><br />
&nbsp; &nbsp; mi.menuitem=<span style="color: #aaffff; font-weight: bold;">New</span> menuitem<br />
&nbsp; &nbsp; mi\name$=m$<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp;old=CreateMenu<span style=" ">&#40;</span>m$,i,parent<span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">End Select</span><br />
<span style="color: #aaffff; font-weight: bold;">Forever</span><br />
UpdateWindowMenu<span style=" ">&#40;</span>w<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> menuitem_name$<span style=" ">&#40;</span>n<span style=" ">&#41;</span><br />
mi.menuitem=<span style="color: #aaffff; font-weight: bold;">First</span> menuitem<br />
<span style="color: #aaffff; font-weight: bold;">For</span> nn=<span style="color: #33ffdd;">2</span> <span style="color: #aaffff; font-weight: bold;">To</span> n<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> mi=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span> Notify <span style="color: #00ff66;">&quot;Menuitem N&quot;</span>+n+<span style="color: #00ff66;">&quot; doesn't exist&quot;</span>:<span style="color: #aaffff; font-weight: bold;">Return</span><br />
&nbsp;mi=<span style="color: #aaffff; font-weight: bold;">After</span> mi<br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Return</span> mi\name$<br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<p>Сначала в строках Data пишется название подменю, затем открывающая фигурная скобка ("{"), затем пункты этого подменю, затем закрывающая фигурная скобка ("}"), следующее подменю, ... , маркер конца меню("===Конец==="). Тестовая программа:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Include</span> <span style="color: #00ff66;">&quot;Menu.bb&quot;</span><br />
<p><br />
<span style="color: #aaffff; font-weight: bold;">Global</span> ent$=<span style="color: #aaffff; font-weight: bold;">Chr</span>$<span style=" ">&#40;</span><span style="color: #33ffdd;">13</span><span style=" ">&#41;</span>+<span style="color: #aaffff; font-weight: bold;">Chr</span>$<span style=" ">&#40;</span><span style="color: #33ffdd;">10</span><span style=" ">&#41;</span>,filename$<br />
<br />
<span style="color: #aaffff; font-weight: bold;">Global</span> win=CreateWindow<span style=" ">&#40;</span><span style="color: #00ff66;">&quot;&quot;</span>,ClientWidth<span style=" ">&#40;</span>Desktop<span style=" ">&#40;</span><span style=" ">&#41;</span><span style=" ">&#41;</span>/<span style="color: #33ffdd;">2</span><span style="color: #33ffdd;">-300</span>,ClientHeight<span style=" ">&#40;</span>Desktop<span style=" ">&#40;</span><span style=" ">&#41;</span><span style=" ">&#41;</span>/<span style="color: #33ffdd;">2</span><span style="color: #33ffdd;">-200</span>,<span style="color: #33ffdd;">600</span>,<span style="color: #33ffdd;">400</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">7</span><span style=" ">&#41;</span><br />
filename_change <span style="color: #00ff66;">&quot;untitled.txt&quot;</span><br />
Menu_Create win<br />
<span style="color: #aaffff; font-weight: bold;">Global</span> ta=CreateTextArea<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">10</span>,win<span style=" ">&#41;</span><br />
ta_resize<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Select</span> WaitEvent<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> $<span style="color: #33ffdd;">1001</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Select</span> menuitem_name<span style=" ">&#40;</span>EventData<span style=" ">&#40;</span><span style=" ">&#41;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;Новый&quot;</span><br />
&nbsp; &nbsp; &nbsp;filename_change <span style="color: #00ff66;">&quot;untitled.txt&quot;</span><br />
&nbsp; &nbsp; &nbsp;SetTextAreaText ta,<span style="color: #00ff66;">&quot;&quot;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;Открыть...&quot;</span><br />
&nbsp; &nbsp; &nbsp;file$=RequestFile<span style=" ">&#40;</span><span style="color: #00ff66;">&quot;Открыть файл...&quot;</span>,<span style="color: #00ff66;">&quot;txt,*&quot;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> file$&lt;&gt;<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> doc_load file$<br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;Сохранить...&quot;</span><br />
&nbsp; &nbsp; &nbsp;doc_save<br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;Сохранить как...&quot;</span><br />
&nbsp; &nbsp; &nbsp;file$=RequestFile<span style=" ">&#40;</span><span style="color: #00ff66;">&quot;Сохранить файл как...&quot;</span>,<span style="color: #00ff66;">&quot;txt,*&quot;</span>,<span style="color: #aaffff; font-weight: bold;">True</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> file$&lt;&gt;<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp; filename_change file$<br />
&nbsp; &nbsp; &nbsp; doc_save<br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;Выход&quot;</span>:<span style="color: #aaffff; font-weight: bold;">Exit</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;Помощь&quot;</span>:Notify <span style="color: #00ff66;">&quot;звони в 03 ((C) В.Н.Машков)&quot;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;О программе...&quot;</span>:Notify <span style="color: #00ff66;">&quot;Простой текстовый редактор&quot;</span>+ent$+<span style="color: #00ff66;">&quot;Автор: Матвей Меркулов&quot;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End Select</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> $<span style="color: #33ffdd;">802</span>:ta_resize<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> $<span style="color: #33ffdd;">803</span>:<span style="color: #aaffff; font-weight: bold;">Exit</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">End Select</span><br />
<span style="color: #aaffff; font-weight: bold;">Forever</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;Файл&quot;</span>,<span style="color: #00ff66;">&quot;{&quot;</span>,<span style="color: #00ff66;">&quot;Новый&quot;</span>,<span style="color: #00ff66;">&quot;Открыть...&quot;</span>,<span style="color: #00ff66;">&quot;Сохранить...&quot;</span>,<span style="color: #00ff66;">&quot;Сохранить как...&quot;</span>,<span style="color: #00ff66;">&quot;&quot;</span>,<span style="color: #00ff66;">&quot;Выход&quot;</span>,<span style="color: #00ff66;">&quot;}&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;Справка&quot;</span>,<span style="color: #00ff66;">&quot;{&quot;</span>,<span style="color: #00ff66;">&quot;Помощь&quot;</span>,<span style="color: #00ff66;">&quot;О программе...&quot;</span>,<span style="color: #00ff66;">&quot;}&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;===Конец===&quot;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> ta_resize<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
SetGadgetShape ta,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,ClientWidth<span style=" ">&#40;</span>win<span style=" ">&#41;</span>,ClientHeight<span style=" ">&#40;</span>win<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> filename_change<span style=" ">&#40;</span>file$<span style=" ">&#41;</span><br />
filename$=file$<br />
SetGadgetText win,<span style="color: #00ff66;">&quot;Простой текстовый редактор - &quot;</span>+filename$<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> doc_load<span style=" ">&#40;</span>file$<span style=" ">&#41;</span><br />
filename_change file$<br />
f=<span style="color: #aaffff; font-weight: bold;">ReadFile</span><span style=" ">&#40;</span>file$<span style=" ">&#41;</span><br />
LockTextArea ta<br />
SetTextAreaText ta,<span style="color: #00ff66;">&quot;&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">While</span> <span style="color: #aaffff; font-weight: bold;">Not</span> <span style="color: #aaffff; font-weight: bold;">Eof</span><span style=" ">&#40;</span>f<span style=" ">&#41;</span><br />
&nbsp;AddTextAreaText ta,<span style="color: #aaffff; font-weight: bold;">ReadLine</span>$<span style=" ">&#40;</span>f<span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">Not</span> <span style="color: #aaffff; font-weight: bold;">Eof</span><span style=" ">&#40;</span>f<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> AddTextAreaText ta,ent$<br />
<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<span style="color: #aaffff; font-weight: bold;">CloseFile</span> f<br />
UnlockTextArea ta<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> doc_save<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
f=<span style="color: #aaffff; font-weight: bold;">WriteFile</span><span style=" ">&#40;</span>filename$<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteLine</span> f,TextAreaText$<span style=" ">&#40;</span>ta<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">CloseFile</span> f<br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<div align="right"><a href="http://blitzetcetera.org/images/5/57/Menu.zip" class="internal" title="Menu.zip">скачать архив с файлами к статье</a></div>
<hr />
<p>Автор: <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Matt_Merkulov" title="Участник:Matt Merkulov">Матвей Меркулов</a> (E-mail: MattMerk@mail.ru, ICQ: 392-274-050)
</p><!-- 
Pre-expand include size: 3127 bytes
Post-expand include size: 406 bytes
Template argument size: 15 bytes
Maximum: 2097152 bytes
-->

<!-- Saved in parser cache with key db1:pcache:idhash:669-0!1!0!!ru!2 and timestamp 20071110033658 -->
<div class="printfooter">
Получено с <a href="3fglr5kz.html">http://blitzetcetera.org/index.php/%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BC%D0%B5%D0%BD%D1%8E_%D0%B2_BlitzPlus</a></div>
			<!-- end content -->			<div class="visualClear"></div>				</td>				<td class="rightside">				</td>			</tr>		</table>		</div>	</div>		</div>	
		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
</div></body>
<!-- Mirrored from localhost/index.php/%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BC%D0%B5%D0%BD%D1%8E_%D0%B2_BlitzPlus by HTTrack Website Copier/3.x [XR&CO'2007], Sat, 10 Nov 2007 05:16:33 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
</html>