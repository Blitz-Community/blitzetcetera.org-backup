<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru" dir="ltr">	
<!-- Mirrored from localhost/index.php/%D0%A0%D0%B0%D0%B1%D0%BE%D1%82%D0%B0_%D1%81_%D0%A1%D0%B5%D1%82%D1%8C%D1%8E_%D0%B2_Blitz3D:_HTTP by HTTrack Website Copier/3.x [XR&CO'2007], Mon, 12 Nov 2007 11:20:39 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
<head>		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />				<meta name="keywords" content="Работа с Сетью в Blitz3D: HTTP,Tadeus" />
		<link rel="shortcut icon" href="http://blitzetcetera.org/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="http://blitzetcetera.org/opensearch_desc.php" title="Blitz Et Cetera (Русский)" />
		<title>Работа с Сетью в Blitz3D: HTTP — Blitz Et Cetera</title>		<style type="text/css" media="screen,projection">/*<![CDATA[*/ @import "bvih5rde.css?63"; /*]]>*/</style>		<link rel="stylesheet" type="text/css" media="print" href="gcxktlm6.css?63" />		<link rel="stylesheet" type="text/css" media="handheld" href="zumsslq_.css?63" />		<!--[if lt IE 5.5000]><style type="text/css">@import "/skins/OfflineNew/IE50Fixes.css?63";</style><![endif]-->		<!--[if IE 5.5000]><style type="text/css">@import "/skins/OfflineNew/IE55Fixes.css?63";</style><![endif]-->		<!--[if IE 6]><style type="text/css">@import "/skins/OfflineNew/IE60Fixes.css?63";</style><![endif]-->		<!--[if IE 7]><style type="text/css">@import "/skins/OfflineNew/IE70Fixes.css?63";</style><![endif]-->		<!--[if lt IE 7]><script type="text/javascript" src="/skins/common/IEFixes.js?63"></script>		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->		<script type= "text/javascript">/*<![CDATA[*/
var skin = "OfflineNew";
var stylepath = "/skins";
var wgArticlePath = "/index.php/$1";
var wgScriptPath = "";
var wgServer = "http://blitzetcetera.org/";
var wgCanonicalNamespace = "";
var wgCanonicalSpecialPageName = false;
var wgNamespaceNumber = 0;
var wgPageName = "Работа_с_Сетью_в_Blitz3D:_HTTP";
var wgTitle = "Работа с Сетью в Blitz3D: HTTP";
var wgAction = "view";
var wgArticleId = "1762";
var wgIsArticle = true;
var wgUserName = null;
var wgUserGroups = null;
var wgUserLanguage = "ru";
var wgContentLanguage = "ru";
var wgBreakFrames = false;
var wgCurRevisionId = "3259";
/*]]>*/</script>
		<script type="text/javascript" src="2nq-6cel.js?63"><!-- wikibits js --></script>		<script type="text/javascript" src="http://blitzetcetera.org/index.php?title=-&amp;action=raw&amp;gen=js"><!-- site js --></script>		<style type="text/css">/*<![CDATA[*/
@import "http://blitzetcetera.org/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://blitzetcetera.org/index.php?title=MediaWiki:OfflineNew.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://blitzetcetera.org/index.php?title=-&amp;action=raw&amp;gen=css&amp;maxage=18000";
/*]]>*/</style>		<!-- Head Scripts -->	</head><body  class="mediawiki ns-0 ltr page-Работа_с_Сетью_в_Blitz3D_HTTP">	<div id="globalWrapper">	<div id="logocontainer">		<table align="center">		  <tr>				<td id="blitzetclogo">				</td>			</tr>		</table>	</div>	<div id="magbar">	Журнал о программированнии на языках Blitz3D, BlitzMax, BlitzPlus	</div>		<div id="column-content">	<div id="content">		<a name="top" id="top"></a>				<div id="bodyContent">		<table cellspacing=0 cellpadding=0 width=100%>			<tr>			  <td class="leftside">				</td>				<td class="sheetbody">					<h1 class="sheet">Работа с Сетью в Blitz3D: HTTP</h1>			<h3 id="siteSub">Материал из Blitz Et Cetera.</h3>			<div id="contentSub"></div>			<!-- start content -->			<p>Итак, давайте сначала обьясню для тех кто не знает: HTTP(с англ. HyperText Transfer Protocol) - протокол передачи гипертекста или,если проще, web-страниц. Где он используется? Да практически везде! Если раньше, использовали только для получения web-страниц, то сейчас его используют в MMORPG. Примеры? Да почти все они на нем основанны. Но если все же вам нужен пример, я его приведу: World of Warcraft. Но я буду (по крайней мере в этой статье) описывать HTTP как средства доступа к ресурсам Интернета и взаимодействия с этими ресурсами.
</p><p>Далее, HTTP стоит над ТСР и использует порт 80. Для того, чтобы продолжить, вы должны уметь работать с ТСР. Если же нет, прочтите мою статью на BlitzEtCetera.org Ну-с приступим.
</p><p>Какой сайт мы будем получать? Давайте офф. сайт блица:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">pot=<span style="color: #aaffff; font-weight: bold;">OpenTCPStream</span><span style=" ">&#40;</span><span style="color: #00ff66;">&quot;www.blitzbasic.com&quot;</span>,<span style="color: #33ffdd;">80</span><span style=" ">&#41;</span><br />
<p><span style="color: #aaffff; font-weight: bold;">WriteLine</span> pot,<span style="color: #00ff66;">&quot;GET /index.php HTTP/1.0&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteLine</span> pot,<span style="color: #aaffff; font-weight: bold;">Chr</span>$<span style=" ">&#40;</span><span style="color: #33ffdd;">10</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">While</span> <span style="color: #aaffff; font-weight: bold;">Not</span> <span style="color: #aaffff; font-weight: bold;">Eof</span><span style=" ">&#40;</span>pot<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Print</span> <span style="color: #aaffff; font-weight: bold;">ReadLine</span>$<span style=" ">&#40;</span>pot<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<span style="color: #aaffff; font-weight: bold;">WaitKey</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">End</span></div>
<p>Запускаем и ура, получилось! Итак, сначала мы открываем поток на адресс www.blitzbasic.com на порте 80. Затем мы подаем туда запрос GET. Что в этом запросе надо указывать? Во-первых, нужную страницу. Если указывается общий адресс, вида www.microsoft.com, www.blitzbasic.com, www.icq.com и т.д., то загружается страница с именем index: index.htm, index.php и т.д. Далее идет версия протокола. Вообще, следует посмотреть, какую версию HTTP использует сервер и потом уже слать запрос. На некоторых неправильно срабатывает запрос с версией 1.0, на других - с 1.1 короче надо проверять. Далее, мы посылаем символ Chr$(10) то есть переход на новую строку, чтобы показать, что текст запроса окончен. 
</p><p>Продолжим. Желательно также вставлять в запрос команду Host - она показывает к какому серверу подключатся. Вы спросите, но ведь мы адресс сервера указали в OpenTCPStream! Зачем еще раз? Ответ прост: прокси. То есть если у вас Интернет через прокси, то в OpenTCPStream вы должны указать IP-адресс прокси и обязательно указать Host. Чтобы правильно подключится. Приведу пример с функцией:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Global</span> BR$ = <span style="color: #aaffff; font-weight: bold;">Chr</span>$<span style=" ">&#40;</span><span style="color: #33ffdd;">13</span><span style=" ">&#41;</span>+<span style="color: #aaffff; font-weight: bold;">Chr</span>$<span style=" ">&#40;</span><span style="color: #33ffdd;">10</span><span style=" ">&#41;</span><br />
<p><span style="color: #ffee00">;1. обычный запрос веб-страницы</span><br />
tcp = GetHttp<span style=" ">&#40;</span><span style="color: #00ff66;">&quot;www.microsoft.com&quot;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> tcp = <span style="color: #aaffff; font-weight: bold;">False</span> <span style="color: #aaffff; font-weight: bold;">RuntimeError</span> <span style="color: #00ff66;">&quot;unable to connect to web server&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">While</span> <span style="color: #aaffff; font-weight: bold;">Eof</span><span style=" ">&#40;</span>tcp<span style=" ">&#41;</span> = <span style="color: #aaffff; font-weight: bold;">False</span><br />
<span style="color: #aaffff; font-weight: bold;">Print</span> <span style="color: #aaffff; font-weight: bold;">ReadLine</span>$<span style=" ">&#40;</span>tcp<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<span style="color: #aaffff; font-weight: bold;">CloseTCPStream</span><span style=" ">&#40;</span>tcp<span style=" ">&#41;</span><br />
<br />
<span style="color: #ffee00">; 2. запрос страницы через прокси-сервер с адресом 192.168.0.1 и портом 80</span><br />
tcp = GetHttp<span style=" ">&#40;</span><span style="color: #00ff66;">&quot;www.microsoft.com&quot;</span>, <span style="color: #33ffdd;">80</span>,<span style="color: #00ff66;">&quot;192.168.0.1&quot;</span>, <span style="color: #33ffdd;">80</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> tcp = <span style="color: #aaffff; font-weight: bold;">False</span> <span style="color: #aaffff; font-weight: bold;">RuntimeError</span> <span style="color: #00ff66;">&quot;unable to connect to web server&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">While</span> <span style="color: #aaffff; font-weight: bold;">Eof</span><span style=" ">&#40;</span>tcp<span style=" ">&#41;</span> = <span style="color: #aaffff; font-weight: bold;">False</span><br />
<span style="color: #aaffff; font-weight: bold;">Print</span> <span style="color: #aaffff; font-weight: bold;">ReadLine</span>$<span style=" ">&#40;</span>tcp<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<span style="color: #aaffff; font-weight: bold;">CloseTCPStream</span><span style=" ">&#40;</span>tcp<span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">WaitKey</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">End</span><br />
<br />
<span style="color: #ffee00">;========================================</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> GetHttp<span style=" ">&#40;</span>server$, port=<span style="color: #33ffdd;">80</span>, proxy$=<span style="color: #00ff66;">&quot;&quot;</span>,proxyport=<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Local</span> www<br />
<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>proxy$<span style=" ">&#41;</span> = <span style="color: #33ffdd;">0</span> proxy$ = server$<br />
<span style="color: #aaffff; font-weight: bold;">If</span> proxyport = <span style="color: #33ffdd;">0</span> proxyport = port<br />
www = <span style="color: #aaffff; font-weight: bold;">OpenTCPStream</span><span style=" ">&#40;</span>proxy$,proxyport<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> www = <span style="color: #aaffff; font-weight: bold;">False</span> <span style="color: #aaffff; font-weight: bold;">Return</span> <span style="color: #aaffff; font-weight: bold;">False</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteLine</span> www,<span style="color: #00ff66;">&quot;GET http://&quot;</span> + server$ + <span style="color: #00ff66;">&quot;:&quot;</span> + port + path$ + <span style="color: #00ff66;">&quot; HTTP/1.1&quot;</span> + BR$ + <span style="color: #00ff66;">&quot;Host: &quot;</span> + server$ + BR$ + <span style="color: #00ff66;">&quot;User-Agent: blitzbasic&quot;</span> + BR$ + <span style="color: #00ff66;">&quot;Accept: */*&quot;</span> + BR$<br />
<span style="color: #aaffff; font-weight: bold;">Return</span> www<br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<p>Ах, да. Просматривая функцию вы могли заметитьть неизвестные команды. Также видно, что они разделенны символом Chr$(13)+Chr$(10) Что ж, так тоже можно, а теперь насчет команд:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">User-Agent: blitzbasic</div>
<p>Используется, чтобы показать, через какую программу делается запрос. Не особо существенно, чесно говоря.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">Accept: */*</div>
<p>Честно говоря, с этой командой не разобрался.
</p><p>Также вы можете заметить что уже в данном примере, используется версия 1.1
</p><p>Вот. Теперь, пожалуй, самый частозадаваемый вопрос по HTTP: допустим, на странице есть формы, как эти формы заполнить и отправить на сервер? Из программы. Это несложно. Но для начала немного теории. Для отправки данных есть два метода GET и POST. В чем различие? А в том, что с помощью GET-метода ты как бы передаешь через адресс, а с методом POST - напрямую. В связи с этим, хочется сказать, если есть форма, содержимое которой посылается на e-mail, там ВСЕГДА должен быть записан и использовал метод POST.
</p><p>Далее, предполагается, что вы хотя бы немного знаете HTML - язык разметки гипертекста. Тэкс, открываем блокнот и пишем значится:
</p>
<div class="xml" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;"><span style="color: #009900;"><span style="font-weight: bold; color: black;">&lt;form</span> <span style="color: #000066;">action</span>=<span style="color: #ff0000;">&quot;login.php&quot;</span> <span style="color: #000066;">method</span>=get <span style="color: #000066;">enctype</span>=text/plain<span style="font-weight: bold; color: black;">&gt;</span></span><br />
<p>Логин:<br />
<span style="color: #009900;"><span style="font-weight: bold; color: black;">&lt;input</span> <span style="color: #000066;">type</span>=text <span style="color: #000066;">name</span>=login<span style="font-weight: bold; color: black;">&gt;</span></span><br />
Пароль:<br />
<span style="color: #009900;"><span style="font-weight: bold; color: black;">&lt;input</span> <span style="color: #000066;">type</span>=text <span style="color: #000066;">name</span>=password<span style="font-weight: bold; color: black;">&gt;</span></span><br />
</p>
<span style="color: #009900;"><span style="font-weight: bold; color: black;">&lt;/form<span style="font-weight: bold; color: black;">&gt;</span></span></span></div>
<p>Итак, мы создали такую вот страничку в Интернете. Теперь, как из Блица послать на login.php данные? В данном случае мы сделаем методом GET:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">pot=<span style="color: #aaffff; font-weight: bold;">OpenTCPStream</span><span style=" ">&#40;</span><span style="color: #00ff66;">&quot;vasya.com&quot;</span><span style=" ">&#41;</span><br />
<p><span style="color: #aaffff; font-weight: bold;">WriteLine</span> pot,<span style="color: #00ff66;">&quot;GET login.php?login=Vasya&amp;password=qwerty HTTP/1.0&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteLine</span> pot,<span style="color: #00ff66;">&quot;Host: vasya.com&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteLine</span> pot,<span style="color: #aaffff; font-weight: bold;">Chr</span>$<span style=" ">&#40;</span><span style="color: #33ffdd;">10</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">While</span> <span style="color: #aaffff; font-weight: bold;">Not</span> <span style="color: #aaffff; font-weight: bold;">Eof</span><span style=" ">&#40;</span>pot<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Print</span> <span style="color: #aaffff; font-weight: bold;">ReadLine</span>$<span style=" ">&#40;</span>pot<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<span style="color: #aaffff; font-weight: bold;">WaitKey</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">End</span></div>
<p>Как я уже говорил, при GET-методе параметры передаются в заголовке. Далее, считываем, что нам отвечает сервер. Не правда ли просто? А теперь давайте тоже повторим с методом POST. Не забудьте на нашей web-странице в теге &lt;form&gt; заменить параметр method=get на method=post Далее код для блица:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">pot=<span style="color: #aaffff; font-weight: bold;">OpenTCPStream</span><span style=" ">&#40;</span><span style="color: #00ff66;">&quot;vasya.com&quot;</span><span style=" ">&#41;</span><br />
<p><span style="color: #aaffff; font-weight: bold;">WriteLine</span> pot,<span style="color: #00ff66;">&quot;POST login.php HTTP/1.0&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteLine</span> pot,<span style="color: #00ff66;">&quot;Host: vasya.com&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteLine</span> pot,<span style="color: #aaffff; font-weight: bold;">Chr</span><span style=" ">&#40;</span><span style="color: #33ffdd;">13</span><span style=" ">&#41;</span>+<span style="color: #aaffff; font-weight: bold;">Chr</span><span style=" ">&#40;</span><span style="color: #33ffdd;">10</span><span style=" ">&#41;</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">WriteLine</span> pot,<span style="color: #00ff66;">&quot;login=Vasya&amp;password=qwerty&quot;</span></div>
<p>Как видите, команды непосредственно разделенны от параметров строкой Chr(13)+Chr(10)
</p><p>Вот и все, что я собирался рассказать. Удачи
</p><p>С Уважением, <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Tadeus" title="Участник:Tadeus">Волошин Леонид аka Tadeus</a>
</p>
<!-- Saved in parser cache with key db1:pcache:idhash:1762-0!1!0!!ru!2 and timestamp 20071112105822 -->
<div class="printfooter">
Получено с <a href="v50nq55y.html">http://blitzetcetera.org/index.php/%D0%A0%D0%B0%D0%B1%D0%BE%D1%82%D0%B0_%D1%81_%D0%A1%D0%B5%D1%82%D1%8C%D1%8E_%D0%B2_Blitz3D:_HTTP</a></div>
			<!-- end content -->			<div class="visualClear"></div>				</td>				<td class="rightside">				</td>			</tr>		</table>		</div>	</div>		</div>	
		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
</div></body>
<!-- Mirrored from localhost/index.php/%D0%A0%D0%B0%D0%B1%D0%BE%D1%82%D0%B0_%D1%81_%D0%A1%D0%B5%D1%82%D1%8C%D1%8E_%D0%B2_Blitz3D:_HTTP by HTTrack Website Copier/3.x [XR&CO'2007], Mon, 12 Nov 2007 11:20:39 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
</html>