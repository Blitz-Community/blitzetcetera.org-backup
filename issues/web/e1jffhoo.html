<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru" dir="ltr">	
<!-- Mirrored from localhost/index.php/%D0%92%D1%8B%D0%BF%D1%83%D1%81%D0%BA_%E2%84%964_-_%D0%B8%D1%8E%D0%BD%D1%8C_2005 by HTTrack Website Copier/3.x [XR&CO'2007], Mon, 12 Nov 2007 11:20:32 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
<head>		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />				<meta name="keywords" content="Выпуск №4 - июнь 2005,Alrusdi,MANIAK dobrii,Matt Merkulov" />
		<link rel="shortcut icon" href="http://blitzetcetera.org/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="http://blitzetcetera.org/opensearch_desc.php" title="Blitz Et Cetera (Русский)" />
		<title>Выпуск №4 - июнь 2005 — Blitz Et Cetera</title>		<style type="text/css" media="screen,projection">/*<![CDATA[*/ @import "bvih5rde.css?63"; /*]]>*/</style>		<link rel="stylesheet" type="text/css" media="print" href="gcxktlm6.css?63" />		<link rel="stylesheet" type="text/css" media="handheld" href="zumsslq_.css?63" />		<!--[if lt IE 5.5000]><style type="text/css">@import "/skins/OfflineNew/IE50Fixes.css?63";</style><![endif]-->		<!--[if IE 5.5000]><style type="text/css">@import "/skins/OfflineNew/IE55Fixes.css?63";</style><![endif]-->		<!--[if IE 6]><style type="text/css">@import "/skins/OfflineNew/IE60Fixes.css?63";</style><![endif]-->		<!--[if IE 7]><style type="text/css">@import "/skins/OfflineNew/IE70Fixes.css?63";</style><![endif]-->		<!--[if lt IE 7]><script type="text/javascript" src="/skins/common/IEFixes.js?63"></script>		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->		<script type= "text/javascript">/*<![CDATA[*/
var skin = "OfflineNew";
var stylepath = "/skins";
var wgArticlePath = "/index.php/$1";
var wgScriptPath = "";
var wgServer = "http://blitzetcetera.org/";
var wgCanonicalNamespace = "";
var wgCanonicalSpecialPageName = false;
var wgNamespaceNumber = 0;
var wgPageName = "Выпуск_№4_-_июнь_2005";
var wgTitle = "Выпуск №4 - июнь 2005";
var wgAction = "view";
var wgArticleId = "607";
var wgIsArticle = true;
var wgUserName = null;
var wgUserGroups = null;
var wgUserLanguage = "ru";
var wgContentLanguage = "ru";
var wgBreakFrames = false;
var wgCurRevisionId = "3641";
/*]]>*/</script>
		<script type="text/javascript" src="2nq-6cel.js?63"><!-- wikibits js --></script>		<script type="text/javascript" src="http://blitzetcetera.org/index.php?title=-&amp;action=raw&amp;gen=js"><!-- site js --></script>		<style type="text/css">/*<![CDATA[*/
@import "http://blitzetcetera.org/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://blitzetcetera.org/index.php?title=MediaWiki:OfflineNew.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://blitzetcetera.org/index.php?title=-&amp;action=raw&amp;gen=css&amp;maxage=18000";
/*]]>*/</style>		<!-- Head Scripts -->	</head><body  class="mediawiki ns-0 ltr page-Выпуск_№4_-_июнь_2005">	<div id="globalWrapper">	<div id="logocontainer">		<table align="center">		  <tr>				<td id="blitzetclogo">				</td>			</tr>		</table>	</div>	<div id="magbar">	Журнал о программированнии на языках Blitz3D, BlitzMax, BlitzPlus	</div>		<div id="column-content">	<div id="content">		<a name="top" id="top"></a>				<div id="bodyContent">		<table cellspacing=0 cellpadding=0 width=100%>			<tr>			  <td class="leftside">				</td>				<td class="sheetbody">					<h1 class="sheet">Выпуск №4 - июнь 2005</h1>			<h3 id="siteSub">Материал из Blitz Et Cetera.</h3>			<div id="contentSub"></div>			<!-- start content -->			<a name="Contents"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%92%D1%8B%D0%BF%D1%83%D1%81%D0%BA_%E2%84%964_-_%D0%B8%D1%8E%D0%BD%D1%8C_2005&amp;action=edit&amp;section=1" title="Править секцию: Contents">править</a>]</span> <span class="mw-headline">Contents</span></h2>
<ul><li>Вступление
<ul><li><a href="#Предисловие редактора (выпуск 4)">Предисловие редактора (выпуск 4)</a>
</li><li><a href="#Почта (выпуск 4)">Почта (выпуск 4)</a>
</li><li><a href="#Результаты конкурса (выпуск 4)">Результаты конкурса (выпуск 4)</a>
</li></ul>
</li><li>Обзор
<ul><li><a href="#Обзор технологий, используемых в играх">Обзор технологий, используемых в играх</a> - <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Matt_Merkulov" title="Участник:Matt Merkulov">Матвей Меркулов</a> 
</li><li><a href="#3D-акселераторы">3D-акселераторы</a> - Дмитрий Татаринов 
</li></ul>
</li><li>Тонкости кодинга
<ul><li><a href="#Работа со списками">Работа со списками</a> - Amir 
</li><li><a href="#Как создавать и править модули">Как создавать и править модули</a> - Bot Builder, перевел <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:MANIAK_dobrii" title="Участник:MANIAK dobrii">MANIAK dobrii</a> 
</li><li><a href="#Древовидная структура">Древовидная структура</a> - <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Matt_Merkulov" title="Участник:Matt Merkulov">Матвей Меркулов</a> 
</li></ul>
</li><li>Другой формат
<ul><li><a href="#Неофициальная спецификация формата файлов «B3D» V0.2">Неофициальная спецификация формата файлов «B3D» V0.2</a> - <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Alrusdi" title="Участник:Alrusdi">Александр Альрушди</a> 
</li></ul>
</li><li>Разработки
<ul><li><a href="#Виртуальный художник: линейные (матричные) фильтры">Виртуальный художник: линейные (матричные) фильтры</a> - Хван И. Ю. 
</li><li><a href="#2D Объекты-капли в Max2D">2D Объекты-капли в Max2D</a> - AngelDaniel, перевел <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:MANIAK_dobrii" title="Участник:MANIAK dobrii">MANIAK dobrii</a> 
</li><li><a href="#Текстовые адвентюры">Текстовые адвентюры</a> - <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Matt_Merkulov" title="Участник:Matt Merkulov">Матвей Меркулов</a> 
</li></ul>
</li><li>Дизайнеру
<ul><li><a href="#Демонический МАКС">Демонический МАКС</a> - Федор Галков, OCR: Святослав 
</li><li><a href="#Страна советов - Max и не только">Страна советов - Max и не только</a> - <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Alrusdi" title="Участник:Alrusdi">Александр Альрушди</a> 
</li><li><a href="#Видеопост">Видеопост</a> - Дмитрий Садченко 
</li></ul>
</li><li>Свободный полет
<ul><li><a href="#Хумор: Пёрлы на GameDev.ru">Хумор: Пёрлы на GameDev.ru</a> - <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Alrusdi" title="Участник:Alrusdi">Александр Альрушди</a> 
</li></ul>
</li><li>В заключение
<ul><li><a href="#Конкурс! (выпуск 4)">Конкурс! (выпуск 4)</a>
</li><li><a href="#В следующем выпуске (выпуск 4)">В следующем выпуске (выпуск 4)</a>
</li></ul>
</li></ul>
<p></td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Предисловие редактора (выпуск 4)"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Предисловие редактора (выпуск 4)&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Предисловие редактора (выпуск 4)&amp;action=edit">править</a>]</span><span class="mw-headline">Предисловие редактора (выпуск 4)</span></h1>
<p>Вот и выпуск №4. Не думал, что объем и сложность статей разрастутся до такой степени. В итоге - задержка, ну да она ИМО стоит того.
</p>
</p><p>Как видите, в этот раз много нововведений - появилась возможность подписки и первая версия задокументированной политики журнала. Внимание авторам статей: если Вы хотите изменить имя, под которым опубликована Ваша статья или внести коррективы в статью - напишите мне.
</p><p>Далее Вы сможете прочитать масштабную статью по обзору технологий, использующихся в компьютерных играх, а также обзор 3D-акселераторов и видеокарт с 3D-ускорением, любезно предоставленный Дмитрием Татариновым. По традиции, в журнале переводы Михаила Солодовниченко (статьи про объекты-капли и создание модулей в BlitzMax), статья о структуре используемого в Blitz формата трехмерных объектов B3D, переведенная Александром Альрушди, цикл "Виртуальный художник" продолжает И. Ю. Хван. А я предлагаю взглянуть на разработанную мной довольно продвинутую систему манипуляций с объектами в играх на примере текстовых приключенческих игр. В разделе "Дизайнеру" снова отсканированная Святославом статья про 3DS Max, на этот раз - о создании модели, а также небольшая заметка Дмитрия Садченко о том, что такое видеопост и с чем его едят.
</p><p>В приложении к этому выпуску - объемный реферат Дмитрия Садченко, в котором большое внимание уделено описанию Blitz-команд, а также приведена Blitz-программа модели идеального газа.
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Почта (выпуск 4)"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Почта (выпуск 4)&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Почта (выпуск 4)&amp;action=edit">править</a>]</span><span class="mw-headline">Почта (выпуск 4)</span></h1>
</p>
<a name=".D0.9F.D0.B8.D1.81.D1.8C.D0.BC.D0.BE_.D0.BE.D1.82_Alexander_Alrusdi"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9F%D0%BE%D1%87%D1%82%D0%B0_%28%D0%B2%D1%8B%D0%BF%D1%83%D1%81%D0%BA_4%29&amp;action=edit&amp;section=1" title="Почта (выпуск 4)">править</a>]</span> <span class="mw-headline">Письмо от Alexander Alrusdi</span></h2>
<p>Привет. А можно личный вопрос? Частое использование HTML таблиц - это мода или привязанность? Просто хотел рацпредложение внести, но чуть с ума не сдвинулся, просматривая код. И теги почему-то открываются, а закрываться забывают (особенно TR на большом расстоянии.) Конечно Ослик(он же Нав, он же Мазила, он же Опер) не дурак и разберется что к чему, но я... Ладно, даже интересно было.
</p><p>А предложить я хотел встроить возможность сворачивать/разворачивать слишком длинные разделы кликом по заголовку. Есть скрипт (сущий пустяк), предполагающий некоторый гимор в HTML, т.е. нужно определить объект по которому щелкать, чтобы раздел свернулся (разумеется, строка заголовка) для чего в тег TR добавляем class="Collapser" и child="уникальный id сворачиваемой части". Заключаем содержание (в нашем случае таблицу которая txt) в тег div задав ему тот самый уникальный id - и все! Скрипт collapser.htc прилагается (обычный текстовый, а расширение - понты, но менять нельзя:), путь к нему указать в ids.htm, добавив строку
<p>.Collapser {behavior:url("КудыКласть/collapser.htc")} 
</p>
</p><p>Ох... Не ожидал, что публикация материалов производится столь оперативно. Прислал черновик и в первом же номере анонс публикации. Я как-то предполагал целый цикл согласований - проверки - исправлений. На самом деле, черновик перевода (про B3D) изобиловал ошибками (кстати, приношу извинения) - к письму прилагается дополненная и исправленная версия. 
</p><p>Идея бумажной публикации хороша, но я бы порекоменовал, в этом случае, не использовать ранее опубликованные материалы или просить подателей четко указывать, откуда они заимствованы. В частности статья про 3D Studio Max из №3 - прямая цитата из журнала Хакер-дизайн. Что касается моего - статья о B3D перевод онлайновой статьи (авторство указано). Часть Страны советов (касающаяся Макса) позаимствована из популярной книги "3DStudio Max 5" (к сожалению, не помню автора). Остальное hand made. На мой взгляд, именно hand made следует предпочесть при выборе публикаций, а при необходимости заказывать нужный материал (который народ просит) на форуме Блиц. Думаю, энтузиасты найдутся. Во всяком случае, на меня можно расcчитывать (конечно в меру компетентности).
</p><p>Рад присоединиться к похвалам за хорошую работу и желаю удачи. 
</p>
<hr />
<p>Привет.
</p><p>Я использую только HTML по двум причинам:
</p>
<ol><li>Пока нет идей, которые я не смог бы в нем реализовать (код на JS, если нужно, заимствую у других, немного подправив для себя)
</li></ol>
<ol><li>Предпочитаю овладевать тонкостями уже знакомого языка переходу на другой
</li></ol>
<p>Кстати, по этим же причинам программирую практически только на BASIC. Что касается кода, то незакрытых тегов, кажется, нет (как только появляются - сразу же все начинает выглядеть перекошенным). Код состоит из шаблонов, которые для удобства соединены в одну строку. Так что, для заголовков и программ - открывающий и закрывающий шаблон, в UltraEdit вставляется нажатием двух клавиш - довольно удобно. А в программы теги добавляет специально написанная утилита. Насчет таблиц - да по-другому, вроде и нельзя, а комплексность - из-за структуры.
</p><p>Сворачивать статьи, на мой взгляд, нет смысла - всегда можно вернуться в оглавление и перейти на нужную, кликнув по ссылке.
</p><p>Ну а насчет публикаций, редактировать - это право автора. К первому выпуску, например, один автор прислал просто набор текстов, из которых я сам составлял статьи. Я публикую, как уже говорил, все, что приходит, только исправляя ошибки и форматируя текст. Не так много материала, чтобы им раскидываться. А насчет энтузиастов, готовых
<p>писать для журнала статьи про свои разработки - активность прекрасно видна из выпусков: пока что пишем только я да Роман Прядко. Впрочем, переводы - тоже неплохая вещь, как и статьи из других журналов (кстати, автор всегда указывается). Идея про статьи по заказу в идеале хороша, только не думаю, что вообще найдутся люди, которые будут этим заниматься (и деньги за это платить я не собираюсь, а если кто хочет быть спонсором - отлично - заказывайте статьи, платите за них, присылайте мне, а я опубликую). Да и как узнать, что конкретно больше всего нужно читателю - цели и мнения ведь у всех разные.
</p>
</p><p>А за поддержку спасибо - буду рад новым материалам, особенно авторским разработкам. Качество статей тоже ценится (в том числе и читателями).
</p><p>Всего доброго<br />
<p>	Матвей Меркулов
</p>
</p>
<a name=".D0.9F.D0.B8.D1.81.D1.8C.D0.BC.D0.BE_.D0.BE.D1.82_.D0.A2.D0.B0.D1.82.D0.B0.D1.80.D0.B8.D0.BD.D0.BE.D0.B2.D0.B0_.D0.94.D0.BC.D0.B8.D1.82.D1.80.D0.B8.D1.8F"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9F%D0%BE%D1%87%D1%82%D0%B0_%28%D0%B2%D1%8B%D0%BF%D1%83%D1%81%D0%BA_4%29&amp;action=edit&amp;section=2" title="Почта (выпуск 4)">править</a>]</span> <span class="mw-headline">Письмо от Татаринова Дмитрия</span></h2>
<p>Привет! Хочу для начала просто сказать огромное "спасибо" за журнал. Ты делаешь нужное дело.  За которое не получаешь ничего материального&nbsp;:). Новичкам, в том числе и мне, журнал и статьи в нем помогают освоить много нюансов, до которых иногда приходиться доходить месяцами. Плюс - собранный по тематике материал - никогда не знаешь, что может понадобиться завтра, даже если сейчас тебе это и не нужно. Я тут написал статью по 3Д-акселераторам. Так уж получилось, что в железе я разбираюсь лучше чем в программировании. Надеюсь она будет кому-то  полезна. Опубликуй ее, если можно, в следующем номере. Если что - говори, какие может нужны доработки в статье.
С уважением Татаринов Дмитрий (ОАК).
</p>
<hr />
<p>Опубликую, конечно. И спасибо за поддержку.
</p><p>WBR, Matt
</p>
<a name=".D0.9F.D0.B8.D1.81.D1.8C.D0.BC.D0.BE_.D0.BE.D1.82_.D0.A1.D0.B2.D1.8F.D1.82.D0.BE.D1.81.D0.BB.D0.B0.D0.B2.D0.B0"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9F%D0%BE%D1%87%D1%82%D0%B0_%28%D0%B2%D1%8B%D0%BF%D1%83%D1%81%D0%BA_4%29&amp;action=edit&amp;section=3" title="Почта (выпуск 4)">править</a>]</span> <span class="mw-headline">Письмо от Святослава</span></h2>
<p>Yo
</p><p>Матвей ты не планируешь сделать несколько обзорных статей по созданию GUI меню и т.д. Просто на форуме эта тема поднималась неоднократно ,но вот хотелось бы увидеть что-нибудь этакое. Я не знаю может какие-то фишки в создании меню и переходов от одной части программы к другой. А лучше что-нить о создание редакторов с виндос подобным интерфейсом(возможностями блица). Я сам пока к сожалению предложить не чего не могу, у меня у самого возникают с этим проблемы, но к счастью они решаются потихоньку. Как ты на это смотришь?
</p>
<hr />
<p>Пока не планирую, хотя по этой теме можно написать многое. В принципе, читателям можно показать, как сделать GUI в Blitz3D с нуля, а можно рассмотреть уже сделанные GUI (обзор или описание одного из них) или технику написания программ на BlitzPlus (сам, кстати, часто его использую - очень удобно).
</p>
<a name=".D0.9F.D0.B8.D1.81.D1.8C.D0.BC.D0.BE_.D0.BE.D1.82_.D0.90.D0.BB.D0.B5.D0.BA.D1.81.D0.B5.D1.8F_.D0.9A.D0.BB.D1.8E.D0.B5.D0.B2.D0.B0"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9F%D0%BE%D1%87%D1%82%D0%B0_%28%D0%B2%D1%8B%D0%BF%D1%83%D1%81%D0%BA_4%29&amp;action=edit&amp;section=4" title="Почта (выпуск 4)">править</a>]</span> <span class="mw-headline">Письмо от Алексея Клюева</span></h2>
<p>Здравствуйте.
</p><p>Спасибо тебе огромное за твой замечательный журнал. Скачал 3 номера и читал практически взахлёб. Действительно круто и впечатляет, что столько всего можно создать с помощью замечательной программы Blitz3D. А могли бы вы сказать примерные сроки следующего номера? Могли бы вы встроить рассылку, которая извещает всех зарегистрированных пользователей о новом номере журнала. Кстати, можно сделать не журнал,а сайт,на котором постепенно в соответствующих разделах добавлять нужные статьи. Так сказать, помалу, но часто&nbsp;:) Прошу вас уделить подробнейшее внимание на создание собственного 3D мира (Начиная от ландшафта с цветочками и заканчивая кварталами многоэтажных зданий, в которые, непременно, можно заходить)
</p><p>Кстати, насчёт возможностей 2D: в GameMaker'e можно сделать качественные игры и вставлять туда скрипты любой сложности.В озможности практически не ограничены, но, к сожалению, GameMaker не поддерживает 3D, а мне непременно надо писать под 3D.
</p><p>Успехов в твоём просто замечательном деле.
</p>
<hr />
<p>Привет
</p>
<p><dl><dt>А могли бы вы сказать примерные сроки следующего номера?
</dt></dl>
</p>
<p>Думаю, не позже 10-го июля.
</p>
<p><dl><dt>Могли бы вы встроить рассылку, которая извещает всех зарегистрированных пользователей о новом номере журнала.
</dt></dl>
</p>
<p>Да, в следующем номере возможность подписаться будет. Решил сделать вручную.
</p>
<p><dl><dt>Кстати, можно сделать не журнал, а сайт, на котором постепенно в соответствующих разделах добавлять нужные статьи. Так сказать, помалу, но часто&nbsp;</dt><dd>)
</dd></dl>
</p>
<p>В идеале, конечно, было бы замечательно. Однако IMO так интерес снизится и статей будет меньше.
</p>
<p><dl><dt>Прошу вас уделить подробнейшее внимание на создание собственного 3D мира (Начиная от ландшафта с цветочками и заканчивая кварталами многоэтажных зданий, в которые, непременно, можно заходить)
</dt></dl>
</p>
<p>Хорошая идея. Вот, в 4-м выпуске будет большая обзорная статья по 3D технологиям, в какой-то мере можно будет отталкиваться от нее. Фактически, статьи на тему разработки отдельных элементов трехмерного мира уже есть, только не систематизированы.
</p>
<p><dl><dt>Успехов в твоём просто замечательном деле.
</dt></dl>
</p>
<p>Спасибо за поддержку!
</p><p>WBR,  Matt
</p>
<a name=".D0.9F.D0.B8.D1.81.D1.8C.D0.BC.D0.BE_.D0.BE.D1.82_.D0.A1.D0.B0.D1.88.D0.B8_.D0.A1.D0.BC.D0.B8.D1.80.D0.BD.D0.BE.D0.B2.D0.B0"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9F%D0%BE%D1%87%D1%82%D0%B0_%28%D0%B2%D1%8B%D0%BF%D1%83%D1%81%D0%BA_4%29&amp;action=edit&amp;section=5" title="Почта (выпуск 4)">править</a>]</span> <span class="mw-headline">Письмо от Саши Смирнова</span></h2>
<p>Привет. Хороший у тебя журнал. Мне нравится. Давно уже читаю его. Он - как более продвинутая ступенька. Т.е. элементарную инфу по Blitz-у и так можно найти - а это - и в ширь и в глубь. Молодец.
</p><p>Блитз мне нравится, хотя юзал я его давно. Арканоид на нем писал. Потом перешел на DiNGS, так как Блитз очень медленный был в операциях вращения и тд. Ну и Дингс проще был намного. Я вот чего не пойму - почему так дорого за него ломят. 3000 рублей - это слишком. Ну 1000 край. 
</p><p>Расскажу собственную историю. Когда я писал на DiNGS игру Ping Pong GOLD, через год я столкнулся с тем, что что в моей версии - пиратской - нельзя создать код более, чем на 32 Кб. Я скачал дальнейшую реинкарнацию языка GLBASIC. И посетила меня крамольная мысль купить ее. За нее автор хотел 80 евро. К слову GLBASIC значительно быстрее блитза, за счет того, что это Си + OpenGL и компилятор Gcc. А синтаксис бэйсика - это лишь маска - едитор конвертит код из бейсика в Си.  Пока я копил деньги на GLBasic, я стал пробовать воссоздать его сам на Си. Деньги уже были у меня в кармане, но на винчестере так же уже красовалась первая версия моего языка LIGHTING BASIC. Я на ее основе создал первую технологическую дему. LB конечно был намного хуже, чем GLBASIC, но уже позволял легко писать игры. На сегодня LB достиг седьмой версии и почти точно воссоздает основные возможности GLBASIC. Он основан на мощи OpenGL, поддерживает кучу музыкальных форматов для проигрывания звука. У меня на него ушло может месяца 2 в свободное время по часику. Пока я не могу его назвать языком, потому что еще только принялся за IDE, который тоже будет интерпретировать бейсик-синтаксис в Си. Скорость языка - колоссальная. Можешь посмотреть технологическую демку, сделанную на нем на emu-machine.narod.ru (так же можешь глянуть мой журнал на emumachs.nm.ru). Вот мне и не понятно, за что буржуи требуют 100 баксов! Ну хороший язык. Но блин! 3000 руб стоит MS Visual C, на котором этот Блитз можно воссоздать. Потом синтаксис у Блитза изобилует ненужными параметрами. То, как пишется в Блитзе я делал в самых ранних версиях LB, пока не догадался писать иначе. Например в Блитз пишется
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;">logo=<span style="color: #ffff00; font-weight: bold;">LoadImage</span><span style=" ">&#40;</span><span style="color: #00FF66;">&quot;bmax120.png&quot;</span><span style=" ">&#41;</span></div>
<p>Зачем это присвоение? Я пишу так (вообще LB - это русский DiNGS/GLBASIC фактически)
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">LOADSPRITE</span><span style=" ">&#40;</span><span style="color: #00ff66;">&quot;star4.png&quot;</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span><span style="color: #ffee00">;</span><br />
<span style="color: #aaffff; font-weight: bold;">LOADSPRITE</span><span style=" ">&#40;</span><span style="color: #00ff66;">&quot;ship2.png&quot;</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><span style="color: #ffee00">; //название файла и его номер ячейки в памяти</span></div>
<p>и тд.
</p><p>Вывод спрайта:
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;">SPRITE<span style=" ">&#40;</span><span style="color: #FFFFFF;">1</span>,x,y,<span style="color: #FFFFFF;">0</span><span style=" ">&#41;</span>;</div>
<p>где 1 - номер ячейки памяти со спрайтом, 0 - степень прозрачности
</p><p>Я честно говоря, по крайней мере с россиян, денег брать не собираюсь. В демке, кстати приложен исходник.
</p><p>Infinity
</p>
<hr />
<p>Привет
</p>
<p><dl><dt>Я вот чего не пойму - почему так дорого за него ломят. 3000 рублей - это слишком. Ну 1000 край.
</dt></dl>
</p>
<p>Это для России и стран СНГ сумма большая, а для Америки и Европы 100$ вполне приемлемо. Хотя, подавляющее большинство (включая меня), просто скачивает его бесплатно. Другой вопрос, что если писать коммерческий проект на Blitz, то купить его следует хотя бы по элементарным этическим соображениям.
</p>
<p><dl><dt>Потом перешел на DiNGS, так как Блитз очень медленный был в операциях вращения и тд. Ну и Дингс проще был намного.
</dt></dl>
</p>
<p>До того, как я узнал про Blitz, у меня появился диск с DarkBasic, DinGS и другими Бейсиками. Тогда я глянул на DinGS, почитал хелп, меня не устроили ограниченные возможности языка (в частности, только 2D-графика) и я стал разбираться с Dark. Хотя, может, вышла более продвинутая версия? Да, двумерщина в Blitz3D медленная, но в BlitzMAX уже основана на том же OpenGL (да и возможность использования технологий объектно-ориентированных языков есть). А Blitz3D ориентирован в первую очередь на 3D-графику.
</p>
<p><dl><dt>Можешь посмотреть технологическую демку, сделанную на нем на emu-machine.narod.ru (так же можешь глянуть мой журнал на emumachs.nm.ru)
</dt></dl>
</p>
<p>Обложки красивые, мне понравились. Когда можно будет скачать выпуски?
</p>
<p><dl><dt>Например в Блитз пишется "logo=LoadImage("bmax120.png")". Зачем это присвоение?
</dt></dl>
</p>
<p>Более продвинутый и используемый повсеместно механизм манипуляций объектами. Проще запомнить имя переменной, в которой хранится адрес объекта, чем его номер, особенно, когда объектов много. Пока программы относительно небольшие, это не так заметно (сам раньше писал программы около 30кб без процедур, пользуясь только GOSUB и числовыми метками).
</p>
<p><dl><dd>Matt
</dd></dl>
</p>
<hr />
<p>Привет
</p>
<p><dl><dt>Это для России и стран СНГ сумма большая, а для Америки и Европы 100$ вполне приемлемо. Хотя, подавляющее большинство (включая меня), просто скачивает его бесплатно. Другой вопрос, что если писать
</dt></dl>
</p>
<p>Да я так же бесплатно его скачал. Дело же не в этом.
</p><p>Дарк я пробовал, уж больно заумный.
</p>
<p><dl><dt>Обложки красивые, мне понравились. Когда можно будет скачать выпуски?
</dt></dl>
</p>
<p>Да они там и лежат, может только хакеры их поуродовали. Ссылки такие примерно emumachs.nm.ru/emumach01.zip emumach02.zip или просто 1 и 2. Всего там 4 номера.
</p>
<p><dl><dt>объекта, чем его номер, особенно, когда объектов много. Пока программы относительно небольшие, это не так заметно (сам раньше писал программы около 30кб без процедур, пользуясь только GOSUB и числовыми метками).
</dt></dl>
</p>
<p>Я писал до 32 Кб, но без меток, функциями.
</p>
<a name=".D0.9F.D0.B8.D1.81.D1.8C.D0.BC.D0.BE_.D0.BE.D1.82_.D0.A1.D0.B0.D0.B4.D1.87.D0.B5.D0.BD.D0.BA.D0.BE_.D0.94.D0.BC.D0.B8.D1.82.D1.80.D0.B8.D1.8F"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9F%D0%BE%D1%87%D1%82%D0%B0_%28%D0%B2%D1%8B%D0%BF%D1%83%D1%81%D0%BA_4%29&amp;action=edit&amp;section=6" title="Почта (выпуск 4)">править</a>]</span> <span class="mw-headline">Письмо от Садченко Дмитрия</span></h2>
<p>Привет Южно-Сахалинску из Хабаровска!
</p><p>Я вот недавно, то есть уже.. хмм.. 17 дней назад сдал все экзамены (!), в т.ч. защитил реферат по информатике. Может ты уже видел мои посты на форуме.. вообщем реферат называется "Применение языка программирования БлитзБэйсик для создания модели идеального газа". Чтобы его написать я перелопатил кучу информации и убил все весенние каникулы (не считая предыдущего времени написания проги, сбора информации и последующей подготовки к экзамену...) В своей работе я представил теоретический курс по Blitz, чего ни в одной предыдущей работе я не видел. Причем, процентов 70 материала пришлось самому переводить с английского. В работе есть перевод основных команд(которые я использовал в своей программе), описание объектов и, конечно, основные сведения о языке. Я читал туториал Scaven'а и вашу дипломную работу, но в своем реферате принципиально не опирался на них, т.к. хотел представить именно теорию, а не практику. Правда, когда я его писал, я ничего не знал о журнале hard'n soft.. знал бы я о нем раньше, списал бы 1 часть оттуда.. но зато так получилось более оригинально.. Ну и в конце реферата я описываю код программы (хотя все таки есть некоторые несущественные кривости о которых умолчим).
</p><p>Кх Кхм.. ну так я все это к чему..  Я подумал, может быть включить этот реферат в приложение к следующему номеру вашего журнала? может быть как Теоретическое пособие для новичков. Несколько дней назад на форуме про рефераты спрашивал.. так сразу все закричали "да мы мол тоже по блитзу и такие и такие рефераты и курсовые писали и пишем..." А когда мне надо было конкретную информацию найти, оказалось что русскоязычных ресурсов то по Блитзу раз и обчелся.. и единой теоретической основы-то и нету.
</p><p>А вообще журнал, конечно, неплох, даже в некоторых местах крут&nbsp;:)   признаюсь, читал не все, но кое-что интересное для себя нашел. Хмм.. просматриваю последний номер, смотрю тема в конце: 3dsMax. помнится я когда-то кому-то (*) писал про видеопост в Максе. А может сойдет за маленькую статью?
</p>
<hr />
<p>Привет!
</p><p>Реферат уже скачал и прочитал, неплохая работа. ОК, включу его в приложение. Ну и статью тоже в журнал помещу.
</p><p>WBR, Matt
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Результаты конкурса (выпуск 4)"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Результаты конкурса (выпуск 4)&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Результаты конкурса (выпуск 4)&amp;action=edit">править</a>]</span><span class="mw-headline">Результаты конкурса (выпуск 4)</span></h1>
<p>Никто не принял участие в конкурсе. Жаль. Ну что-ж, посмотрим, что сдизайнил я:
</p>
</p>
<a name="Excellent_Model"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A0%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82%D1%8B_%D0%BA%D0%BE%D0%BD%D0%BA%D1%83%D1%80%D1%81%D0%B0_%28%D0%B2%D1%8B%D0%BF%D1%83%D1%81%D0%BA_4%29&amp;action=edit&amp;section=1" title="Результаты конкурса (выпуск 4)">править</a>]</span> <span class="mw-headline">Excellent Model</span></h2>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Model01.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Model01.jpg" src="6f6uh9ll.jpg" width="705" height="605" /></a></span></div></div>
<a name="LCD"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A0%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82%D1%8B_%D0%BA%D0%BE%D0%BD%D0%BA%D1%83%D1%80%D1%81%D0%B0_%28%D0%B2%D1%8B%D0%BF%D1%83%D1%81%D0%BA_4%29&amp;action=edit&amp;section=2" title="Результаты конкурса (выпуск 4)">править</a>]</span> <span class="mw-headline">LCD</span></h2>
<p>Числовой (6 элементов):
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:LCD02.gif" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:LCD02.gif" src="oajb0_ra.gif" width="600" height="64" /></a></span></div></div>
<p>Русский шрифт (11 элементов):
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:LCD03.gif" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:LCD03.gif" src="sp4mtdzn.gif" width="620" height="200" /></a></span></div></div>
<a name=".D0.9D.D0.B0.D0.B1.D0.BE.D1.80_.D0.B7.D0.B0.D0.B4.D0.B0.D1.87"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A0%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82%D1%8B_%D0%BA%D0%BE%D0%BD%D0%BA%D1%83%D1%80%D1%81%D0%B0_%28%D0%B2%D1%8B%D0%BF%D1%83%D1%81%D0%BA_4%29&amp;action=edit&amp;section=3" title="Результаты конкурса (выпуск 4)">править</a>]</span> <span class="mw-headline">Набор задач</span></h2>
<a name=".D0.9F.D0.BE.D0.BC.D0.B5.D0.BD.D1.8F.D1.82.D1.8C_.D0.BC.D0.B5.D1.81.D1.82.D0.B0.D0.BC.D0.B8_.D0.BF.D0.B5.D1.80.D0.B5.D0.BC.D0.B5.D0.BD.D0.BD.D1.8B.D0.B5"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A0%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82%D1%8B_%D0%BA%D0%BE%D0%BD%D0%BA%D1%83%D1%80%D1%81%D0%B0_%28%D0%B2%D1%8B%D0%BF%D1%83%D1%81%D0%BA_4%29&amp;action=edit&amp;section=4" title="Результаты конкурса (выпуск 4)">править</a>]</span> <span class="mw-headline">Поменять местами переменные</span></h3>
<p>Классический вариант решения прислали И. Ю. Хван и Михаил Солодовниченко
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">a = a + b<br />
<p>b = a - b<br />
</p>
a = a - b</div>
<p>также можно найти аналогичные способы решения, используя взаимно - обратные функции (сложение и вычитание, умножение и деление, возведение в степень и логарифмирование - для произвольного основания: log<sub>a</sub>b = ln(a) / ln(b)):
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffee00">;вычитание</span><br />
<p>a = a - b<br />
b = a + b<br />
a = b - a<br />
<br />
<span style="color: #ffee00">;умножение (a#, b# &lt;&gt; 0)</span><br />
a = a * b<br />
b = a / b<br />
a = a / b<br />
<br />
<span style="color: #ffee00">;деление (a#, b# &lt;&gt; 0)</span><br />
a# = a# / b#<br />
b# = a# * b#<br />
a# = b# / a#<br />
<br />
<span style="color: #ffee00">;возведение в степень (a#, b# &gt; 0, b# &lt;&gt; 1)</span><br />
a# = b# ^ a#<br />
b# = <span style="color: #aaffff; font-weight: bold;">Log</span><span style=" ">&#40;</span>a#<span style=" ">&#41;</span> / <span style="color: #aaffff; font-weight: bold;">Log</span><span style=" ">&#40;</span>b#<span style=" ">&#41;</span><br />
</p>
a# = a# ^ <span style=" ">&#40;</span><span style="color: #33ffdd;">1.0</span> / b#<span style=" ">&#41;</span></div>
<p>Эти способы имеют ограничения, может быть потеря точности, переполнение. А вот логическая функция XOR обратна сама себе и не имеет ограничений (хотя, в Blitz логика работает только с целыми числами):
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">a = a <span style="color: #aaffff; font-weight: bold;">Xor</span> b<br />
<p>b = a <span style="color: #aaffff; font-weight: bold;">Xor</span> b<br />
</p>
a = a <span style="color: #aaffff; font-weight: bold;">Xor</span> b</div>
<a name="Function_Max.28a.2Cb.29"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A0%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82%D1%8B_%D0%BA%D0%BE%D0%BD%D0%BA%D1%83%D1%80%D1%81%D0%B0_%28%D0%B2%D1%8B%D0%BF%D1%83%D1%81%D0%BA_4%29&amp;action=edit&amp;section=5" title="Результаты конкурса (выпуск 4)">править</a>]</span> <span class="mw-headline">Function Max(a,b)</span></h3>
<p>Это решение прислал И. Ю. Хван:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Return</span> <span style=" ">&#40;</span>a + b + <span style="color: #aaffff; font-weight: bold;">Abs</span><span style=" ">&#40;</span>a - b<span style=" ">&#41;</span><span style=" ">&#41;</span> / <span style="color: #33ffdd;">2</span></div>
<p>А этот вариант прислал Михаил Солодовниченко:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Return</span> a * <span style=" ">&#40;</span>a &gt; b<span style=" ">&#41;</span> + b * <span style=" ">&#40;</span>b &gt;= a<span style=" ">&#41;</span></div>
<p><br />
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Обзор технологий, используемых в играх"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Обзор технологий, используемых в играх&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Обзор технологий, используемых в играх&amp;action=edit">править</a>]</span><span class="mw-headline">Обзор технологий, используемых в играх</span></h1>
</p>
<a name=".D0.94.D0.B5.D0.BC.D0.BE.D1.81.D1.86.D0.B5.D0.BD.D0.B0"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=1" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Демосцена</span></h2>
<p>Первые компьютерные игры появились не один десяток лет назад и, так как возможности компьютеров тех лет были мягко говоря очень ограничены, то одним из важнейших в разработке игр стало умение эффективно распределять скудные ресурсы так, чтобы выжать из машины максимум - построить большой и разнообразный игровой мир, сдобрить его красивой графикой, музыкой и спецэффектами. Местом, где виртуозы в этой области публиковали свои творения, стала т. н. Демосцена - группа неформальных организаций, сначала просто устраивающих встречи с показом работ отдельных команд, где люди вживую общались и менялись опытом. Потом Демосцена переместилась в Интернет, где появилось множество огромных порталов. Вы и сейчас можете скачать массу демо-роликов и музыки с них. Основа Демосцены - программистские и композиторские конкурсы, где задаются ограничения и тема (к тому же, старые компьютеры и языки программирования тоже содержат предостаточно ограничений). Здесь вовсю господствует оригинальность: талантливые сценеры делали, на первый взгляд, невозможные вещи - создавали 4-х канальные музыкальные шедевры, размером в несколько десятков килобайт, графические эффекты, поражающие воображение.
</p><p>У некоторых возникнет мысль: "А, да это просто забава, ничего более.". Но сейчас умение написать оригинальный алгоритм не менее актуально, а многие программисты, создающие сейчас трехмерные движки с захватывающей дух графикой, набирали опыт именно в ДС. Стремление к совершенству бесконечно, а ресурсы всегда ограничены, поэтому спрос на новые оригинальные технологии, добавляющие реализма виртуальным мирам, чтобы игра нормально работала на компьютерах большинства пользователей, не отпадет никогда.
</p><p>А теперь я попытаюсь охватить как можно больше технологий, придуманных на разных этапах становления игровой индустрии, которые могут нам пригодиться.
</p>
<a name=".D0.9E.D1.82.D0.BE.D0.B1.D1.80.D0.B0.D0.B6.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B8.D0.B3.D1.80.D0.BE.D0.B2.D0.BE.D0.B3.D0.BE_.D0.BC.D0.B8.D1.80.D0.B0"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=2" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Отображение игрового мира</span></h2>
<p>Вначале был ASCII: экраны первых компьютеров работали в текстовом режиме и могли отображать только символы в сетке nxm. Памяти было мало, программировать было сложно, программы хранились на перфокартах, перфолентах, но, несмотря на трудности, люди делали первые игры. Можно было сделать стратегию с картой и сменой характеристик (Star Trek), текстовые адвентюры (о них подробно расскажу ниже), аркады (например, Mars, где установка расстреливает тарелки, пытаясь защитить людей от снарядов инопланетян), ролевые игры (где персонаж, представленный символом "улыбающееся лицо", перемещался по миру, где объекты заменялись подходящими символами и набирал опыт в текстовых боях. Следующая волна компьютеров была уже не с такими ограничениями - появлялась растровая графика, постепенно повышалось количество возможных цветов, вводились ограничения для экономии памяти (один из оригинальных способов реализован на Спектруме), не были исключением и игровые приставки. Ну а потом - IBM PC, Macintosh, Amiga - 256 цветов, Hi Color, True Color, 320x200, 640x480, 800x600....
</p><p>Много прекрасных игр было реализовано в разрешении 320х200х256, но сейчас 32 (или в крайнем случае - 16) - битный цвет - стандарт, поэтому не будем разбирать замысловатые технологии работы с 256-цветной палитрой (как, например, в DOOM - реализация затемнения и прозрачности объектов).
</p><p>Самый простой вариант графического отображения (исключая текстовый) - это блочный. Игровое поле представляет собой nxm квадратных (редко бывает - прямоугольных) блоков, каждый из которых имеет свои характеристики. Обычно, это номер изображения, флаг проходимости / непроходимости и несколько специфических. Поле может умещаться на экране (так часто делают в головоломках и простых аркадах) а может быть и больше, тогда возможен скроллинг - попиксельный или поблочный. Персонажи (объекты) могут перемещаться только по клеткам, что упрощает программу (как в походовых стратегиях - например, Civilization, Jagged Alliance, стратегиях в реальном времени - Dune 2 или японских ролевиках) или свободно. Еще один красивый прием - объекты, которые могут накладываться друг друга. Это может достигаться отображением поля "сверху вниз" - ландшафта вместе с мобильными объектами; сортировкой мобильных и стационарных объектов такого рода, в зависимости от их высоты; созданием трех слоев отображения - верхнего, нижнего и промежуточного.
</p><p>Изометрический (UFO, Civilization 2 / 3) и гексагональный (из шестиугольников - Fallout, Arcanum (выглядят, кстати, как изометрия), Nectaris, Panzer General) отличаются только структурой, но принцип остается практически неизменным. Существуют игры, где блочность не так ярко выражена (трудно определить структуру поля), например аркады на SEGA. В игре Worms один блок соответствует одному пикселу - для того, чтобы можно было взрывать и дырявить ландшафт. Есть игры, где все игровое поле - растровый (Postal) или векторный (Another World) рисунок.
</p><p>В старых гоночных имитаторах трасса отображалась, как набор масштабируемых (возможно, заранее) горизонтальных линий. Так можно было создавать повороты, холмы, дополняли картину масштабируемые спрайты машин соперников и объектов окружения.
</p><p>Полигональные трехмерные движки (где объекты состоят из многоугольников) появились, пожалуй, раньше всего. Вначале это были "проволочные каркасы", потом с залитые многоугольниками, отсортированными по степени удаления от камеры. До появления полностью текстурированных полигональных движков (Quake) прошло достаточно много времени, т. к. для этого требовались мощные компьютеры, но текстуры уже иногда использовались (иногда без перспективной коррекции).
</p><p>В это время, пышным цветом расцвели менее притязательные к ресурсам трехмерные движки: Wolfenstein - блочный движок со спрайтами (заметьте - текстурированы только стены - все те же масштабируемые полосы, теперь вертикальные, с одномерным z-буффером. Doom был следующим (гигантским) шагом в этом направлении - поле уже стало векторным (но все еще двумерным), текстурированные (точно так же, как и стены, но с поворотом текстуры) сегменты пола на разных высотах освещались уже по-разному. Серия игр на движке Duke Nukem завершила эту стадию - были добавлены все возможные для такого движка эффекты, в т. ч. наклонные поверхности, ложная многоэтажность за счет использования "телепортационных окон", ведущих в другую область, зеркала. Но это все уже в прошлом.
</p><p>Еще одна интересная концепция - отображение трехмерных объектов на заранее отрендеренном фоне. В игровом мире как бы устанавливались фиксированные камеры, которые переключались, по мере того, как главный герой переходил в другие области. Вспомните знаменитый аркадно-квестовый сериал "Alone In The Dark", триллер "Resident Evil", квест "Grim Fandango". При этом, существенно улучшалась графика и снижались системные требования. Недостатком было некоторое несоответствие между объектами фона и мобильными, реально трехмерными объектами.
</p><p>Дизайнеры из Andrew Spencer Studios пошли еще дальше, создав уникальный и великолепный мир Ecstatica. Использовав технологию отображения эллипсоидов в трехмерном пространстве и построив мир из миллионов таких же эллипсоидов, они добились того, что персонажи гармонично вписались в отрендеренный фон.
</p><p>Сейчас стандарт (благо, мощности бытовых компьютеров теперь позволяют), использующийся в подавляющем большинстве игр - технологии DirectX и OpenGL. Трехмерный движок - полигональный с огромных набором возможностей и спецэффектов.
</p>
<a name=".D0.91.D0.B0.D0.B7.D0.BE.D0.B2.D1.8B.D0.B5_.D1.8D.D0.BB.D0.B5.D0.BC.D0.B5.D0.BD.D1.82.D1.8B_.D0.B8_.D1.8D.D1.84.D1.84.D0.B5.D0.BA.D1.82.D1.8B"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=3" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Базовые элементы и эффекты</span></h2>
<a name=".D0.9E.D1.82.D1.81.D0.B5.D1.87.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BD.D0.B5.D0.B2.D0.B8.D0.B4.D0.B8.D0.BC.D1.8B.D1.85_.D0.BF.D0.BE.D0.B2.D0.B5.D1.80.D1.85.D0.BD.D0.BE.D1.81.D1.82.D0.B5.D0.B9"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=4" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Отсечение невидимых поверхностей</span></h3>
<p>Этот способ очень древний, но используется и по сей день. Для подавляющего большинства граней, нужно отображать только одну сторону (внешнюю сторону объекта, в который входит грань). Поэтому, если грань повернута невидимой стороной к камере, отображать ее не нужно. Реализация проста и оригинальна - вершины грани пронумеровываются против часовой стрелки, если смотреть на видимую сторону. В таком случае, если смотреть в направлении невидимой стороны, они будут пронумерованы по часовой стрелке. Такая же особенность проявляется для проекции граней на экран. Проверяется порядок нумерации довольно просто с помощью формулы для трех вершин.
</p>
<a name="Z-.D0.B1.D1.83.D1.84.D0.B5.D1.80.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D1.8F"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=5" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Z-буферизация</span></h3>
<p>Если в первых полигональных движках объекты сортировались по степени удаления от камеры и отображались, начиная с самых дальних, то следующее поколение движков использовало слой, называемый Z-буфером. Этот слой определял для каждого пиксела экрана десятичную дробь с плавающей точкой - расстояние от камеры до ближайшего объекта. Таким образом, когда новый треугольник рисовался на экране, для каждого пиксела его экранной проекции вычислялось расстояние до треугольника. Если оно меньше, чем уже существующее (изначально для пустого пространства ставится максимально возможное), то значит данный пиксел треугольника находится перед уже нарисованными объектами, соответственно, он рисуется, затирая старый. Если расстояние больше - пиксел треугольника находится за нарисованными объектами и не отображается. Таким образом, можно коррестно отображать пересекающиеся треугольники и вообще, сцену с тысячами примитивов без существенного снижения быстродействия (при сортировке).
</p>
<a name=".D0.9F.D1.80.D0.BE.D0.B7.D1.80.D0.B0.D1.87.D0.BD.D0.BE.D1.81.D1.82.D1.8C"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=6" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Прозрачность</span></h3>
<p>Самый простой способ задания прозрачности называется masking. Один из цветов рисунка помечается, как "пустой" - пиксели этого цвета игнорируются, не затирая фон. Более комплексная прозрачность (смешивание цветов с определенным коэффициэнтом) может задаваться для всего объекта (параметр - альфа), второй вариант - наличие дополнительного слоя для растрового рисунка (256 градаций серого) - альфа-канала. Чем цвет пиксела слоя ближе к черному, тем более прозрачен соответствующий пиксел (белый - пискел рисунка полностью затирает фон, серый - цвета смешиваются на равных условиях, черный - фон не изменяется). Есть одна деталь: т. к. даже полупрозрачные пикселы записываются в Z-буфер, то если рисовать объект за прозрачной гранью, то он не будет отображаться на экране (т. к. имеющиеся значения Z-буфера меньше), поэтому полупрозрачные объекты отображаются в последнюю очередь и сортируются по степени удаления от камеры, начиная от самого дальнего.
</p>
<a name=".D0.A1.D0.BF.D1.80.D0.B0.D0.B9.D1.82.D1.8B.2C_.D0.BC.D0.B0.D1.81.D0.BA.D0.B0"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=7" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Спрайты, маска</span></h3>
<p>Спрайт - это просто двумерный рисунок, который выводится на экран в произвольной позиции (в отличии от фиксированных позиций блоков фона). Это один из основных элементов игр. Так, прямоугольная картинка превращается в фигуру произвольной формы (например, человека). В 2D-играх, обычно, с помощью спрайтов изображают движущиеся объекты - персонажей, врагов, всякие мостики. Также, фон может состоять из блочной основы с наложенной на нее спрайтами, они могут быть наложены и на передний фон, тогда мобиильные объекты будут красиво заслоняться деревьями, колоннами и т. д.
3D-проекция открыла для спрайтов массу вакансий. Раньше, для экономии ресурсов, все мало-мальски сложные объекты делали спрайтами (Wolfenstein, Doom, Duke Nukem). Если статитческие объекты (бочки, мебель, лампы, трупы) обычно всегда выглядели одинаково (вспомните, как трупы всегда лежали ногами вперед), то движущиеся (например, враги) имели фазы поворота и анимации. Для грубого, но пристойно выглядящего монстра, обходились 8 фазами поворота (кстати, в двумерных играх с видом сверху тоже используются фазы поворота для юнитов, напр в Казаках было аж 64 фазы для каждого). Сейчас спрайты чаще всего используются для световых пятен, брызг и других мелких частиц.
</p>
<a name=".D0.A4.D0.BE.D0.BD"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=8" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Фон</span></h3>
<p>Задний фон в 2D играх - это, обычно, растровая картинка. Она может быть размером с экран (тогда через окна помещений и открытое пространство будет виден застывший пейзаж). Использование статичного заднего фона уже добавляет игре иллюзию трехмерности, а если фонов несколько, они разной величины (больше, чем экран) и двигаются с разными скоростями, то эффект просто потрясающий.
В трехмерных играх тоже может быть статический или динамический (в таком случае, он зацикливается как текстура и сдвигается при повороте камеры) растровый фон. Теперь часто для фона используют сферические и кубические объекты: камера, как бы находится внутри куба или сферы, на внутренней стороне которой нарисован фон - ландшафт, небо; при движении камеры, движется и объект, который рисуется первым; создается иллюзия перспективы.
</p>
<a name=".D0.A7.D0.B0.D1.81.D1.82.D0.B8.D1.86.D1.8B"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=9" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Частицы</span></h3>
<p>Эти элементы добавляют хорошую долю реализма в трехмерный мир. Части разбитых или поврежденных объектов, искры, брызги и т. д. Частица - это, обычно, спрайт или малополигональный объект (чтобы можно было без особой нагрузки на систему отобразить их сотню-другую. Частицы могут вращаться в воздухе (спрайты меняют фазы) или не менять положения (огни, сферы). Задается источник частиц (это может быть точка или область), направление (в пределах сектора или полностью случайное - для хаотичных), длительность жизни (обычно - несколько секунд, чтобы не занимать ресурсы). Часто используется коллизия с объектами - частицы отскакивают (исчезают) при столкновении с препятствием, брызги крови и снаряды оставляют следы.
</p>
<a name=".D0.94.D0.B5.D0.BA.D0.B0.D0.BB.D1.8B"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=10" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Декалы</span></h3>
<p>Декалами называются изображения, накладываемые на уже существующий объект. В Duke Nukem на стенах оставались брызги крови и дырки от пуль, на полу - отпечатки ботинок. В Max Payne если декал выходил за пределы одной грани, он частично отображался на другой (до сих пор помню окровавленный унитаз). Для большего реализма использовались декалы с альфа-каналом. В FarCry пошли еще дальше - отслеживается вся траектория полета пули, она проходит навылет и может оставить "траншею" на теле. Обычно, для декала создается полупрозрачный полигон, параллельный поверхности и немного отстоящий от нее. Это часто приводит к "борьбе полигонов", когда пикселы полигона поверхности проникают сквозь декал (из-за недостаточной точности z-буфера). Реже (это более ресурсозатратно, хотя и корректно) на объект накладывается дополнительная текстура для декалов (или для каждого объекта создается своя, а затем изменяется).
</p>
<a name=".D0.92.D0.BE.D0.BA.D1.81.D0.B5.D0.BB.D0.B8"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=11" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Воксели</span></h3>
<p>Воксели - это маленькие квадраты (реже - круги) разного цвета, скопление которых образовывает объект или эффект. По сути, это то же самое, что и частицы, но примитивные и их количество может быть на несколько порядков больше без существенного снижения скорости. Вокели масштабируются в зависимости от расстояния до камеры. С помощью вокселей можно делать детальные трехмерные объекты, создавая трехмерный массив (как некоторые объекты в Duke Nukem), эффекты (кровь, хвост ракеты, дробь в Quake), качественные ландшафты (Delta Force). Однако, сейчас эта технология применяется очень редко, а чтобы использовать ее в Blitz придется писать библиотеки или медленно работающие процедуры.
</p>
<a name=".D0.9C.D1.83.D0.BB.D1.8C.D1.82.D0.B8.D1.82.D0.B5.D0.BA.D1.81.D1.82.D1.83.D1.80.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=12" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Мультитекстурирование</span></h3>
<p>Мультитекстурирование - прямой способ смешения текстур на одной грани. Ранее эту технологию пытались эмулировать, делая слоеный "бутерброд" из полупрозрачных граней. Проблема в том, что если расстояние между гранями слишком маленькое, на дальних расстояниях проявляется эффект "борьбы полигонов". Если слишком большое - при близком рассмотрении можно заметить нестыковку. Текстуры смешиваются по порядку - первая со второй, результат с трейтьей, этот результат - с четвертой и т. д. (обычно, используют максимум 3 слоя). Способы смешения - прозрачность, сложение (для каждого канала берется максимальное значение), умножение (берется минимальное значение). Мультитекстурирование может быть использоваться так: основной слой - цикличная текстура, задающая покрытие объекта (камень, дерево и т. д.), больший по масштабу слой затенения, определяющий освещение объекта и цикличная микротектстура, задающая фактуру объекта.
</p>
<a name=".D0.9A.D0.B0.D1.80.D1.82.D0.B0_.D0.BE.D0.BA.D1.80.D1.83.D0.B6.D0.B5.D0.BD.D0.B8.D1.8F"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=13" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Карта окружения</span></h3>
<p>Оригинальный алгоритм создания зеркальных изогнутых поверхностей без потери быстродействия - использование карты окружения. Это текстура, которая накладывается на объект, для каждой вершины текстурные координаты определяются направлением нормали (представляющей собой вектор, перпендикулярный касательной плоскости к этой вершине) данной вершины. С помощью этой технологии можно, например, создать тонированное стекло машины, в котором будут отражаться предварительно нарисованные дома и улицы. Отражение не будет в точности соответствовать улицам, по которым мчится машина, но эффект будет вполне впечатляющим, так что пользователь, возможно и не обратит внимания на это.
</p>
<a name=".D0.A1.D1.84.D0.B5.D1.80.D0.B0.2C_.D0.BA.D1.83.D0.B1_.D0.BE.D0.BA.D1.80.D1.83.D0.B6.D0.B5.D0.BD.D0.B8.D1.8F"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=14" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Сфера, куб окружения</span></h3>
<p>Это технология отображения зеркальных поверностей следующего поколения. Соответственно, требует много ресурсов и мощный компьютер. Для куба создаются шесть камер - на каждую плоскость, которые периодически "фотографируют" окружающую местность и создают на основе снимков карту окружения. Сфера конфигурируется по несколько иному пути.
</p>
<a name=".D0.9C.D0.B8.D0.BF-.D0.BC.D0.B0.D0.BF.D0.BF.D0.B8.D0.BD.D0.B3"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=15" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Мип-маппинг</span></h3>
<p>Старая технология, используемая и по сей день. Суть заключается в том, что для каждой текстуры создается набор текстур - уменьшенных (в 2, 4, 8 и т. д раз) копий исходной. При этом используется фильтрация для корректного отображения. Поэтому, в зависимости от удаления пиксела полигона, его цвет берется из соответствующей текстуры набора, что позволяет избавиться от "зернистости" далеких объектов.
</p>
<a name=".D0.90.D0.B4.D0.B0.D0.BF.D1.82.D0.B8.D0.B2.D0.BD.D0.B0.D1.8F_.D0.B4.D0.B5.D0.B3.D1.80.D0.B0.D0.B4.D0.B0.D1.86.D0.B8.D1.8F"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=16" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Адаптивная деградация</span></h3>
<p>Адаптивная деградация - способ, позволяющий существенно повысить производительность за счет упрощения объектов, по мере их удаления от камеры. Для примера - далеко стоящий человек, высота которого несколько пикселов не нуждается в детальной прорисовки структуры лица или рук. Для такой модели вполне достаточно коробкоподобных конечностей и головы, в сумме - несколько десятков полигонов или вообще спрайта. Разницу заметит только эксперт, если присмотрится. В этом направлении - непаханное поле нереализованных возможностей. Некоторые объекты вообще появляются только вблизи главного героя (растительность в Serious Sam 2, Far Cry). Пока способы адаптивной деградации можно разбить на три категории: скачкообразная (когда более детализированная фигура мнгновенно сменяется менее детализированной) - Drakkan, морфинг (одна фаза постепенно, с помощью перемещения вершин, переходит в другую) и альфа-блендинг (старая фигура, становясь все более прозрачной, исчезает, новая проявляется) - GTA: Vice City. В Blitz адаптивная деградация используется в отображении ландшафта (Terrain), причем есть возможность переключения между скачкообразной и морфингом. Для больших ландшафтов используются методы динамической детализации, такие, как построение QUAD-деревьев (далеко расположенные треугольники ландшафта объединяются в один).
</p>
<a name=".D0.A1.D0.BE.D0.BA.D1.80.D1.8B.D1.82.D0.B8.D0.B5_.D0.BD.D0.B5.D0.B2.D0.B8.D0.B4.D0.B8.D0.BC.D1.8B.D1.85_.D0.BE.D0.B1.D1.8A.D0.B5.D0.BA.D1.82.D0.BE.D0.B2"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=17" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Сокрытие невидимых объектов</span></h3>
<p>В первых трехмерных блочных движках методом "светового луча" определялась небольшая зона, в пределах которой отображались объекты. Сейчас, когда структура виртуальных миров менее ограничена, в ход идут другие способы. Например, уровень (чаще всего это делают с уровнями внутри помещений) разбивается на зоны. Затем определяется для каждой из зон, какие зоны видимы для игрока, находящегося в данной зоне. Позже, в процессе игры, отображаются объекты только тех зон, которые привязаны к той, где находится игрок. Один из алгоритмов, программно реализующих данный метод - построение и рендеринг BSP-дерева.
</p>
<a name=".D0.A2.D1.80.D0.B0.D1.84.D0.B0.D1.80.D0.B5.D1.82.D0.BD.D1.8B.D0.B9_.D0.B1.D1.83.D1.84.D0.B5.D1.80"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=18" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Трафаретный буфер</span></h3>
<p>Это буфер, где для каждого пиксела экрана задается флаг, который определяет, отображается пиксел на экране или нет. Это, грубо говоря, более продвинутая версия "Masking" с возможностью обрезать слой (в т. ч. отрендеренный экранный буфер) на основе определенного алгоритма. Формирование буфера может осуществляться также в процессе рендеринга.
</p>
<a name=".D0.A8.D0.B5.D0.B9.D0.B4.D0.B5.D1.80.D1.8B"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=19" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Шейдеры</span></h3>
<p>Реально, мало кто представляет себе, что такое шейдеры. На самом деле шейдер - это набор инструкций, написанных на встроенном языке, которые определяют, в какой цвет красить определенный пиксел полигона или определяют свойства вершины на основе входных параметров (координаты пиксела/вершины, нормаль, позиция на текстуре). К сожалению, пока в Blitz3D шейдеры не реализованы, хотя это очень мощный инструмент, позволяющий создавать графические эффекты с реалистичностью на порядок выше.
</p>
<a name=".D0.A4.D0.B8.D0.BB.D1.8C.D1.82.D1.80.D0.B0.D1.86.D0.B8.D1.8F"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=20" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Фильтрация</span></h3>
<p>После рендеринга можно еще поработать над изображением: сгладить острые углы, наложить сверху изображение, чтобы не бросалась в глаза идеальная правильность форм (как в Deus Ex - накладывается слой, создающий что-то типа диффузии). Широко распространены эффекты черно-белой низкокачествнной кинопленки с дефектами и камеры низкого качества (дергающееся изображение, полосы видеошума)
</p>
<a name=".D0.98.D0.B7.D0.BE.D0.B1.D1.80.D0.B0.D0.B6.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BE.D0.B1.D1.8A.D0.B5.D0.BA.D1.82.D0.BE.D0.B2_.D0.B8_.D1.8F.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B9"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=21" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Изображение объектов и явлений</span></h2>
<a name=".D0.9E.D0.B3.D0.BE.D0.BD.D1.8C_.D0.B8_.D0.B4.D1.8B.D0.BC"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=22" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Огонь и дым</span></h3>
<p>Самый простой вариант - спрайт с циклом из нескольких фаз. В Quake огонь был полигональным (модель). Сейчас это выглядит убого, поэтому огонь представляют в виде источника частиц. Если это факел или свеча, то частицы мелкие и летят вверх, постепенно затухая (становясь прозрачнее). Если пожар - большие частицы масштабируются и вращаются (как в Max Payne). Для наилучшего качества используются спрайты с альфа-каналом. Дым создается аналогично.
</p>
<a name=".D0.92.D0.BE.D0.B4.D0.B0"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=23" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Вода</span></h3>
<p>Классический вариант - поверхность, пересекаемая неровностями ландшафта (в старину - просто полигон). Он может быть полупрозрачным, чтобы было видно дно или просто текстурой (обычно, анимируемой - водовороты или течения). Позже стали накладывать еще и зеркальную поверхность, чтобы надземные объекты отражались поверхностью. В FarCry к тому же добавлена рябь, в итоге вода выглядит потрясающе. Водопады могут быть отображены аналогичным способом и с добавлением частиц (для создания всплесков у поверхности водопада), частицы могут формировать сам водопад. Под водой, обычно, меняется цветовая гамма (увеличение интенсивности сине-голубого цвета), на дне может быть установлена динамичная затеняющая текстура (тени от ряби на поверхности). Кстати, при наложении такой такой же текстуры на подводные объекты можно достичь неплохого визуального эффекта. Дополнительные частицы - обитатели подводного мира, пузырьки воздуха, кровавые потоки от плавающих тел. При столкновении объектов с поверхностью - рябь на поверхности воды, всплески с помощью частиц. В игре "Curse: The Eye Of Isis" сделаны объемные волны от перемещения героя, когда он по колено в воде (водная поверхность разбивается на клетки).
</p>
<a name=".D0.A2.D1.83.D0.BC.D0.B0.D0.BD"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=24" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Туман</span></h3>
<p>Это довлольно легко реализуемый эффект, поэтому ипользуется тоже давно (в основном, для ограничения видимого пространства и, соответственно, повышения производительности). Есть несколько параметров: конечный цвет перехода (обычно, белый, для темноты - черный), дистанция, на которой окружающая обстановка начинает затуманиваться и дистанция, на которой уже ничего не видно. Локальные виды тумана (например, реальные облака в авиаимитаторах) создаются, обычно, полупрозрачными спрайтами.
</p>
<a name=".D0.97.D0.B5.D1.80.D0.BA.D0.B0.D0.BB.D0.B0"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=25" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Зеркала</span></h3>
<p>Зеркальные плоскости создаются посредством рендеринга трансформированного игрового мира, а для зеркальных прямоугольников устанавливаются дополнительные камеры, результат рендеринга которых переносится на текстуру прямоугольника. Новые движки используют шейдеры. На зеркала могут быть наложены текстуры, чтобы смоделировать загрязнение, трещины.
</p>
<a name=".D0.A1.D1.82.D0.B5.D0.BA.D0.BB.D0.B0"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=26" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Стекла</span></h3>
<p>Обычно - полупрозрачные поверхности (иногда - без текстур). Некоторые разбиваются на осколки (частицы). Стекла бывают цветными - тогда пространство за ними приобретает тот или иной оттенок.
</p>
<a name=".D0.9B.D0.B0.D0.BD.D0.B4.D1.88.D0.B0.D1.84.D1.82"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=27" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Ландшафт</span></h3>
<p>Прежде всего, для ландшафта задается карта высот (массив NxM, чаще NxN, где N - степень двойки). Сам ландшафт имеет клеточную структуру в плоскости XZ, где каждая клетка состоит из двух треугольных граней, соединяющих смежные вершины. В Blitz на ландшафт можно наложить текстуру покрытия, а на нее - текстуру цвета, масштабированную на всю поверхность, чтобы получить отдельные зоны (зеленая - трава, коричневая - земля, серая - камень, желтая - песок, белая - известняк, черная - асфальт). Хотя это выглядит слегка убого, но позволяет использовать адаптивную деградацию, реализация которой в случае с блочным ландшафтом (где для разных клеток могут использоваться разные текстуры) сталкивается с серьезными проблемами.
</p>
<a name=".D0.92.D0.B7.D1.80.D1.8B.D0.B2.D1.8B"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=28" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Взрывы</span></h3>
<p>Стандартный взрыв - спрайт с альфа каналом, однако выглядит уродливо, если произошел рядом с какой-нибудь поверхностью, поэтому для улучшения качества используют набор спрайтов и / или систему частиц.
</p>
<a name=".D0.9C.D1.83.D1.81.D0.BE.D1.80"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=29" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Мусор</span></h3>
<p>Придает игре более "приземленный" вид - до блеска натертые улицы, на которых нет и пылинки, дают стойкое ощущение искусственности мира. Но, часто мусор делают очень грубо: обычно, это пара-тройка видов частиц (создается впечатление, что все люди читают один и тот же журнал везде, где только можно, много раз на дню, считая своим долгом его тут же выкинуть), которые вращаются, "повинуясь ветровым потокам" и коллизируют с окружающей обстановкой. Недостаточная проработка коллизии приводит к тому, что десяток газет может застрять где-нибудь в углу.
</p>
<a name=".D0.9E.D1.81.D0.B2.D0.B5.D1.89.D0.B5.D0.BD.D0.B8.D0.B5"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=30" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Освещение</span></h2>
<a name=".D0.93.D0.B0.D0.BC.D0.BC.D0.B0"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=31" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Гамма</span></h3>
<p>Изменение цвета всего экранного пространства по формулам дает возможность сделать эффект ослепления вспышкой (когда цвета постепенно проявляются от белого), кровавую пелену, регулировать яркость и контраст.
</p>
<a name=".D0.97.D0.B0.D1.82.D0.B5.D0.BD.D0.B5.D0.BD.D0.B8.D0.B5"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=32" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Затенение</span></h3>
<p>Плоское затенение сейчас редко используется (в основном, только для плоских поверхностей, таких как крышка стола) - вся грань затеняется однотонно. Затенение по Гуро выглядит более впечатляюще - яркость интерполируется по треугольнику в зависимости от вычисленной яркости для его вершин, получается плавный переход. Затенение по Фонгу более медленное, но позволяет получить красивые блики (в Blitz не используется).
</p>
<a name=".D0.9D.D0.B0.D0.BF.D1.80.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.BD.D1.8B.D0.B9_.D1.81.D0.B2.D0.B5.D1.82"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=33" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Направленный свет</span></h3>
<p>Затенение объектов при наличии источника направленного света задается так: для каждой вершины яркость определяется отклонением вектора нормали этой вершины (вектор, перпендикулярный плоскости, касающейся этой вершины, если она входит в приближенную изогнутую поверхность). Для плокости используется ее вектор нормали.
</p>
<a name=".D0.A2.D0.BE.D1.87.D0.B5.D1.87.D0.BD.D1.8B.D0.B9_.D0.B8.D1.81.D1.82.D0.BE.D1.87.D0.BD.D0.B8.D0.BA"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=34" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Точечный источник</span></h3>
<p>Освещение вершин точечным источником рассчитывается исходя из расстояния от источника до вершины. При этом, качество полученного светового пяна зависит от структуры мира - плоскости целесообразно разбить на квадраты (вспомните эффект фонарика в Deus Ex). Можно также наложить на поверхности затеняющий декал, но это довольно грубый способ (иногда используется в автоимитаторах).
</p>
<a name=".D0.9A.D0.B0.D1.80.D1.82.D1.8B_.D0.BE.D1.81.D0.B2.D0.B5.D1.89.D0.B5.D0.BD.D0.B8.D1.8F"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=35" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Карты освещения</span></h3>
<p>Это старый способ, эффектно выглядящий (применялся еще в RedNeck Rampage), который подходит для фиксированных источников освещения. Простейший вариант реализации - создается текстура, пиксели которой уже затенены нужным образом. Так, можно создать тень от стационарных объектов (например, мебели), добавив тени в текстуры пола и стен. Недостаток - текстуру можно использовать только в этом или подобных местах (с таким же расположением объектов и источников освещения). Другой вариант, который используется и сейчас - наложить поверх обычной текстуры слой затенения, который будет определять яркость участков текстуры и, соответственно, тени. Этот слой можно сделать в несколько раз меньше и растянуть по поверхности. Существуют программы для генерации слоя затенения для всего мира. Недостатки этих способов очевидны - не поддерживаются динамические источники света и заметна блочность.
</p>
<a name=".D0.9F.D1.80.D0.BE.D0.B5.D0.BA.D1.86.D0.B8.D1.8F_.D1.82.D0.B5.D0.BD.D0.B8_.D0.BD.D0.B0_.D0.BE.D0.B1.D1.8A.D0.B5.D0.BA.D1.82"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=36" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Проекция тени на объект</span></h3>
<p>Самый примитив - отрисовка "теневого пятна" (старые аркады, Mario64, Мах Payne), во многих играх это делается, чтобы игрок мог определить, куда приземлится ведомый персонаж, подпрыгнув. Хотя, в Mortal Combat и Age of Empires сделали лучше - использовали для теней сами спрайты. В более Hi-Tec-играх более развитые технологии, например в Blade of Darkness (IMO, самые реалистичные тени - там) - полигональные тени (то есть, каждый световой источник (я не знаю, как там в действительности, просто предположение) освещает какую-то трехмерную полигональную область. Часть полигонов может быть полностью затенена, полностью освещена или частично освещена / частично затенена - в этом случае полигон разбивается на части. Выглядит очень реалистично (особенно, когда бежишь по подземелью с факелом и на стену отбрасывается твоя гигантская тень), но есть недостатки - при данном (весьма непростом) алгоритме, начинаются проблемы с несколькими источниками света и нет дисперсивной грани между тенью и светом. При использовании растровых затенителей (растровых текстур или декалов) приходится вводить ограничения (для того, чтобы натянуть на весь уровень и объекты детализированные растровые текстуры, потребуется слишком много ресурсов): например, тени делают только для небольших мобильных объектов, как то персонажей (особенно, главного героя), ящики и т. д. При этом, тень генерируется в процессе игры и накладывается на определенный объект (например, ландшафт, или стены). Детализированные отдельные объекты, обычно пропускаются (наверняка, видели тень, которая проходит, например, под мусорным баком). С использованием шейдеров, тени стало возможным накладывать корректно на все объекты и с дисперсией (Doom, Far Cry, Silent Hill 4). Особенно великолепно смотрятся тени на самом персонаже.
</p>
<a name=".D0.91.D0.BB.D0.B8.D0.BA.D0.B8"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=37" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Блики</span></h3>
<p>В случае с классическим затенением по Гуро, меняется градиент: от стандартного плавного перехода от черного к белому до таког же перехода, только с присоединенным полностью белым промежутком. Другими словами, теперь полная яркость задается не для вершины с нормалью, противоположно направленной световому вектору, а для части нормалей, отклоняющихся от вектора максимального освещения в определенных пределах. Соответственно, если освещаемый объект достаточно детализирован, на нем появляется световой блик - пятно максимальной яркости. Очень хорошо смотрятся блики, сделанные с помощью карты окружения. Также, неплохо было бы использовать затенение по Фонгу, но оно редко где поддерживается. Зато теперь идеальный вариант (если есть возможность) - написать соответствующий шейдер.
</p>
<a name=".D0.97.D0.B2.D1.83.D0.BA_.D0.B8_.D0.BC.D1.83.D0.B7.D1.8B.D0.BA.D0.B0"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=38" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Звук и музыка</span></h2>
<p>Звуки вносят солидный вклад в дело оживления виртуального мира. Если раньше достаточно было FM-овских бульканий, то теперь стандарт - цифровой звук 44000kHz, 16бит (впрочем, для разных звуков можно подобрать разное качество - для шумов, например, низкое, для голоса - среднее). Широко используются mp3 и ogg (хороша, потому что бесплатна) коммпрессии. Наибольший объем звуковой информации, как правило, занимает речь - диалоги, "мысли вслух", подслушанные разговоры, теле- и радиопередачи, реакция врагов (гневные возгласы, издевки, бахвальство, вопли о помощи). Очень здорово, когда для каждого события предусмотренно несколько вариантов звуков.
</p><p>Midi и mod-музыка уже устарели (однако, в том же Deus Ex mod-музыка - на 5 баллов), поэтому, в основном, используется компрессированная цифровая или CD. Красивый прием - изменение музыки при изменении игровой ситуации (к примеру, спокойная мелодия, когда игрок в безопасности и напряженная - когда его заметили или атакуют), он еще в Dune 2 на Сеге использовался. Еще используется "эмбиент" - шумы, дополняющие атмосферу места.
</p>
<a name=".D0.9A.D0.BE.D0.BB.D0.BB.D0.B8.D0.B7.D0.B8.D1.8F"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=39" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Коллизия</span></h2>
<p>Коллизия - это столкновение объектов.
</p>
<a name=".D0.A1.D1.84.D0.B5.D1.80.D0.B0_.28.D0.BA.D1.80.D1.83.D0.B3.29"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=40" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Сфера (круг)</span></h3>
<p>Самый простой вариант коллизии: определяется растояние между центрами по формуле, если оно меньше или равно сумме радиусов - объекты столкнулись. С определением действий сложнее: в продвинутых движках учитывается скорость и направление (например, в бильярде это необходимо), а также масса. В трехмерных играх раньше тоже были подобные упрощения (Doom, Duke Nukem), но сейчас это слишком примитивно.
</p>
<a name=".D0.9F.D0.B0.D1.80.D0.B0.D0.BB.D0.BB.D0.B5.D0.BB.D0.B5.D0.BF.D0.B8.D0.BF.D0.B5.D0.B4_.28.D0.BF.D1.80.D1.8F.D0.BC.D0.BE.D1.83.D0.B3.D0.BE.D0.BB.D1.8C.D0.BD.D0.B8.D0.BA.29"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=41" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Параллелепипед (прямоугольник)</span></h3>
<p>Более продвинутый метод (но все же примитивный). Часто используется в аркадах - пересечение двух прямоугольников также распознать просто. Трехмерные игры могут использовать грубый (когда объекты "вписываются" в параллелепипед, всегда ориентированный по координатным осям) или более трудный в математической реализации - когда параллелепипед может вращаться. Второй идеален для параллелепипедообразных объектов (ящики, коробки) и может быть использован грубо для похожих - табуретки, покрышки. С обработкой столкновений еще сложнее - нужно учесть еще и скорость вращения.
</p>
<a name=".D0.9A.D0.BE.D0.BB.D0.BB.D0.B8.D0.B7.D0.B8.D1.8F_.D1.81.D0.BE.D1.81.D1.82.D0.B0.D0.B2.D0.BD.D1.8B.D1.85_.D0.BE.D0.B1.D1.8A.D0.B5.D0.BA.D1.82.D0.BE.D0.B2"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=42" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Коллизия составных объектов</span></h3>
<p>Когда объект состоит из набора примитивов, получается гораздо более реалистичная коллизия. Причем, можно добиться очень даже неплохого качества, используя минимум примитивов даже для анимированного объекта. Стремление к такому упрощению можно заметить - обратите внимание на кубообразныые головы некоторых моделей в 3D-боевиках. При использовании таких объектов, физичекая модель может еще больше усложниться (что, впрочем, окупается).
</p>
<a name=".D0.9F.D0.BE.D0.BB.D0.B8.D0.B3.D0.BE.D0.BD.D0.B0.D0.BB.D1.8C.D0.BD.D0.B0.D1.8F_.28.D0.BF.D0.B8.D0.BA.D1.81.D0.B5.D0.BB.D1.8C.D0.BD.D0.B0.D1.8F.29"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=43" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Полигональная (пиксельная)</span></h3>
<p>В двумерных играх пиксельная коллизия используется уже давно (она медленнее, зато потрясно выглядит), а в трехмерных полигональная используется нечасто. Сложность и медленность физики и алгоритмов определения коллизии таких объектов крайне высока, поэтому объекты стремтся упростить до примитивных (например, в Max payne 2, для стула, у которого есть четыре ножки коллизионный слой представляет собой две призмы).
</p>
<a name=".D0.9B.D1.83.D1.87.D0.B5.D0.B2.D0.B0.D1.8F_.28.D0.B8.D0.BB.D0.B8_.D0.B4.D0.BB.D1.8F_.D0.BE.D1.82.D1.80.D0.B5.D0.B7.D0.BA.D0.B0.29"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=44" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Лучевая (или для отрезка)</span></h3>
<p>Обычно, используется для очень скоростных объектов - пуль и фотонов (в лазерных лучах). Сразу определяется объект столкновения (или отсутствие столкновения). Пример - дробовик, пистолет и электрошок в Quake.
</p>
<a name=".D0.9A.D0.BE.D0.BB.D0.BB.D0.B8.D0.B7.D0.B8.D0.BE.D0.BD.D0.BD.D1.8B.D0.B9_.D1.81.D0.BB.D0.BE.D0.B9_.28.D0.BF.D1.80.D0.BE.D1.81.D1.82.D1.80.D0.B0.D0.BD.D1.81.D1.82.D0.B2.D0.BE.29"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=45" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Коллизионный слой (пространство)</span></h3>
<p>Неподвижные объекты уровня (будь то стены, пол, потолок, неподвижная мебель, ландшафт) естественно, тоже должны коллизировать с остальными объектами. Но, если расматривать все полигоны уровня, то проверки будут занимать оччень много системного времени (а вкупе с адаптивной деградацией - будут возникать сбои). Поэтому создают коллизионный слой, который будет определять "материальную структуру" уровня. Так как многими деталями можно пренебречь, то такой слой будет грубым приближением уровня (если его рендерить, похож на первые трехмерные игры, без текстур). Степень огрубления зависит от типа использования структуры и вообще продвинутости физического движка (чтобы удовлетворять его запросам).
</p>
<a name=".D0.A4.D0.B8.D0.B7.D0.B8.D0.BA.D0.B0"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=46" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Физика</span></h2>
<a name=".D0.A7.D0.B0.D1.81.D1.82.D0.B8.D1.86.D1.8B_2"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=47" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Частицы</span></h3>
<p>Определяется источник частиц, диапазон начальной скорости, сектор, определяющий начальное направление полета, количество и время жизни. Частицы могут коллизировать с окружением (обломки, снаряды, мусор, брызги крови), а могут и не коллизировать (искры, огненные языки, пузырьки воздуха, текущая вода, пар). При столкновении могут оставлять декалы (обычно, только немногочисленные частицы).
</p>
<a name=".D0.A1.D0.BD.D0.B0.D1.80.D1.8F.D0.B4.D1.8B"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=48" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Снаряды</span></h3>
<p>Обычно, используется лучевая коллизия. При столкновении с объектом, могут оставлять декалы: для стен - пробоины (различаются от типа снарядов), для живых существ - раны; создавать частицы: обломки, брызги крови, замечательно смотрится сыплющаяся штукатурка в Max Payne. Для продвинутых физических движков - придавать ускорение объектам (хотя, для людей, обычно, используют разные фазы анимации, исключение - рагдоллы).
</p>
<a name=".D0.94.D0.B2.D0.B5.D1.80.D0.B8"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=49" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Двери</span></h3>
<p>Что меня постоянно раздражает - двери практически всегда имеют свойство закрываться сами собой (понимаю, шлюзы в футуристических комплексах, но деревянные двери в сараях?). Не знаю, что послужило причиной повального распространения этого IMO маразма. Однако, если неправильно это сделать, то дверь может "прищемить" (игрок застрянет, выйдет за пределы уровня или погибнет, как в Blood) - двери могут быть очень опасны. Иногда двери служат переходом между "игровыми мирами" (имеются в виду не находящиеся в одном пространстве) - вспомните Silent Hill.
</p>
<a name=".D0.A2.D1.80.D0.B0.D0.BD.D1.81.D0.BF.D0.BE.D1.80.D1.82"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=50" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Транспорт</span></h3>
<p>Использование транспортных средств добавляет играбельности. Физика зависит от типа ТС и уровня приближения к реальной. Например, автомобили/танки могут быть совершенно лишены инерции и не отрываться от плоскости (Shadow Warrior) или реагировать на весь спектр взаимодействий - коллизия колесами и корпусом, акселерация в зависимости от наклона и касания ведущих колес с землей, реакция на столкновения с мобильными и неподвижными объектами, вращение и покачивание, пружинистая подвеска. Управление самолетом в авиаимитаторах бывает очень сложным - воздействуют воздушные потоки, самолет клонит в штопор, нужно убирать шасси, управлять закрылками. Космичесие корабли, обычно имеют поворотные двигатели, чтобы установить нос корабля в нужном направлении, и двигатели ускорения / торможения. Соответственно, инерция при повороте, воздействие гравитации в гравитационном поле планеты. Посадка или стыковка - тоже целая процедура. Катерам и моторным лодкам на поверхности воды инерция мешает в гораздо большей степени, к тому же лодка покачивается на волнах, что тоже усложняет управление.
</p>
<a name=".D0.A0.D0.B0.D0.B3.D0.B4.D0.BE.D0.BB.D0.BB.D1.8B"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=51" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Рагдоллы</span></h3>
<p>Этим термином обозначают тела (необязательно человеческие), которые представляют собой костную структуру (где каждая кость может поворачиваться относительно связанной с ней в определенных пределах) с натянутой на нее оболочкой. Используется, в основном, для тел нейтрализованных врагов (эффект реалистичного падения с вышки, разные позы трупов). В играх это выглядит так: когда у врага здоровье падает до нуля, он "расслабляется", ему придается ускорение от последнего снаряда / взрыва и он летит, свободно размахивая руками и ногами или реалистично валясь на пол. Математическая модель рагдолла довольно сложна.
</p>
<a name=".D0.94.D0.B5.D1.84.D0.BE.D1.80.D0.BC.D0.B0.D1.86.D0.B8.D1.8F_.D0.BE.D0.B1.D1.8A.D0.B5.D0.BA.D1.82.D0.BE.D0.B2"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=52" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Деформация объектов</span></h3>
<p>Старый как мир способ - либо сменить модель / спрайт объекта, либо удалить объект, разбросав обломки (которые могут исчезнуть или стать самостоятельными объектами). В Drakkan, например, это сделано очень интересным образом - скажем, от трупа можно отрубать куски, их разрубать на более мелкие куски и т. д. Обычно, враги деформируются только когда погибают (Blade of Darkness), хотя в том же Drakkan можно отрубить врагу конечность (или рыло) и тот еще будет бугать и пытаться Вас убить. Следующим шагом, думаю, будет создание объектов, которые будут произвольно деформироваться, в зависимости от воздействия - сминающиеся контейнеры, решетки.
</p>
<a name=".D0.98.D0.B3.D1.80.D0.BE.D0.B2.D0.BE.D0.B9_.D0.BC.D0.B8.D1.80"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=53" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Игровой мир</span></h2>
<a name=".D0.A4.D0.B8.D0.BA.D1.81.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.BD.D1.8B.D0.B9"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=54" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Фиксированный</span></h3>
<p>Ну это стандарт - всегда все одно и то же. Очевидные недостатки - проходить игру еще раз неинтересно (исключение - фанаты игры), предсказуемость (исследовав уровень и начав по каким-то причинам снова, уже знаешь, где будут враги и полезные предметы), ограниченность (при всем желании, не удастся сделать мир по настоящему огромным, таким, где можно затеряться, да и то придется потратить массу человеко-часов). Зато достоинством такого подхода является то, что в процессе прохождения игры, можно открывать новые возможности, сценарий может иметь неожиданный поворот и уровень, в каком-то роде будет произведением искусства.
</p>
<a name=".D0.A1.D0.BB.D1.83.D1.87.D0.B0.D0.B9.D0.BD.D0.BE_.D1.81.D0.B3.D0.B5.D0.BD.D0.B5.D1.80.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.BD.D1.8B.D0.B9"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=55" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Случайно сгенерированный</span></h3>
<p>Мир при таком подходе может быть сколь угодно большим, однако надоедает его однообразие. Зато, в игру можно играть бесконечно, выполнять неисчислимые миссии (естественно, количество их видов ограничено). Самый удачный вариант - смешение генерированного мира с фиксированным - наличие искусственно созданных областей для сюжета, уникальных персонажей и предметов. Пример - игры серии The Elder Scrolls: Arena, Daggerfall, Morrowind.
</p>
<a name=".D0.93.D0.B5.D0.BD.D0.B5.D1.80.D0.B8.D1.80.D1.83.D1.8E.D1.89.D0.B8.D0.B9.D1.81.D1.8F_.D0.BF.D0.BE_.D1.85.D0.BE.D0.B4.D1.83_.D0.B8.D0.B3.D1.80.D1.8B"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=56" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Генерирующийся по ходу игры</span></h3>
<p>За этой технологией - будущее. Ведь, события, которые происходят где-то в отдалении от игрока, можно сильно огрубить, а мелкие, не имеющие к нему отношение - и вовсе опустить. Детализация игрового мира концентрируется вокруг игрока. Так, например, в GTA генерируются машины, пешеходы, но это лишь небольшая примесь данного метода. Идеально - когда генерируется абсолютно все (естественно, с привязкой к координатам, т. е. если игрок входит в квартиру номер N дома M и видит там шкаф с книгой, а потом отправляется в путешествие, то по его возвращению через продолжительное время в эту же квартиру, шкаф и книга должны быть там), включая здания, мебель (именно внешний вид), текстуры, ландшафт, структуру городов. А изменения, совершенные игроком, записываются (если он взял ту книгу, то после возвращении ее там не будет). Сложнее с событиями, которые происходят "на фоне" и в какой-то мере касаются игрока, но для этого можно использовать, например, такие характеристики, как отношения определенных социальных групп и достижения игрока.
</p>
<a name=".D0.A1.D1.8E.D0.B6.D0.B5.D1.82"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=57" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Сюжет</span></h3>
<p>Часто, в погоне за реалистичной графикой, забывают про сюжетную модель. Нет, конечно, сюжету уделяют большое внимание - детально прорабатывается весь путь главного героя, второстепенные персонажи, изобретаются неожиданные повороты сюжета, действие происходит в различных местах и условиях. Но,  в большинстве случаев, к сожалению, сюжет строго прямолинеен. То есть, конечно, по пути Вы можете заходить в закутки за полезными предметами, взрывать, портить, двигать предметы, возможно, решите массу оригинальных головоломок, но за шаг влево / вправо от сюжета - растрел. И это не может не сказаться на ощущении свободы выбора (которое начисто пропадает и игровое времяпрепровождение начинает мало чем отличаться от просмотра кинофильма). Поэтому, часто сюжет делают разветвленным, что ОЧЕНЬ способствует популярности игры у искушенных игроманов. В принципе, игра может иметь одно завершение (а может и несколько, в зависимости от Вашего поведения (выбор - к кому примкнуть, обычно), банальная смерть не в счет), но иметь небольшие ответвления в виде т. н. квестов - небольших миссий, которые Вы можете выполнять, а можете и пропустить. В зависимости от совершенных игроком дейсвий в течение игры может по разному освещены последующие события после прохождиения (Fallout). Еще одна вещь (на которой, кстати, сыграли (можно сказать, спекулировали) разработчики серии Silent Hill) - после прохождения игры игрок получает дополнительные возможности, если захочет пройти ее еще раз (в зависимости от концовки).
</p>
<a name=".D0.9E.D0.B3.D1.80.D0.B0.D0.BD.D0.B8.D1.87.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B8.D0.B3.D1.80.D0.BE.D0.B2.D0.BE.D0.B3.D0.BE_.D0.BF.D1.80.D0.BE.D1.81.D1.82.D1.80.D0.B0.D0.BD.D1.81.D1.82.D0.B2.D0.B0"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=58" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Ограничение игрового пространства</span></h3>
<p>В аркадах играющий ограничен простой прямоугольной стенкой - непроходимыми границами поля (иногда невидимыми). В очень редких случаях, поле закольцовано по принципу тора (выйдя за пределы поля с одной стороны, игрок появлялся с другой). Далее, в трехмерных боевиках игрока, обычно, ограничивает пространство уровня, который может быть какой угодно конфигурации (правда, при определенных обстоятельствах, можно было "вылететь" за пределы поля и "выпасть в космос"). Ограничить уровень могут "завалы", через которые нормальный человек легко перемахнет, а игрок - не в состоянии, "скользкие поверхности", на которые нельзя взобраться - соскальзываешь. В FarCry просто банально убивают, если "посмеешь". Вот еще один метод ограничения - бесконечное пространство, в котором есть некоторый объект (объекты) и можно сколько угодно удалиться от них, но далее будет всего лишь безбрежная пустота (морская гладь или еще что-нибудь однообразное). Метод применен в игре "Elite" и многих космических / авиаимитаторах. В качестве снисхождения к игроку, иногда его "притягивает" "осознанная область" (создается иллюзия движения, хотя перемещения не происходит), чтобы ему не нужно было долго бежать обратно.
</p>
<a name=".D0.98.D1.81.D0.BA.D1.83.D1.81.D1.81.D1.82.D0.B2.D0.B5.D0.BD.D0.BD.D1.8B.D0.B9_.D0.B8.D0.BD.D1.82.D0.B5.D0.BB.D0.BB.D0.B5.D0.BA.D1.82"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=59" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Искусственный интеллект</span></h2>
<a name=".D0.90.D0.BA.D1.82.D0.B8.D0.B2.D0.B0.D1.86.D0.B8.D1.8F_.283D-.D0.B1.D0.BE.D0.B5.D0.B2.D0.B8.D0.BA.D0.B8.29"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=60" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Активация (3D-боевики)</span></h3>
<p>Так как в игре на одном уровне могут одновременно находиться сотни и тысячи врагов, при даже самом простом алгоритме их поведения существенно бы тратились ресурсы (по крайней мере на уровне 94 года). С другой стороны, игрока мало интересует, чем занимаются враги, которые находятся в противоположном конце уровня, ведь до него еще идти и идти. Да и вообще - чем заниматься врагам, когда рядом нет игрока (как-то действуя, могут случайно перебить друг друга, забрести куда-нибудь не туда или подохнуть)? Поэтому был найден простой способ - пока враг не увидит игрока (или игрок врага), либо пока игрок не приблизится на достаточное расстояние, враг стоит столбом и ничего не делает. Посмотрите на камеры в Duke Nukem или на радар Zero Tolerance, использовав биосканер (хотя в DN враги "топчутся на месте", но это то же, что стоять). Как только враг "проснулся", он тут же идет искать игрока. С другой стороны, когда ресурсов достаточно, можно позволить врагам "скриптово пожить": патрулировать, болтать, танцевать, и т. д. В случае, когда враг достаточно большое время не видит игрока, он может "деактивироваться".
</p>
<a name=".D0.9D.D0.B0.D1.85.D0.BE.D0.B6.D0.B4.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D1.83.D1.82.D0.B8"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=61" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Нахождение пути</span></h3>
<p>Алгоритм нахождения пути был рассмотрен в прошлом выпуске, хотя для врагов в большинстве трехмерных игр он прост - тупо переть на игрока и / или стрелять. И это дает неплохие результаты: когда монстр идет на играющего, "чувствуется ослепляющая ярость", если играющий убежал, а монстр топчется позади (потому что не может найти путь) - "стало наплевать, занялся своими делами". Еще враги могут бегать по невидимым дорожкам, проторенным создателями уровней, чтобы добраться до игрока, могут додуматься обойти препятствие.
</p>
<a name=".D0.A1.D1.82.D1.80.D0.B5.D0.BB.D1.8C.D0.B1.D0.B0"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=62" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Стрельба</span></h3>
<p>В подавляющем большинстве случаев, враги стреляют в то место, где в данный момент находится противник. Для пуль, это, в общем-то, не принципиально, а вот всякие ракеты-фаерболы летят мимо, если просто бегать вокруг врага (или толпы врагов). Пока, насколько я знаю, на опережение стреляют только боты. Но, даже глупый враг способен быстро убить игрока, абсолютно точно стреляя из "мгновенного" оружия, поэтому разработчики либо намеренно ухудшают точность его стрельбы, либо делают такую стрельбу "суперприемом", к которому враг "готовится", чтобы дать возможность играющему уйти в укрытие (Shambler из Quake, некоторые "боссы"). Играющему тоже могут ослабить прицельность огня (и корректировать ее в зависимости от того, бежит / стоит / сидит / лежит ли он).
</p>
<a name=".D0.97.D1.80.D0.B5.D0.BD.D0.B8.D0.B5_.283D-.D0.B1.D0.BE.D0.B5.D0.B2.D0.B8.D0.BA.D0.B8.29"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=63" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Зрение (3D-боевики)</span></h3>
<p>Первоначально, зрение компьютерных оппонентов было абсолютным. То есть, враги точно знали координаты игрока, спрятаться от них было невозможно (разве что, запереться где-нибудь или убежать от них так, чтобы они не смогли найти дороги). Так как это было, в общем-то, жульничество, то позже предпринимались попытки ограничить абсолютное зрение компьютерных соперников. Активацию тоже можно в какой-то степени считать такой попыткой (можно подобраться к врагу сзади и если не убить, то серьезно поранить). Но, если вместе с имплементацией зрения серьезно не поработать с интеллектом врагов, может получиться стадо баранов, идущих на убой (что, кстати, часто и случается). Например, в FarCry я перестреливался с солдатом через окно. После одного-двух попаданий, он решил присесть и тут же закричал "Куда он делся?!!!" - я оказался за пределами его видимости (так маленькие дети закрывают глаза ладонями и, испугавшись, кричат: "Куда все пропало?"). Однако, даже такой вариант расширяет арсенал тактических приемов (в игре Commandos зрение врагов - один из краеугольных камней в игровой концепции).
</p>
<a name=".D0.9E.D1.82.D1.81.D1.82.D1.83.D0.BF.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=64" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Отступление</span></h3>
<p>В очень немногих играх, враг после того как его здоровье окажется ниже определенного порога, панически убегает от игрока. Фактически, это игроку только на руку - враг перестает стрелять, а попав в тупик будет просто стоять, "ожидая расстрела". Это паника, а вот отступление было бы гораздо интереснее - противник начинает уклоняться от выстрелов, укрываться за объектами, отстреливаться и его не так-то просто поймать. Я не видел реализации такого метода, за исключением скриптовой (ситуация, когда оппонент бежит через все поле, которое хорошо простреливается, чтобы укрыться за обломками взорванного автомобиля и там присесть, чтобы его преспокойно пристрелили - не в счет).
</p>
<a name=".D0.98.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.BE.D0.B1.D1.8A.D0.B5.D0.BA.D1.82.D0.BE.D0.B2"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=65" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Использование объектов</span></h3>
<p>В ролевых играх NPC часто используют лечение, когда здоровье приближается к 0, магию. Иногда враги настолько умны, что идут и подбирают нужные предметы (хотя, не всегда оптимальный вариант бежать к предмету вместо того чтобы стрелять / драться).
</p>
<a name=".D0.9D.D0.B0.D0.B8.D0.B2.D1.8B.D0.B3.D0.BE.D0.B4.D0.BD.D0.B5.D0.B9.D1.88.D0.B0.D1.8F_.D0.BF.D0.BE.D0.B7.D0.B8.D1.86.D0.B8.D1.8F_.28.D0.BF.D0.BE.D1.85.D0.BE.D0.B4.D0.BE.D0.B2.D1.8B.D0.B5_.D1.81.D1.82.D1.80.D0.B0.D1.82.D0.B5.D0.B3.D0.B8.D0.B8.29"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=66" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Наивыгоднейшая позиция (походовые стратегии)</span></h3>
<p>Это еще из шахмат - анализируются все возможные ходы, для каждой полученной позиции вычисляются очки (в шахматах - очки дает съеденная фигура, "простреливаемое" поле, шах, угроза фигуре противника, продвинутая пешка, защита своей фигуры, отбирает - угроза своей фигуре и т. д.), затем делается ход, набравший наибольшее количество очков. Довольно примитивно, но позволяет добиться средних результатов и конкурентоспособности при умелом использовании. Плюсы - можно относительно легко "объяснить" компьютеру, чего он должен избегать и к чему стремиться, создать и сбалансировать "систему ценностей". Минусы - может потребоваться много времени на проработку ходов компьютером, а также игрок может найти способы заставить компьютер сделать глупый ход.
</p>
<a name=".D0.A0.D0.B0.D0.B7.D0.B2.D0.B8.D1.82.D0.B8.D0.B5_.28.D1.81.D1.82.D1.80.D0.B0.D1.82.D0.B5.D0.B3.D0.B8.D0.B8.29"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=67" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Развитие (стратегии)</span></h3>
<p>Когда нужно создать в стратегиях более-менее достойного противника, нужно проработать систему развития (хотя, в Dune 2, например, противник просто отстраивал разрушенные здания). Для этого необходимо создать иерархию приоритетов (что строить / улучшать / изучать в первую очередь). Самые изощренные компьютерные противники распределяют приоритеты в зависимости от ситуации. Хотя, часто недостаток умения развиваться компьютеру компенсирует возможность жульничать. К тому же, он заведомо обладает преимуществами перед человеком - способностью производить несколько операций одновременно и точностью.
</p>
<a name=".D0.90.D1.82.D0.B0.D0.BA.D0.B0_.28.D1.81.D1.82.D1.80.D0.B0.D1.82.D0.B5.D0.B3.D0.B8.D0.B8.29"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9E%D0%B1%D0%B7%D0%BE%D1%80_%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B9%2C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%B2_%D0%B8%D0%B3%D1%80%D0%B0%D1%85&amp;action=edit&amp;section=68" title="Обзор технологий, используемых в играх">править</a>]</span> <span class="mw-headline">Атака (стратегии)</span></h3>
<p>Самый простой способ - набрать отряд и напасть на игрока. Отразить такую атаку довольно просто, к тому же такие действия легко предсказуемы, что дает возможность хорошо подготовиться к встрече. Другое дело, когда компьютер атакует, выбирая малозащищенное место, нападает толпой, не растягивая отряд в цепочку, избегает боя с численно превосходящим отрядом игрока, отступает при неблагоприятных обстоятельствах. Такое поведение более характерно для походовых стратегий, отчасти потому что у игрока есть время подумать и произвести все необходимые действия.
</p>
<hr />
<p>Автор: <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Matt_Merkulov" title="Участник:Matt Merkulov">Матвей Меркулов</a> (E-mail: MattMerk@mail.ru, ICQ: 392-274-050)
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="3D-акселераторы"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:3D-акселераторы&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=3D-акселераторы&amp;action=edit">править</a>]</span><span class="mw-headline">3D-акселераторы</span></h1>
<p>Вот и я решил сделать что-нибудь полезное для нашего журнала и всей коммунити. Но поскольку в основах "программизма" с нашими "блиц-зубрами" мне тягаться бесполезно, то я решил блеснуть знаниями, там, где уже немножко разбираюсь. Очень надеюсь, что кому-нибудь эта информация пригодится.
</p>
</p><p>В статье я собираюсь привести не столько технические характеристики видеоакселераторов, сколько попытаться упорядочить их и разбить  на некоторые группы с равными возможностями и производительностью. Ведь частенько, особенно в последнее время, из одного только названия видюхи нельзя сделать вывод о ее возможностях.  Многие ли из вас знают, что, например, Geforce FX 5600XT 256M 64bit где-то в 4 раза медленнее, чем Geforce FX 5600Ultra 128M 128bit? Нехилая разница, правда? Несмотря на то, что у первой карточки четверть гига памяти на борту… (Раньше люди тоже насмотревшись и наохавшись от производительности Riva TNT2 Ultra шли и покупали Riva TNT2 Vanta, вдвое урезанную по шине и еще в двое по частотам и хвастались, что у них самая быстрая видеокарта&nbsp;:)).
</p><p>Начну обзор я с самых первых массовых 3Д акселераторов, так как на Блице легко создавать не требовательные к ресурсам игры. Некоторые мои кривые демки  запускались и бегали со скоростью 8-10 фпс даже на S3 Virge 3D DX 2Mb&nbsp;:). А этой карточки даже не будет в обзоре, ввиду уж очень низкой скорости в 3D! 
</p>
<a name="DirectX_5"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=3D-%D0%B0%D0%BA%D1%81%D0%B5%D0%BB%D0%B5%D1%80%D0%B0%D1%82%D0%BE%D1%80%D1%8B&amp;action=edit&amp;section=1" title="3D-акселераторы">править</a>]</span> <span class="mw-headline">DirectX 5</span></h2>
<p>Итак, к самой первой группе я причислил:
</p>
<ul><li>Nvidia Riva 128
</li><li>Nvidia Riva 128 ZX
</li><li>Ati 3D Rage Pro
</li><li>3DFX Voodoo Graphics
</li><li>3DFX Voodoo Rush
</li><li>Matrox G200
</li></ul>
<p>Производительности этих карточек когда-то хватало на такие великие игры, как Quake 2, Unreal и Half-Life! Все они поддерживают только DirectX5 и ранние версии OpenGL. И имеют только начальные и самые простые функции по 3Д обработке.  Так же,  почти все карточки имеют очень небольшой объем памяти, за исключением Riva 128ZX (8М). Так же эти акселераторы не поддерживают рендеринг в 32-битном цвете и ограничены разрешением 800х600, а некоторые и 640х480. Затачивать свои игрушки под это поколение ИМХО не стоит. Потому что те, кто еще пользуются такими видеокартами, вряд ли вообще играют в 3-х мерные игры.  
</p><p>А вот следующее поколение куда более интересно, а, главное, до сих пор массово распространено в компьютерах наших не очень богатых сограждан  и обладает уже кое-какими возможностями и скоростью. Эти железяки уже поддерживают или делают вид, что поддерживают мультитекстурирование (multitexturing), трилинейную фильтрацию , бамп-меппинг(trilinear filtering) в той или иной извращенной форме и т.д.  Большинство обзавелось 32-битным цветом с 8-битным стенсил-буффером (8-bit stensil-buffer) и поддержкой рендера в высоких разрешениях, вплоть до 1600х1200. Правда, про скорость в этом режиме все обычно умалчивают… 
</p><p>Voodoo 2 следовало бы причислить к прошлому поколению, но благодаря ее зверской на тот период мощи и аппаратной поддержки Direct3D 6.0 она может потягаться с некоторыми карточками данной группы. 
</p><p>Все остальные перечисленные видеокарты аппаратно поддерживают DX6-DX6.1 и частично совместимы с DX7. На этих видюхах уже можно добиться довольно красивой графики а-ля Quake 3, Need for Speed 5 (Porche) и т.д. Правда филлрейта хватает только на низкие разрешения с минимальным количеством эффектов требующих несколько текстур (lightmap, bump и т.д.). 
</p>
<a name="DirectX_6.2FDirectX_7."></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=3D-%D0%B0%D0%BA%D1%81%D0%B5%D0%BB%D0%B5%D1%80%D0%B0%D1%82%D0%BE%D1%80%D1%8B&amp;action=edit&amp;section=2" title="3D-акселераторы">править</a>]</span> <span class="mw-headline">DirectX 6/DirectX 7.</span></h2>
<ul><li>Nvidia Riva TNT
</li><li>Nvidia Riva TNT 2 Vanta LT
</li><li>Nvidia Riva TNT 2 Vanta 
</li><li>Nvidia Riva TNT 2 M64
</li><li>Nvidia Riva TNT 2
</li><li>Nvidia Riva TNT 2 PRO
</li><li>Nvidia Riva TNT 2 Ultra
</li><li>Ati Rage 128
</li><li>Ati Rage 128 PRO
</li><li>Ati Rage 128 Ultra
</li><li>3DFX Voodoo 2
</li><li>3DFX Voodoo 2 SLI
</li><li>3DFX Voodoo Banshee
</li><li>3DFX Velocity 100 
</li><li>3DFX Velocity 200
</li><li>3DFX Voodoo 3 1000
</li><li>3DFX Voodoo 3 2000
</li><li>3DFX Voodoo 3 3000
</li><li>3DFX Voodoo 3 3500
</li><li>SiS 300              
</li><li>SiS 305              
</li><li>S3 Savage 3D
</li><li>S3 Savage 4 GT
</li><li>S3 Savage 4 PRO
</li><li>S3 Savage 4 Exreme
</li><li>Matrox G400
</li><li>Matrox G400 MAX
</li></ul>
<p>Следующее поколение, не сильно отрываясь по технологии, заметно окрепло по позициям  мультитекстуринга и геометрической обработки. 
</p>
<a name=".D0.9F.D0.BE.D0.BB.D0.BD.D0.BE.D1.86.D0.B5.D0.BD.D0.BD.D1.8B.D0.B9_DirectX_7."></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=3D-%D0%B0%D0%BA%D1%81%D0%B5%D0%BB%D0%B5%D1%80%D0%B0%D1%82%D0%BE%D1%80%D1%8B&amp;action=edit&amp;section=3" title="3D-акселераторы">править</a>]</span> <span class="mw-headline">Полноценный DirectX 7.</span></h2>
<ul><li>Nvidia GeForce 256
</li><li>Nvidia GeForce 256 DDR
</li><li>Nvidia GeForce 2 MX
</li><li>Nvidia GeForce 2 MX 200
</li><li>Nvidia GeForce 2 MX 400 64 bit
</li><li>Nvidia GeForce 2 MX 400
</li><li>Nvidia GeForce 4 MX 420
</li><li>Nvidia GeForce 4 MX 440-SE
</li><li>Ati Radeon VE / 7000
</li><li>Ati Radeon 256 SDR       
</li><li>Ati Radeon 7500 SDR
</li><li>3DFX Voodoo 4 4500   
</li><li>3DFX Voodoo 5 5500
</li><li>Sis 315              
</li><li>S3 Savage 2000
</li></ul>
<p>Сильно подрос филрейт (fillrate) - многие карточки имеют по 4 текстурных модуля. У большинства из них появился TnL блок, кое-какие оптимизации пропускной полосы памяти (раннее отсечение Z-координат и компрессия текстур, появившаяся благодаря S3 и ее Savage), поддержка Анти-Алиасинга (Anti-aliasing) (правда, методом Super-sampling с убийственно низкой  скоростью) и Анизотропной фильтрации (нормально реализована только у Ati).
</p><p>Далее: 
</p>
<ul><li>Nvidia GeForce 2 GTS
</li><li>Nvidia GeForce 2 PRO
</li><li>Nvidia GeForce 2 Ti VX
</li><li>Nvidia GeForce 2 Titanium
</li><li>Nvidia GeForce 2 Ultra
</li><li>Nvidia GeForce 4 MX 4000
</li><li>Nvidia GeForce 4 MX 440
</li><li>Nvidia GeForce 4 MX 460
</li><li>Nvidia GeForce 4 MX 440-8x / 480
</li><li>Nvidia GeForce FX 5600 XT 64bit
</li><li>Nvidia GeForce FX 5200 SE
</li><li>Ati Radeon 7200      
</li><li>Ati Radeon 7500
</li><li>Ati Radeon 9200 SE
</li><li>Sis Xabre 200
</li><li>Sis Xabre 400
</li><li>Sis Xabre 600
</li></ul>
<p>Эти видеокарты (кроме Radeon 9200 SE, GeForce FX 5200 SE/5600XT  и семейства Xabre) представляют собой, по сути, усовершенствованные акселераторы прошлого поколения. Сильно выросшие частоты и использование более продвинутых технологий экономии ПСП (пропускной способности памяти) позволяют с грехом пополам играть и в современные игры. Были попытки "засунуть" в них еще и шейдеры, и они таки там присутствуют в зачаточном состоянии, но совместимость с  DirectX 8 они не обеспечивают.
</p><p>А вот  Radeon 9200 SE, и Xabre (200/400/600) имеют поддержку пиксельных шейдеров версии 1.4 и 1.1 соответственно, и вершинных шейдеров 1.1 и 1.0 ( 1.0 эмулируются  ЦПУ, как и у остальных чипов в данной группе). GeForce FX 5200 SЕ  и GeForce FX 5600XT имеют полноценную поддержку  DirectX 9 и, соответственно, пиксельных и вершинных шейдеров вплоть до версий 2.0. Но, учитывая крайне низкую скорость данных видеокарт в новых играх, про это можно забыть&nbsp;:).  Это также касается и Xabre.
</p>
<a name="DirectX_8.1_.2F_DirectX_9"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=3D-%D0%B0%D0%BA%D1%81%D0%B5%D0%BB%D0%B5%D1%80%D0%B0%D1%82%D0%BE%D1%80%D1%8B&amp;action=edit&amp;section=4" title="3D-акселераторы">править</a>]</span> <span class="mw-headline">DirectX 8.1 / DirectX 9</span></h2>
<ul><li>Nvidia GeForce 3 Ti200
</li><li>Nvidia GeForce 3 Ti
</li><li>Nvidia GeForce 3 Ti500
</li><li>Nvidia GeForce 4 Ti 4200
</li><li>Nvidia GeForce 4 Ti 4200-8x
</li><li>Nvidia GeForce 4 Ti 4400
</li><li>Nvidia GeForce 4 Ti 4800-SE
</li><li>Nvidia GeForce 4 Ti 4600
</li><li>Nvidia GeForce 4 Ti 4800
</li><li>Nvidia GeForce FX 5200
</li><li>Nvidia GeForce FX 5500
</li><li>Nvidia GeForce FX 5600
</li><li>Nvidia GeForce FX 5600 XT
</li><li>Nvidia GeForce FX 5200 Ultra
</li><li>Nvidia GeForce PCX 4300
</li><li>Nvidia GeForce PCX 5300
</li><li>Nvidia GeForce PCX 5550
</li><li>Ati Radeon 8500 LE / 9100
</li><li>Ati Radeon 8500 
</li><li>Ati Radeon 9000
</li><li>Ati Radeon 9000 PRO
</li><li>Ati Radeon 9200
</li><li>Ati Radeon 9200 PRO
</li><li>Ati Radeon 9250
</li><li>Ati Radeon 9550 SE
</li><li>Ati Radeon 9600 SE
</li><li>Ati Radeon X300 SE
</li></ul>
<p>Часть этих видеокарт была массовой пару лет назад, а некоторые пользуются спросом и сейчас. В нашей стране (ИМХО) - карточки данного класса стоят в компьютерах у большинства пользователей. На этих видеокартах даже можно "посмотреть", как выглядят Far Cry, DooM 3 и Half-Life 2. 
</p><p>Можно даже поиграть в эти игры, если мазохизм вам не совсем чужд&nbsp;:). (Признаюсь, что последние 2 игры я прошел на Radeon 9000).  
</p><p>Так вот, все эти видеокарты в той или иной степени и с разным результатом поддерживают почти все новомодные фичи. 
</p><p>Например, семейство Титаниум 4 является до сих пор весьма ядреным имея зверский филрейт благодаря высокой частоте чипа и 8-ми текстурным модулям. Но их сгубил маркетинг (Nvidia вовсю пропихивала более дешевые FX-ы) и отсутствие поддержки шейдеров 2.0.
</p><p>Все перечисленные чипсеты поддерживают Анти-алиасинг степеней 4х (некоторые 6х). И анизотропную фильтрацию 8х/16Х (Nvidia/Ati). На Радеонах 8500-9250 в режиме АА  используется устаревший метод суперсемплинга, у остальных - мультисемплинг и, соответственно, куда меньшие потери в скорости. Еще замечу, что включение анизотропии практически не влияет на скорость у любых чипов ATI, но довольно  заметно съедает скорость у Geforce-ов, особенно 4-ого поколения. 
</p><p>Все видеокарты отлично работают с шейдерами (кроме FX-серии). У Ати серий 8500-9250 есть небольшое преимущество в скорости перед 3-ми Geforce-ами за счет использования более продвинутой (1.4 против 1.1) версии пиксельных шейдеров, а вот 4-ые Титаны, поддерживая версию 1.3, берут свое грубой мощью - более высокими частотами и количеством исполнительных блоков. 
</p><p>5-е Geforce-ы (серия FX) еще неплохо справляется с играми, использующими шейдеры версии 1.1-1.3, благодаря жестоким оптимизациям драйверов и программе Nvidia по поддержке разработчиков, но представляют из себя жалкое зрелище, как по скорости, так и по качеству в  играх, где шейдеры 2.0 присутствуют массово. 
</p><p>9550/9600SE попали в эту группу "благодаря" 64-битной шине памяти. Данные "усовершенствования" конечно, весьма снижают цену, но зачастую не дают раскрыться на полную мощь неплохим чипам. (Кстати, подобную практику "урезания" начала первой Nvidia, выпустив соответствующие чипы и разрешив китайским производителям удешевлять карточки нижнего и среднего уровня как им вздумается). Вот с тех пор мы и имеем кучу всяких суффиксов типа LE/SE/LT/XT/TX/Pro и так далее.… Причем иногда один и тот же суффикс у разных производителей может означать как урезанную, так и усиленную версию чипа. Например, 5600ХТ и 9600ХТ - первый "опущен", а второй наоборот,  "разогнан". А народ ведь путается. А ведь было время, когда VooDoo 2 был и в Африке VooDoo 2&nbsp;!   Ну, что-то я отвлекся, видимо наболело&nbsp;:).
</p>
<a name="DirectX_9"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=3D-%D0%B0%D0%BA%D1%81%D0%B5%D0%BB%D0%B5%D1%80%D0%B0%D1%82%D0%BE%D1%80%D1%8B&amp;action=edit&amp;section=5" title="3D-акселераторы">править</a>]</span> <span class="mw-headline">DirectX 9</span></h2>
<ul><li>Nvidia GeForce 6200
</li><li>Nvidia GeForce 6600
</li><li>Nvidia GeForce FX 5600 Ultra
</li><li>Nvidia GeForce FX 5700 LE
</li><li>Nvidia GeForce FX 5700
</li><li>Nvidia GeForce FX 5700 Ultra 
</li><li>Nvidia GeForce PCX 5750
</li><li>Nvidia GeForce PCX 5900
</li><li>Nvidia GeForce PCX 5950
</li><li>Ati Radeon 9500 /64 MB
</li><li>Ati Radeon 9500 /128 MB
</li><li>Ati Radeon 9500 PRO
</li><li>Ati Radeon 9550
</li><li>Ati Radeon 9550 XT
</li><li>Ati Radeon 9600
</li><li>Ati Radeon 9600 PRO LT
</li><li>Ati Radeon 9600 PRO
</li><li>Ati Radeon 9600 XT
</li><li>Ati Radeon X300
</li><li>Ati Radeon X600 PRO
</li><li>Ati Radeon X600 XT
</li><li>Ati Radeon X700
</li></ul>
<p>Скорость акселераторов уже вполне достаточна для непритязательных геймеров. В не самых навороченных играх уже можно позволить себе высокие разрешения и разные там АА и АФ&nbsp;:). 
</p><p>Из особенностей, можно только заметить низкую скорость шейдеров 2.0 на FX 5600/5700, которая отчасти компенсируется  высокой частотой чипов и памяти, особенно у версий "Ультра" - до 950МГц. 
</p><p>А так же 6200/6600 имеют поддержку новейшей модели шейдеров 3.0. Которая пока фактически нигде не используется, (но хоть скорость старых шейдеров (1.1-1.0) нормальная). 
</p><p>Дальше идут монстры, прошлого поколения и нового:
</p>
<ul><li>Ati Radeon X700 XT
</li><li>Ati Radeon 9700
</li><li>Ati Radeon 9700 PRO
</li><li>Ati Radeon 9800 SE-128 bit
</li><li>Ati Radeon 9800 SE-256 bit
</li><li>Ati Radeon 9800
</li><li>Ati Radeon 9800 PRO /128 MB
</li><li>Ati Radeon 9800 PRO /256 MB
</li><li>Ati Radeon 9800 XT
</li><li>Nvidia GeForce FX 5800 Ultra
</li><li>Nvidia GeForce FX 5900 XT
</li><li>Nvidia GeForce FX 5900 ZT
</li><li>Nvidia GeForce FX 5900
</li><li>Nvidia GeForce FX 5900 Ultra
</li><li>Nvidia GeForce FX 5950 Ultra
</li><li>Nvidia GeForce 6600 GT
</li><li>Nvidia GeForce 6800 LE
</li></ul>
<p>Дури у этих акселей хватает уже на все. Ну и цена соответствующая. Хотя нужно заметить, что в последнее время они становятся более доступными. Если, конечно цена порядка 200 у.е. является доступной&nbsp;:). А ведь когда-то нормальный акселератор стоил порядка 50 у.е (например Savage4 в 99 году) и его хватало для любой существующей на тот момент игры!
</p><p>А это их старшие братья:
</p>
<ul><li>Nvidia GeForce 6800 PRO
</li><li>Nvidia GeForce 6800 GT
</li><li>Nvidia GeForce 6800 Ultra
</li><li>Nvidia GeForce 6800 Ultra Extreme
</li><li>Ati Radeon X800 PRO
</li><li>Ati Radeon X800 XT
</li><li>Ati Radeon X800 XT PE
</li><li>Ati Radeon X850 PRO
</li><li>Ati Radeon X850 XT
</li><li>Ati Radeon X850 XT PE
</li></ul>
<p>Все то же, только еще быстрее и дороже&nbsp;:). В данной статье описывать их нет никакого смысла. 
</p><p>Кстати, если заметили, то на современном рынке присутствуют акселераторы только на чипах от Ati и Nvidia. S3  и XGI (переименованное графическое подразделение Sis) время от времени анонсируют свои поделки, но дальше семпловых образцов и мелкосерийных выпусков дело не заходит. А Matrox ушел в нишу мультимониторных конфигураций, скорость и глюченность Parhelia - ниже всякой критики.
</p><p>Тут сказываются как не отлаженные и сырые драйвера, неохота производителей видеокарт проталкивать и раскручивать новые чипы, так и в целом, несбалансированность и общая слабость  этих решений. Будем надеяться, что с внедрением WGF 2.0 ситуация изменится к лучшему…
</p><p>Отдельно стоит упомянуть про интегрированные видеокарты. Думаю, не многие из вас в курсе, что порядка 40% всех поставляемых в мире видеочипов ютятся в материнках на чипсетах от Intel!!! i815Е, i845GV, i865G, а теперь и i915GL - простенькие, слабенькие тихо мирно стоят в офисах по всему миру. Балуются интегрированными чипсетами и VIA, SIS, Ati, Nvidia. Общее у всех них одно - глючные драйвера и низкая скорость. Бывали попытки догнать low-end сектор дискретных видеокарт (nforce 420, nforce 2 400 , Ati 9000/9100 IGP, Radeon Xpress 200). Видеокаселераторы в этих чипсетах за счет поддержки двухканального режима работы памяти догоняли и обгоняли своих урезанных по шине собратьев (МХ400-64bit, МХ440SЕ и 9000SЕ). Но широкого распространения не получили. Intel-овский Extreme Graphics 1 и 2 несмотря на название в лучшем случае сопоставим с МХ200 и ниже. Приблизительно с этой же скоростью работают и "последние" за 3 года чипсеты от Sis, Trident и VIA (Sis 755G, VIA KM266/KM400/P4M266 и  т.д.). i815E и другие SDR чипсеты  (VIA KM133/KLE133/PLE133, Sis 630/730) конкуренты в лучшем случае для TNT2 Vanta.
</p><p>Ничуть не  лучше и современные дела. i915GL, Radeon Xpress 200  и будущие чипсеты показывают скорость на уровне самых слабых видеокарт присутствующих в продаже - FX5200SE и R9550SE.
</p><p>Чуть лучше себя ведут видеокарты, имеющие технологию Hyper Memory и Turbo Cache (Geforce 6200TC и Radeon Х300 HM). Они являются дискретными (исключительно под новомодную шину PCI-E), но под свои нужды (за исключением кадрового буфера) используют системную память. Скорость соответствующая.
</p><p>Хочу заметить, что я умышленно не упомянул некоторые видеокарты, когда-либо присутствовавшие на рынке ввиду их малой распространенности. Например, последние разработки Matrox, S3, Trident и XGI (графическое подразделение Sis). Некоторые "древние" малораспространенные видеокарты тоже остались "за кадром" (Permedia 2 и 3 и т.д.). Но я постарался описать большинство массовых карт, кратко рассмотреть их недостатки и сильные стороны. И надеюсь, это поможет вам лучше ориентироваться в безумном мире 3Д-акселераторов&nbsp;:). 
</p><p>С уважением, Татаринов Дмитрий a.k.a. OAK.
</p>
<a name=".D0.A1.D1.83.D1.84.D1.84.D0.B8.D0.BA.D1.81.D1.8B_.D0.B2_.D0.BD.D0.B0.D0.B7.D0.B2.D0.B0.D0.BD.D0.B8.D1.8F.D1.85_.D1.87.D0.B8.D0.BF.D0.BE.D0.B2_.D0.B2.D0.B8.D0.B4.D0.B5.D0.BE.D0.BA.D0.B0.D1.80.D1.82."></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=3D-%D0%B0%D0%BA%D1%81%D0%B5%D0%BB%D0%B5%D1%80%D0%B0%D1%82%D0%BE%D1%80%D1%8B&amp;action=edit&amp;section=6" title="3D-акселераторы">править</a>]</span> <span class="mw-headline">Суффиксы в названиях чипов видеокарт.</span></h2>
<ul><li>SE - обычно трактуется как Slow Edition, то есть "замедленная" версия. Чаще всего означает, что шина памяти урезана вдвое и, как минимум, сниженные частоты памяти и чипа. У некоторых видеокарт могут быть отключены часть пиксельных конвейеров.
</li><li>LE - Lite Edition - "облегченная" версия. Принцип тот же - "режем" и "даунлочим" все что можно&nbsp;:)
</li><li>LT - Lite  - просто "Лайт" этим все сказано.
</li><li>LX  - обычно несколько замедленная по частоте чипа версия.
</li><li>XT (Ati) - eXtended  - "расширенная". Частоты завышены. Представляет из себя самую скоростную версию в линейке.  
</li><li>XT (Nvidia) - расшифровки не знаю. Частоты занижены по отношению к базовым версиям.
</li><li>ZT - то же что и ХТ (у Nvidia), но частоты снижены еще сильнее.
</li><li>VX - тоже самое по смыслу, что и ZT.
</li><li>Pro - ускоренный вариант чипа, но ниже, чем XT(Ati)/Ultra
</li><li>GT - обычно то же, что и Pro. (У S3 чуть ниже рангом, чем Pro, но выше базового варианта).
</li><li>Extreme - Ультра-крайний вариант. 
</li><li>Ultra - самый "разогнанный" вариант.
</li><li>Nitro - то же, что и "Ультра". 
</li><li>FX - присутствует в названии только в 5-ом поколении Geforce. По слухам, означает, что в основу данного семейства легли наработки компании 3DFX, вошедшей в состав Nvidia лет 5 назад.
</li><li>MX - так Nvidia маркирует бюджетные, сильно урезанные версии видеочипов. Обычно не имеющие ничего общего с топовыми.
</li><li>ZX - так именовался усиленный вариант Riva 128. Отдельно можно отметить еще суффиксы Vanta и M64, применяемые в семействе ТНТ2. Оба обозначают урезание вдвое шины памяти, а первый еще и снижение частот. 
</li><li>GTS - просто добавили в название 2-му Geforce-у, потому что "Giga Texel Shader" это круто!
</li><li>Titanium - когда Ati выпустила R8500, с ним нужно было конкурировать, поэтому и появилось данное семейство, включившее в себя разогнанную и чуть "даунлоченную" версии 3-го Geforce-а. А для конкуренции с R7500 скрестили Gf 2 Pro и Gf 2 Ultra и получили 2-ой Титаниум. За 4-ым поколением название осталось - красивое!
</li><li>PCX - ввели для отличия от AGP версий видеокарт. 
</li><li>SLI - Scan line Interactive - технология позволяющая объединять 2 или более графических процессора/видеокарты. 
</li><li>8х - так обозначались карты получившие поддержку тогда нового стандарта AGP 3.0 несовместимого с AGP 1.0 (1х/2х).
</li><li>128, 256 или 512  - раньше в названии любили указывать разрядность графического процессора (не путать с разрядностью шины и объемом памяти).
</li></ul>
<hr />
<p>Автор: Дмитрий Татаринов (oak667@leasat.net)
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Работа со списками"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Работа со списками&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Работа со списками&amp;action=edit">править</a>]</span><span class="mw-headline">Работа со списками</span></h1>
<p>Поводом написания этой статьи было мое личное заблуждение по использованию типов в Blitz-е. Возьмем простой пример - нужен список юнитов игрока. Что обычно делается (ну или я делал) - делаю такой простой код: 
</p>
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Type</span> TUnit<br />
<p><span style="color: #aaffff; font-weight: bold;">Field</span> x,y,id<br />
<span style="color: #aaffff; font-weight: bold;">End Type</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Global</span> Units.TUnit &nbsp;<span style="color: #ffee00">; создаем переменную юнитов</span><br />
<span style="color: #aaffff; font-weight: bold;">for</span> i=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">to</span> <span style="color: #33ffdd;">10</span><br />
Units.TUnit = <span style="color: #aaffff; font-weight: bold;">New</span> TUnit<br />
Units\x=i:Units\x=i:Units\id=i<br />
<span style="color: #aaffff; font-weight: bold;">next</span><br />
<span style="color: #ffee00">; теперь переберем все юниты</span><br />
<span style="color: #aaffff; font-weight: bold;">for</span> Unit.TUnit=<span style="color: #aaffff; font-weight: bold;">Each</span> TUnit<br />
<span style="color: #aaffff; font-weight: bold;">Print</span> Unit\id<br />
</p>
<span style="color: #aaffff; font-weight: bold;">Next</span></div>
<p>В данном случае все нормально - но если мы захотим списки для каждого игрока, то такой способ не подойдет, т.к. при переборе Each Unit  - будут выдаваться все юниты этого типа. Можно конечно ставить всякие условия, но есть способ гораздо лучший. Делаем связанный список используя типы Блица и проблема решается. Вникать в подробности создания списка я не буду (это можно понять самому, т.к. код небольшой), а дам пример использования.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffee00">; Переменная списка - может быть сколько угодно разных</span><br />
<p><span style="color: #aaffff; font-weight: bold;">Global</span> MyList.TList = <span style="color: #aaffff; font-weight: bold;">New</span> TList<br />
<span style="color: #aaffff; font-weight: bold;">Global</span> MyList2.TList = <span style="color: #aaffff; font-weight: bold;">New</span> TList<br />
<br />
<span style="color: #aaffff; font-weight: bold;">For</span> i=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">10</span><br />
Add<span style=" ">&#40;</span>MyList,i<span style=" ">&#41;</span> <span style="color: #ffee00">; Добавляет i в список List</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">For</span> i=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">10</span><br />
Add<span style=" ">&#40;</span>MyList2,i<span style="color: #33ffdd;">+15</span><span style=" ">&#41;</span> <span style="color: #ffee00">; Добавляет i в список List</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
Start<span style=" ">&#40;</span>MyList<span style=" ">&#41;</span> <span style="color: #ffee00">; Устанавливает список на начало</span><br />
<span style="color: #aaffff; font-weight: bold;">While</span> <span style="color: #aaffff; font-weight: bold;">Not</span> EofList<span style=" ">&#40;</span>MyList<span style=" ">&#41;</span> <span style="color: #ffee00">; Пока список не закончился</span><br />
NextItem<span style=" ">&#40;</span>MyList<span style=" ">&#41;</span> <span style="color: #ffee00">; Следующий элемент</span><br />
<span style="color: #aaffff; font-weight: bold;">Print</span> Item<span style=" ">&#40;</span>MyList<span style=" ">&#41;</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">Wend</span></div>
<p>Это был код который нужно написать пользователю для использованию списков с предлагаемыми мною функциями. Как видите здесь все просто. И все списки отделены друг от друга! Так же можно создать массив списков. 
Полный код включаю мои функции:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Type</span> TList<br />
<p><span style="color: #aaffff; font-weight: bold;">Field</span> Start.TItem,Item.TItem<br />
<span style="color: #aaffff; font-weight: bold;">End Type</span><br />
<span style="color: #aaffff; font-weight: bold;">Type</span> TItem<br />
<span style="color: #aaffff; font-weight: bold;">Field</span> c% <br />
<span style="color: #aaffff; font-weight: bold;">Field</span> N.TItem<br />
<span style="color: #aaffff; font-weight: bold;">End Type</span> <br />
<br />
<span style="color: #ffee00">; Переменная списка - может быть сколько угодно разных</span><br />
<span style="color: #aaffff; font-weight: bold;">Global</span> MyList.TList = <span style="color: #aaffff; font-weight: bold;">New</span> TList<br />
<span style="color: #aaffff; font-weight: bold;">Global</span> MyList2.TList = <span style="color: #aaffff; font-weight: bold;">New</span> TList<br />
<br />
<span style="color: #aaffff; font-weight: bold;">For</span> i=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">10</span><br />
Add<span style=" ">&#40;</span>MyList,i<span style=" ">&#41;</span> <span style="color: #ffee00">; Добавляет i в список List</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">For</span> i=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">10</span><br />
Add<span style=" ">&#40;</span>MyList2,i<span style="color: #33ffdd;">+15</span><span style=" ">&#41;</span> <span style="color: #ffee00">; Добавляет i в список List</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
Start<span style=" ">&#40;</span>MyList<span style=" ">&#41;</span> <span style="color: #ffee00">; Устанавливает список на начало</span><br />
<span style="color: #aaffff; font-weight: bold;">While</span> <span style="color: #aaffff; font-weight: bold;">Not</span> EofList<span style=" ">&#40;</span>MyList<span style=" ">&#41;</span> <span style="color: #ffee00">; Пока список не закончился</span><br />
NextItem<span style=" ">&#40;</span>MyList<span style=" ">&#41;</span> <span style="color: #ffee00">; Следующий элемент</span><br />
<span style="color: #aaffff; font-weight: bold;">Print</span> Item<span style=" ">&#40;</span>MyList<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Wend</span> <br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> Add<span style=" ">&#40;</span>List.TList,i<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Local</span> a.TItem<br />
a.TItem = <span style="color: #aaffff; font-weight: bold;">New</span> TItem<br />
a\c=i<br />
<span style="color: #aaffff; font-weight: bold;">If</span> List\Item=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span> List\Item=<span style="color: #aaffff; font-weight: bold;">New</span> TItem:List\Start=List\Item<br />
List\Item\n=a<br />
List\Item=a<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> Start<span style=" ">&#40;</span>List.TList<span style=" ">&#41;</span><br />
List\Item=List\Start<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> NextItem<span style=" ">&#40;</span>List.TList<span style=" ">&#41;</span><br />
List\Item=List\Item\n<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> EofList<span style=" ">&#40;</span>List.TList<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> List\Item\n=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Return</span> <span style="color: #aaffff; font-weight: bold;">True</span> <span style="color: #aaffff; font-weight: bold;">Else</span> <span style="color: #aaffff; font-weight: bold;">Return</span> <span style="color: #aaffff; font-weight: bold;">False</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> Item<span style=" ">&#40;</span>List.TList<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Return</span> List\Item\c<br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<div align="right"><a href="http://blitzetcetera.org/images/e/e6/Lists2.bb" class="internal" title="Lists2.bb">скачать исходный код</a></div>
<hr />
<p>Автор: Amir (e-mail: AmirL@mail.ru)
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Как создавать и править модули"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Как создавать и править модули&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Как создавать и править модули&amp;action=edit">править</a>]</span><span class="mw-headline">Как создавать и править модули</span></h1>
<p>Для начала нужно определиться, какой именно модуль ты собрался делать. Это либо это уже существующий модуль, написанный на C/C++/ObjC, либо интерфейс для DLL либо код BlitzMax.
</p>
</p>
<a name="Mingw"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9A%D0%B0%D0%BA_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%B2%D0%B0%D1%82%D1%8C_%D0%B8_%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C_%D0%BC%D0%BE%D0%B4%D1%83%D0%BB%D0%B8&amp;action=edit&amp;section=1" title="Как создавать и править модули">править</a>]</span> <span class="mw-headline">Mingw</span></h2>
<a name=".D0.94.D0.BB.D1.8F_Windows:"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9A%D0%B0%D0%BA_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%B2%D0%B0%D1%82%D1%8C_%D0%B8_%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C_%D0%BC%D0%BE%D0%B4%D1%83%D0%BB%D0%B8&amp;action=edit&amp;section=2" title="Как создавать и править модули">править</a>]</span> <span class="mw-headline">Для Windows:</span></h3>
<p>Чтобы компилировать модули нужен MinGW и прописанный путь в "Переменной среде". Для тех, кто не знает, переменные среды позволяют программам вызывать общие программы(как cmd.exe)  только ссылаясь на её  имя.
</p><p>MinGW позволяет компилировать не-BlitzMax-овский код в модули для BlitzMax, а также использовать DLL-ки после написания враппера/декларирования. Нужно скачать два файла этот и этот(Автор ссылался на это, но там какая-то байда). Создай пакпку с любым именем(например: C:\dev\MinGW) и разархивируй туда оба архива.  
</p><p>Теперь нужно прописать переменную среду.  Панель Управления&gt;Система(или правой кнопкой мыши на Мой Компьютер&gt;Свойства) жми закладку Дополнительно на ней внизу Переменные среды. Ищи переменную Path. Выбери её и жми Изменить. Проедь до конца строки, вставь точку с запятой(;) и пропиши папку bin(полный путь, например C:\dev\MinGW\bin ) из папки, куда ты разархивировал архивы.
</p>
<a name=".D0.94.D0.BB.D1.8F_Mac_.D0.B8_Linux:"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9A%D0%B0%D0%BA_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%B2%D0%B0%D1%82%D1%8C_%D0%B8_%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C_%D0%BC%D0%BE%D0%B4%D1%83%D0%BB%D0%B8&amp;action=edit&amp;section=3" title="Как создавать и править модули">править</a>]</span> <span class="mw-headline">Для Mac и Linux:</span></h3>
<p>Не знаю, но вроде там в дистрибутиве есть gcc (GNU Compiler Collection) - это то что надо BlitzMax-у для компиляции модулей, написанных на разных языках программирования.
</p>
<a name=".D0.97.D0.B0.D0.B1.D0.B0.D0.B1.D0.B0.D1.85.D0.B0.D0.B5.D0.BC_.D0.A1.D0.92.D0.9E.D0.99_.D0.BC.D0.BE.D0.B4.D1.83.D0.BB.D1.8C.21"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9A%D0%B0%D0%BA_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%B2%D0%B0%D1%82%D1%8C_%D0%B8_%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C_%D0%BC%D0%BE%D0%B4%D1%83%D0%BB%D0%B8&amp;action=edit&amp;section=4" title="Как создавать и править модули">править</a>]</span> <span class="mw-headline">Забабахаем СВОЙ модуль!</span></h2>
<p>Ок, начнем. Создай новый файл. Первой строкой идет:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">Strict</div>
<p>Теперь определяем имя модуля коммандой Module&nbsp;: 
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">Strict<br />
<p><br />
</p>
Module Bot.FirstModule</div>
<p>Вторая строка определяет, что текущий файл - модуль, и его нельзя компилировать обычным способом. Затем опишем что это за модуль коммандой ModuleInfo&nbsp;: 
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">Strict<br />
<p><br />
Module Bot.FirstModule<br />
<br />
ModuleInfo <span style="color: #00ff66;">&quot;Name: Мой первый модуль&quot;</span><br />
ModuleInfo <span style="color: #00ff66;">&quot;Description: Круто, не правдя ли?&quot;</span><br />
ModuleInfo <span style="color: #00ff66;">&quot;License: Public Domain&quot;</span><br />
ModuleInfo <span style="color: #00ff66;">&quot;Authors: Bot Builder и Ты&quot;</span><br />
</p>
ModuleInfo <span style="color: #00ff66;">&quot;CustomAttr: Увырлаг!&quot;</span></div>
<p>Теперь подключаем необходимые для работы нашего модули: 
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">Strict<br />
<p><br />
Module Bot.FirstModule<br />
<br />
ModuleInfo <span style="color: #00ff66;">&quot;Name: Мой первый модуль&quot;</span><br />
ModuleInfo <span style="color: #00ff66;">&quot;Description: Круто, не правдя ли?&quot;</span><br />
ModuleInfo <span style="color: #00ff66;">&quot;License: Public Domain&quot;</span><br />
ModuleInfo <span style="color: #00ff66;">&quot;Authors: Bot Builder и Ты&quot;</span><br />
ModuleInfo <span style="color: #00ff66;">&quot;CustomAttr: Увырлаг!&quot;</span><br />
<br />
</p>
Import BRL.StandardIO 'Для работы <span style="color: #aaffff; font-weight: bold;">Print</span></div>
<p>Замечание: По настоящему ничего не подключается. Последняя строка гарантирует, что нужный модуль будет подключен к твоей программе. Другими словами - если ты подключишь свой модуль, то подключится и BRL.StandardIO.
</p><p>Для примера буду использовать наипростейшую функцию, а вообще, в модулях можно использовать всё, как и в обычных программах.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">Strict<br />
<p><br />
Module Bot.FirstModule<br />
<br />
ModuleInfo <span style="color: #00ff66;">&quot;Name: Мой первый модуль&quot;</span><br />
ModuleInfo <span style="color: #00ff66;">&quot;Description: Круто, не правдя ли?&quot;</span><br />
ModuleInfo <span style="color: #00ff66;">&quot;License: Public Domain&quot;</span><br />
ModuleInfo <span style="color: #00ff66;">&quot;Authors: Bot Builder и Ты&quot;</span><br />
ModuleInfo <span style="color: #00ff66;">&quot;CustomAttr: Увырлаг!&quot;</span><br />
<br />
Import BRL.StandardIO 'Для работы <span style="color: #aaffff; font-weight: bold;">Print</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> SayHello<span style=" ">&#40;</span>Name$<span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Print</span> <span style="color: #00ff66;">&quot;Hi &quot;</span>+Name$<br />
</p>
EndFunction</div>
<p>Демонстрация Private. Всё после Private не доступно снаружи модуля(т.е. из проги, подключающей его, или другого модуля):
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">Strict<br />
<p><br />
Module Bot.FirstModule<br />
<br />
ModuleInfo <span style="color: #00ff66;">&quot;Name: Мой первый модуль&quot;</span><br />
ModuleInfo <span style="color: #00ff66;">&quot;Description: Круто, не правдя ли?&quot;</span><br />
ModuleInfo <span style="color: #00ff66;">&quot;License: Public Domain&quot;</span><br />
ModuleInfo <span style="color: #00ff66;">&quot;Authors: Bot Builder и Ты&quot;</span><br />
ModuleInfo <span style="color: #00ff66;">&quot;CustomAttr: Увырлаг!&quot;</span><br />
<br />
Import BRL.StandardIO 'Для работы <span style="color: #aaffff; font-weight: bold;">Print</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> SayHello<span style=" ">&#40;</span>Name$<span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Print</span> <span style="color: #00ff66;">&quot;Hi &quot;</span>+Name$<br />
EndFunction<br />
<br />
Private<br />
</p>
<span style="color: #aaffff; font-weight: bold;">Const</span> Greeting$=<span style="color: #00ff66;">&quot;Hi&quot;</span></div>
<p>Всё, пора сохранять файл. Открой папку, где у тебя установлен BlitzMax, открой папку mod. В mod создай папку bot.mod. В ней создай папку firstmodule.mod. Важно, чтобы имена папок и файлов были точно такими, как описано тут. Сохраняй свой модуль в эту папку под именем firstmodule.bmx. Пуск&gt;Выполнить или(Ctrl-Alt-Delete&gt;Файл&gt;Новая задача(выполнить...)) в строке ввода набери cmd. Вылезет родное (для некоторых) окно эмуляции доса, там пиши: CD C:\Program Files\ProgrammerProgs\BlitzMax\bin, или какой там у тебя путь и жми интэр. Далее пиши: bmk makemods -d bot.firstmodule для компиляции дебаг версии модуля, -r bot.firstmodule для компиляции релизной версии модуля или -a bot.firstmodule для полной компиляции модуляи опять жми интэр. Чтобы проверить что за байда получилась, создай новый файл и пиши в нем:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">SayHello<span style=" ">&#40;</span><span style="color: #00ff66;">&quot;Всем, Млин&quot;</span><span style=" ">&#41;</span></div>
<p>и запусти. Надеюсь напишется следующее:
</p><p>Hi Всем, Млин!!!
</p>
<a name=".D0.98.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.BD.D0.B5_bmx-.D0.BD.D1.8B.D1.85_.D1.84.D0.B0.D0.B9.D0.BB.D0.BE.D0.B2"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9A%D0%B0%D0%BA_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%B2%D0%B0%D1%82%D1%8C_%D0%B8_%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C_%D0%BC%D0%BE%D0%B4%D1%83%D0%BB%D0%B8&amp;action=edit&amp;section=5" title="Как создавать и править модули">править</a>]</span> <span class="mw-headline">Использование не bmx-ных файлов</span></h2>
<p>Делается так:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">Import <span style="color: #00ff66;">&quot;Файл.C&quot;</span><br />
<p><br />
Extern 'Добавь <span style="color: #00ff66;">&quot;win32&quot;</span> &nbsp;если функции из win32 dll<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Function</span> МояФункцияКоторуюЯХочуИспользовать:ТипВозвращаемогоЗначения<span style=" ">&#40;</span>параметры:ихТипы<span style=" ">&#41;</span><br />
&nbsp;'И т.д.<br />
</p>
<span style="color: #aaffff; font-weight: bold;">End</span> Extern</div>
<p>От переводчика (я так декларирую АПИ-шные функции в обычных файлах):
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">Extern <span style="color: #00ff66;">&quot;Win32&quot;</span><br />
<p>&nbsp;<span style="color: #aaffff; font-weight: bold;">Function</span> FindWindow:<span style="color: #aaffff; font-weight: bold;">Int</span><span style=" ">&#40;</span>ClassName$z,<span style="color: #aaffff; font-weight: bold;">apptitle</span>$z<span style=" ">&#41;</span> = <span style="color: #00ff66;">&quot;FindWindowA@8&quot;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Function</span> SetWindowLong:<span style="color: #aaffff; font-weight: bold;">Int</span><span style=" ">&#40;</span>hWnd%,nIndex%,dNewLong%<span style=" ">&#41;</span> = <span style="color: #00ff66;">&quot;SetWindowLongA@12&quot;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Function</span> GetWindowLong:<span style="color: #aaffff; font-weight: bold;">Int</span><span style=" ">&#40;</span>hWnd%,nIndex%<span style=" ">&#41;</span> = <span style="color: #00ff66;">&quot;GetWindowLongA@8&quot;</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">End</span> Extern</div>
<p>Тут $z - это специальная C-шная строка, А @x - размер буфера для параметров, если не знаешь какой он, то просто его не пиши (в Дебуге увидишь, какой надо).
</p><p>З.Ы. У переводчика работает, но подлежит проверке:)
</p>
<hr />
<p>Автор: Bot Builder<br />
Перевод: <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:MANIAK_dobrii" title="Участник:MANIAK dobrii">MANIAK dobrii</a> (e-mail: MANIAK_dobrii@list.ru, сайт: <a href="http://www.maniak-dobrii.nm.ru/" class="external free" title="http://www.maniak-dobrii.nm.ru/" rel="nofollow">http://www.maniak-dobrii.nm.ru/</a>)
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Древовидная структура"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Древовидная структура&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Древовидная структура&amp;action=edit">править</a>]</span><span class="mw-headline">Древовидная структура</span></h1>
<p>В прошлом выпуске в статье о "Жизни" рассматривался один из видов древовидной структуры данных (двоичной), хорошо подходящей для алгоритма "Жизни". Это очень частный случай, имеющий много ограничений, особенно для абстрактных систем, не предназначеных для отображения. Рассмотрим более общий вариант, который использован в структуре директорий. Возьмем только папки: это система объектов, которые могут включать в себя группу объектов, каждый из которых может, в свою очередь, включать в себя еще объекты и т. д:
</p>
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:TreeStructure01.gif" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:TreeStructure01.gif" src="8v4e5ava.gif" width="220" height="340" /></a></span></div></div>
<p>Определим соотношения: для каждого элемента могут существовать:"корневой" элемент (элемент, включающий группу в которую входит данный), следующий и предыдущий элементы в группе, а также ссылка на первый элемент "вложенной" группы для данного (группа может состоять из единственного элемента). Для удобства лучше создать вначале "корень" структуры - один элемент, не имеющий предыдущего, следующего и корневого. Он будет содержать в себе все элементы структуры и с ним нельзя проводить никаких манипуляций. Таким образом, все остальные элементы будут иметь корневой. Вот пример ссылок 
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:TreeStructure02.gif" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:TreeStructure02.gif" src="3zc1y5xb.gif" width="223" height="338" /></a></span></div></div>
<p>Вот базовые операции для манипуляций со структурой: добавление элемента (перед, после данного, "вложение" в данный), перемещение элемента и его удаление. Перемещение можно разделить на два этапа - удаление его из структуры и вставка его в заданное место структуры. Добавление нового элемента - создание нового объекта и его вставка. Как видно, процедуры перемещения и создание элемента можно объединить. Что касается удаления, то необходимо не просто разорвать цепь, но и удалить все вложенные элементы и группы - ветвь, исходящую от элемента. Тут можно эффективно использовать рекурсию (ее можно использовать также при создании и отображении структуры на экране):
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Type</span> element<br />
<p>&nbsp;<span style="color: #ffee00">;Пользовательские поля элемента</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Field</span> r,g,b<br />
&nbsp;<span style="color: #ffee00">;Вспомогательные поля элемента</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Field</span> root.element,prev.element,nxt.element,sub.element<br />
<span style="color: #aaffff; font-weight: bold;">End Type</span><br />
<br />
<span style="color: #ffee00">;Корневой элемент</span><br />
<span style="color: #aaffff; font-weight: bold;">Global</span> root.element=<span style="color: #aaffff; font-weight: bold;">New</span> element<br />
<br />
<span style="color: #aaffff; font-weight: bold;">Global</span> ex,ey,sel.element<br />
<br />
<span style="color: #aaffff; font-weight: bold;">Graphics</span> <span style="color: #33ffdd;">800</span>,<span style="color: #33ffdd;">600</span><br />
branchcreate root,<span style="color: #33ffdd;">9</span><br />
sel=root\sub<br />
<span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">BackBuffer</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Cls</span><br />
&nbsp;ex=<span style="color: #33ffdd;">0</span>:ey=<span style="color: #33ffdd;">0</span><br />
&nbsp;branchview root<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Flip</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Select</span> <span style="color: #aaffff; font-weight: bold;">WaitKey</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">3</span><span style="color: #ffee00">;Ins</span><br />
&nbsp; &nbsp;sel=einsertin<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Null</span>,sel<span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">4</span><span style="color: #ffee00">;Del</span><br />
&nbsp; &nbsp;sel2.element=<span style="color: #aaffff; font-weight: bold;">Null</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> sel\prev&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; sel2=sel\prev<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">ElseIf</span> sel\nxt&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; sel2=sel\nxt<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">ElseIf</span> sel\root&lt;&gt;root<br />
&nbsp; &nbsp; sel2=sel\root<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> sel2&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">Then</span> eremove sel:sel=sel2<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">5</span><span style="color: #ffee00">;Page Up</span><br />
&nbsp; &nbsp;sel=einsertbefore<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Null</span>,sel<span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">6</span><span style="color: #ffee00">;Page Down</span><br />
&nbsp; &nbsp;sel=einsertafter<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Null</span>,sel<span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">27</span><span style="color: #ffee00">;Esc</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Exit</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">28</span><span style="color: #ffee00">;стрелка вверх</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> sel\prev&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">Then</span> sel=sel\prev<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">29</span><span style="color: #ffee00">;стрелка вниз</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> sel\nxt&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">Then</span> sel=sel\nxt<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">30</span><span style="color: #ffee00">;стрелка вправо</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> sel\sub&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">Then</span> sel=sel\sub<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">31</span><span style="color: #ffee00">;стрелка влево</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> sel\root&lt;&gt;root <span style="color: #aaffff; font-weight: bold;">Then</span> sel=sel\root<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">End Select</span><br />
<span style="color: #aaffff; font-weight: bold;">Forever</span><br />
<br />
<span style="color: #ffee00">;Функция, создающая ветвь с элементами от элемента e (k-максимум элементов)</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> branchcreate<span style=" ">&#40;</span>e.element,k<span style=" ">&#41;</span><br />
q=<span style="color: #aaffff; font-weight: bold;">Rand</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span>,k<span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Создаем n элементов</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> q<br />
&nbsp;e2.element=einsertin<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Null</span>,e<span style=" ">&#41;</span><br />
&nbsp;<span style="color: #ffee00">;В трети случаев создаем ответвление от данного элемента, уменьшая максимум</span><br />
&nbsp;<span style="color: #ffee00">; вложений на 2</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">Rand</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span>,<span style="color: #33ffdd;">3</span><span style=" ">&#41;</span>=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">Then</span> branchcreate e2,k<span style="color: #33ffdd;">-2</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Отображение ветви (используется рекурсия)</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> branchview<span style=" ">&#40;</span>e.element<span style=" ">&#41;</span><br />
ex=ex<span style="color: #33ffdd;">+35</span><br />
e=e\sub<br />
ey1=ey<span style="color: #33ffdd;">-6</span><br />
ey2=ey1<br />
<span style="color: #aaffff; font-weight: bold;">While</span> e&lt;&gt;Null<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Line</span> ex<span style="color: #33ffdd;">-20</span>,ey<span style="color: #33ffdd;">+10</span>,ex<span style="color: #33ffdd;">+15</span>,ey<span style="color: #33ffdd;">+10</span><br />
&nbsp;<span style="color: #ffee00">;Подсветка текущего элемента</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> e=sel <span style="color: #aaffff; font-weight: bold;">Then</span> c=<span style="color: #33ffdd;">127</span> <span style="color: #aaffff; font-weight: bold;">Else</span> c=<span style="color: #33ffdd;">0</span><br />
&nbsp;<span style="color: #ffee00">;Если цвет элемента не задан - задаем случайным образом</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> e\r=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; e\r=<span style="color: #aaffff; font-weight: bold;">Rand</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span>,<span style="color: #33ffdd;">128</span><span style=" ">&#41;</span><br />
&nbsp; e\g=<span style="color: #aaffff; font-weight: bold;">Rand</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span>,<span style="color: #33ffdd;">128</span><span style=" ">&#41;</span><br />
&nbsp; e\b=<span style="color: #aaffff; font-weight: bold;">Rand</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span>,<span style="color: #33ffdd;">128</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Color</span> c+e\r,c+e\g,c+e\b<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Rect</span> ex,ey,<span style="color: #33ffdd;">30</span>,<span style="color: #33ffdd;">20</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Rect</span> ex,ey,<span style="color: #33ffdd;">30</span>,<span style="color: #33ffdd;">20</span>,<span style="color: #aaffff; font-weight: bold;">False</span><br />
&nbsp;ey2=ey<span style="color: #33ffdd;">+10</span><br />
&nbsp;ey=ey<span style="color: #33ffdd;">+25</span><br />
&nbsp;branchview e<br />
&nbsp;e=e\nxt<br />
<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<span style="color: #aaffff; font-weight: bold;">Line</span> ex<span style="color: #33ffdd;">-20</span>,ey1,ex<span style="color: #33ffdd;">-20</span>,ey2<br />
ex=ex<span style="color: #33ffdd;">-35</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Вставка элемента перед заданным</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> einsertafter.element<span style=" ">&#40;</span>what.element,afterwhat.element<span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Если элемент не задан - создаем его, иначе корректно удаляем из его группы</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> what=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span> what=<span style="color: #aaffff; font-weight: bold;">New</span> element <span style="color: #aaffff; font-weight: bold;">Else</span> epush what<br />
<span style="color: #ffee00">;Соединяем новый элемент с верхним и нижним в группе</span><br />
what\prev=afterwhat<br />
what\nxt=afterwhat\nxt<br />
<span style="color: #aaffff; font-weight: bold;">If</span> afterwhat\nxt&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">Then</span> afterwhat\nxt\prev=what<br />
afterwhat\nxt=what<br />
<span style="color: #ffee00">;Задаем корень и возвращаем указатель на элемент</span><br />
what\root=afterwhat\root<br />
<span style="color: #aaffff; font-weight: bold;">Return</span> what<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Вставка элемента после заданного</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> einsertbefore.element<span style=" ">&#40;</span>what.element,beforewhat.element<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> what=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span> what=<span style="color: #aaffff; font-weight: bold;">New</span> element <span style="color: #aaffff; font-weight: bold;">Else</span> epush what<br />
what\prev=beforewhat\prev<br />
what\nxt=beforewhat<br />
<span style="color: #aaffff; font-weight: bold;">If</span> beforewhat\prev&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">Then</span> beforewhat\prev\nxt=what<br />
what\root=beforewhat\root<br />
<span style="color: #ffee00">;Если элемент помещается перед первым в группе - соединяем с ним корень</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> what\prev=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span> what\root\sub=what<br />
beforewhat\prev=what<br />
<span style="color: #aaffff; font-weight: bold;">Return</span> what<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Вставка элемента в группу заданного</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> einsertin.element<span style=" ">&#40;</span>what.element,inwhat.element<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> what=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span> what=<span style="color: #aaffff; font-weight: bold;">New</span> element <span style="color: #aaffff; font-weight: bold;">Else</span> epush what<br />
<span style="color: #ffee00">;Помещаем элемент в начало группы</span><br />
what\prev=<span style="color: #aaffff; font-weight: bold;">Null</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> inwhat\sub=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp;what\nxt=<span style="color: #aaffff; font-weight: bold;">Null</span><br />
<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp;<span style="color: #ffee00">;Если группа не пуста - сдвигая первый элемент вниз, соединяя его с новым</span><br />
&nbsp;what\nxt=inwhat\sub<br />
&nbsp;inwhat\sub\prev=what<br />
<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
<span style="color: #ffee00">;Соединяем корень группы с новым элементом (теперь первым в группе)</span><br />
inwhat\sub=what<br />
what\root=inwhat<br />
<span style="color: #aaffff; font-weight: bold;">Return</span> what<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Удаление элемента вместе с его ответвлениями</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> eremove<span style=" ">&#40;</span>what.element,care=<span style="color: #aaffff; font-weight: bold;">True</span><span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Корректно удаляем элемент из его группы</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> care <span style="color: #aaffff; font-weight: bold;">Then</span> epush what<br />
e.element=what\sub<br />
<span style="color: #ffee00">;Если элемент содержит вложенные - удаляем их, используя рекурсию</span><br />
<span style="color: #aaffff; font-weight: bold;">While</span> e&lt;&gt;Null<br />
&nbsp;e2.element=e<br />
&nbsp;e=e\nxt<br />
&nbsp;<span style="color: #ffee00">;Вложенные элементы не нуждаются в корректном удалении из группы</span><br />
&nbsp;eremove e2,<span style="color: #aaffff; font-weight: bold;">False</span><br />
<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<span style="color: #aaffff; font-weight: bold;">Delete</span> what<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Вспомогательная функция - корректное удаление дэлемента из группы</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> epush<span style=" ">&#40;</span>what.element<span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Соединяем верхний и нижний элементы друг с другом</span><br />
<span style="color: #ffee00">;Если элемент находится в верху группы - соединяем с ним корень группы</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> what\prev&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">Then</span> what\prev\nxt=what\nxt <span style="color: #aaffff; font-weight: bold;">Else</span> what\root\sub=what\nxt<br />
<span style="color: #aaffff; font-weight: bold;">If</span> what\nxt&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">Then</span> what\nxt\prev=what\prev<br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<div align="right"><a href="http://blitzetcetera.org/images/1/11/TreeStructure.bb" class="internal" title="TreeStructure.bb">скачать исходный код</a></div>
<hr />
<p>Автор: <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Matt_Merkulov" title="Участник:Matt Merkulov">Матвей Меркулов</a> (E-mail: MattMerk@mail.ru, ICQ: 392-274-050)
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Неофициальная спецификация формата файлов «B3D» V0.2"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Неофициальная спецификация формата файлов «B3D» V0.2&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Неофициальная спецификация формата файлов «B3D» V0.2&amp;action=edit">править</a>]</span><span class="mw-headline">Неофициальная спецификация формата файлов «B3D» V0.2</span></h1>
</p>
<a name=".D0.92.D0.B2.D0.B5.D0.B4.D0.B5.D0.BD.D0.B8.D0.B5"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9D%D0%B5%D0%BE%D1%84%D0%B8%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F_%D1%81%D0%BF%D0%B5%D1%86%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F_%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%B0_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%C2%ABB3D%C2%BB_V0.2&amp;action=edit&amp;section=1" title="Неофициальная спецификация формата файлов «B3D» V0.2">править</a>]</span> <span class="mw-headline">Введение</span></h2>
<p>Этот документ представляет собой попытку описания на русском формата файлов B3D использующихся в Blitz Basic. Как вы уже догадались B3D - внутренний формат Блица, главным образом предназначенный для описания 3D моделей, материалов и ссылок на текстуры.
</p><p>Надо заметить, что перевод оказался делом довольно непростым. Причем не из-за того что формат особо заумный (он напротив весьма дружественный), а из-за проблем с терминологией. Сложилась довольно стройная и универсальная английская терминология описания форматов файлов, а вот русской увы нет. Поэтому chunk обозван фрагментом, node - ветвью а кое-что - вообще никак.
</p>
<a name="B3D_.D0.B2_.D1.86.D0.B5.D0.BB.D0.BE.D0.BC"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9D%D0%B5%D0%BE%D1%84%D0%B8%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F_%D1%81%D0%BF%D0%B5%D1%86%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F_%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%B0_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%C2%ABB3D%C2%BB_V0.2&amp;action=edit&amp;section=2" title="Неофициальная спецификация формата файлов «B3D» V0.2">править</a>]</span> <span class="mw-headline">B3D в целом</span></h2>
<p>Файл можно представить в виде совокупности следующих элементов: 
</p>
<ul><li>Скелет модели (bones) необходимый для анимации. 
</li><li>Совокупность субмоделей состоящих в свою очередь из поверхностей. 
</li><li>Кадры анимации в виде ряда фиксированных положений скелета модели. 
</li><li>Информация о текстурах и общем цвете модели. 
</li></ul>
<p>При описании формата принята нотация в стиле C/C++ с учетом следующей специфики данных и их размеров. 
</p>
<ul><li>int (4 байта), целое со знаком. Любые целые числа (1, 2, 324382 и т. д.) в пределах от -2147483648 до 2147483647
</li><li>float (тоже 4 байта). Дробные числа с плавающей запятой (1.34, 2.345.0.0994), целые приведенные к этому типу имеют вид 1.0 2.0 и т. д. 
</li><li>char (1 байт). Символы типа A,a,c,$,&amp;,1 и т. д., в том виде как они обычно хранятся в файлах. Несколько отличается от строкового типа данных в Блице. Для трансляции можно воспользоваться функциями предоставлеенные Марком Сибли - B3dfile.bb. Кроме того, там можно найти функции для записи заголовка файла и отдельных его элементов - целых, дробных чисел и chunks 
</li></ul>
<p>Каждому chunk предшествует 8 байт заголовка:  B3D Chunk  
</p>
<table>
<tr>
<td>char tag [4]
</td><td>4 байта - 4 буквы названия тега (BB3D, TEXS, BRUS и т. д.) )
</td></tr>
<tr>
<td>int length
</td><td>4 байта размер фрагмента (не включая размера самого заголовка)
</td></tr></table>
<p>Каждый chunk содержит данные о размере и необязательные вложенные chunks. При написании собственного загрузчика необходимо предусмотреть пропуск всего тела неподдерживаемых chunks .
</p>
<a name=".D0.A1.D0.BE.D1.81.D1.82.D0.B0.D0.B2.D0.BD.D1.8B.D0.B5_.D1.87.D0.B0.D1.81.D1.82.D0.B8_.D0.BF.D0.BE_.D0.BE.D1.82.D0.B4.D0.B5.D0.BB.D1.8C.D0.BD.D0.BE.D1.81.D1.82.D0.B8"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9D%D0%B5%D0%BE%D1%84%D0%B8%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F_%D1%81%D0%BF%D0%B5%D1%86%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F_%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%B0_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%C2%ABB3D%C2%BB_V0.2&amp;action=edit&amp;section=3" title="Неофициальная спецификация формата файлов «B3D» V0.2">править</a>]</span> <span class="mw-headline">Составные части по отдельности</span></h2>
<a name=".2A.D0.9F.D0.A0.D0.98.D0.9C.D0.95.D0.A7.D0.90.D0.9D.D0.98.D0.AF.2A"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9D%D0%B5%D0%BE%D1%84%D0%B8%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F_%D1%81%D0%BF%D0%B5%D1%86%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F_%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%B0_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%C2%ABB3D%C2%BB_V0.2&amp;action=edit&amp;section=4" title="Неофициальная спецификация формата файлов «B3D» V0.2">править</a>]</span> <span class="mw-headline">*ПРИМЕЧАНИЯ*</span></h3>
<ul><li>Значения цвета (RGBA), берутся от 0 до 1. То есть берем цвет из Блица и делим на 255. 
</li><li>string (char[]) значения представляют строку в стиле 'C' . По умолчанию Блиц читает строки из файлов не так! 
</li><li>Quaternions используются для задания направления. Первое значение - параметр 'w', следующие 3 параметра 'vector'. Ноль ориентации описывается как 1,0,0,0. Самое время почитать подробнее о кватернионах...(Хм... Да уж! Хорошее место - документация по DirectX SDK) 
</li><li>Все на что следует ссылка 'по индексу' всегда должно быть описано в файле РАНЬШЕ чем собственно ссылка. Т. е. не ссылаться на то чего еще не загружено. 
</li><li>Ссылки типа brush_id могут быть -1: основной цвет модели по умолчанию.
</li><li>Все заключенное в фигурные скобки {} в последующих описаниях подразумевает что блок может неограниченно повторяться вплоть до следующего сhunk. Квадратные скобки [] означают необязательные элементы. 
</li></ul>
<a name=".D0.9E.D1.81.D0.BD.D0.BE.D0.B2.D0.BD.D1.8B.D0.B5_.D1.84.D1.80.D0.B0.D0.B3.D0.BC.D0.B5.D0.BD.D1.82.D1.8B_.D1.84.D0.B0.D0.B9.D0.BB.D0.B0_B3D"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9D%D0%B5%D0%BE%D1%84%D0%B8%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F_%D1%81%D0%BF%D0%B5%D1%86%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F_%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%B0_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%C2%ABB3D%C2%BB_V0.2&amp;action=edit&amp;section=5" title="Неофициальная спецификация формата файлов «B3D» V0.2">править</a>]</span> <span class="mw-headline">Основные фрагменты файла B3D</span></h3>
<ul><li>[BB3D] Заголовок. 
</li><li>[TEXS] Описание текстур. 
</li><li>[BRUS] Информация об основном цвете модели. 
</li><li>[NODE] Объекты (Blitz3D Entity). 
</li><li>[VRTS] Информация о вершинах модели. 
</li><li>[TRIS] Описание поверхности. 
</li><li>[MESH] Описание собственно модели. 
</li><li>[BONE] Анимационный скелет модели(кости). 
</li><li>[KEYS] Описание кадров анимации. 
</li><li>[ANIM] Описание анимации. 
</li></ul>
<a name="BB3D"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9D%D0%B5%D0%BE%D1%84%D0%B8%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F_%D1%81%D0%BF%D0%B5%D1%86%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F_%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%B0_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%C2%ABB3D%C2%BB_V0.2&amp;action=edit&amp;section=6" title="Неофициальная спецификация формата файлов «B3D» V0.2">править</a>]</span> <span class="mw-headline">BB3D</span></h3>
<table>
<tr>
<td>int version
</td><td>версия формата, по умочанию 1. На момент этого описания формат файла не изменялся со времени его разработки, а значит как минимум для версии Blitz3D 1.83 версия остается первой. Тег длины соответственно обозначает размер файла в байтах не считая заголовка. Формат записи версии файла выглядит так major*100+minor те: версия 1.0 обозначается как 1000 1.1 1001 и т. д.
</td></tr></table>
<a name="TEXS"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9D%D0%B5%D0%BE%D1%84%D0%B8%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F_%D1%81%D0%BF%D0%B5%D1%86%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F_%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%B0_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%C2%ABB3D%C2%BB_V0.2&amp;action=edit&amp;section=7" title="Неофициальная спецификация формата файлов «B3D» V0.2">править</a>]</span> <span class="mw-headline">TEXS</span></h3>
<table>
<tr>
<td>&lsaquo;
</td><td>
</td></tr>
<tr>
<td>char file[ ]
</td><td>имя текстуры типа "wall.bmp" Online загрузка не поддерживается.
</td></tr>
<tr>
<td>int flags,blend
</td><td>флаги текстуры. Формируются на том же принципе,что и в Блице.
</td></tr>
<tr>
<td>float x_pos,y_pos
</td><td>положение текстуры: по умолчанию = 0,0.
</td></tr>
<tr>
<td>float x_scale,y_scale
</td><td>масштабирование текстуры: по умолчанию = 1,1.
</td></tr>
<tr>
<td>float rotation
</td><td>вращение текстуры (в радианах): по умолчанию = 0 радиан = 180/pi градусов
</td></tr>
<tr>
<td>&rsaquo;
</td><td>
</td></tr></table>
<p>Такое описание должно быть для всех используемых текстур. Флаг текстуры 65536 не описанный Марком Сибли означает то, что текстура использует второй набор текстурных координат. Таких наборов в Блиц может быть не больше двух.
</p><p>Пример:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">If</span> t\flags <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">65536</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
<p>&nbsp;<span style="color: #aaffff; font-weight: bold;">TextureCoords</span> t\tex,<span style="color: #33ffdd;">1</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Else</span> <span style="color: #aaffff; font-weight: bold;">TextureCoords</span> t\tex,<span style="color: #33ffdd;">0</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">EndIf</span></div>
<a name="BRUS"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9D%D0%B5%D0%BE%D1%84%D0%B8%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F_%D1%81%D0%BF%D0%B5%D1%86%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F_%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%B0_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%C2%ABB3D%C2%BB_V0.2&amp;action=edit&amp;section=8" title="Неофициальная спецификация формата файлов «B3D» V0.2">править</a>]</span> <span class="mw-headline">BRUS</span></h3>
<table>
<tr>
<td>int n_texs
</td><td>
</td></tr>
<tr>
<td>&lsaquo;
</td><td>
</td><td>char name[]
</td><td>Имя типа "WATER" - имя текстуры
</td></tr>
<tr>
<td>float red,green,blue,alpha
</td><td>Цвет, последняя составляющая которого - прозрачность: по умолчанию= 1,1,1,1
</td></tr>
<tr>
<td>float shininess
</td><td>Блик: по умолчанию= 0
</td></tr>
<tr>
<td>int blend,fx
</td><td>Смешивание(blending) и специальные эффекты: по умолчанию= 1,0
</td></tr>
<tr>
<td>int texture_id
</td><td>список идентификаторов всех используемых в данном материале текстур могут использоваься текстуры прозрачности, освещения, маска и т. д. Все ID должны вводится с типом int т.е по четыре байта.
</td></tr>
<tr>
<td>&rsaquo;
</td><td>
</td></tr></table>
<p>Каждый материал должен содержать отдельный тег BRUS. 
</p>
<a name="NODE"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9D%D0%B5%D0%BE%D1%84%D0%B8%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F_%D1%81%D0%BF%D0%B5%D1%86%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F_%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%B0_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%C2%ABB3D%C2%BB_V0.2&amp;action=edit&amp;section=9" title="Неофициальная спецификация формата файлов «B3D» V0.2">править</a>]</span> <span class="mw-headline">NODE</span></h3>
<table>
<tr>
<td>char name[]
</td><td>имя ветви структуры
</td></tr>
<tr>
<td>float position
</td><td>локальная позиция...
</td></tr>
<tr>
<td>float scale
</td><td>масштабирование...
</td></tr>
<tr>
<td>float rotation
</td><td>общий поворот...
</td></tr>
<tr>
<td>BONE]
</td><td>тег типа описываемого ветвью структуры, если нераспознается, то принимается как центр масс (pivot).
</td></tr>
<tr>
<td>[KEYS[,KEYS...]]
</td><td>необязательные кадры анимации
</td></tr>
<tr>
<td>[NODE[,NODE...]]&lt;/td&gt;
</td><td>необязательные вложенные иерархии
</td></tr>
<tr>
<td>[ANIM]
</td><td>необязательная анимация
</td></tr></table>
<a name="VRTS"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9D%D0%B5%D0%BE%D1%84%D0%B8%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F_%D1%81%D0%BF%D0%B5%D1%86%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F_%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%B0_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%C2%ABB3D%C2%BB_V0.2&amp;action=edit&amp;section=10" title="Неофициальная спецификация формата файлов «B3D» V0.2">править</a>]</span> <span class="mw-headline">VRTS</span></h3>
<table>
<tr>
<td>int flags
</td><td>1 = вершина с нормалями, 2 = цветная вершина
</td></tr>
<tr>
<td>int tex_coord_sets
</td><td>количество блоков текстурных координат на вершину (1 - простые U/V) max = 8
</td></tr>
<tr>
<td>int tex_coord_set_size
</td><td>размер блока (2 - простые U/V) max = 4
</td></tr>
<tr>
<td>&lsaquo;
</td><td>
</td></tr>
<tr>
<td>float x,y,z
</td><td>обязательны
</td></tr>
<tr>
<td>float nx,ny,nz
</td><td>нормаль вершины: только если flags=1
</td></tr>
<tr>
<td>float red,green,blue,alpha
</td><td>цвет вершины: если (flags= 2)
</td></tr>
<tr>
<td>float tex_coords
</td><td>текстурные координаты
</td></tr>
<tr>
<td>&rsaquo;
</td><td>
</td></tr></table>
<p>Фрагмент VRTS содержит список вершин модели. Значение flags показывает какая и сколько дополнительной информации хранится с каждой вершиной (информация о нормали или цвет вершины). В tex_coord_sets и tex_coord_set_size хранится информация о текстурных координатах.
</p><p>Если, по тем или иным причинам, доведется просматривать файл в шестнадцатиричном редакторе,  не стоит удивляться тому, что вершины задаются нечитабельно. Число 1, например выглядит как 0000803F. На самом деле именно так в шестнадцатеричном виде записываются числа с плавающей запятой (Тип данных float в С/С++ и single в VB). Мне не известен алгоритм непосредственного преобразования таких чисел к нормальному виду, но как обходной маневр можно использовать чтение их из файла оператором ReadFloat с выводом на экран.  Для обратной операции используем WriteFloat потом читаем это число побайтово (всего 4 байта), преобразуем при помощи Hex и выводим на экран в правильной последовательности.
</p><p>Чтобы структура VERTS стала немного понятнее приводится следующий пример описания VRTS, в виде, в котором он должен быть в файле.
</p><p>EXAMPLE:
</p><p><br />
</p>
<table>
<tr>
<td> 1
</td><td> Флаг показывающий, что с каждой вершиной дополнительно хранится описание нормали, он должен быть равен 2 если модель цветная но без текстуры, и 3 если без текстуры но с нормалью
</td></tr>
<tr>
<td> 1
</td><td> простейший uvset.
</td></tr>
<tr>
<td> 2
</td><td> простейший uvset.
</td></tr>
<tr>
<td> &lsaquo;
</td><td>
</td></tr>
<tr>
<td> 2.3
</td><td> X \
</td></tr>
<tr>
<td> 3.2
</td><td> Y &#124;--- координаты вершины.
</td></tr>
<tr>
<td> -1.34
</td><td> Z /
</td></tr>
<tr>
<td> 0.0096
</td><td>
</td></tr>
<tr>
<td> -0.9998
</td><td> нормаль к вершине.
</td></tr>
<tr>
<td> 0.0200
</td><td>
</td></tr>
<tr>
<td> 0.45
</td><td> текстурная координата U
</td></tr>
<tr>
<td> 0.23
</td><td> текстурная координата V
</td></tr>
<tr>
<td> ...
</td><td> и так для каждой вершины.
</td></tr>
<tr>
<td> &rsaquo;
</td><td>
</td></tr></table>
<p><br />
</p>
<a name="TRIS"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9D%D0%B5%D0%BE%D1%84%D0%B8%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F_%D1%81%D0%BF%D0%B5%D1%86%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F_%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%B0_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%C2%ABB3D%C2%BB_V0.2&amp;action=edit&amp;section=11" title="Неофициальная спецификация формата файлов «B3D» V0.2">править</a>]</span> <span class="mw-headline">TRIS</span></h3>
<table>
<tr>
<td>int brush_id
</td><td>общий цвет(кисть) модели: по умолчанию= -1
</td></tr>
<tr>
<td>&lsaquo;
</td><td>
</td></tr>
<tr>
<td>int vertex_id
</td><td>индексы вершин треугольника. Порядок обхода влияет на то, которая из сторон будет видимой.
</td></tr>
<tr>
<td>&rsaquo;
</td><td>
</td></tr></table>
<p>Описывает треугольники составляющие модель.  
</p>
<a name="MESH"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9D%D0%B5%D0%BE%D1%84%D0%B8%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F_%D1%81%D0%BF%D0%B5%D1%86%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F_%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%B0_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%C2%ABB3D%C2%BB_V0.2&amp;action=edit&amp;section=12" title="Неофициальная спецификация формата файлов «B3D» V0.2">править</a>]</span> <span class="mw-headline">MESH</span></h3>
<table>
<tr>
<td>int brush_id
</td><td>основной цвет(кисть): по умолчанию=-1
</td></tr>
<tr>
<td>VRTS
</td><td>вершины
</td></tr>
<tr>
<td>TRIS
</td><td>1 или более наборов треугольников
</td></tr></table>
<p>Описывает модель в общем. Имеет единственный фрагмент VRTS и один или более TRIS.
</p>
<a name="BONE"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9D%D0%B5%D0%BE%D1%84%D0%B8%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F_%D1%81%D0%BF%D0%B5%D1%86%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F_%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%B0_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%C2%ABB3D%C2%BB_V0.2&amp;action=edit&amp;section=13" title="Неофициальная спецификация формата файлов «B3D» V0.2">править</a>]</span> <span class="mw-headline">BONE</span></h3>
<table>
<tr>
<td>&lsaquo;
</td><td>
</td></tr>
<tr>
<td>int vertex_id
</td><td>индекс вершины, которой управляет данный манипулятор
</td></tr>
<tr>
<td>float weight
</td><td>не поддерживается устанавливается в 1
</td></tr>
<tr>
<td>&rsaquo;
</td><td>
</td></tr></table>
<p>Описывает манипуляторы(кости) скелетной анимации.
</p>
<a name="KEYS"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9D%D0%B5%D0%BE%D1%84%D0%B8%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F_%D1%81%D0%BF%D0%B5%D1%86%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F_%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%B0_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%C2%ABB3D%C2%BB_V0.2&amp;action=edit&amp;section=14" title="Неофициальная спецификация формата файлов «B3D» V0.2">править</a>]</span> <span class="mw-headline">KEYS</span></h3>
<table>
<tr>
<td>int flags
</td><td>1=position, 2=scale, 4=rotation
</td></tr>
<tr>
<td>&lsaquo;
</td><td>
</td></tr>
<tr>
<td>int frame
</td><td>в каком кадре срабатывает
</td></tr>
<tr>
<td>float position
</td><td>если (flags=1)
</td></tr>
<tr>
<td>float scale
</td><td>если (flags=2)
</td></tr>
<tr>
<td>float rotation
</td><td>если (flags= 4)
</td></tr>
<tr>
<td>&rsaquo;
</td><td>
</td></tr></table>
<p>Описывает ключевые моменты анимации. Изменение поворота, масштаба, координат модели не могут быть скомбинированы в одном фрагменте KEYS, но несколько KEYS могут указывать на один и тот же кадр
</p>
<a name="ANIM"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9D%D0%B5%D0%BE%D1%84%D0%B8%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F_%D1%81%D0%BF%D0%B5%D1%86%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F_%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%B0_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%C2%ABB3D%C2%BB_V0.2&amp;action=edit&amp;section=15" title="Неофициальная спецификация формата файлов «B3D» V0.2">править</a>]</span> <span class="mw-headline">ANIM</span></h3>
<table>
<tr>
<td>int flags
</td><td>не используется=0
</td></tr>
<tr>
<td>int frames
</td><td>сколько кадров в анимации
</td></tr>
<tr>
<td>float fps
</td><td>скорось анимации(кадры в секунду)= 60
</td></tr></table>
<p>Описывает анимацию. Каждый такой фрагмент является отдельной анимационной последовательностью. Каждая ветвь иерархической модели (типа персонажа) может иметь на каждую ветвь иерархии только одну анимационную последовательность.
</p>
<a name=".D0.92.D1.81.D0.B5.2C_.D1.87.D1.82.D0.BE_.D0.BD.D1.83.D0.B6.D0.BD.D0.BE_.D0.B7.D0.BD.D0.B0.D1.82.D1.8C_.D0.BE.D0.B1_.D0.B8.D0.B5.D1.80.D0.B0.D1.80.D1.85.D0.B8.D0.B8_.D0.BC.D0.BE.D0.B4.D0.B5.D0.BB.D0.B8"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9D%D0%B5%D0%BE%D1%84%D0%B8%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F_%D1%81%D0%BF%D0%B5%D1%86%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F_%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%B0_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%C2%ABB3D%C2%BB_V0.2&amp;action=edit&amp;section=16" title="Неофициальная спецификация формата файлов «B3D» V0.2">править</a>]</span> <span class="mw-headline">Все, что нужно знать об иерархии модели</span></h2>
<p>Специфика описываемого стандарта может привести к ошибкам доступа на этапе чтения модели в Блиц. Как уже говорилось Все на что следует ссылка 'по индексу' всегда должно быть описано в файле РАНЬШЕ чем собственно ссылка.. т.е.: Использования манипулятором(костью) индекса вершины, который идет в файле ниже, чем описание этого манипулятора вызовет горячо любимый некоторыми Illegal Memory Address.
</p><p>Фрагмент NODE описывает Blitz3D Entity. Иерархия модели определяется системой вложенных элементов NODE.
</p><p>Тип NODE должен определятся однозначно. Он может быть и MESH, и BONE, но не одновременно и тем и другим! Если тип не распознается, то принимается как центр масс (pivot).
</p><p>Появление в NODE тега ANIM обозначает, что именно на этом уровне иерархии начинается ее анимация. Это предполагает возможность нескольких вложенных анимаций воспроизводящихся на разных скоростях. 
</p>
<a name=".D0.9F.D1.80.D0.BE.D1.81.D1.82.D0.B5.D0.B9.D1.88.D0.B0.D1.8F_.D1.81.D1.82.D0.B0.D1.82.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.B0.D1.8F_.D0.BD.D0.B5.D1.82.D0.B5.D0.BA.D1.81.D1.82.D1.83.D1.80.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.BD.D0.B0.D1.8F_.D0.BC.D0.BE.D0.B4.D0.B5.D0.BB.D1.8C"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9D%D0%B5%D0%BE%D1%84%D0%B8%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F_%D1%81%D0%BF%D0%B5%D1%86%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F_%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%B0_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%C2%ABB3D%C2%BB_V0.2&amp;action=edit&amp;section=17" title="Неофициальная спецификация формата файлов «B3D» V0.2">править</a>]</span> <span class="mw-headline">Простейшая статическая нетекстурированная модель</span></h2>
<table>
<tr>
<td> BB3D
</td><td> заголовок
</td></tr>
<tr>
<td> 1
</td><td> версия
</td></tr>
<tr>
<td> NODE
</td><td>
</td></tr>
<tr>
<td> "root_node"
</td><td> имя элемента иерархии
</td></tr>
<tr>
<td> 0,0,0
</td><td> положение
</td></tr>
<tr>
<td> 1,1,1
</td><td> масштаб
</td></tr>
<tr>
<td> 1,0,0,0
</td><td> вращение
</td></tr>
<tr>
<td> MESH
</td><td> 3D модель
</td></tr>
<tr>
<td> -1
</td><td> нет материала (brush)
</td></tr>
<tr>
<td> VRTS
</td><td> вершины
</td></tr>
<tr>
<td> 0
</td><td> с вершинами нет никакой дополнительной информации
</td></tr>
<tr>
<td> 0,0
</td><td> и координат текстуры нет
</td></tr>
<tr>
<td> (x,y,z...)
</td><td> координаты вершины
</td></tr>
<tr>
<td> TRIS
</td><td> треугольники модели
</td></tr>
<tr>
<td> -1
</td><td> без материала (brush)
</td></tr>
<tr>
<td> (v0,v1,v2...)
</td><td> перечисление индексов вершин
</td></tr></table>
<a name="B3DFile.bb"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9D%D0%B5%D0%BE%D1%84%D0%B8%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F_%D1%81%D0%BF%D0%B5%D1%86%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F_%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%B0_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%C2%ABB3D%C2%BB_V0.2&amp;action=edit&amp;section=18" title="Неофициальная спецификация формата файлов «B3D» V0.2">править</a>]</span> <span class="mw-headline">B3DFile.bb</span></h2>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffee00">;</span><br />
<p><span style="color: #ffee00">;b3d file utils to be included</span><br />
<span style="color: #ffee00">;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> b3d_stack<span style=" ">&#40;</span><span style="color: #33ffdd;">100</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Global</span> b3d_file,b3d_tos<br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> b3dSetFile<span style=" ">&#40;</span> file <span style=" ">&#41;</span><br />
b3d_tos=<span style="color: #33ffdd;">0</span><br />
b3d_file=file<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;***** functions for reading from B3D files *****</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> b3dReadByte<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Return</span> <span style="color: #aaffff; font-weight: bold;">ReadByte</span><span style=" ">&#40;</span> b3d_file <span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> b3dReadInt<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Return</span> <span style="color: #aaffff; font-weight: bold;">ReadInt</span><span style=" ">&#40;</span> b3d_file <span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> b3dReadFloat#<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Return</span> <span style="color: #aaffff; font-weight: bold;">ReadFloat</span><span style=" ">&#40;</span> b3d_file <span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> b3dReadString$<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
ch=b3dReadByte<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> ch=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Return</span> t$<br />
t$=t$+<span style="color: #aaffff; font-weight: bold;">Chr</span>$<span style=" ">&#40;</span>ch<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Forever</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> b3dReadChunk$<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> k=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">4</span><br />
tag$=tag$+<span style="color: #aaffff; font-weight: bold;">Chr</span>$<span style=" ">&#40;</span>b3dReadByte<span style=" ">&#40;</span><span style=" ">&#41;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
sz=<span style="color: #aaffff; font-weight: bold;">ReadInt</span><span style=" ">&#40;</span> b3d_file <span style=" ">&#41;</span><br />
b3d_tos=b3d_tos<span style="color: #33ffdd;">+1</span><br />
b3d_stack<span style=" ">&#40;</span>b3d_tos<span style=" ">&#41;</span>=<span style="color: #aaffff; font-weight: bold;">FilePos</span><span style=" ">&#40;</span> b3d_file <span style=" ">&#41;</span>+sz<br />
<span style="color: #aaffff; font-weight: bold;">Return</span> tag$<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> b3dExitChunk<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">SeekFile</span> b3d_file,b3d_stack<span style=" ">&#40;</span>b3d_tos<span style=" ">&#41;</span><br />
b3d_tos=b3d_tos<span style="color: #33ffdd;">-1</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> b3dChunkSize<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Return</span> b3d_stack<span style=" ">&#40;</span>b3d_tos<span style=" ">&#41;</span>-<span style="color: #aaffff; font-weight: bold;">FilePos</span><span style=" ">&#40;</span> b3d_file <span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;***** Functions for writing to B3D files *****</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> b3dWriteByte<span style=" ">&#40;</span> n <span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteByte</span><span style=" ">&#40;</span> b3d_file,n <span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> b3dWriteInt<span style=" ">&#40;</span> n <span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteInt</span><span style=" ">&#40;</span> b3d_file,n <span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> b3dWriteFloat<span style=" ">&#40;</span> n# <span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteFloat</span><span style=" ">&#40;</span> b3d_file,n <span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> b3dWriteString<span style=" ">&#40;</span> t$ <span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> k=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span> t$ <span style=" ">&#41;</span><br />
ch=<span style="color: #aaffff; font-weight: bold;">Asc</span><span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span>t$,k,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><span style=" ">&#41;</span><br />
b3dWriteByte<span style=" ">&#40;</span>ch<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> ch=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Return</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
b3dWriteByte<span style=" ">&#40;</span> <span style="color: #33ffdd;">0</span> <span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> b3dBeginChunk<span style=" ">&#40;</span> tag$ <span style=" ">&#41;</span><br />
b3d_tos=b3d_tos<span style="color: #33ffdd;">+1</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> k=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">4</span><br />
b3dWriteByte<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Asc</span><span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span> tag$,k,<span style="color: #33ffdd;">1</span> <span style=" ">&#41;</span><span style=" ">&#41;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
b3dWriteInt<span style=" ">&#40;</span> <span style="color: #33ffdd;">0</span> <span style=" ">&#41;</span><br />
b3d_stack<span style=" ">&#40;</span>b3d_tos<span style=" ">&#41;</span>=<span style="color: #aaffff; font-weight: bold;">FilePos</span><span style=" ">&#40;</span> b3d_file <span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> b3dEndChunk<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
n=<span style="color: #aaffff; font-weight: bold;">FilePos</span><span style=" ">&#40;</span> b3d_file <span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">SeekFile</span> b3d_file,b3d_stack<span style=" ">&#40;</span>b3d_tos<span style=" ">&#41;</span><span style="color: #33ffdd;">-4</span><br />
b3dWriteInt<span style=" ">&#40;</span> n-b3d_stack<span style=" ">&#40;</span>b3d_tos<span style=" ">&#41;</span> <span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">SeekFile</span> b3d_file,n<br />
b3d_tos=b3d_tos<span style="color: #33ffdd;">-1</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<hr />
<p>Авторы: Mark Sibly, Adam Templeton (DragoBC@hotmail.com)<br />
Дата создания: 2003 г.<br />
Перевод: <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Alrusdi" title="Участник:Alrusdi">Александр Альрушди</a> (e-mail: ork@indus.ru)<br />
Дата перевода: 2005 г.<br />
Благодарности: Beaker, Bloodlocust
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Виртуальный художник: линейные (матричные) фильтры"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Виртуальный художник: линейные (матричные) фильтры&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Виртуальный художник: линейные (матричные) фильтры&amp;action=edit">править</a>]</span><span class="mw-headline">Виртуальный художник: линейные (матричные) фильтры</span></h1>
</p>
<a name=".D0.92.D0.B2.D0.B5.D0.B4.D0.B5.D0.BD.D0.B8.D0.B5_2"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%92%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9_%D1%85%D1%83%D0%B4%D0%BE%D0%B6%D0%BD%D0%B8%D0%BA:_%D0%BB%D0%B8%D0%BD%D0%B5%D0%B9%D0%BD%D1%8B%D0%B5_%28%D0%BC%D0%B0%D1%82%D1%80%D0%B8%D1%87%D0%BD%D1%8B%D0%B5%29_%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80%D1%8B&amp;action=edit&amp;section=1" title="Виртуальный художник: линейные (матричные) фильтры">править</a>]</span> <span class="mw-headline">Введение</span></h2>
<p>Речь будет идти о растровых RGB-изображениях, для которых R[x, y], G[x, y], B[x, y] – три компоненты (красная, зеленая, синяя) цвета пикселя с координатами (x, y),  их значения лежат в пределах [0, 255], если в результате вычислений значение вышло за границы, то оно принимает ближайшее значение.
</p><p>Для простоты введем вектор C:
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Painter4-01.gif" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Painter4-01.gif" src="prpwn2-r.gif" width="142" height="81" /></a></span></div></div>
<p>Следует так же заметить, что обработка ведется над каждым компонентом отдельно.
</p>
<a name=".D0.9E.D0.B1.D1.89.D0.B8.D0.B9_.D0.B2.D0.B8.D0.B4"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%92%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9_%D1%85%D1%83%D0%B4%D0%BE%D0%B6%D0%BD%D0%B8%D0%BA:_%D0%BB%D0%B8%D0%BD%D0%B5%D0%B9%D0%BD%D1%8B%D0%B5_%28%D0%BC%D0%B0%D1%82%D1%80%D0%B8%D1%87%D0%BD%D1%8B%D0%B5%29_%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80%D1%8B&amp;action=edit&amp;section=2" title="Виртуальный художник: линейные (матричные) фильтры">править</a>]</span> <span class="mw-headline">Общий вид</span></h2>
<p>В общем случае преобразование заключается в следующей формуле:
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Painter4-02.gif" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Painter4-02.gif" src="mu3_e_w1.gif" width="443" height="54" /></a></span></div></div>
<table>
<tr>
<td> где
</td><td> i, j - целые ( например, от -2 до 2 );
</td></tr>
<tr>
<td> D - некоторое целое число;
</td></tr>
<tr>
<td> A - ядро свертки (матрица некоторых коэффицентов);
</td></tr>
<tr>
<td> C'[x, y] - новый цвет пикселя;
</td></tr>
<tr>
<td> C[x+i, y+j] - старый цвет пикселя.
</td></tr></table>
<p>Объясняю "на пальцах"&nbsp;: мы берем все точки в пределах некоторой окрестности (сумма по i и j), домножаем их на коэффиценты (A[i,j]), прибавляем к результату число (D), и переписываем цвет пикселя.
</p>
<a name="Smooth_.2F_Blur_.28.D1.81.D0.B3.D0.BB.D0.B0.D0.B6.D0.B8.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5.29"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%92%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9_%D1%85%D1%83%D0%B4%D0%BE%D0%B6%D0%BD%D0%B8%D0%BA:_%D0%BB%D0%B8%D0%BD%D0%B5%D0%B9%D0%BD%D1%8B%D0%B5_%28%D0%BC%D0%B0%D1%82%D1%80%D0%B8%D1%87%D0%BD%D1%8B%D0%B5%29_%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80%D1%8B&amp;action=edit&amp;section=3" title="Виртуальный художник: линейные (матричные) фильтры">править</a>]</span> <span class="mw-headline">Smooth / Blur (сглаживание)</span></h2>
<table border="1" align="center">
<tr>
<td> D = 0
</td></tr>
<tr>
<td> i, j = {-1, 0, 1}
</td></tr>
<tr>
<td>
<table>

<tr align="center">
<td> 0.2
</td></tr>
<tr align="center">
<td align="left"> A =
</td><td> 0.2
</td><td> 0.2
</td><td> 0.2
</td></tr>
<tr align="center">
<td> 0.2
</td></tr></table>
</td></tr></table>
<p>Таким образом мы складываем компоненты цвета сверху, снизу, справа, слева, по центру, домноженные на 0.2, т.е. усредняем значение цвета, что логично.
</p>
<table border="1" align="center">

<tr align="center">
<td> До
</td><td> После
</td></tr>
<tr>
<td>
<p><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Painter4-03.png" class="image" title="Изображение:Painter4-03.png"><img alt="Изображение:Painter4-03.png" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Painter4-03.png" src="5bsgd_15.png" width="300" height="40" /></a>
</p>
</td><td>
<p><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Painter4-04.png" class="image" title="Изображение:Painter4-04.png"><img alt="Изображение:Painter4-04.png" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Painter4-04.png" src="_ii7lf-s.png" width="300" height="40" /></a>
</p>
</td></tr></table>
<a name="Edge_detection_.28.D0.BE.D0.BA.D0.BE.D0.BD.D1.82.D1.83.D1.80.D0.B8.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5.29"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%92%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9_%D1%85%D1%83%D0%B4%D0%BE%D0%B6%D0%BD%D0%B8%D0%BA:_%D0%BB%D0%B8%D0%BD%D0%B5%D0%B9%D0%BD%D1%8B%D0%B5_%28%D0%BC%D0%B0%D1%82%D1%80%D0%B8%D1%87%D0%BD%D1%8B%D0%B5%29_%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80%D1%8B&amp;action=edit&amp;section=4" title="Виртуальный художник: линейные (матричные) фильтры">править</a>]</span> <span class="mw-headline">Edge detection (оконтуривание)</span></h2>
<table border="1" align="center">
<tr>
<td> D = 0
</td></tr>
<tr>
<td> i, j = {-1, 0, 1}
</td></tr>
<tr>
<td>
<table>

<tr align="center">
<td> 1
</td></tr>
<tr align="center">
<td align="left"> A =
</td><td> 1
</td><td> -4
</td><td> 1
</td></tr>
<tr align="center">
<td> 1
</td></tr></table>
</td></tr></table>
<p>Этот фильтр создает контур вокруг объектов на рисунке.
</p>
<table border="1" align="center">

<tr align="center">
<td> До
</td><td> После
</td></tr>
<tr>
<td>
<p><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Painter4-03.png" class="image" title="Изображение:Painter4-03.png"><img alt="Изображение:Painter4-03.png" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Painter4-03.png" src="5bsgd_15.png" width="300" height="40" /></a>
</p>
</td><td>
<p><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Painter4-05.png" class="image" title="Изображение:Painter4-05.png"><img alt="Изображение:Painter4-05.png" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Painter4-05.png" src="uo08uyhf.png" width="300" height="40" /></a>
</p>
</td></tr></table>
<a name="Emboss_.28.D0.B1.D0.B0.D1.80.D0.B5.D0.BB.D1.8C.D0.B5.D1.84.29"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%92%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9_%D1%85%D1%83%D0%B4%D0%BE%D0%B6%D0%BD%D0%B8%D0%BA:_%D0%BB%D0%B8%D0%BD%D0%B5%D0%B9%D0%BD%D1%8B%D0%B5_%28%D0%BC%D0%B0%D1%82%D1%80%D0%B8%D1%87%D0%BD%D1%8B%D0%B5%29_%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80%D1%8B&amp;action=edit&amp;section=5" title="Виртуальный художник: линейные (матричные) фильтры">править</a>]</span> <span class="mw-headline">Emboss (барельеф)</span></h2>
<table border="1" align="center">
<tr>
<td> D = 128
</td></tr>
<tr>
<td> i, j = {-1, 0, 1}
</td></tr>
<tr>
<td>
<table>

<tr align="center">
<td> -1
</td></tr>
<tr align="center">
<td align="left"> A<sub>1</sub> =
</td><td> 1
</td></tr>
</table>
</td></tr></table>
<p>Этот фильтр создает эффект вдавливания/выпуклости объектов на рисунке. Заметка&nbsp;: число -1 может стоять где угодно вокруг центральной ячейки, при этом меняется направление падения света на объекты. Например, допустимо и следующее значение A:
</p>
<table align="center">


<tr align="center">
<td align="left"> A<sub>2</sub> =
</td><td> 1
</td><td> -1
</td></tr>
</table>
<p>Так же, можно домножить матрицу A на -1, тогда и эффект поменяется. Например&nbsp;:
</p>
<table align="center">


<tr align="center">
<td align="left"> A<sub>3</sub> =
</td><td> -1
</td><td> 1
</td></tr>
</table>
<table border="1" align="center">

<tr align="center">
<td> До
</td><td> После
</td></tr>
<tr>
<td>
<p><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Painter4-03.png" class="image" title="Изображение:Painter4-03.png"><img alt="Изображение:Painter4-03.png" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Painter4-03.png" src="5bsgd_15.png" width="300" height="40" /></a>
</p>
</td><td>
<table>

<tr align="center">
<td>
<p><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Painter4-06.png" class="image" title="Изображение:Painter4-06.png"><img alt="Изображение:Painter4-06.png" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Painter4-06.png" src="z4g-fxqg.png" width="300" height="40" /></a>
</p>
</td><td> для A<sup>1</sup>
</td></tr>
<tr align="center">
<td>
<p><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Painter4-07.png" class="image" title="Изображение:Painter4-07.png"><img alt="Изображение:Painter4-07.png" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Painter4-07.png" src="2euvhgn3.png" width="300" height="40" /></a>
</p>
</td><td> для A<sup>2</sup>
</td></tr>
<tr align="center">
<td>
<p><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Painter4-08.png" class="image" title="Изображение:Painter4-08.png"><img alt="Изображение:Painter4-08.png" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Painter4-08.png" src="ui4j_m-v.png" width="300" height="40" /></a>
</p>
</td><td> для A<sup>3</sup>
</td></tr></table>
</td></tr></table>
<a name=".D0.9F.D1.80.D0.B8.D0.BC.D0.B5.D1.80"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%92%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9_%D1%85%D1%83%D0%B4%D0%BE%D0%B6%D0%BD%D0%B8%D0%BA:_%D0%BB%D0%B8%D0%BD%D0%B5%D0%B9%D0%BD%D1%8B%D0%B5_%28%D0%BC%D0%B0%D1%82%D1%80%D0%B8%D1%87%D0%BD%D1%8B%D0%B5%29_%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80%D1%8B&amp;action=edit&amp;section=6" title="Виртуальный художник: линейные (матричные) фильтры">править</a>]</span> <span class="mw-headline">Пример</span></h2>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffee00">;=============================================================================</span><br />
<p><span style="color: #ffee00">;========================== &quot;БИБЛИОТЕКА&quot; =====================================</span><br />
<span style="color: #ffee00">;=============================================================================</span><br />
<span style="color: #aaffff; font-weight: bold;">Const</span> MaxFilters=<span style="color: #33ffdd;">10</span><br />
<span style="color: #aaffff; font-weight: bold;">Global</span> CountFilters=<span style="color: #33ffdd;">-1</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> Filter_core# <span style=" ">&#40;</span> MaxFilters, <span style="color: #33ffdd;">2</span>, <span style="color: #33ffdd;">2</span> <span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> Filter_D <span style=" ">&#40;</span> MaxFilters <span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> Filter_matrixR<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span>, <span style="color: #33ffdd;">0</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> Filter_matrixG<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span>, <span style="color: #33ffdd;">0</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> Filter_matrixB<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span>, <span style="color: #33ffdd;">0</span><span style=" ">&#41;</span><br />
<span style="color: #ffee00">;=======================================</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> CreateFilter <span style=" ">&#40;</span> d, c1#, c2#, c3#, c4#, c5#, c6#, c7#, c8#, c9# <span style=" ">&#41;</span> <span style="color: #ffee00">; создает фильтр, </span><br />
<span style="color: #ffee00">; коэффициенты записываются построчно</span><br />
&nbsp; &nbsp; &nbsp; CountFilters = CountFilters<span style="color: #33ffdd;">+1</span><br />
&nbsp; &nbsp; &nbsp; Filter_D <span style=" ">&#40;</span> CountFilters <span style=" ">&#41;</span> = d<br />
&nbsp; &nbsp; &nbsp; Filter_core <span style=" ">&#40;</span> CountFilters, <span style="color: #33ffdd;">0</span>, <span style="color: #33ffdd;">0</span> <span style=" ">&#41;</span> = c1#<br />
&nbsp; &nbsp; &nbsp; Filter_core <span style=" ">&#40;</span> CountFilters, <span style="color: #33ffdd;">0</span>, <span style="color: #33ffdd;">1</span> <span style=" ">&#41;</span> = c2#<br />
&nbsp; &nbsp; &nbsp; Filter_core <span style=" ">&#40;</span> CountFilters, <span style="color: #33ffdd;">0</span>, <span style="color: #33ffdd;">2</span> <span style=" ">&#41;</span> = c3#<br />
&nbsp; &nbsp; &nbsp; Filter_core <span style=" ">&#40;</span> CountFilters, <span style="color: #33ffdd;">1</span>, <span style="color: #33ffdd;">0</span> <span style=" ">&#41;</span> = c4#<br />
&nbsp; &nbsp; &nbsp; Filter_core <span style=" ">&#40;</span> CountFilters, <span style="color: #33ffdd;">1</span>, <span style="color: #33ffdd;">1</span> <span style=" ">&#41;</span> = c5#<br />
&nbsp; &nbsp; &nbsp; Filter_core <span style=" ">&#40;</span> CountFilters, <span style="color: #33ffdd;">1</span>, <span style="color: #33ffdd;">2</span> <span style=" ">&#41;</span> = c6#<br />
&nbsp; &nbsp; &nbsp; Filter_core <span style=" ">&#40;</span> CountFilters, <span style="color: #33ffdd;">2</span>, <span style="color: #33ffdd;">0</span> <span style=" ">&#41;</span> = c7#<br />
&nbsp; &nbsp; &nbsp; Filter_core <span style=" ">&#40;</span> CountFilters, <span style="color: #33ffdd;">2</span>, <span style="color: #33ffdd;">1</span> <span style=" ">&#41;</span> = c8#<br />
&nbsp; &nbsp; &nbsp; Filter_core <span style=" ">&#40;</span> CountFilters, <span style="color: #33ffdd;">2</span>, <span style="color: #33ffdd;">2</span> <span style=" ">&#41;</span> = c9#<br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Return</span> CountFilters<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> ApplyFilter <span style=" ">&#40;</span> img, id <span style=" ">&#41;</span> <span style="color: #ffee00">; применяем фильтр</span><br />
&nbsp; &nbsp; &nbsp; width = <span style="color: #aaffff; font-weight: bold;">ImageWidth</span> <span style=" ">&#40;</span> img <span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; height = <span style="color: #aaffff; font-weight: bold;">ImageHeight</span> <span style=" ">&#40;</span> img <span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; buffer = <span style="color: #aaffff; font-weight: bold;">ImageBuffer</span> <span style=" ">&#40;</span> img <span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; PrepareMatrixRGB <span style=" ">&#40;</span> img <span style=" ">&#41;</span> <span style="color: #ffee00">; считываем картинку в массивы покомпонентно ( r, g, b )</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> k=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> Width<span style="color: #33ffdd;">-2</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> j=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> Height<span style="color: #33ffdd;">-2</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffee00">; инициализируем компоненты нового цвета</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; r = Filter_D <span style=" ">&#40;</span> id <span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; g = Filter_D <span style=" ">&#40;</span> id <span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; b = Filter_D <span style=" ">&#40;</span> id <span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffee00">; чтобы не пересчитывать по несколько раз величины (k-1) и (j-1)</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffee00">; создаем дополнительные переменные</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xx=k<span style="color: #33ffdd;">-1</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; yy=j<span style="color: #33ffdd;">-1</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffee00">; непосредственно применяем фильтр</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> x = <span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">2</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> y = <span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">2</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; r = r + Filter_matrixR<span style=" ">&#40;</span>xx+x, yy+y<span style=" ">&#41;</span>*Filter_core<span style=" ">&#40;</span>id, x, y<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; g = g + Filter_matrixG<span style=" ">&#40;</span>xx+x, yy+y<span style=" ">&#41;</span>*Filter_core<span style=" ">&#40;</span>id, x, y<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; b = b + Filter_matrixB<span style=" ">&#40;</span>xx+x, yy+y<span style=" ">&#41;</span>*Filter_core<span style=" ">&#40;</span>id, x, y<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffee00">; переписываем цвет пикселя</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">WritePixelFast</span> k, j, RGB<span style=" ">&#40;</span>r, g, b<span style=" ">&#41;</span>, buffer<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">UnlockBuffer</span> buffer<br />
&nbsp; &nbsp; &nbsp; CorrectDefect <span style=" ">&#40;</span> img <span style=" ">&#41;</span> <span style="color: #ffee00">; убираем &quot;рамку&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> RGB<span style=" ">&#40;</span>r,g,b<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> r&lt;<span style="color: #33ffdd;">0</span> &nbsp;r=<span style="color: #33ffdd;">0</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> r&gt;<span style="color: #33ffdd;">255</span> &nbsp;r=<span style="color: #33ffdd;">255</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> g&lt;<span style="color: #33ffdd;">0</span> &nbsp;g=<span style="color: #33ffdd;">0</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> g&gt;<span style="color: #33ffdd;">255</span> &nbsp;g=<span style="color: #33ffdd;">255</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> b&lt;<span style="color: #33ffdd;">0</span> &nbsp;b=<span style="color: #33ffdd;">0</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> b&gt;<span style="color: #33ffdd;">255</span> &nbsp;b=<span style="color: #33ffdd;">255</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Return</span> <span style=" ">&#40;</span>r <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">16</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Or</span> <span style=" ">&#40;</span>g <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">8</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Or</span> b &nbsp;<span style="color: #aaffff; font-weight: bold;">Or</span> <span style=" ">&#40;</span><span style="color: #33ffdd;">255</span> <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">24</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> GetR<span style=" ">&#40;</span>val<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Return</span> <span style=" ">&#40;</span>val <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">16</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">And</span> <span style=" ">&#40;</span>$000000FF<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> GetG<span style=" ">&#40;</span>val<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Return</span> <span style=" ">&#40;</span>val <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">8</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">And</span> <span style=" ">&#40;</span>$000000FF<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> GetB<span style=" ">&#40;</span>val<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Return</span> <span style=" ">&#40;</span>val <span style="color: #aaffff; font-weight: bold;">And</span> $000000FF<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> PrepareMatrixRGB <span style=" ">&#40;</span> img <span style=" ">&#41;</span> <span style="color: #ffee00">; считывает картинку в матрицы покомпонентно ( r, g, b )</span><br />
&nbsp; &nbsp; &nbsp; width = <span style="color: #aaffff; font-weight: bold;">ImageWidth</span> <span style=" ">&#40;</span> img <span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; height = <span style="color: #aaffff; font-weight: bold;">ImageHeight</span> <span style=" ">&#40;</span> img <span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Dim</span> Filter_matrixR<span style=" ">&#40;</span> width, height <span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Dim</span> Filter_matrixG<span style=" ">&#40;</span> width, height <span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Dim</span> Filter_matrixB<span style=" ">&#40;</span> width, height <span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">LockBuffer</span> <span style="color: #aaffff; font-weight: bold;">ImageBuffer</span><span style=" ">&#40;</span>img<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> k=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> width<span style="color: #33ffdd;">-1</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> j=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> Height<span style="color: #33ffdd;">-1</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; clr=<span style="color: #aaffff; font-weight: bold;">ReadPixelFast</span><span style=" ">&#40;</span>k, j, <span style="color: #aaffff; font-weight: bold;">ImageBuffer</span><span style=" ">&#40;</span>img<span style=" ">&#41;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Filter_matrixR<span style=" ">&#40;</span>k, j<span style=" ">&#41;</span>=GetR<span style=" ">&#40;</span>clr<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Filter_matrixG<span style=" ">&#40;</span>k, j<span style=" ">&#41;</span>=GetG<span style=" ">&#40;</span>clr<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Filter_matrixB<span style=" ">&#40;</span>k, j<span style=" ">&#41;</span>=GetB<span style=" ">&#40;</span>clr<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> CorrectDefect <span style=" ">&#40;</span> img <span style=" ">&#41;</span> <span style="color: #ffee00">; корректирует изображение ( убирает &quot;рамку&quot; )...</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffee00">; ...&quot;рамка&quot; возникает вследствие того, что мы не обрабатывем крайние пиксели.</span><br />
&nbsp; &nbsp; &nbsp; buffer = <span style="color: #aaffff; font-weight: bold;">ImageBuffer</span> <span style=" ">&#40;</span> img <span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">LockBuffer</span> <span style=" ">&#40;</span> buffer <span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; height = <span style="color: #aaffff; font-weight: bold;">ImageHeight</span> <span style=" ">&#40;</span> img <span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; width = <span style="color: #aaffff; font-weight: bold;">ImageWidth</span> <span style=" ">&#40;</span> img <span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> k = <span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> width<span style="color: #33ffdd;">-1</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">WritePixelFast</span> k, <span style="color: #33ffdd;">0</span>, <span style="color: #aaffff; font-weight: bold;">ReadPixelFast</span> <span style=" ">&#40;</span> k, <span style="color: #33ffdd;">1</span>, buffer <span style=" ">&#41;</span>, buffer<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">WritePixelFast</span> k, height<span style="color: #33ffdd;">-1</span>, <span style="color: #aaffff; font-weight: bold;">ReadPixelFast</span> <span style=" ">&#40;</span> k, height<span style="color: #33ffdd;">-2</span>, buffer <span style=" ">&#41;</span>, buffer<br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> k = <span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> height<span style="color: #33ffdd;">-1</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">WritePixelFast</span> <span style="color: #33ffdd;">0</span>, k, <span style="color: #aaffff; font-weight: bold;">ReadPixelFast</span> <span style=" ">&#40;</span> <span style="color: #33ffdd;">1</span>, k, buffer <span style=" ">&#41;</span>, buffer<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">WritePixelFast</span> width<span style="color: #33ffdd;">-1</span>, k, <span style="color: #aaffff; font-weight: bold;">ReadPixelFast</span> <span style=" ">&#40;</span> width<span style="color: #33ffdd;">-2</span>, k, buffer <span style=" ">&#41;</span>, buffer<br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">UnlockBuffer</span> <span style=" ">&#40;</span> buffer <span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;==============================================================================</span><br />
<span style="color: #ffee00">;=================== ТЕСТОВАЯ ПРОГА ===========================================</span><br />
<span style="color: #ffee00">;==============================================================================</span><br />
<span style="color: #ffee00">;=========================== Инициализация</span><br />
<span style="color: #aaffff; font-weight: bold;">Graphics</span> <span style="color: #33ffdd;">640</span>, <span style="color: #33ffdd;">480</span>, <span style="color: #33ffdd;">16</span>, <span style="color: #33ffdd;">2</span><br />
<span style="color: #aaffff; font-weight: bold;">SetFont</span> <span style="color: #aaffff; font-weight: bold;">LoadFont</span> <span style=" ">&#40;</span> <span style="color: #00ff66;">&quot;arial cyr&quot;</span>, <span style="color: #33ffdd;">30</span>, <span style="color: #33ffdd;">1</span> <span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">ClsColor</span> <span style="color: #33ffdd;">150</span>, <span style="color: #33ffdd;">150</span>, <span style="color: #33ffdd;">150</span><br />
<span style="color: #aaffff; font-weight: bold;">Cls</span><br />
<br />
<span style="color: #ffee00">;=========================== Создание шаблонов и примеров</span><br />
template = <span style="color: #aaffff; font-weight: bold;">CreateImage</span> <span style=" ">&#40;</span> <span style="color: #33ffdd;">300</span>, <span style="color: #33ffdd;">40</span> <span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">ImageBuffer</span> <span style=" ">&#40;</span> template <span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">ClsColor</span> <span style="color: #33ffdd;">50</span>, <span style="color: #33ffdd;">50</span>, <span style="color: #33ffdd;">50</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Cls</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">255</span>, <span style="color: #33ffdd;">255</span>, <span style="color: #33ffdd;">255</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #33ffdd;">150</span>, <span style="color: #33ffdd;">20</span>, <span style="color: #00ff66;">&quot;Filters &nbsp;Example&quot;</span>, <span style="color: #33ffdd;">1</span>, <span style="color: #33ffdd;">1</span><br />
<span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">BackBuffer</span> <span style=" ">&#40;</span> <span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">DrawBlock</span> template, <span style="color: #33ffdd;">10</span>, <span style="color: #33ffdd;">10</span><br />
<span style="color: #aaffff; font-weight: bold;">Flip</span> <span style=" ">&#40;</span> <span style=" ">&#41;</span><br />
<br />
<span style="color: #ffee00">;=========================== Создание фильтров</span><br />
emboss = CreateFilter <span style=" ">&#40;</span> <span style="color: #33ffdd;">128</span>, <span style="color: #33ffdd;">-1</span>, <span style="color: #33ffdd;">0</span>, <span style="color: #33ffdd;">0</span>, <span style="color: #33ffdd;">0</span>, <span style="color: #33ffdd;">1</span>, <span style="color: #33ffdd;">0</span>, <span style="color: #33ffdd;">0</span>, <span style="color: #33ffdd;">0</span>, <span style="color: #33ffdd;">0</span> <span style=" ">&#41;</span> <span style="color: #ffee00">; создаем фильтр &quot;барельеф&quot;</span><br />
blur = CreateFilter <span style=" ">&#40;</span> <span style="color: #33ffdd;">0</span>, <span style="color: #33ffdd;">0</span>, .<span style="color: #33ffdd;">2</span>, <span style="color: #33ffdd;">0</span>, .<span style="color: #33ffdd;">2</span>, .<span style="color: #33ffdd;">2</span>, .<span style="color: #33ffdd;">2</span>, <span style="color: #33ffdd;">0</span>, .<span style="color: #33ffdd;">2</span>, <span style="color: #33ffdd;">0</span> <span style=" ">&#41;</span> <span style="color: #ffee00">; создаем фильтр &quot;сглаживание&quot;</span><br />
contur = CreateFilter <span style=" ">&#40;</span> <span style="color: #33ffdd;">0</span>, <span style="color: #33ffdd;">0</span>, <span style="color: #33ffdd;">1</span>, <span style="color: #33ffdd;">0</span>, <span style="color: #33ffdd;">1</span>, <span style="color: #33ffdd;">-4</span>, <span style="color: #33ffdd;">1</span>, <span style="color: #33ffdd;">0</span>, <span style="color: #33ffdd;">1</span>, <span style="color: #33ffdd;">0</span> <span style=" ">&#41;</span> <span style="color: #ffee00">; создаем фильтр &quot;оконтуривание&quot;</span><br />
<br />
<span style="color: #ffee00">;=========================== Применение фильтров</span><br />
img1 = <span style="color: #aaffff; font-weight: bold;">CopyImage</span> <span style=" ">&#40;</span> template <span style=" ">&#41;</span><br />
ApplyFilter <span style=" ">&#40;</span> img1, blur <span style=" ">&#41;</span> <span style="color: #ffee00">; сглаживаем</span><br />
ApplyFilter <span style=" ">&#40;</span> img1, blur <span style=" ">&#41;</span> <span style="color: #ffee00">; сглаживаем</span><br />
ApplyFilter <span style=" ">&#40;</span> img1, emboss <span style=" ">&#41;</span> <span style="color: #ffee00">; выдавливаем</span><br />
<span style="color: #aaffff; font-weight: bold;">DrawBlock</span> img1, <span style="color: #33ffdd;">10</span>, <span style="color: #33ffdd;">60</span><br />
<span style="color: #aaffff; font-weight: bold;">Flip</span> <span style=" ">&#40;</span> <span style=" ">&#41;</span><br />
<br />
img2 = <span style="color: #aaffff; font-weight: bold;">CopyImage</span> <span style=" ">&#40;</span> template <span style=" ">&#41;</span><br />
ApplyFilter <span style=" ">&#40;</span> img2, contur <span style=" ">&#41;</span> <span style="color: #ffee00">; оконтуриваем</span><br />
ApplyFilter <span style=" ">&#40;</span> img2, blur <span style=" ">&#41;</span> <span style="color: #ffee00">; сглаживаем</span><br />
ApplyFilter <span style=" ">&#40;</span> img2, emboss <span style=" ">&#41;</span> <span style="color: #ffee00">; вдавливаем</span><br />
<span style="color: #aaffff; font-weight: bold;">DrawBlock</span> img2, <span style="color: #33ffdd;">10</span>, <span style="color: #33ffdd;">110</span><br />
<span style="color: #aaffff; font-weight: bold;">Flip</span> <span style=" ">&#40;</span> <span style=" ">&#41;</span><br />
<br />
img3 = <span style="color: #aaffff; font-weight: bold;">CopyImage</span> <span style=" ">&#40;</span> template <span style=" ">&#41;</span><br />
ApplyFilter <span style=" ">&#40;</span> img3, emboss <span style=" ">&#41;</span> <span style="color: #ffee00">; вдавливаем</span><br />
ApplyFilter <span style=" ">&#40;</span> img3, blur <span style=" ">&#41;</span> <span style="color: #ffee00">; сглаживаем</span><br />
ApplyFilter <span style=" ">&#40;</span> img3, blur <span style=" ">&#41;</span> <span style="color: #ffee00">; сглаживаем</span><br />
ApplyFilter <span style=" ">&#40;</span> img3, blur <span style=" ">&#41;</span> <span style="color: #ffee00">; сглаживаем</span><br />
<span style="color: #aaffff; font-weight: bold;">DrawBlock</span> img3, <span style="color: #33ffdd;">10</span>, <span style="color: #33ffdd;">160</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #33ffdd;">10</span>, <span style="color: #33ffdd;">210</span>, <span style="color: #00ff66;">&quot;Press any key...&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Flip</span> <span style=" ">&#40;</span> <span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">FlushKeys</span> <span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">WaitKey</span> <span style=" ">&#40;</span> <span style=" ">&#41;</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">End</span></div>
<div align="right"><a href="http://blitzetcetera.org/images/5/58/VirtualPainter-Filters.bb" class="internal" title="VirtualPainter-Filters.bb">скачать исходный код</a></div>
<hr />
<p>Автор: Хван И. Ю. (selin@onego.ru)
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="2D Объекты-капли в Max2D"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:2D Объекты-капли в Max2D&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=2D Объекты-капли в Max2D&amp;action=edit">править</a>]</span><span class="mw-headline">2D Объекты-капли в Max2D</span></h1>
<p>Этот тьюториал поможет тебе научиться рисовать объекты-капли, используя простые команды Max2D.
</p>
</p><p>Обычно, когда ты рисуешь картинку на экране, ты видишь её, как она есть, пиксель в пиксель. Если эта картинка была кругом, то, после того, как ты её нарисуешь, на экране ты увидишь круг. Форма картинки не изменилась, т.к. она зафиксирована в памяти попиксельно. Добавление картинок на экран не изменит форму других картинок.
</p><p>Объекты-капли от других отличаются тем, что их форма, которая обычно - круг, меняется в зависимости от того, как близко такие объекты расположены друг от друга. Два отдельных объекта могут слиться в один (на самом деле их два, но смотрится, как один). Классная это штука - объекты-капли!
</p><p>Как только ты нарисуешь несколько объектов-капель на достаточно близком расстоянии, они начнут влиять друг на друга. Чем ближе они друг к другу, тем сильнее они "выпучиваются" в сторону друг друга, как будто стягиваемые гравитационной силой. Когда же они совсем близко они начинают смешиваться в одну "гладкую фигуру"(похожую на знак бесконечность, если объекта два). Приемлемо называть такую фигуру "каплей". Если объекты находятся в одной точке, то образуется одна сфера побольше. Иногда объекты-капли называют "меташарами" (metaballs), поскольку это название хорошо объясняет их поведение - "это что-то большее, чем просто шар ".
</p><p>Можно представлять отдельный объект-каплю как ядро атома с энергетическим полем вокруг. Чем ближе подбираемся к нему - тем сильнее энергетическое поле. Сферообразная форма атома получается из-за "размытия" электронов, летящих вокруг него на огромной скорости. С приближением атомов друг к другу, такая форма меняется, т.к. на электроны одного атома влияет соседний(и наоборот). В конечном счете электроны вырываются из орбиты "своего" атома и перелетают на другой, потом, возможно, возвращаясь и т.д. Это ,в основном, и создает "каплю". Вот почему объекты-капли используются в науке для моделирования поведения атомов и молекул.
</p><p>Для нас вопрос в том, чтобы научиться рисовать фигуры, которые будут менять фигуру по заданному закону в зависимости от того, как близко они расположены друг к другу. Другой вопрос - это как рисовать классные "гладкие" фигуры, и как это делать быстро .
</p><p>Изобретено много алгоритмов по рисованию объектов капель. Самый известный из них - "движущиеся кубы"("marching cubes"). Про него можно почитать в Интернете. Алгоритм этот патентованный, так что мы не можем полностью его использовать(фигуры).
</p><p>Однако, получено несколько "побочных эффектов", например "движущиеся треугольники" ("marching triangles"). Основная идея такого алгоритма в том, чтобы подразделять данный набор "атомов" и их объединенные энергетические поля в кубы. Затем ты работаешь на очень маленьком уровне, когда внутри куба создается полигон, перпендикулярный поверхности энергетического поля. Тебе не нужно понимать, как это работает (в нашем случае), так как этот алгоритм мы использовать не будем. Он обычно используется для генерирования 3D полигональных мешей с определенным уровнем детализации.
</p><p>Чаще всего, по такому алгоритму, полигон будет создан в любой точке энергетического поля, где его интенсивность приблизительно равна половине силы. Это понимается, как порог. Т. к. алгоритму нужно знать все возможные места, где энергетический уровень на своем "пороге" в половину силы, требуется большое количество вычислений, особенно работая в 3D. Одна из областей использования объектов-капель - это моделирование органических форм в 3D, и это фича самых навороченных 3D редакторов. Главным образом тяжело это сделать в реальном времени - приходиться разрабатывать специфический системный код.
</p><p>Сперва нужно разобраться, как выглядит объединенное энергетическое поле нескольких объектов-капель или атомов. Представь несколько атомов, висящих в воздухе неподалеку друг от друга. Они испускают энергетические поля заданной силы, рассеивающиеся с расстоянием. В пространстве, где энергетические поля пересекаются, сила энергетического поля равна сумме энергий пересеченных "кусочков".
</p><p>Что хочется сделать в первую очередь - это по данным положениям атомов определить, количество энергии в каждой точке пространства. Очевидно, что в 3D таких точек очень много. В 2D всё проще, особенно с фиксированным количеством пикселей на экране. Так что нам нужно знать только что такое энергетическое поле на пиксельной основе.
</p><p>Традиционные алгоритмы, такие как "движущиеся кубы", используют "много математики" чтобы узнать где располагается энергетическое поле. Поскольку они обычно работают в 3D, они должны задать трехмерную систему точек заданного разрешения и построить энергетическое поле в нем. Это достигается множеством формул и, в случае алгоритма "движущихся кубов", пытается ограничить вычисления ссылкой на возможное кол-во перестановок результата. Но всё это считает процессор.
</p><p>Поскольку мы собираемся создавать двумерные объекты-капли, нам нужно знать как выглядит объединенное энергетическое поле нескольких объектов в 2D. Начнем с рисования картинки энергетического поля в оттенках серого. 
</p><p>Всё что нам нужно - это нарисовать энергетическое поле каждого атома и убедится, что в области их пересечения энергия пересеченных "кусочков" складывается. Поскольку мы работаем в 2D и вычисляем положение точек "меша" за один шаг, каждый пиксель можно использовать как точка энергетического поля. Мы просто делаем кадр всех энергетических полей вокруг всех атомов.
</p><p>Вместо использования массива для хранения поля, или использования математики для работы в реальном времени, мы будем использовать картинку на экране. Экран - это массив данных, преобразуемых железом в цвет в зависимости от содержания данных. А фрукт в том, что используя картинку в качестве объекта-капли, мы можем спихнуть вычисления на видеокарту. Видеокарта = скорость видео.
</p><p>BlitzMax позволяет рисовать картинки разными способами. Установить способ рисования можно командой SetBlend. Обычно картинки рисуются непрозрачными, с использованием режима SOLIDBLEND, установленного по умолчанию. При таком режиме содержание картинки полностью заменяет содержимое экрана под собой. Но нам нужно другое - LIGHTBLEND. Это режим "прибавления". В таком режиме цвет каждого пикселя картинки складывается с соответствующем пикселем экрана. Когда цвет складываемых пикселей получается больше 255(в цвете) или 1.0(в цвете, выраженным числом с плавающей точкой), то сумма обрезается, соответственно до 255 и 1.0. Таким образом мы можем использовать режим LIGHTBLEND для определения пересекающихся частей каждого поля. Ничего, что непересекающиеся участки полей рисуются в таком режиме - позади этих областей черный экран, так что картинка нарисуется так, как она нарисуется в режиме SOLIDBLEND .
</p><p>Итак, мы можем использовать режим LIGHTBLEND для комбинирования энергий каждого атома. Мы будем использовать обычную DrawImage , чтобы нарисовать энергию каждого атома. Энергетическое поле будет просчитываться до использования и храниться в картинке. Пре-просчитывание картинки - это важный фактор, позволяющий нам в реальном времени, с нормальной скоростью создавать эффект капли. Если просчитывать каждое поле, комбинировать его с другими полями, причем делать всё это в реальном времени, то наша прога будет жутко тормозить.
</p><p>Итак, теперь вопрос в том, чтобы сгенерировать энергетическое поле атома и сохранить его как картинка в оттенках серого. Ну, как я уже говорил, чем дальше мы от атома - тем слабее сила энергетического поля. Следовательно, энергетическое поле атома представляет собой шар, с убывающей к краям плотностью. Центр шара - яркий, края шара - почти невидимы. Будем рисовать каждый уровень энергетического поля разным цветом и, поскольку мы работаем в оттенках серого, мы будем использовать 256 оттенков серого.
</p><p>Нарисовать энергетическое поле атома очень легко, скажешь ты. Начать нужно с установки цвета черным, затем нарисовать большой круг, по размеру равный энергетическому полю. Затем нужно повторять этот цикл, уменьшая размер круга, и добавляя 1 к его цвету(и к красному, и к зеленому, и к синему). Получиться круг, залитый градиентом от белого до черного, из центра к краям. Это выглядит так:
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Blobs01.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Blobs01.jpg" src="bdh2roew.jpg" width="400" height="277" /></a></span></div></div>
<p>Если положить это в картинку и нарисовать её несколько раз, получим это:
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Blobs02.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Blobs02.jpg" src="2k45-2cm.jpg" width="400" height="278" /></a></span></div></div>
<p>Эффекта капли не получилось. Пока энергии пересеченных кусочков не складываются, нет эффекта гладкой поверхности. Это становится более очевидным, если выделить некоторые кусочки поля одного цвета контрастным, например красным:
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Blobs03.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Blobs03.jpg" src="wuacp34l.jpg" width="400" height="278" /></a></span></div></div>
<p>Далее можно увидеть, какая, собственно, фигура получилась. Получился почти прямой  "мост" между двумя полями. Но почему? Эта прямолинейность - результат приращения цвета исходной картинки.  Градиент получился полностью "линейным". Его изменение показано на графике:
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Blobs04.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Blobs04.jpg" src="uu_gzii0.jpg" width="512" height="257" /></a></span></div></div>
<p>Так как цвет изменяется от черного к белому, существует устойчивый шаг его увеличения, пропорциональный диаметру нарисованных кругов. Из-за "линейного" градиента ничего не получается. Технически энергетические поля комбинируются, но делают они это не так, как нам надо. Нам не подходит такой способ представления объектов-капель.
</p><p>Нам нужно сгенерировать искривленную поверхность. Нам нужно, чтобы объекты взаимодействовали постепенно, чтобы образовалась гладкая искривленная поверхность, а не все сразу рывком. Чтобы этого достичь, нужно изменить форму градиента, чтобы он был нелинейным. Это значит, что вместо увеличения цвета на 1 с каждым шагом, нужно медленно увеличивать изменение цвета (до этого оно всегда было 1).
</p><p>Электрону из такого энергетического поля, на краю поля будет очень легко вылететь, когда при приближении к центру это становится почти невозможным.
</p><p>Рисование изогнутого градиента включено в исходник ниже. Нам нужно увеличивать интенсивность цвета квадратично. Пока число маленькое - кривая не сильно гнется, но с его увеличением, она становится очень изогнутой. Выглядит такая кривая так:
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Blobs05.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Blobs05.jpg" src="_gvfiw2u.jpg" width="512" height="257" /></a></span></div></div>
<p>Так выглядит энергетическое поле атома, заданное картинкой, залитой квадратичным градиентом:
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Blobs06.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Blobs06.jpg" src="y7ktgxfl.jpg" width="400" height="277" /></a></span></div></div>
<p>У новой картинки больше проявляется центр, где максимум яркости и прозрачность краев.  Яркость быстро спадает по направлению от центра к краям. Это идеальная форма для объекта-капли.
</p><p>Такой градиент подходит больше всего, т.к. его кривизна также показывает, как взаимодействуют два поля друг на друга в зависимости от расстояния между ними. При рисовании нескольких таких картинок в режиме LIGHTBLEND образуются не только гладкоизогнутые формы, но и различные углы кривизны, зависящие от близости атомов. С линейным градиентом получается резкое образование "моста" между двумя атомами, когда как при изогнутом градиенте мы получаем различную степень выгнутости.
</p><p>Итак, вот что получается при рисовании двух энергетических полей новым способом:
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Blobs07.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Blobs07.jpg" src="l7t46rw9.jpg" width="400" height="278" /></a></span></div></div>
<p>Теперь это совсем не похоже на то, что у нас получилось в начале. Опять же, выделив "кусочки" поля красным, видим кривые, но теперь такие, как нам надо:
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Blobs08.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Blobs08.jpg" src="0oe-641k.jpg" width="400" height="276" /></a></span></div></div>
<p>Получился нормальный объект-капля. Области ближе к центру ещё не "вытянулись", т.к. ещё не находятся во влиянии друг друга. Области, которые влияют друг на друга (пересекаясь) начинают выгибаться в сторону друг друга и объединяться. Только из-за квадратичного градиента у нас всё получилось.
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Blobs09.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Blobs09.jpg" src="8z0-7p7v.jpg" width="442" height="358" /></a></span></div></div>
<p>Всё, теперь у тебя есть объект-капля, нарисованный на экране! 
</p><p>Самое классное это то, что это очень-очень простая техника по сравнению с "движущимися кубами". Особенно классно то, что мы все преобразования производим, используя данные картинки и, следовательно, используем ускорение видеокарты. Простая комбинация пре-просчитанной картинки, с использованием правильного градиента и "прибавительного" режима рисования обеспечивает нам эффект объекта-капли.
</p><p>Существуют и другие кривые градиента, основанные на других формулах. Формула ЧИСЛОxЧИСЛО - самая простая и производит стандартный эффект. Другие формулы дают более плоские кривые, или подчеркивают центр. Изменение кривой таким способом могут сделать объекты-капли более "липкими".
</p><p>Главная идея получения объектов-капель в том, что сперва генерируется объединенное поле, официально называемое "изоповерхность"("isosurface") и, затем рисуется с определенным порогом. В моем примере выше(про выделение красным) я взял программу рисования, включил потоковую заливку, шириной в 5 пикселей и тыкнул мышкой в нескольких местах. Можно определить порог цвета, который будет рисоваться.
</p><p>Обычно объекты-капли так и рисуются, рисуя только пиксели цветом, скажем, между 120 и 140. Получится полоска, похожая на одну из красных на картинках выше.
</p><p>В этом тьюториале я всего лишь показываю тебе основы генерации объектов-капель. Твоя задача в том, чтобы преобразовать сгенерированную картинку в ту, что тебе надо. В следующем, более продвинутом примере, я перевел весь код в прямой OpenGL. Это позволяет мне устанавливать режимы рисования, не имеющиеся в оригинальном Max2D. Используя дополнительные режимы, я  несколько раз покрывал экран заполненным треугольником, и с каждым разом производились различные математические преобразования над цветами пикселей. В конечном результате можно получить несколько полосок цвета.
</p><p>В примере этого тьюториала есть встроенный порог в 255, т.е. в любой точке экрана яркость не может быть больше 255. Посредством различных манипуляций можно сделать объект-каплю полностью белым. В добавление можно нарисовать прямоугольник над экраном в режиме LIGHTBLEND с цветом $80,$80,$80 (наполовину серый), который приведет к изменению порога так, что он будет равен половине силы поля - что гораздо лучше смотрится, чем белый. Немного умных манипуляций и может получиться что-нибудь, похожее на это:
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Blobs10.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Blobs10.jpg" src="i_-wxnre.jpg" width="640" height="480" /></a></span></div></div>
<p>Пока всё что мы сделали - это сферический объект-капля. Мы работаем с пре-просчитанной картинкой в качестве поля. Можно её сохранить в файл и, затем изменить в любом графическом редакторе. Потом нужно будет просто загрузить её в начале программы, вместо генерации. Изменяя форму, или добавляете что-либо в начальную картинку, можно достичь классных эффектов!
</p><p>Можно закрашивать картинки при рендеринге, используя SetColor для каждой. Так можно получить эффект, похожий на изображенный выше.
</p><p>Этот алгоритм поддерживает неограниченное количество объектов! Повеселись!
</p><p>Надеюсь всё написано чётко и понятно (я тоже - прим. всеп. пер.).
</p><p>Вот очень маленький исходник, просто скопируй, вставь в свой IDE и запусти! Тут реализовано создание сферических объектов-капель диаметром 512, 256 и 128 пикселей. Возможны и другие размеры, но для них нужно определить значения balldivider и lineardivider - уверен, что существует формула их вычисления, но я пока не смог её вывести.
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #B1E7EB;">'Объекты-капли в BlitzMax, используя только Max2D </span><br />
<p><br />
<span style="color: #B1E7EB;">'Диаметр шара и его половина</span><br />
<span style="color: #ffff00; font-weight: bold;">Local</span> ballsize:<span style="color: #ffff00; font-weight: bold;">Int</span>=<span style="color: #FFFFFF;">512</span><br />
<span style="color: #ffff00; font-weight: bold;">Local</span> ballsizehalf:<span style="color: #ffff00; font-weight: bold;">Int</span>=ballsize/<span style="color: #FFFFFF;">2</span> <br />
<br />
<span style="color: #B1E7EB;">'Устанавливаем графический режим</span><br />
<span style="color: #ffff00; font-weight: bold;">Graphics</span> <span style="color: #FFFFFF;">800</span>,<span style="color: #FFFFFF;">600</span>,<span style="color: #FFFFFF;">0</span><br />
<br />
<span style="color: #ffff00; font-weight: bold;">Cls</span> <br />
<br />
<span style="color: #B1E7EB;">'Вычисляем делители для разных диаметров шара</span><br />
<span style="color: #ffff00; font-weight: bold;">Local</span> balldivider:<span style="color: #ffff00; font-weight: bold;">Float</span><br />
<span style="color: #ffff00; font-weight: bold;">If</span> ballsize=<span style="color: #FFFFFF;">128</span> <span style="color: #ffff00; font-weight: bold;">Then</span> balldivider=<span style="color: #FFFFFF;">64</span> <span style="color: #B1E7EB;">'8x8</span><br />
<span style="color: #ffff00; font-weight: bold;">If</span> ballsize=<span style="color: #FFFFFF;">256</span> <span style="color: #ffff00; font-weight: bold;">Then</span> balldivider=<span style="color: #FFFFFF;">256</span> <span style="color: #B1E7EB;">'16x16</span><br />
<span style="color: #ffff00; font-weight: bold;">If</span> ballsize=<span style="color: #FFFFFF;">512</span> <span style="color: #ffff00; font-weight: bold;">Then</span> balldivider=<span style="color: #FFFFFF;">1024</span> <span style="color: #B1E7EB;">'32x32</span><br />
<span style="color: #ffff00; font-weight: bold;">Local</span> lineardivider:<span style="color: #ffff00; font-weight: bold;">Float</span><br />
<span style="color: #ffff00; font-weight: bold;">If</span> ballsize=<span style="color: #FFFFFF;">128</span> <span style="color: #ffff00; font-weight: bold;">Then</span> lineardivider=<span style="color: #FFFFFF;">0.5</span><br />
<span style="color: #ffff00; font-weight: bold;">If</span> ballsize=<span style="color: #FFFFFF;">256</span> <span style="color: #ffff00; font-weight: bold;">Then</span> lineardivider=<span style="color: #FFFFFF;">1</span><br />
<span style="color: #ffff00; font-weight: bold;">If</span> ballsize=<span style="color: #FFFFFF;">512</span> <span style="color: #ffff00; font-weight: bold;">Then</span> lineardivider=<span style="color: #FFFFFF;">2</span><br />
<br />
<span style="color: #B1E7EB;">'Генерация картинки с полем</span><br />
<span style="color: #ffff00; font-weight: bold;">For</span> <span style="color: #ffff00; font-weight: bold;">Local</span> r:<span style="color: #ffff00; font-weight: bold;">Float</span>=<span style="color: #FFFFFF;">1</span> <span style="color: #ffff00; font-weight: bold;">To</span> ballsize<span style="color: #FFFFFF;">-1</span> <span style="color: #ffff00; font-weight: bold;">Step</span> <span style="color: #FFFFFF;">0.5</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Local</span> level:<span style="color: #ffff00; font-weight: bold;">Float</span>=r<br />
&nbsp; &nbsp; &nbsp; &nbsp; level:*level<br />
&nbsp; &nbsp; &nbsp; &nbsp; level=level/balldivider<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">SetColor</span> level,level,level <span style="color: #B1E7EB;">'Нужный градиент</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #B1E7EB;">'SetColor r/lineardivider,r/lineardivider,r/lineardivider 'Для линейных градиентов</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <br />
<span style="color: #ffff00; font-weight: bold;">DrawOval</span> r/<span style="color: #FFFFFF;">2</span>,r/<span style="color: #FFFFFF;">2</span>,ballsize-r,ballsize-r &nbsp;<br />
<span style="color: #ffff00; font-weight: bold;">Next</span><br />
<br />
<span style="color: #B1E7EB;">'Собираем в картинку</span><br />
<span style="color: #ffff00; font-weight: bold;">AutoMidHandle</span> <span style="color: #ffff00; font-weight: bold;">True</span><br />
<span style="color: #ffff00; font-weight: bold;">Local</span> img:TImage=<span style="color: #ffff00; font-weight: bold;">CreateImage</span><span style=" ">&#40;</span>ballsize,ballsize,<span style="color: #FFFFFF;">1</span>,FILTEREDIMAGE<span style=" ">&#41;</span><br />
<span style="color: #ffff00; font-weight: bold;">GrabImage</span><span style=" ">&#40;</span>img,<span style="color: #FFFFFF;">0</span>,<span style="color: #FFFFFF;">0</span>,<span style="color: #FFFFFF;">0</span><span style=" ">&#41;</span><br />
<br />
<br />
<span style="color: #B1E7EB;">'Устанавливаем режим рисования</span><br />
<span style="color: #ffff00; font-weight: bold;">SetBlend</span> LIGHTBLEND<br />
<br />
<span style="color: #B1E7EB;">'Рисуем картинку, пока не нажмут на escape</span><br />
<span style="color: #ffff00; font-weight: bold;">Repeat</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Cls</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">DrawImage</span> img,<span style="color: #FFFFFF;">400</span>,<span style="color: #FFFFFF;">300</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">DrawImage</span> img,<span style="color: #ffff00; font-weight: bold;">MouseX</span><span style=" ">&#40;</span><span style=" ">&#41;</span>,<span style="color: #ffff00; font-weight: bold;">MouseY</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffff00; font-weight: bold;">Flip</span><br />
</p>
<span style="color: #ffff00; font-weight: bold;">Until</span> <span style="color: #ffff00; font-weight: bold;">KeyHit</span><span style=" ">&#40;</span>KEY_ESCAPE<span style=" ">&#41;</span></div>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffee00">;Blobby Objects для Blitz3D</span><br />
<p><span style="color: #ffee00">;Портировал на Блитз: Солодовниченко Михаил ака MANIAK_dobrii</span><br />
<span style="color: #ffee00">;Нужна картинка, и установленный графический режим</span><br />
<span style="color: #ffee00">;В главном цикле BlobBlend(картинка,Х-координата,Y-координата)</span><br />
<span style="color: #ffee00">;Картинка должна входить в экран по Y, т.е. если хоть кусочек картинки</span><br />
<span style="color: #ffee00">; выйдет за верхний/нижний край экрана, то прога вылетит</span><br />
<br />
<br />
<span style="color: #aaffff; font-weight: bold;">Graphics</span> <span style="color: #33ffdd;">640</span>,<span style="color: #33ffdd;">480</span>,<span style="color: #33ffdd;">32</span>,<span style="color: #33ffdd;">2</span><br />
<span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">BackBuffer</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
BlobSize = <span style="color: #33ffdd;">128</span><br />
BlobDivider = <span style="color: #33ffdd;">64</span><br />
<br />
<br />
<span style="color: #aaffff; font-weight: bold;">Global</span> blob = <span style="color: #aaffff; font-weight: bold;">CreateImage</span><span style=" ">&#40;</span>BlobSize,BlobSize<span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">ImageBuffer</span><span style=" ">&#40;</span>blob<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> i#=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> BlobSize<span style="color: #33ffdd;">-1</span> <span style="color: #aaffff; font-weight: bold;">Step</span> .<span style="color: #33ffdd;">5</span><br />
&nbsp; lev# = i<br />
&nbsp; lev = lev*lev<br />
&nbsp; lev = lev/BlobDivider<br />
<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Color</span> lev,lev,lev<br />
<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Oval</span> i/<span style="color: #33ffdd;">2</span>,i/<span style="color: #33ffdd;">2</span>,BlobSize-i,BlobSize-i<br />
&nbsp; <br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">BackBuffer</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
<br />
<br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
<span style="color: #aaffff; font-weight: bold;">Cls</span><br />
msX = <span style="color: #aaffff; font-weight: bold;">MouseX</span><span style=" ">&#40;</span><span style=" ">&#41;</span>:msy = <span style="color: #aaffff; font-weight: bold;">MouseY</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
BlobBlend<span style=" ">&#40;</span>blob,<span style="color: #33ffdd;">256</span>,<span style="color: #33ffdd;">176</span><span style=" ">&#41;</span><br />
BlobBlend<span style=" ">&#40;</span>blob,msX<span style="color: #33ffdd;">-64</span>,msY<span style="color: #33ffdd;">-64</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Flip</span><br />
<span style="color: #aaffff; font-weight: bold;">Until</span> <span style="color: #aaffff; font-weight: bold;">KeyHit</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">End</span><br />
<br />
<span style="color: #ffee00">;Рисует blob в X и Y</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> BlobBlend<span style=" ">&#40;</span>Blob,x,y<span style=" ">&#41;</span><br />
BlobBlendEx<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">BackBuffer</span><span style=" ">&#40;</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">ImageBuffer</span><span style=" ">&#40;</span>Blob<span style=" ">&#41;</span>,x,y,<span style="color: #aaffff; font-weight: bold;">ImageWidth</span><span style=" ">&#40;</span>Blob<span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">ImageHeight</span><span style=" ">&#40;</span>blob<span style=" ">&#41;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Тоже, что и BlobBlend(), но расширенная</span><br />
<span style="color: #ffee00">;[буфер &quot;под картинкой&quot;][буфер картинки][X-коорд.][Y-коорд.]</span><br />
<span style="color: #ffee00">;[ширина картинки][высота картинки][прозрачность][маска]</span><br />
<span style="color: #ffee00">;ширина и высота картинки может быть меньше реальных высоты и ширины</span><br />
<span style="color: #ffee00">;Цвет, определенный в маске не будет рисоваться</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> BlobBlendEx<span style=" ">&#40;</span>Back_Buffer,BlobBuffer,x,y,BlobWidth,BlobHeight,alpha=<span style="color: #33ffdd;">1500</span>,mask=<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Local</span> yy,xx,xn,yn,argb<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Local</span> back_buffer_red, Blob_Buffer_red, result_red, back_buffer_green, <br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Local</span> Blob_Buffer_green, result_green, back_buffer_blue, Blob_Buffer_blue, result_blue<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">LockBuffer</span> Back_Buffer<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">LockBuffer</span> BlobBuffer<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> yy = <span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> BlobHeight<span style="color: #33ffdd;">-1</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> xx = <span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> BlobWidth<span style="color: #33ffdd;">-1</span><br />
&nbsp; &nbsp; &nbsp; xn = x+xx<br />
&nbsp; &nbsp; &nbsp; yn = y+yy<br />
&nbsp; &nbsp; &nbsp; <br />
&nbsp; &nbsp; &nbsp; argb = <span style="color: #aaffff; font-weight: bold;">ReadPixelFast</span><span style=" ">&#40;</span>xx,yy,BlobBuffer<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> argb &lt;&gt; mask<br />
&nbsp; &nbsp; &nbsp; &nbsp; Blob_Buffer_red = <span style=" ">&#40;</span>argb <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">16</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">And</span> $ff<br />
&nbsp; &nbsp; &nbsp; &nbsp; Blob_Buffer_green = <span style=" ">&#40;</span>argb <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">8</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">And</span> $ff<br />
&nbsp; &nbsp; &nbsp; &nbsp; Blob_Buffer_blue = argb <span style="color: #aaffff; font-weight: bold;">And</span> $ff<br />
&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp; &nbsp; &nbsp; &nbsp; argb = <span style="color: #aaffff; font-weight: bold;">ReadPixelFast</span><span style=" ">&#40;</span>xn,yn,Back_Buffer<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; back_buffer_red = <span style=" ">&#40;</span>argb <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">16</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">And</span> $ff<br />
&nbsp; &nbsp; &nbsp; &nbsp; back_buffer_green = <span style=" ">&#40;</span>argb <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">8</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">And</span> $ff<br />
&nbsp; &nbsp; &nbsp; &nbsp; back_buffer_blue = argb <span style="color: #aaffff; font-weight: bold;">And</span> $ff<br />
&nbsp; <br />
&nbsp; &nbsp; &nbsp; &nbsp; result_red = <span style=" ">&#40;</span>alpha * Blob_Buffer_red<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">8</span> + back_buffer_red<br />
&nbsp; &nbsp; &nbsp; &nbsp; result_green = <span style=" ">&#40;</span>alpha * Blob_Buffer_green<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">8</span> + back_buffer_green<br />
&nbsp; &nbsp; &nbsp; &nbsp; result_blue = <span style=" ">&#40;</span>alpha * Blob_Buffer_blue<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">8</span> + back_buffer_blue<br />
&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> result_red &gt; <span style="color: #33ffdd;">255</span> <span style="color: #aaffff; font-weight: bold;">Then</span> result_red = <span style="color: #33ffdd;">255</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> result_green &gt; <span style="color: #33ffdd;">255</span> <span style="color: #aaffff; font-weight: bold;">Then</span> result_green = <span style="color: #33ffdd;">255</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> result_blue &gt; <span style="color: #33ffdd;">255</span> <span style="color: #aaffff; font-weight: bold;">Then</span> result_blue = <span style="color: #33ffdd;">255</span><br />
&nbsp; <br />
&nbsp; &nbsp; &nbsp; &nbsp; argb_pix = <span style=" ">&#40;</span><span style=" ">&#40;</span><span style=" ">&#40;</span>result_red <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">8</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Or</span> result_green<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">8</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Or</span> result_blue<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">WritePixelFast</span> xn,yn,argb_pix,Back_Buffer<br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">EndIf</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">UnlockBuffer</span> Back_Buffer<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">UnlockBuffer</span> BlobBuffer<br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<div align="right"><a href="http://blitzetcetera.org/images/c/c9/Blobs.zip" class="internal" title="Blobs.zip">скачать архив с файлами к статье</a></div>
<hr />
<p>Автор: AngelDaniel (worklog: http://www.blitzbasic.com/logs/userlog.php?log=436&amp;user=8053)<br />
Перевод: <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:MANIAK_dobrii" title="Участник:MANIAK dobrii">MANIAK dobrii</a> (e-mail: MANIAK_dobrii@list.ru, сайт: <a href="http://www.maniak-dobrii.nm.ru/" class="external free" title="http://www.maniak-dobrii.nm.ru/" rel="nofollow">http://www.maniak-dobrii.nm.ru/</a>)
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Текстовые адвентюры"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Текстовые адвентюры&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Текстовые адвентюры&amp;action=edit">править</a>]</span><span class="mw-headline">Текстовые адвентюры</span></h1>
<p>Прежде всего, разъясню само понятие для тех, кто с ним не знаком.  Текстовые адвентюры - это жанр компьютерных игр, в которых пользователь вводит с клавиатуры команды (как то "взять камень" или "срубить топором дерево"), а компьютер распознает эти команды и, соответственно, реагирует. Игровой мир классических программ этого жанра состоит из локаций - абстрактных мест, где герой (а также другие объекты) может находиться. Между локациями можно перемещаться (иногда достаточно просто пойти в нужном направлении, а иногда - найти ключ, отпереть им дверь и войти в нее), в них можно производить действия с объектами. Некоторые объекты игрового мира можно взять, тогда они переносятся в инвентарь (обычно, это изолированная локация) и главный герой сможет ими воспользоваться, имея их всегда под рукой.
</p>
</p><p>Львиная доля текстовых адвентюр написана на платформе Спектрума на английском. Английский язык прост и это способствует удобству распознавания фразы (иногда идут на компромисс - описание локаций на русском, объекты и ввод фразы - на английском). Это процесс (в самых простых играх) происходит следующим образом: удаляются предлоги, выделяются три слова: глагол, первое существительное, второе существительное. Они урезаются до 3-5 букв (чем активно пользовались составители адвентюр с вводом фраз на русском) и передаются в процедуру, которая производит вся манипуляции с игровым миром. Тот состоит из массива локаций (широко применялся прием - для каждой локации можно было задать возможность перемещения в одном из 6 направлений (на север, на запад, на юг, на восток, вверх, вниз)) и массива объектов (каждый объект привязан к определенной локации). Это все старые технологии и мы ими пользоваться не будем.
</p><p>Стоит еще упомянуть также сплавы адвентюр на IBM PC и Commodore: первые версии Leisure Suit Larry, King's Quest, Future Wars, Hero's Quest, Hugo, Maniac Mansion, Police Quest. В них совмещено перемещение по игровому пространству с помощью клавиш или мыши и ввод команд с клавиатуры. Большинство из этих игр плавно перекочевали в жанр квестов. По сути, квесты вобще появились в результате эволюции текстовых адвентюр, но потеряли при этом такие аспекты, как налаживание диалога с программой, разнообразие возможностей. Елки-палки, все на откуп казуалам отдали (ну разве что, кроме походовых стратегий). Ну да ладно.
</p><p>Перед тем, как засесть за разработку программы, я поставил себе цель создать гибкую систему, в полной мере подходящую для написания текстовых адвентюр. В прошлом, я уже создавал гибкий движок ввода слов на русском. Решив использовать для хранения данных древовидную иерархическую структуру, я написал под нее движок с нуля, добавив некоторые улучшения. Когда я стал разрабатывать процедуру обработки введенной фразы, то увидел, что такая система подходит и для других игр. С ее помощью можно вдохнуть в жестко ограниченные игровые миры (будь то 3D-боевик, где можно только убивать или взрывать, либо закованная в кандалы правил AD&amp;D ролевуха, да и другие жанры) свободу (например, возможность все потрогать, осмотреть, открыть) и жизнь (смоделировать действия NPC в зависимости от состояния системы). Поэтому, статью можно назвать и так "создание гибкой системы взаимодействия с игровым миром с помощью древовидной структуры на примере текстовых адвентюр", длинно, зато в полной мере отражает суть.
</p><p>Гибкость системы базируется на простоте установки связи между объектами. К примеру: вот комната, в ней стоит стол, на столе лежит книга. Нужно не просто создать объекты "комната", "стол", "тетрадь", а еще и установить зависимости: "стол - в комнате", "тетрадь - на столе". Пойдем дальше - стол это составной объект, он состоит из столешницы и 4-х ножек, тетрадь состоит из обложки и листов, а комната - из стен, пола и потолка. Нужно, чтобы система позволяла действовать, как с объектом, так и с его составляющими. Далее, так как однотипных объектов может быть много, нужно ввести возможность сгруппировать в один, с указанием количества (не все же тетрадные листы заносить, как отдельные объекты). Данный процесс разложения на составляющие можно проводить сколь угодно долго - уровень, на котором мы остановимся зависит от выбранной степени детализации, которая, в свою очередь, вычисляется исходя из целей и ресурсов.
</p><p>Возникает вопрос: какими критериями руководствоваться в выборе структуры данных, чтобы достичь желаемой максимальной гибкости? Первое: чем меньше типов объектов в системе - тем лучше. Чем больше объектов, тем больше возможных типов связей может понадобиться - квадратичная зависимость. Например, если есть всего один тип объекта, то тип связи один - объект с объектом. В случае 2-х типов объектов, связей больше - об1-&gt;об1, об2-&gt;об2, об1-&gt;об2, об2-&gt;об1 - четыре и т. д. Второе: в идеале, каждый объект должен иметь возможность связи с любым другим. Чем больше ограничений - тем хуже. Третье: система должна быть простой в использовании, обладать быстродействием и потреблять минимум ресурсов.
</p><p>Древовидная структура: 1) обладает единственным типом данных, 2) каждый объект может быть включать в себя группу из других объектов и, в свою очередь, состоять в группе с другими (но не теми же) объектами. Этот недостаток не позволяет приписать объекту какие-либо свойства (наример, что все элементы стола - деревянные, привязать все эти объекты к объекту "деревянный"), но его, однако, можно устранить. Система "вложений" вполне удовлетворяет пространственным размещениям объектов (тетрадь лежит на столе, стол находится в комнате; если проанализировать "ветвь" комнаты, то окажется, что и стол и тетрадь находятся в комнате, хотя и находятся на разных уровнях иерархии). 3) Система удобна - можно брать целые ветви и прикреплять их к другому объекту (переносить), ресурсы - 4 ссылки + дополнительные данные, скорость операций с элементами высока.
</p><p>Недостаток возможности приписывания определенном объекту свойств можно устранить следующим образом: перечислить свойства объекта в текстовой переменной через запятую. Этот способ, конечно, медленный и ресурсозатратный, однако для адвентюрных игр он вполне подойдет, к тому же, при его использовании удобно вводить данные. Его вполне можно оптимизировать, но это долгая работа, поэтому останавливаться на этом вопросе пока не будем.
</p><p>Организация данных. Первый уровень иерархии (после root) будет включать в себя локации. Первая локация - всегда присутствующие объекты: "руки" - там будет храниться объект, который играющий в данный момент держит в руках, "тело" - там будет одежда и "все" - объект, заменяющий доступные. Остальные локации будут включать в себя объекты, те, в свою очередь, то, что в них находится и свои компоненты. Каждый объект имеет имя и флаги, характеризующие его состояние и свойства:
</p>
<ul><li>[Локация] - можно осуществить переход в данную локацию с помощью объекта
</li><li>Ж / С / М - женский род / средний род / множественное число (мужской по умолчанию)
</li><li>Скр - скрытый объект (появлятся, после того, как осмотреть корневой)
</li><li>Откр / Закр - состояние для объектов, которые могут открываться / закрываться
</li><li>Отп / Зап - состояние для объектов, которые могут отпираться / запираться
</li><li>Кл_на / Кл_в / Кл_под - на / в / под этот объект можно положить предмет
</li><li>На / В / Под - предмет лежит на / в / под корневым объектом
</li><li>Одеть - предмет можно одеть
</li><li>Карман - будучи одет, этот объект позволяет "вкладывать в себя" мелкие предметы
</li><li>Взять - объект является мелким предметом и его можно положить в карман или взять в руки
</li><li>Рук - объект является большим предметом и его можно только взять в руки
</li><li>Цел / Разб - состояние для объектов, которые можно разбить
</li><li>Сух / Мок - состояние для объектов, которые можно намочить
</li><li>Вода - данный объект наполнен водой
</li><li>Рез - объект можно разрезать осколком
</li><li>Пов_на - на этот объект можно повесить другой
</li><li>М_вис - этот объект можно повесить на другой
</li><li>Вис - объект висит на корневом объекте
</li></ul>
<p>Теперь о текстовом движке. Стоит отметить, что самую сложную команду можно представить в виде набора команд типа "(глагол) (объект1) (предлог) (объект2)". Иногда второй объект не требуется (да и первый тоже, например, команда "осмотреться"). Итак, необходим список глаголов. Если быть точнее  - необходим список форматов команд (так как существительные имеют падежи) в следующем виде: "(глагол) (падеж 1-го объекта, если он нужен) (предлог) (падеж 2-го объекта, если он нужен)". Далее, может потребоваться взять каждое существительное и прилагательное в названии объекта в одном из 6 падежей, поэтому нужен список возможных окончаний. В теле имени изменяющееся окончание пусть будет заменено ссылкой "#N", где N - номер набора окончаний. Почему бы не воспользоваться методом урезания окончаний? Все дело в том, что вводить фразу полностью черсчур медленно, а сокращения типа "сруб топо дере" плохо смотрятся. Да и сама урезка сопряжена с определенными трудностями, например для слова "яма" или ситуации, когда меняются местами существительные (фразы "срубить топором дерево" и "срубить топор деревом" компьютер может расценить одинаково). Поэтому, будем делать упор на "предсказывание" компьютером слова в процессе ввода.
</p><p>Предсказывание будет осуществляться следующим образом: из списка возможных объектов берется первый попавшийся, первые буквы которого совпадают с уже введенным куском. Однако, слово "осмотреться" придется вводить почти целиком, потому что ранее в списке идет "осмотреть". Это неудобно, поэтому включим возможность перебирать возможные варианты с помощью клавиш PgUp / PgDn. Если удалось найти слово, не введенная часть добавляется, написанная зеленым цветом. Если нет - введенная часть помечается красным цветом. Пробел или запятая расцениваются, как конец слова и переход к началу набора следующего.
</p><p>Сначала предсказывается форма - подбор ведется по имени глагола (кстати, недостаток движка - если команды имеют одинаковое имя глагола, но разные предлоги (например, "положить А в Б" и "положить А на Б"), то ввести их не удастся, поэтому придется переключать их с помощью PgUp / PgDn, а предлог показывать в скобках). Если введена запятая - подбираем еще одну команду, идентичную по форме первой, если пробел -переходим к следующему этапу - подбирается объект (по имени). Здесь нужен список из ссылок на подходящие объекты (те, что в данной локации и в инвентаре, включая вложенные, кроме скрытых, а также объект "все"). После еще одного пробела, подбирается еще один (если нужен). Enter завершает ввод фразы и передает ее интерпретатору.
</p><p>На первом этапе, интерпретатор разбивает команды на элементарные - сначала идет перебор глаголов, затем 1-х объектов, затем 2-х. Например, команда "взять, одеть брюки, пиджак" будет разбита на "взять брюки", "одеть брюки", "взять пиджак", "одеть пиджак". Объект "все" заменяется перечислением всех доступных объектов.
</p><p>Второй этап интерпретации - самый важный. Процедура получает данные в виде (команда), (объект1), (объект2). Необходимо изменить базу данных и выдать нужную информацию. Прежде всего, зададим фразу для непредусмотренных действий - "не получается". Введем переменную loc, чтобы хранить локацию, где находится главный герой. Чтобы перемещаться между локациями, меняем переменную и обновляем список ссылок на доступные объектов (в него входят объекты в текущей локации, кроме скрытых и из локации "всегда присутствующие объекты"). Команда "идти" вычленяет у 1-го объекта флаг перемещения и перемещает игрока в локацию с указанным именем. При этом, если 1-й объект закрыт (для дверей) или не найден соотв. флаг, то перемещение невозможно, о чем и сообщается игроку. Команда "взять" более комплексна (это я для примера разнообразия возможностей усложнил) - если предмет маленький и его можно положить в карман (присутствует флаг "взять"), а на играющем одежда с карманом/ами (флаг "Карман") - предмет перемещается в карман предмета одежды. Если одежи нет или предмет не поместится в карман, но его можно взять в руки (присутствует флаг "Рук"), то если руки не заняты - взять в руки. При этом, объект перемещается в группу соответствующего (пиджака, брюк или рук) вместе со всеми вложениями (например, можно положить матрац на стул, рубашку и галстук на матрац и взять стул в руки - игрок будет нести все в руках; я не сделал ограничения по весу или объему, т. к. предметов мало, но это вполне реально воплотить). Так же можно логически описать и другие команды - смотрите комментарии.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Type</span> element<br />
<p>&nbsp;<span style="color: #aaffff; font-weight: bold;">Field</span> name$,flag$<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Field</span> root.element,prev.element,nxt.element,sub.element<br />
<span style="color: #aaffff; font-weight: bold;">End Type</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Type</span> eref<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Field</span> e.element<br />
<span style="color: #aaffff; font-weight: bold;">End Type</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Type</span> verb<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Field</span> name$,n<span style=" ">&#91;</span><span style="color: #33ffdd;">1</span><span style=" ">&#93;</span>,adverb$<br />
<span style="color: #aaffff; font-weight: bold;">End Type</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Type</span> cmd<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Field</span> e.element, v.verb, typ<br />
<span style="color: #aaffff; font-weight: bold;">End Type</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Const</span> tysiz=<span style="color: #33ffdd;">14</span>,xsiz=<span style="color: #33ffdd;">590</span>,ysiz=<span style="color: #33ffdd;">600</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Global</span> root.element=<span style="color: #aaffff; font-weight: bold;">New</span> element<br />
<span style="color: #aaffff; font-weight: bold;">Global</span> loc.element,hands.element,body.element,all.element,shared.element<br />
<span style="color: #aaffff; font-weight: bold;">Global</span> ty<br />
<br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> try.cmd<span style=" ">&#40;</span><span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>, fcmd.cmd<span style=" ">&#40;</span><span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Graphics</span> <span style="color: #33ffdd;">800</span>,<span style="color: #33ffdd;">600</span><br />
<span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">FrontBuffer</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">SetFont</span> <span style="color: #aaffff; font-weight: bold;">LoadFont</span><span style=" ">&#40;</span><span style="color: #00ff66;">&quot;Arial Cyr&quot;</span>,<span style="color: #33ffdd;">16</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #ffee00">;Загрузка окончаний</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> en$<span style=" ">&#40;</span><span style="color: #33ffdd;">20</span>,<span style="color: #33ffdd;">6</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp;n1=n1<span style="color: #33ffdd;">+1</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Read</span> m$<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> m$=<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Exit</span><br />
&nbsp;q$=<span style="color: #00ff66;">&quot;&quot;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> n2=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">6</span><br />
&nbsp; en$<span style=" ">&#40;</span>n1,n2<span style=" ">&#41;</span>=rustrim$<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span>m$,n2*<span style="color: #33ffdd;">3</span><span style="color: #33ffdd;">-2</span>,<span style="color: #33ffdd;">3</span><span style=" ">&#41;</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Forever</span><br />
<br />
<span style="color: #ffee00">;Загрузка глаголов</span><br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Read</span> m$<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> m$=<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Exit</span><br />
&nbsp;v.verb=<span style="color: #aaffff; font-weight: bold;">New</span> verb<br />
&nbsp;i=<span style="color: #aaffff; font-weight: bold;">Instr</span><span style=" ">&#40;</span>m$,<span style="color: #00ff66;">&quot;#&quot;</span><span style=" ">&#41;</span><br />
&nbsp;v\name$=<span style="color: #aaffff; font-weight: bold;">Left</span>$<span style=" ">&#40;</span>m$,i<span style="color: #33ffdd;">-2</span><span style=" ">&#41;</span><br />
&nbsp;v\n<span style=" ">&#91;</span><span style="color: #33ffdd;">0</span><span style=" ">&#93;</span>=<span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span>m$,i<span style="color: #33ffdd;">+1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #ffee00">;Определение второго глагола (если присутствует)</span><br />
&nbsp;ii=<span style="color: #aaffff; font-weight: bold;">Instr</span><span style=" ">&#40;</span>m$,<span style="color: #00ff66;">&quot;#&quot;</span>,i<span style="color: #33ffdd;">+1</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> ii&gt;<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; v\n<span style=" ">&#91;</span><span style="color: #33ffdd;">1</span><span style=" ">&#93;</span>=<span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span>m$,ii<span style="color: #33ffdd;">+1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
&nbsp; v\adverb$=<span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span>m$,i<span style="color: #33ffdd;">+3</span>,ii-i<span style="color: #33ffdd;">-3</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #ffee00">;Эта строка - для отладки</span><br />
&nbsp;<span style="color: #ffee00">;Print v\name$+&quot; &quot;+v\n[0]+&quot; &quot;+v\adverb$+&quot; &quot;+v\n[1]</span><br />
<span style="color: #aaffff; font-weight: bold;">Forever</span><br />
<span style="color: #ffee00">;WaitKey</span><br />
<br />
<span style="color: #ffee00">;Формирование базы данных</span><br />
e.element=root.element<br />
oldsp=<span style="color: #33ffdd;">-1</span><br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Read</span> m$<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> m$=<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Exit</span><br />
&nbsp;<span style="color: #ffee00">;Определение уровня (в зависимости от пробелов в начале)</span><br />
&nbsp;sp=<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>m$<span style=" ">&#41;</span>-<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>rustrim$<span style=" ">&#40;</span>m$<span style=" ">&#41;</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">While</span> sp&lt;oldsp<br />
&nbsp; e=e\root<br />
&nbsp; oldsp=oldsp<span style="color: #33ffdd;">-1</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> sp&gt;oldsp <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; e=einsertin<span style=" ">&#40;</span>e,<span style="color: #aaffff; font-weight: bold;">Null</span><span style=" ">&#41;</span><br />
&nbsp; oldsp=oldsp<span style="color: #33ffdd;">+1</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; e=einsertafter<span style=" ">&#40;</span>e,<span style="color: #aaffff; font-weight: bold;">Null</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #ffee00">;Флаги</span><br />
&nbsp;i=<span style="color: #aaffff; font-weight: bold;">Instr</span><span style=" ">&#40;</span>m$,<span style="color: #00ff66;">&quot;:&quot;</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> i <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; e\flag$=<span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span>m$,i<span style="color: #33ffdd;">+1</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;,&quot;</span><br />
&nbsp; e\name$=rustrim$<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Left</span>$<span style=" ">&#40;</span>m$,i<span style="color: #33ffdd;">-1</span><span style=" ">&#41;</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; e\name$=rustrim$<span style=" ">&#40;</span>m$<span style=" ">&#41;</span> <br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #ffee00">;Эта строка - для отладки</span><br />
&nbsp;<span style="color: #ffee00">;viewpad e</span><br />
<span style="color: #aaffff; font-weight: bold;">Forever</span><br />
<br />
shared=root\sub<br />
all=<span style="color: #aaffff; font-weight: bold;">After</span> shared<br />
hands=<span style="color: #aaffff; font-weight: bold;">After</span> all<br />
body=<span style="color: #aaffff; font-weight: bold;">After</span> hands<br />
<br />
moveplayer <span style="color: #00ff66;">&quot;комната&quot;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">0</span><br />
tprint <span style="color: #00ff66;">&quot;Переключите клавиатуру на русский регистр и отключите CapsLock.&quot;</span><br />
tprint <span style="color: #00ff66;">&quot;Используйте кл. PgUp и PgDn для выбора подходящего слова.&quot;</span><br />
<br />
look<br />
<br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp;inputphrase<br />
<br />
&nbsp;k=<span style="color: #33ffdd;">-1</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> c.cmd=<span style="color: #aaffff; font-weight: bold;">Each</span> cmd<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> c\e=all <span style="color: #aaffff; font-weight: bold;">Then</span> <br />
&nbsp; &nbsp;<span style="color: #ffee00">;Вставка объектов вместо слова &quot;все&quot;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> r.eref=<span style="color: #aaffff; font-weight: bold;">Each</span> eref<br />
&nbsp; &nbsp; e=r\e<br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> e&lt;&gt;all <span style="color: #aaffff; font-weight: bold;">And</span> e&lt;&gt;hands <span style="color: #aaffff; font-weight: bold;">And</span> e&lt;&gt;body <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp;cc.cmd=<span style="color: #aaffff; font-weight: bold;">New</span> cmd<br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Insert</span> cc <span style="color: #aaffff; font-weight: bold;">After</span> c<br />
&nbsp; &nbsp; &nbsp;cc\e=e<br />
&nbsp; &nbsp; &nbsp;cc\typ=c\typ<br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span> &nbsp; <br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Delete</span> c<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">;Определение первой команды каждого типа</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> k&lt;&gt;c\typ <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; k=c\typ<br />
&nbsp; &nbsp; try<span style=" ">&#40;</span>k<span style=" ">&#41;</span>=c<br />
&nbsp; &nbsp; fcmd<span style=" ">&#40;</span>k<span style=" ">&#41;</span>=c<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
&nbsp;<span style="color: #ffee00">;Разбивка фразы на элементарные</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> try<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>\v\n<span style=" ">&#91;</span><span style="color: #33ffdd;">0</span><span style=" ">&#93;</span>=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; processcmd<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp; &nbsp;processcmd<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> try<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Exit</span><br />
&nbsp; &nbsp;try<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>=<span style="color: #aaffff; font-weight: bold;">After</span> try<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> try<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>=fcmd<span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; try<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>=fcmd<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; try<span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>=<span style="color: #aaffff; font-weight: bold;">After</span> try<span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> try<span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>=fcmd<span style=" ">&#40;</span><span style="color: #33ffdd;">2</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp;try<span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>=fcmd<span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span> &nbsp; &nbsp; <br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> try<span style=" ">&#40;</span><span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Exit</span><br />
&nbsp; &nbsp; &nbsp;try<span style=" ">&#40;</span><span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>=<span style="color: #aaffff; font-weight: bold;">After</span> try<span style=" ">&#40;</span><span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> try<span style=" ">&#40;</span><span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Exit</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span> <br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Forever</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
<span style="color: #aaffff; font-weight: bold;">Forever</span> <br />
<br />
<span style="color: #ffee00">;наборы окончаний для каждого из 6 падежей (по 3 символа)</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;а &nbsp;и &nbsp;е &nbsp;у &nbsp;ой е &nbsp;&quot;</span><span style="color: #ffee00">;01</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;а &nbsp;ы &nbsp;е &nbsp;у &nbsp;ой е &nbsp;&quot;</span><span style="color: #ffee00">;02</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;я &nbsp;и &nbsp;е &nbsp;ю &nbsp;ей е &nbsp;&quot;</span><span style="color: #ffee00">;03</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;о &nbsp;а &nbsp;у &nbsp;о &nbsp;ом е &nbsp;&quot;</span><span style="color: #ffee00">;04</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;ь &nbsp;и &nbsp;и &nbsp;ь &nbsp;ью и &nbsp;&quot;</span><span style="color: #ffee00">;05</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; &nbsp; а &nbsp;у &nbsp; &nbsp; ом е &nbsp;&quot;</span><span style="color: #ffee00">;06</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; &nbsp; а &nbsp;у &nbsp; &nbsp; ем е &nbsp;&quot;</span><span style="color: #ffee00">;07</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;ая ей ей ую ей ей &quot;</span><span style="color: #ffee00">;08</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;ая ой ой ую ой ой &quot;</span><span style="color: #ffee00">;09</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;ь &nbsp;я &nbsp;ю &nbsp;ь &nbsp;ем е &nbsp;&quot;</span><span style="color: #ffee00">;10</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;ый огоомуый ым ом &quot;</span><span style="color: #ffee00">;11</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;ий егоемуий им ем &quot;</span><span style="color: #ffee00">;12</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;и &nbsp; &nbsp; ам и &nbsp;амиах &quot;</span><span style="color: #ffee00">;13</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;е &nbsp;егоемуе &nbsp;ем ем &quot;</span><span style="color: #ffee00">;14</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;ое огоомуое ым ом &quot;</span><span style="color: #ffee00">;15</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;и &nbsp;ов ам и &nbsp;амиах &quot;</span><span style="color: #ffee00">;16</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;&quot;</span><br />
<br />
<span style="color: #ffee00">;глаголы</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;взять #4&quot;</span>,<span style="color: #00ff66;">&quot;брать #4&quot;</span>,<span style="color: #00ff66;">&quot;бросить #4&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;положить #4 на #4&quot;</span>,<span style="color: #00ff66;">&quot;класть #4 на #4&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;повесить #4 на #4&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;идти в #4&quot;</span>,<span style="color: #00ff66;">&quot;идти по #3&quot;</span>,<span style="color: #00ff66;">&quot;прыгнуть в #4&quot;</span>,<span style="color: #00ff66;">&quot;войти в #4&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;открыть #4&quot;</span>,<span style="color: #00ff66;">&quot;закрыть #4&quot;</span>,<span style="color: #00ff66;">&quot;отпереть #4 #5&quot;</span>,<span style="color: #00ff66;">&quot;запереть #4 #5&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;сломать #4 #5&quot;</span>,<span style="color: #00ff66;">&quot;разбить #4 #5&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;одеть #4&quot;</span>,<span style="color: #00ff66;">&quot;надеть #4&quot;</span>,<span style="color: #00ff66;">&quot;снять #4&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;положить #4 в #4&quot;</span>,<span style="color: #00ff66;">&quot;положить #4 под #4&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;осмотреть #4&quot;</span>,<span style="color: #00ff66;">&quot;обследовать #4&quot;</span>,<span style="color: #00ff66;">&quot;осмотреться #0&quot;</span>,<span style="color: #00ff66;">&quot;инвентарь #0&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;бросить #4 в #4&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;резать #4 #5&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;&quot;</span><br />
<br />
<span style="color: #ffee00">;иерархия объектов</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;всегда присутствующие объекты&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; вс#14:С&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; рук#13:М&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; тел#04:С&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; &nbsp;майк#01:Рук,Одеть,Ж,Сух,Рез&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;комнат#02:Ж&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; двер#05:Откр,Ж,&gt;прихожая&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; шкаф#06:Закр,Кл_на,Кл_в&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; &nbsp;дверц#02:Скр,Ж&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; &nbsp;вешалк#01:Скр,Рук,Ж,В,Пов_на&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; &nbsp; пиджак#06:Скр,Рук,Одеть,Вис,Сух,Рез,Карман&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; &nbsp; брюк#13:Скр,Рук,Одеть,Вис,М,Сух,Рез,Карман&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; &nbsp; рубашк#01:Скр,Рук,Одеть,Вис,Ж,Сух,Рез&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; &nbsp;галстук#06:Скр,Рук,Одеть,На,Сух,Рез&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; окн#04:Закр,С&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; &nbsp;стекл#04:Скр,С&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; &nbsp;рам#02:Скр,Ж&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; кроват#05:Кл_на,Ж,Кл_под&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; &nbsp;матрац#06:Скр,Рук,Кл_на,На,Сух,Кл_под,Рез&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; стул#06:Рук,Кл_на,Сух&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;прихож#08:Ж&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; двер#05 комнаты:Откр,Ж,&gt;комната&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; двер#05 ванной:Закр,Ж,&gt;ванная&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; двер#05 туалета:Закр,Ж,&gt;туалет&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; двер#05 кухни:Откр,Ж,&gt;кухня&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; входн#09 двер#05:Закр,Зап,Ж,&gt;лестничная клетка&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; коврик#06:Рук,Кл_на,Кл_под,Сух&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; настенн#09 вешалк#01:Пов_на,Ж&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; &nbsp;ключ:Скр,Вис,Кл_на,Взять&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;ванн#09:Ж&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; двер#05:Откр,Ж,&gt;прихожая&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; ванн#02:Кл_в,Ж&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; &nbsp;красн#11 вентил#10 ванны:Скр,Закр&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; &nbsp;син#12 вентил#10 ванны:Скр,Закр&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; &nbsp;кран#06 ванны:Скр&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; &nbsp;вентил#10 душа:Скр,Откр&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; &nbsp;душ#07:Скр,Пов_на&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; &nbsp;слив#06 ванны:Скр&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; раковин#02:Кл_в,Ж&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; &nbsp;красн#11 вентил#10 раковины:Скр,Закр&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; &nbsp;син#12 вентил#10 раковины:Скр,Закр&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; &nbsp;кран#06 раковины:Скр&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; &nbsp;слив#06 раковины:Скр&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;туалет#06&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; двер#05:Откр,Ж,&gt;прихожая&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; унитаз#06:Кл_в,Вода&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; бач^ок#06:Кл_на&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;кухн#03:Ж&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; двер#05:Откр,&gt;прихожая&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; плит#02:Кл_на,Ж&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; шкафчик#06:Закр,Кл_на&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; окн#04:Закр,С&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; &nbsp;стекл#04:Скр,С&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; &nbsp;рам#02:Скр,Ж&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;лестничн#09 клетк#01:Ж&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; входн#09 двер#05:Откр,Ж,Отп,&gt;прихожая&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; красн#09 двер#05:Зап,Ж&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; черн#09 двер#05:Зап,Ж&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; лестниц#02 вниз:Кл_на,Ж&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot; лестниц#02 наверх:Кл_на,Ж&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;&quot;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> einsertafter.element<span style=" ">&#40;</span>afterwhat.element,what.element<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> what=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span> what=<span style="color: #aaffff; font-weight: bold;">New</span> element <span style="color: #aaffff; font-weight: bold;">Else</span> epush what<br />
what\prev=afterwhat<br />
what\nxt=afterwhat\nxt<br />
<span style="color: #aaffff; font-weight: bold;">If</span> afterwhat\nxt&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">Then</span> afterwhat\nxt\prev=what<br />
afterwhat\nxt=what<br />
what\root=afterwhat\root<br />
<span style="color: #aaffff; font-weight: bold;">Return</span> what<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> einsertbefore.element<span style=" ">&#40;</span>beforewhat.element,what.element<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> what=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span> what=<span style="color: #aaffff; font-weight: bold;">New</span> element <span style="color: #aaffff; font-weight: bold;">Else</span> epush what<br />
what\prev=beforewhat\prev<br />
what\nxt=beforewhat<br />
<span style="color: #aaffff; font-weight: bold;">If</span> beforewhat\prev&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">Then</span> beforewhat\prev\nxt=what<br />
what\root=beforewhat\root<br />
<span style="color: #aaffff; font-weight: bold;">If</span> what\prev=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span> what\root\sub=what<br />
beforewhat\prev=what<br />
<span style="color: #aaffff; font-weight: bold;">Return</span> what<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> einsertin.element<span style=" ">&#40;</span>inwhat.element,what.element<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> what=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span> what=<span style="color: #aaffff; font-weight: bold;">New</span> element <span style="color: #aaffff; font-weight: bold;">Else</span> epush what<br />
what\prev=<span style="color: #aaffff; font-weight: bold;">Null</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> inwhat\sub=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp;what\nxt=<span style="color: #aaffff; font-weight: bold;">Null</span><br />
<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp;what\nxt=inwhat\sub<br />
&nbsp;inwhat\sub\prev=what<br />
<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
inwhat\sub=what<br />
what\root=inwhat<br />
<span style="color: #aaffff; font-weight: bold;">Return</span> what<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> eremove<span style=" ">&#40;</span>what.element,care=<span style="color: #aaffff; font-weight: bold;">True</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> care <span style="color: #aaffff; font-weight: bold;">Then</span> epush what<br />
e.element=what\sub<br />
<span style="color: #aaffff; font-weight: bold;">While</span> e&lt;&gt;Null<br />
&nbsp;e2.element=e<br />
&nbsp;e=e\nxt<br />
&nbsp;eremove e2,<span style="color: #aaffff; font-weight: bold;">False</span><br />
<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<span style="color: #aaffff; font-weight: bold;">Delete</span> what<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> epush<span style=" ">&#40;</span>what.element<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> what\prev&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">Then</span> what\prev\nxt=what\nxt <span style="color: #aaffff; font-weight: bold;">Else</span> what\root\sub=what\nxt<br />
<span style="color: #aaffff; font-weight: bold;">If</span> what\nxt&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">Then</span> what\nxt\prev=what\prev<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Реальное название объекта с заменой ссылок на окончания (с учетом падежа)</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> realname$<span style=" ">&#40;</span>e.element,pad<span style=" ">&#41;</span><br />
m$=e\name$<br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp;i=<span style="color: #aaffff; font-weight: bold;">Instr</span><span style=" ">&#40;</span>m$,<span style="color: #00ff66;">&quot;#&quot;</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> i=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Exit</span><br />
&nbsp;m$=<span style="color: #aaffff; font-weight: bold;">Left</span>$<span style=" ">&#40;</span>m$,i<span style="color: #33ffdd;">-1</span><span style=" ">&#41;</span>+en$<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span>m$,i<span style="color: #33ffdd;">+1</span>,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>,pad<span style=" ">&#41;</span>+<span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span>m$,i<span style="color: #33ffdd;">+3</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Forever</span><br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp;i=<span style="color: #aaffff; font-weight: bold;">Instr</span><span style=" ">&#40;</span>m$,<span style="color: #00ff66;">&quot;^&quot;</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> i=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Exit</span><br />
&nbsp;m$=<span style="color: #aaffff; font-weight: bold;">Left</span>$<span style=" ">&#40;</span>m$,i<span style="color: #33ffdd;">-1</span><span style=" ">&#41;</span>+<span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span>m$,i<span style="color: #33ffdd;">+1</span>+<span style=" ">&#40;</span>pad&gt;<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">And</span> pad&lt;&gt;<span style="color: #33ffdd;">5</span><span style=" ">&#41;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Forever</span><br />
<span style="color: #aaffff; font-weight: bold;">Return</span> m$<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Функция удаления пробелов с краев строки, корректно работающая с русским шрифтом</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> rustrim$<span style=" ">&#40;</span>m$<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>m$<span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span>m$,n,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>&lt;&gt;<span style="color: #00ff66;">&quot; &quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Exit</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
m$=<span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span>m$,n<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>m$<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">Step</span> <span style="color: #33ffdd;">-1</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span>m$,n,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>&lt;&gt;<span style="color: #00ff66;">&quot; &quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Exit</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Return</span> <span style="color: #aaffff; font-weight: bold;">Left</span>$<span style=" ">&#40;</span>m$,n<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Корректное перемещение в локацию</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> moveplayer<span style=" ">&#40;</span>lname$<span style=" ">&#41;</span><br />
e.element=root\sub<br />
<span style="color: #ffee00">;Поиск локации по названию</span><br />
<span style="color: #aaffff; font-weight: bold;">While</span> e&lt;&gt;Null<br />
&nbsp;m$=realname$<span style=" ">&#40;</span>e,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> m$=lname$ <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Exit</span><br />
&nbsp;e=e\nxt<br />
<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> e=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Stop</span><br />
<span style="color: #ffee00">;Формирование списка доступных объектов</span><br />
<span style="color: #aaffff; font-weight: bold;">Delete</span> <span style="color: #aaffff; font-weight: bold;">Each</span> eref<br />
<span style="color: #ffee00">;Добавление всегда присутствующих объектов</span><br />
addbranch shared<br />
<span style="color: #ffee00">;Добавление всегда объектов локации</span><br />
addbranch e<br />
loc=e<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Вспомогательная функция для занесения объектов в список доступных</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> addbranch<span style=" ">&#40;</span>what.element<span style=" ">&#41;</span><br />
e.element=what\sub<br />
<span style="color: #aaffff; font-weight: bold;">While</span> e&lt;&gt;Null<br />
&nbsp;<span style="color: #ffee00">;Скрытые объекты не заносятся</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>e,<span style="color: #00ff66;">&quot;Скр&quot;</span><span style=" ">&#41;</span>=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; r.eref=<span style="color: #aaffff; font-weight: bold;">New</span> eref<br />
&nbsp; r\e=e<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;e=nextobj<span style=" ">&#40;</span>what,e<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Просмотр названия объекта в разных падежах</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> viewpad<span style=" ">&#40;</span>e.element<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Cls</span><br />
<span style="color: #ffee00">;Просмотр названия объекта во всех падежах (отладка)</span><br />
<span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,realname$<span style=" ">&#40;</span>e,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">15</span>,<span style="color: #00ff66;">&quot;нет &quot;</span>+realname$<span style=" ">&#40;</span>e,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">30</span>,<span style="color: #00ff66;">&quot;дать &quot;</span>+realname$<span style=" ">&#40;</span>e,<span style="color: #33ffdd;">3</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">45</span>,<span style="color: #00ff66;">&quot;винить &quot;</span>+realname$<span style=" ">&#40;</span>e,<span style="color: #33ffdd;">4</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">60</span>,<span style="color: #00ff66;">&quot;творить &quot;</span>+realname$<span style=" ">&#40;</span>e,<span style="color: #33ffdd;">5</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">75</span>,<span style="color: #00ff66;">&quot;говорить о &quot;</span>+realname$<span style=" ">&#40;</span>e,<span style="color: #33ffdd;">6</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">WaitKey</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Функция ввода фразы</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> inputphrase$<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Очистка списка составляющих команды</span><br />
<span style="color: #aaffff; font-weight: bold;">Delete</span> <span style="color: #aaffff; font-weight: bold;">Each</span> cmd<br />
cur.cmd=<span style="color: #aaffff; font-weight: bold;">New</span> cmd<br />
fc.cmd=cur<br />
<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span><br />
<span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #33ffdd;">0</span>,ty,<span style="color: #00ff66;">&quot;|&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp;i=<span style="color: #aaffff; font-weight: bold;">WaitKey</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Select</span> i<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">8</span><span style="color: #ffee00">;Backspace</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> part$&lt;&gt;<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; part$=<span style="color: #aaffff; font-weight: bold;">Left</span>$<span style=" ">&#40;</span>part$,<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>part$<span style=" ">&#41;</span><span style="color: #33ffdd;">-1</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> fc&lt;&gt; cur <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp;cur=<span style="color: #aaffff; font-weight: bold;">Before</span> cur<br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Delete</span> <span style="color: #aaffff; font-weight: bold;">Last</span> cmd<br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">27</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">44</span>, <span style="color: #33ffdd;">32</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">;Проверка на возможность ввода 1-го и 2-го объектов</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> fc\v\n<span style=" ">&#91;</span><span style="color: #33ffdd;">0</span><span style=" ">&#93;</span>&gt;<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Or</span> i=<span style="color: #33ffdd;">44</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> cur\typ&lt;<span style="color: #33ffdd;">2</span>-<span style=" ">&#40;</span>fc\v\n<span style=" ">&#91;</span><span style="color: #33ffdd;">1</span><span style=" ">&#93;</span>=<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Or</span> i=<span style="color: #33ffdd;">44</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #ffee00">;Если найдено подходящее слово - создаем новый элемент команды</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> fnd <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp; t=cur\typ<br />
&nbsp; &nbsp; &nbsp; cur=<span style="color: #aaffff; font-weight: bold;">New</span> cmd<br />
&nbsp; &nbsp; &nbsp; fnd=<span style="color: #33ffdd;">0</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #ffee00">;Если введена запятая, а не пробел, то следующий объект будет такого же типа</span><br />
&nbsp; &nbsp; &nbsp;cur\typ=t+<span style=" ">&#40;</span>i=<span style="color: #33ffdd;">32</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp;part$=<span style="color: #00ff66;">&quot;&quot;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #ffee00">;Проверка на возможность ввода фразы</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">13</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> cur\e=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span> i=<span style="color: #33ffdd;">0</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> fc&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">If</span> fc\v&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">If</span> fc\v\n<span style=" ">&#91;</span><span style="color: #33ffdd;">0</span><span style=" ">&#93;</span>=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span> i=<span style="color: #33ffdd;">13</span><br />
&nbsp; <span style="color: #ffee00">;Изменение номера подходящего объекта</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">5</span><br />
&nbsp; &nbsp;q=q<span style="color: #33ffdd;">+1</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">6</span><br />
&nbsp; &nbsp;q=q<span style="color: #33ffdd;">-1</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Default</span><br />
&nbsp; &nbsp;part$=part$+<span style="color: #aaffff; font-weight: bold;">Chr</span>$<span style=" ">&#40;</span>i<span style=" ">&#41;</span> &nbsp;<br />
&nbsp; &nbsp;q=<span style="color: #33ffdd;">1</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">End Select</span><br />
<br />
&nbsp;pl=<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>part$<span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> part$&lt;&gt;<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; n=<span style="color: #33ffdd;">0</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> cur\typ=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">;Поиск подходящего глагола (тип 0)</span><br />
&nbsp; &nbsp;fv.verb=<span style="color: #aaffff; font-weight: bold;">Null</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> v.verb=<span style="color: #aaffff; font-weight: bold;">Each</span> verb <br />
&nbsp; &nbsp; <span style="color: #ffee00">;Проверка на совпадение введенной части с началом глагола</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span>v\name$,<span style="color: #33ffdd;">1</span>,pl<span style=" ">&#41;</span>=part$ <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #ffee00">;Проверка на совпадение формы (для дополнительных глаголов)</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> fc=cur <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp; k=<span style="color: #33ffdd;">1</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">ElseIf</span> v\n<span style=" ">&#91;</span><span style="color: #33ffdd;">0</span><span style=" ">&#93;</span>=fc\v\n<span style=" ">&#91;</span><span style="color: #33ffdd;">0</span><span style=" ">&#93;</span> <span style="color: #aaffff; font-weight: bold;">And</span> v\n<span style=" ">&#91;</span><span style="color: #33ffdd;">1</span><span style=" ">&#93;</span>=fc\v\n<span style=" ">&#91;</span><span style="color: #33ffdd;">1</span><span style=" ">&#93;</span> <span style="color: #aaffff; font-weight: bold;">And</span> v\adverb$=fc\v\adverb$ <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp; k=<span style="color: #33ffdd;">1</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp; &nbsp; k=<span style="color: #33ffdd;">0</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> k <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp; n=n<span style="color: #33ffdd;">+1</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffee00">;Определение первого или последнего найденного объекта (в зависимости от</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffee00">; целей</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">Or</span> q=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span> fv=v<br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffee00">;При встрече q-го объекта - выход (объект найден)</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> q=n <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Exit</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">;Если объекта с таким номером (q) нет, значит либо это последний объект</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">; (перескок с 1-го, q=1-1=0) либо первый (с последнего)</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> fv&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">And</span> v=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; v=fv<br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> q=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span> q=n <span style="color: #aaffff; font-weight: bold;">Else</span> q=<span style="color: #33ffdd;">1</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> v&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">Then</span> fnd=<span style="color: #33ffdd;">1</span><br />
&nbsp; &nbsp;cur\v=v<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">;Аналогичный поиск 1-го или 2-го объекта по названию</span><br />
&nbsp; &nbsp;fr.eref=<span style="color: #aaffff; font-weight: bold;">Null</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> r.eref=<span style="color: #aaffff; font-weight: bold;">Each</span> eref<br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span>r\e\name$,<span style="color: #33ffdd;">1</span>,pl<span style=" ">&#41;</span>=part$ <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp;n=n<span style="color: #33ffdd;">+1</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">Or</span> q=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span> fr=r<br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> q=n <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Exit</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> fr&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">And</span> r=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; r=fr<br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> q=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span> q=n <span style="color: #aaffff; font-weight: bold;">Else</span> q=<span style="color: #33ffdd;">1</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> r&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; fnd=<span style="color: #33ffdd;">1</span><br />
&nbsp; &nbsp; cur\e=r\e<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp; cur\e=<span style="color: #aaffff; font-weight: bold;">Null</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
<br />
&nbsp;m$=<span style="color: #00ff66;">&quot;&quot;</span><br />
&nbsp;<span style="color: #ffee00">;Отображение команды на экране</span><br />
&nbsp;<span style="color: #ffee00">;Очистка полосы</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Rect</span> <span style="color: #33ffdd;">0</span>,ty,<span style="color: #33ffdd;">800</span>,tysiz*<span style="color: #33ffdd;">2</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> c.cmd=<span style="color: #aaffff; font-weight: bold;">Each</span> cmd<br />
&nbsp; <span style="color: #ffee00">;Печать пробела (между командами разных типов) или запятой</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> c&lt;&gt;fc <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> c\typ=oldtyp <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; m$=m$+<span style="color: #00ff66;">&quot;, &quot;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp; m$=m$+<span style="color: #00ff66;">&quot; &quot;</span> &nbsp; &nbsp;<br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> c\typ=<span style="color: #33ffdd;">2</span> <span style="color: #aaffff; font-weight: bold;">Then</span> m$=m$+fc\v\adverb$<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; oldtyp=c\typ<br />
&nbsp; <span style="color: #ffee00">;Печать последнего (вводимого) слова</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> c=cur <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">;Если слово не удалось подобрать - печать красным, выход</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> c\e=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">And</span> c\v=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #33ffdd;">0</span>,ty,m$<br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
&nbsp; &nbsp; pl=<span style="color: #aaffff; font-weight: bold;">StringWidth</span><span style=" ">&#40;</span>m$<span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Text</span> pl,ty,part$+<span style="color: #00ff66;">&quot;|&quot;</span><br />
&nbsp; &nbsp; m$=<span style="color: #00ff66;">&quot;&quot;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Exit</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">;Печать предыдущих слов и введенной части белым</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> i&lt;&gt;<span style="color: #33ffdd;">13</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; pl=<span style="color: #aaffff; font-weight: bold;">StringWidth</span><span style=" ">&#40;</span>m$+part$<span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #33ffdd;">0</span>,ty,m$+part$<br />
&nbsp; &nbsp; m$=<span style="color: #00ff66;">&quot;&quot;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #ffee00">;Добавление в фразу последнего слова</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> c\typ=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;m$=m$+c\v\name$<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp;m$=m$+realname$<span style=" ">&#40;</span>c\e,fc\v\n<span style=" ">&#91;</span>c\typ<span style="color: #33ffdd;">-1</span><span style=" ">&#93;</span><span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> i=<span style="color: #33ffdd;">13</span> <span style="color: #aaffff; font-weight: bold;">And</span> c=cur <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;tprint m$<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Return</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #ffee00">;Добавление предлога в скобках (если вводится глагол с предлогом)</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> cur\typ=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">And</span> fc\v&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">Then</span> <br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> fc\v\adverb$&lt;&gt;<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> m$=m$+<span style="color: #00ff66;">&quot; (&quot;</span>+rustrim$<span style=" ">&#40;</span>fc\v\adverb$<span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;)&quot;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
<br />
&nbsp;<span style="color: #ffee00">;Печать зеленым оставшейся части &quot;предсказанного&quot; слова</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">0</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> m$&lt;&gt;<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Text</span> pl,ty,<span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span>m$,<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>part$<span style=" ">&#41;</span><span style="color: #33ffdd;">+1</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;|&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Forever</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Процедура обработки элементарных команд</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> processcmd<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">0</span><br />
v.verb=try<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>\v<br />
verb$=v\name$<br />
adv$=v\adverb$<br />
<span style="color: #aaffff; font-weight: bold;">If</span> try<span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp;n1.element=try<span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>\e<br />
&nbsp;n1n$=realname$<span style=" ">&#40;</span>n1,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> try<span style=" ">&#40;</span><span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp;n2.element=try<span style=" ">&#40;</span><span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>\e<br />
&nbsp;n2n$=realname$<span style=" ">&#40;</span>n2,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
<span style="color: #aaffff; font-weight: bold;">Select</span> verb$<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;взять&quot;</span>,<span style="color: #00ff66;">&quot;брать&quot;</span><br />
&nbsp; k=flag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;Взять&quot;</span><span style=" ">&#41;</span><br />
&nbsp; n2=findobjwithflag<span style=" ">&#40;</span>body,<span style="color: #00ff66;">&quot;Карман&quot;</span><span style=" ">&#41;</span><br />
&nbsp; <span style="color: #ffee00">;Если одет объект с карманом и предмет достаточно мал - положить его в карман</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> n2&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">And</span> k <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;moveobj n2,n1,<span style="color: #00ff66;">&quot;В&quot;</span><br />
&nbsp; &nbsp;m$=m$+<span style="color: #00ff66;">&quot;Вы положили &quot;</span>+realname$<span style=" ">&#40;</span>n1,<span style="color: #33ffdd;">4</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot; в &quot;</span>+realname$<span style=" ">&#40;</span>n2,<span style="color: #33ffdd;">4</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;.&quot;</span><br />
&nbsp; <span style="color: #ffee00">;Если предмет можно взять в руки и в руках ничего нет, взять его в руки</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">ElseIf</span> k <span style="color: #aaffff; font-weight: bold;">Or</span> flag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;Рук&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> hands\sub=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; moveobj hands,n1<br />
&nbsp; &nbsp; m$=<span style="color: #00ff66;">&quot;Теперь у вас в руках &quot;</span>+n1n$<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp; m2$=<span style="color: #00ff66;">&quot;У вас заняты руки.&quot;</span><br />
&nbsp; &nbsp; n2=<span style="color: #aaffff; font-weight: bold;">Null</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;положить&quot;</span>,<span style="color: #00ff66;">&quot;бросить&quot;</span>,<span style="color: #00ff66;">&quot;класть&quot;</span><br />
&nbsp; <span style="color: #ffee00">;Если предмет в инвентаре, то ...</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> findobj<span style=" ">&#40;</span>body,n1n$<span style=" ">&#41;</span>&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">Or</span> findobj<span style=" ">&#40;</span>hands,n1n$<span style=" ">&#41;</span>&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">;Задаются флаги местоположения (в случае, если предмет может быть помещен</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">; таким образом)</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> n2&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> adv$=<span style="color: #00ff66;">&quot;на &quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>n2,<span style="color: #00ff66;">&quot;Кл_на&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> m2$=<span style="color: #00ff66;">&quot;На&quot;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> adv$=<span style="color: #00ff66;">&quot;в &quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>n2,<span style="color: #00ff66;">&quot;Кл_в&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> m2$=<span style="color: #00ff66;">&quot;В&quot;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> adv$=<span style="color: #00ff66;">&quot;под &quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>n2,<span style="color: #00ff66;">&quot;Кл_под&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> m2$=<span style="color: #00ff66;">&quot;Под&quot;</span><br />
&nbsp; &nbsp; <span style="color: #ffee00">;Устранение ситуаций типа &quot;матрас на стуле, стул на матрасе&quot;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> m2$&lt;&gt;<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp;e.element=n2<br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">While</span> e&lt;&gt;Null<br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> e=n1 <span style="color: #aaffff; font-weight: bold;">Then</span> m2$=<span style="color: #00ff66;">&quot;&quot;</span>:<span style="color: #aaffff; font-weight: bold;">Exit</span><br />
&nbsp; &nbsp; &nbsp; e=e\root<br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> m2$&lt;&gt;<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <br />
&nbsp; &nbsp; &nbsp; moveobj n2,n1,m2$<br />
&nbsp; &nbsp; &nbsp; m$=<span style="color: #00ff66;">&quot;Вы избавились от &quot;</span>+realname$<span style=" ">&#40;</span>n1,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> m2$=<span style="color: #00ff66;">&quot;В&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> water<br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp; <span style="color: #ffee00">;Предмет помещается в текущую локацию</span><br />
&nbsp; &nbsp; moveobj loc,n1<br />
&nbsp; &nbsp; m$=<span style="color: #00ff66;">&quot;Вы избавились от &quot;</span>+realname$<span style=" ">&#40;</span>n1,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">;Объект, брошеный в открытое / разбитое окно уничтожается</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> adv$=<span style="color: #00ff66;">&quot;в &quot;</span> <span style="color: #aaffff; font-weight: bold;">And</span> n2n$=<span style="color: #00ff66;">&quot;окно&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>n2,<span style="color: #00ff66;">&quot;Разб&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Or</span> flag<span style=" ">&#40;</span>n2,<span style="color: #00ff66;">&quot;Откр&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp;tprint <span style="color: #00ff66;">&quot;Вы выбросили &quot;</span>+realname$<span style=" ">&#40;</span>n1,<span style="color: #33ffdd;">4</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot; в окно.&quot;</span><br />
&nbsp; &nbsp; &nbsp;eremove n1<br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Return</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp; &nbsp;moveobj loc,n1<br />
&nbsp; &nbsp; &nbsp;m$=cap$<span style=" ">&#40;</span>n1n$<span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot; отскочил&quot;</span>+vend$<span style=" ">&#40;</span>n1<span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot; от стекла и упал&quot;</span>+vend$<span style=" ">&#40;</span>n1<span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot; на пол.&quot;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp;m2$=<span style="color: #00ff66;">&quot;У вас нет &quot;</span>+realname$<span style=" ">&#40;</span>n1,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;повесить&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;М_вис&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">And</span> flag<span style=" ">&#40;</span>n2,<span style="color: #00ff66;">&quot;Пов_на&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;remflag n1,<span style="color: #00ff66;">&quot;Вис&quot;</span><br />
&nbsp; &nbsp;moveobj n1,n2,<span style="color: #00ff66;">&quot;Вис&quot;</span><br />
&nbsp; &nbsp;m$=<span style="color: #00ff66;">&quot;Вы повесили &quot;</span>+realname$<span style=" ">&#40;</span>n1,<span style="color: #33ffdd;">4</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot; на &quot;</span>+realname$<span style=" ">&#40;</span>n2,<span style="color: #33ffdd;">4</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;.&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;идти по&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">Left</span>$<span style=" ">&#40;</span>n1n$,<span style="color: #33ffdd;">8</span><span style=" ">&#41;</span>=<span style="color: #00ff66;">&quot;лестница&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;tprint <span style="color: #00ff66;">&quot;Вы пошли по лестнице. Вот идете Вы, идете, а ступеньки вдруг возьми, &quot;</span><br />
&nbsp; &nbsp;tprint <span style="color: #00ff66;">&quot; да обвались. И полетели Вы вниз, в пустоту недоделанного уровня... The End.&quot;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">WaitKey</span>:<span style="color: #aaffff; font-weight: bold;">End</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;идти в&quot;</span>,<span style="color: #00ff66;">&quot;прыгнуть в&quot;</span>,<span style="color: #00ff66;">&quot;войти в&quot;</span><br />
&nbsp; k=<span style="color: #aaffff; font-weight: bold;">Instr</span><span style=" ">&#40;</span>n1\flag$,<span style="color: #00ff66;">&quot;&gt;&quot;</span><span style=" ">&#41;</span><br />
&nbsp; <span style="color: #ffee00">;Обработка прыжка в окно</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> n1n$=<span style="color: #00ff66;">&quot;окно&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;k2=flag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;Разб&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Or</span> flag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;Откр&quot;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> k2=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">And</span> verb$=<span style="color: #00ff66;">&quot;прыгнуть в&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; m$=<span style="color: #00ff66;">&quot;Своим телом Вы разбили стекло и ужасно порезались.&quot;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> k2 <span style="color: #aaffff; font-weight: bold;">Or</span> m$&lt;&gt;<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; tprint <span style="color: #00ff66;">&quot;Вы выпрыгнули в окно.&quot;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> m$&lt;&gt;<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> tprint m$<br />
&nbsp; &nbsp; tprint <span style="color: #00ff66;">&quot;С дикими воплями, размахивая руками Вы летели вниз, пока не шмякнулись&quot;</span><br />
&nbsp; &nbsp; tprint <span style="color: #00ff66;">&quot; о поверхность, испещренную надписями 'Under Construction'. The End.&quot;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">WaitKey</span>: <span style="color: #aaffff; font-weight: bold;">End</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #ffee00">;Переход в другую локацию</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> k <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;Закр&quot;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; m2$=<span style="color: #00ff66;">&quot;Закрыто.&quot;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp; tprint <span style="color: #00ff66;">&quot;ОК.&quot;</span><br />
&nbsp; &nbsp; <span style="color: #ffee00">;Вычленяется имя локации и осуществляется переход в нее</span><br />
&nbsp; &nbsp; k2=<span style="color: #aaffff; font-weight: bold;">Instr</span><span style=" ">&#40;</span>n1\flag$,<span style="color: #00ff66;">&quot;,&quot;</span>,k<span style=" ">&#41;</span><br />
&nbsp; &nbsp; moveplayer <span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span>n1\flag$,k<span style="color: #33ffdd;">+1</span>,k2-k<span style="color: #33ffdd;">-1</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffee00">;Перейдя, осматриваемся</span><br />
&nbsp; &nbsp; look<br />
&nbsp; &nbsp; <span style="color: #ffee00">;Остальные команды игнорируются (т. к. могут оказаться некорректными)</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Delete</span> <span style="color: #aaffff; font-weight: bold;">Each</span> cmd<br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Return</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;открыть&quot;</span><br />
&nbsp; <span style="color: #ffee00">;Если объект закрыт ...</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;Закр&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">;И не заперт...</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;Зап&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; m2$=<span style="color: #00ff66;">&quot;Заперто.&quot;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp; <span style="color: #ffee00">;То поменять флаг</span><br />
&nbsp; &nbsp; m$=<span style="color: #00ff66;">&quot;Вы открыли &quot;</span>+realname$<span style=" ">&#40;</span>n1,<span style="color: #33ffdd;">4</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;.&quot;</span><br />
&nbsp; &nbsp; remflag n1,<span style="color: #00ff66;">&quot;Закр&quot;</span><br />
&nbsp; &nbsp; addflag n1,<span style="color: #00ff66;">&quot;Откр&quot;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #ffee00">;Изменение наполненности водой</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">Instr</span><span style=" ">&#40;</span>n1n$,<span style="color: #00ff66;">&quot;ванны&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> n1=findobj<span style=" ">&#40;</span>root,<span style="color: #00ff66;">&quot;ванна&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Else</span> n1=findobj<span style=" ">&#40;</span>root,<span style="color: #00ff66;">&quot;раковина&quot;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;Вода&quot;</span><span style=" ">&#41;</span>=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span> addflag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;Вода&quot;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; water<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">;Иначе, если он открыт (то есть, вообще открывается) ...</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">ElseIf</span> flag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;Откр&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;m$=cap$<span style=" ">&#40;</span>n1n$<span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot; уже открыт&quot;</span>+vend$<span style=" ">&#40;</span>n1<span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;.&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;закрыть&quot;</span><br />
&nbsp; <span style="color: #ffee00">;Аналогично</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;Закр&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;m$=cap$<span style=" ">&#40;</span>n1n$<span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot; уже закрыт&quot;</span>+vend$<span style=" ">&#40;</span>n1<span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;.&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">ElseIf</span> flag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;Откр&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;m$=<span style="color: #00ff66;">&quot;Вы закрыли &quot;</span>+n1n$<br />
&nbsp; &nbsp;addflag n1,<span style="color: #00ff66;">&quot;Закр&quot;</span><br />
&nbsp; &nbsp;remflag n1,<span style="color: #00ff66;">&quot;Откр&quot;</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">;Изменение наполненности водой</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">Instr</span><span style=" ">&#40;</span>n1n$,<span style="color: #00ff66;">&quot;ванны&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>findobj<span style=" ">&#40;</span>loc,<span style="color: #00ff66;">&quot;красный вентиль ванны&quot;</span><span style=" ">&#41;</span>,<span style="color: #00ff66;">&quot;Закр&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>findobj<span style=" ">&#40;</span>loc,<span style="color: #00ff66;">&quot;синий вентиль ванны&quot;</span><span style=" ">&#41;</span>,<span style="color: #00ff66;">&quot;Закр&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp; remflag findobj<span style=" ">&#40;</span>loc,<span style="color: #00ff66;">&quot;ванна&quot;</span><span style=" ">&#41;</span>,<span style="color: #00ff66;">&quot;Вода&quot;</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>findobj<span style=" ">&#40;</span>loc,<span style="color: #00ff66;">&quot;красный вентиль раковины&quot;</span><span style=" ">&#41;</span>,<span style="color: #00ff66;">&quot;Закр&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>findobj<span style=" ">&#40;</span>loc,<span style="color: #00ff66;">&quot;синий вентиль раковины&quot;</span><span style=" ">&#41;</span>,<span style="color: #00ff66;">&quot;Закр&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <br />
&nbsp; &nbsp; &nbsp; remflag findobj<span style=" ">&#40;</span>loc,<span style="color: #00ff66;">&quot;раковина&quot;</span><span style=" ">&#41;</span>,<span style="color: #00ff66;">&quot;Вода&quot;</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;сломать&quot;</span>,<span style="color: #00ff66;">&quot;разбить&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;Разб&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;m2$=cap$<span style=" ">&#40;</span>n1n$<span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;Уже разбит&quot;</span>+vend$<span style=" ">&#40;</span>n2<span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;.&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">ElseIf</span> n1n$=<span style="color: #00ff66;">&quot;стекло&quot;</span> <span style="color: #aaffff; font-weight: bold;">Or</span> n1n$=<span style="color: #00ff66;">&quot;окно&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">;Предмет можно разбить только кулаком или стулом</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> n2n$=<span style="color: #00ff66;">&quot;стул&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; m$=<span style="color: #00ff66;">&quot;Вы разбили окно стулом.&quot;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">ElseIf</span> n2=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; m$=<span style="color: #00ff66;">&quot;Вы разбили окно кулаком, но при этом сильно порезались.&quot;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp; m2$=cap$<span style=" ">&#40;</span>n2n$<span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot; отскочил&quot;</span>+vend$<span style=" ">&#40;</span>n2<span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot; от стекла.&quot;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">;Добавляем новый объект - осколки стекла</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> m$&lt;&gt;<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; n2=einsertin<span style=" ">&#40;</span>loc,<span style="color: #aaffff; font-weight: bold;">Null</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; n2\name$=<span style="color: #00ff66;">&quot;осколк#13 стекла&quot;</span><br />
&nbsp; &nbsp; n2\flag$=<span style="color: #00ff66;">&quot;Взять,М,Остр&quot;</span><br />
&nbsp; &nbsp; r.eref=<span style="color: #aaffff; font-weight: bold;">New</span> eref<br />
&nbsp; &nbsp; r\e=n2<br />
&nbsp; &nbsp; <span style="color: #ffee00">;Вне зависимости от того, что били, разбиваем и окно и стекло</span><br />
&nbsp; &nbsp; addflag findobj<span style=" ">&#40;</span>loc,<span style="color: #00ff66;">&quot;стекло&quot;</span><span style=" ">&#41;</span>,<span style="color: #00ff66;">&quot;Разб&quot;</span><br />
&nbsp; &nbsp; addflag findobj<span style=" ">&#40;</span>loc,<span style="color: #00ff66;">&quot;окно&quot;</span><span style=" ">&#41;</span>,<span style="color: #00ff66;">&quot;Разб&quot;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span> &nbsp;<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;одеть&quot;</span>,<span style="color: #00ff66;">&quot;надеть&quot;</span><br />
&nbsp; <span style="color: #ffee00">;Является ли объект одеждой?</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;Одеть&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <br />
&nbsp; &nbsp;<span style="color: #ffee00">;Находится ли он в руках</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> hands\sub=n1 <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; einsertin body,n1<br />
&nbsp; &nbsp; m$=<span style="color: #00ff66;">&quot;На вас теперь &quot;</span>+n1n$+<span style="color: #00ff66;">&quot;.&quot;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp; m2$=cap$<span style=" ">&#40;</span>realname$<span style=" ">&#40;</span>n1,<span style="color: #33ffdd;">4</span><span style=" ">&#41;</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot; нужно сначала взять в руки.&quot;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;снять&quot;</span><br />
&nbsp; <span style="color: #ffee00">;Аналогично</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> hands=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;m2$=<span style="color: #00ff66;">&quot;У вас заняты руки.&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">ElseIf</span> existin<span style=" ">&#40;</span>body,n1n$<span style=" ">&#41;</span><br />
&nbsp; &nbsp;einsertin hands,n1<br />
&nbsp; &nbsp;m$=<span style="color: #00ff66;">&quot;Вы сняли &quot;</span>+n1n$+<span style="color: #00ff66;">&quot;.&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp;m$=<span style="color: #00ff66;">&quot;У вас нет &quot;</span>+realname$<span style=" ">&#40;</span>n1,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;.&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;отпереть&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;Зап&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">And</span> n2n$=<span style="color: #00ff66;">&quot;ключ&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> n2n$=<span style="color: #00ff66;">&quot;ключ&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; m$=<span style="color: #00ff66;">&quot;Вы отперли &quot;</span>+realname$<span style=" ">&#40;</span>n1,<span style="color: #33ffdd;">4</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;.&quot;</span><br />
&nbsp; &nbsp; remflag n1,<span style="color: #00ff66;">&quot;Зап&quot;</span><br />
&nbsp; &nbsp; addflag n1,<span style="color: #00ff66;">&quot;Отп&quot;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">ElseIf</span> flag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;Отп&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;m$=cap$<span style=" ">&#40;</span>n1n$<span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot; уже отперт&quot;</span>+vend$<span style=" ">&#40;</span>n1<span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;.&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;запереть&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;Отп&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> n2n$=<span style="color: #00ff66;">&quot;ключ&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; m$=<span style="color: #00ff66;">&quot;Вы заперли &quot;</span>+realname$<span style=" ">&#40;</span>n1,<span style="color: #33ffdd;">4</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;.&quot;</span><br />
&nbsp; &nbsp; remflag n1,<span style="color: #00ff66;">&quot;Отп&quot;</span><br />
&nbsp; &nbsp; addflag n1,<span style="color: #00ff66;">&quot;Зап&quot;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">ElseIf</span> flag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;Зап&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;m$=cap$<span style=" ">&#40;</span>n1n$<span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot; уже заперт&quot;</span>+vend$<span style=" ">&#40;</span>n1<span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;.&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;осмотреть&quot;</span>,<span style="color: #00ff66;">&quot;обследовать&quot;</span><br />
&nbsp; e.element=n1\sub<br />
&nbsp; <span style="color: #ffee00">;Цикл по всем объектам в группе обследуемого</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">While</span> e&lt;&gt;Null<br />
&nbsp; &nbsp;m2$=realname$<span style=" ">&#40;</span>e,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">;Вывод информации в зависимости от положения</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>e,<span style="color: #00ff66;">&quot;На&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; m$=m$+<span style="color: #00ff66;">&quot;наверху - &quot;</span>+m2$+<span style="color: #00ff66;">&quot;, &quot;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">ElseIf</span> flag<span style=" ">&#40;</span>e,<span style="color: #00ff66;">&quot;Под&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; m$=m$+<span style="color: #00ff66;">&quot;под ним - &quot;</span>+m2$+<span style="color: #00ff66;">&quot;, &quot;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">ElseIf</span> flag<span style=" ">&#40;</span>e,<span style="color: #00ff66;">&quot;В&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;Закр&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <br />
&nbsp; &nbsp; &nbsp;m2$=<span style="color: #00ff66;">&quot;&quot;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp; &nbsp;m$=m$+<span style="color: #00ff66;">&quot;внутри - &quot;</span>+m2$+<span style="color: #00ff66;">&quot;, &quot;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">ElseIf</span> flag<span style=" ">&#40;</span>e,<span style="color: #00ff66;">&quot;Вис&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp;m$=m$+<span style="color: #00ff66;">&quot;висит &quot;</span>+m2$+<span style="color: #00ff66;">&quot;, &quot;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp; m$=m$+<span style="color: #00ff66;">&quot;есть &quot;</span>+m2$+<span style="color: #00ff66;">&quot;, &quot;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">;Скрытые объекты становятся видимыми</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> m2$&lt;&gt;<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>e,<span style="color: #00ff66;">&quot;Скр&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp;r.eref=<span style="color: #aaffff; font-weight: bold;">New</span> eref<br />
&nbsp; &nbsp; &nbsp;r\e=e<br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp; remflag <span style=" ">&#40;</span>e,<span style="color: #00ff66;">&quot;Скр&quot;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp;e=e\nxt<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<br />
&nbsp; m2$=<span style="color: #00ff66;">&quot;&quot;</span><br />
&nbsp; <span style="color: #ffee00">;Информация о состоянии объекта</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;Откр&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> m2$=m2$+<span style="color: #00ff66;">&quot;, открыт&quot;</span>+vend$<span style=" ">&#40;</span>n1<span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;Закр&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> m2$=m2$+<span style="color: #00ff66;">&quot;, закрыт&quot;</span>+vend$<span style=" ">&#40;</span>n1<span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;Зап&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> m2$=m2$+<span style="color: #00ff66;">&quot;, заперт&quot;</span>+vend$<span style=" ">&#40;</span>n1<span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;Разб&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> m2$=m2$+<span style="color: #00ff66;">&quot;, разбит&quot;</span>+vend$<span style=" ">&#40;</span>n1<span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;Мокр&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> m2$=m2$+<span style="color: #00ff66;">&quot;, пропитан&quot;</span>+vend$<span style=" ">&#40;</span>n1<span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot; водой&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;Вода&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> m2$=m2$+<span style="color: #00ff66;">&quot;, наполнен&quot;</span>+vend$<span style=" ">&#40;</span>n1<span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot; водой&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> m$&lt;&gt;<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Or</span> m2$&lt;&gt;<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> m$&lt;&gt;<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> m$=<span style="color: #00ff66;">&quot;: &quot;</span>+<span style="color: #aaffff; font-weight: bold;">Left</span>$<span style=" ">&#40;</span>m$,<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>m$<span style=" ">&#41;</span><span style="color: #33ffdd;">-2</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> m2$&lt;&gt;<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> m$=<span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span>m2$,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>+m$<br />
&nbsp; &nbsp;m$=cap$<span style=" ">&#40;</span>n1n$<span style=" ">&#41;</span>+m$+<span style="color: #00ff66;">&quot;.&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
<br />
&nbsp; m2$=<span style="color: #00ff66;">&quot;&quot;</span><br />
&nbsp; <span style="color: #ffee00">;Если вентиль душа открыт - вода будет течь из крана ванной, иначе - из крана душа</span><br />
&nbsp; k=flag<span style=" ">&#40;</span>findobj<span style=" ">&#40;</span>root,<span style="color: #00ff66;">&quot;вентиль душа&quot;</span><span style=" ">&#41;</span>,<span style="color: #00ff66;">&quot;Закр&quot;</span><span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> <span style=" ">&#40;</span>n1n$=<span style="color: #00ff66;">&quot;кран ванны&quot;</span> <span style="color: #aaffff; font-weight: bold;">And</span> k=<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Or</span> <span style=" ">&#40;</span>n1n$=<span style="color: #00ff66;">&quot;душ&quot;</span> <span style="color: #aaffff; font-weight: bold;">And</span> k=<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> m2$=<span style="color: #00ff66;">&quot;ванны&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> n1n$=<span style="color: #00ff66;">&quot;кран раковины&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> m2$=<span style="color: #00ff66;">&quot;раковины&quot;</span><br />
&nbsp; <span style="color: #ffee00">;Температура воды зависит от того, какие краны открыты (если оба закрыты, то вода</span><br />
&nbsp; <span style="color: #ffee00">; не потечет)</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> m2$&lt;&gt;<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;k=flag<span style=" ">&#40;</span>findobj<span style=" ">&#40;</span>loc,<span style="color: #00ff66;">&quot;синий вентиль &quot;</span>+m2$<span style=" ">&#41;</span>,<span style="color: #00ff66;">&quot;Откр&quot;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>findobj<span style=" ">&#40;</span>loc,<span style="color: #00ff66;">&quot;красный вентиль &quot;</span>+m2$<span style=" ">&#41;</span>,<span style="color: #00ff66;">&quot;Откр&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> k <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp;m$=<span style="color: #00ff66;">&quot;теплая вода&quot;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp; &nbsp;m$=<span style="color: #00ff66;">&quot;горячая вода&quot;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">ElseIf</span> k <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; m$=<span style="color: #00ff66;">&quot;холодная вода&quot;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Else</span> <br />
&nbsp; &nbsp; m$=<span style="color: #00ff66;">&quot;&quot;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span> &nbsp; <br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> m$&lt;&gt;<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> m$=<span style="color: #00ff66;">&quot;Из &quot;</span>+realname$<span style=" ">&#40;</span>n1,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot; течет &quot;</span>+m$+<span style="color: #00ff66;">&quot;.&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> m$=<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> m$=<span style="color: #00ff66;">&quot;Осмотрев &quot;</span>+realname$<span style=" ">&#40;</span>n1,<span style="color: #33ffdd;">4</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;, Вы не обнаружили ничего особенного.&quot;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;осмотреться&quot;</span><br />
&nbsp; look<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Return</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;инвентарь&quot;</span><br />
&nbsp; m$=<span style="color: #00ff66;">&quot;&quot;</span><br />
&nbsp; <span style="color: #ffee00">;Осмотр своего тела на предмет одежды</span><br />
&nbsp; e=body\sub<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">While</span> e&lt;&gt;Null<br />
&nbsp; &nbsp;m$=m$+realname$<span style=" ">&#40;</span>e,<span style="color: #33ffdd;">4</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;, &quot;</span><br />
&nbsp; &nbsp;e=e\nxt<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Wend</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> m$&lt;&gt;<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> tprint <span style="color: #00ff66;">&quot;Вы одеты в &quot;</span>+<span style="color: #aaffff; font-weight: bold;">Left</span>$<span style=" ">&#40;</span>m$,<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>m$<span style=" ">&#41;</span><span style="color: #33ffdd;">-2</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;.&quot;</span><br />
<br />
&nbsp; <span style="color: #ffee00">;Осмотр рук</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> hands\sub=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;m$=<span style="color: #00ff66;">&quot;ничего нет, &quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp;m$=realname$<span style=" ">&#40;</span>hands\sub,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;, &quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; tprint <span style="color: #00ff66;">&quot;У Вас в руках &quot;</span>+<span style="color: #aaffff; font-weight: bold;">Left</span>$<span style=" ">&#40;</span>m$,<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>m$<span style=" ">&#41;</span><span style="color: #33ffdd;">-2</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;.&quot;</span><br />
&nbsp; m$=<span style="color: #00ff66;">&quot;&quot;</span><br />
<br />
&nbsp; <span style="color: #ffee00">;Осмотр карманов</span><br />
&nbsp; e=body\sub<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">While</span> e&lt;&gt;Null<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>e,<span style="color: #00ff66;">&quot;Одеть&quot;</span><span style=" ">&#41;</span>=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span> m$=m$+realname$<span style=" ">&#40;</span>e,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;, &quot;</span><br />
&nbsp; &nbsp;e=nextobj<span style=" ">&#40;</span>body,e<span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Wend</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> m$&lt;&gt;<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> tprint <span style="color: #00ff66;">&quot;В карманах у Вас &quot;</span>+<span style="color: #aaffff; font-weight: bold;">Left</span>$<span style=" ">&#40;</span>m$,<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>m$<span style=" ">&#41;</span><span style="color: #33ffdd;">-2</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;.&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Return</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;резать&quot;</span>,<span style="color: #00ff66;">&quot;разрезать&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>n1,<span style="color: #00ff66;">&quot;Рез&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">Left</span>$<span style=" ">&#40;</span>n2n$,<span style="color: #33ffdd;">5</span><span style=" ">&#41;</span>=<span style="color: #00ff66;">&quot;оскол&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> hands\sub=n2 <span style="color: #aaffff; font-weight: bold;">Or</span> hands\sub=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp;m$=<span style="color: #00ff66;">&quot;Вы разрезали &quot;</span>+realname$<span style=" ">&#40;</span>n1,<span style="color: #33ffdd;">4</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;.&quot;</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #ffee00">;Изменение названия предмета, чтобы получить куски</span><br />
&nbsp; &nbsp; &nbsp;n1\name$=<span style="color: #00ff66;">&quot;куск#16 &quot;</span>+realname$<span style=" ">&#40;</span>n1,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #ffee00">;Удаление возможности одеть и разрезать</span><br />
&nbsp; &nbsp; &nbsp;remflag n1,<span style="color: #00ff66;">&quot;Рез&quot;</span><br />
&nbsp; &nbsp; &nbsp;remflag n1,<span style="color: #00ff66;">&quot;Одеть&quot;</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #ffee00">;Бросить на пол</span><br />
&nbsp; &nbsp; &nbsp;moveobj loc,n1<br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp; &nbsp;m$=<span style="color: #00ff66;">&quot;У Вас заняты руки.&quot;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp; m$=<span style="color: #00ff66;">&quot;Чем?&quot;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
<span style="color: #aaffff; font-weight: bold;">End Select</span><br />
<br />
<span style="color: #ffee00">;Обработка неудавшегося действия</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> m$=<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp;m$=cap$<span style=" ">&#40;</span>verb$<span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot; &quot;</span>+realname$<span style=" ">&#40;</span>n1,v\n<span style=" ">&#91;</span><span style="color: #33ffdd;">0</span><span style=" ">&#93;</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> n2&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">Then</span> m$=m$+<span style="color: #00ff66;">&quot; &quot;</span>+v\adverb$+realname$<span style=" ">&#40;</span>n2,v\n<span style=" ">&#91;</span><span style="color: #33ffdd;">1</span><span style=" ">&#93;</span><span style=" ">&#41;</span><br />
&nbsp;m$=m$+<span style="color: #00ff66;">&quot; не получается. &quot;</span>+m2$<br />
<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
tprint m$<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Функция, проверяющая наличие данного флага у объекта</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> flag<span style=" ">&#40;</span>e.element,flag$<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">Instr</span><span style=" ">&#40;</span>e\flag$,flag$+<span style="color: #00ff66;">&quot;,&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Return</span> <span style="color: #33ffdd;">1</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Добавление флага в строку флагов объекта</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> addflag<span style=" ">&#40;</span>e.element,flag$<span style=" ">&#41;</span><br />
e\flag$=e\flag$+flag$+<span style="color: #00ff66;">&quot;,&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Удаление флага из строки флагов объекта</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> remflag<span style=" ">&#40;</span>e.element,flag$<span style=" ">&#41;</span><br />
m$=e\flag$<br />
i=<span style="color: #aaffff; font-weight: bold;">Instr</span><span style=" ">&#40;</span>m$,flag$+<span style="color: #00ff66;">&quot;,&quot;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> i=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Return</span><br />
e\flag$=<span style="color: #aaffff; font-weight: bold;">Left</span>$<span style=" ">&#40;</span>m$,i<span style="color: #33ffdd;">-1</span><span style=" ">&#41;</span>+<span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span>m$,i+<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>flag$<span style=" ">&#41;</span><span style="color: #33ffdd;">+1</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Проверка наличия объекта с данным именем в группе данного</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> existin<span style=" ">&#40;</span>inwhat.element,what$<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> inwhat=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Return</span><br />
inwhat=inwhat\sub<br />
<span style="color: #aaffff; font-weight: bold;">While</span> inwhat&lt;&gt;Null<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> realname$<span style=" ">&#40;</span>inwhat,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>=what$ <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Return</span> <span style="color: #33ffdd;">1</span><br />
&nbsp;inwhat=<span style="color: #aaffff; font-weight: bold;">After</span> inwhat<br />
<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Функция, делающая начальную букву строки заглавной</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> cap$<span style=" ">&#40;</span>m$<span style=" ">&#41;</span><br />
m$=<span style="color: #aaffff; font-weight: bold;">Chr</span>$<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Asc</span><span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Left</span>$<span style=" ">&#40;</span>m$,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><span style=" ">&#41;</span><span style="color: #33ffdd;">-32</span><span style=" ">&#41;</span>+<span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span>m$,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Return</span> m$<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Функция, подбирающее окончание, в зависимости от рода</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> vend$<span style=" ">&#40;</span>e.element<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>e,<span style="color: #00ff66;">&quot;Ж&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Return</span> <span style="color: #00ff66;">&quot;а&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>e,<span style="color: #00ff66;">&quot;С&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Return</span> <span style="color: #00ff66;">&quot;о&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>e,<span style="color: #00ff66;">&quot;М&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Return</span> <span style="color: #00ff66;">&quot;ы&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Выполнение команды &quot;осмотреться&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> look<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
e.element=loc\sub<br />
<span style="color: #ffee00">;Перечисление объектов, входящих в ветвь локации (кроме скрытых)</span><br />
<span style="color: #aaffff; font-weight: bold;">While</span> e&lt;&gt;Null<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>e,<span style="color: #00ff66;">&quot;Скр&quot;</span><span style=" ">&#41;</span>=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span> m$=m$+realname$<span style=" ">&#40;</span>e,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;, &quot;</span><br />
&nbsp;e=nextobj<span style=" ">&#40;</span>loc,e<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> m$=<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> m$=<span style="color: #00ff66;">&quot;ничего нет &nbsp;&quot;</span><br />
tprint <span style="color: #00ff66;">&quot;Вы находитесь в &quot;</span>+realname$<span style=" ">&#40;</span>loc,<span style="color: #33ffdd;">3</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;.&quot;</span><br />
tprint <span style="color: #00ff66;">&quot;Перед вами &quot;</span>+<span style="color: #aaffff; font-weight: bold;">Left</span>$<span style=" ">&#40;</span>m$,<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>m$<span style=" ">&#41;</span><span style="color: #33ffdd;">-2</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;.&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Корректная печать текста (с переносом и сдвигом экрана)</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> tprint<span style=" ">&#40;</span>m$<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp;l=<span style="color: #aaffff; font-weight: bold;">StringWidth</span><span style=" ">&#40;</span>m$<span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> l&lt;=xsiz <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Exit</span><br />
&nbsp;n$=<span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span>m$,<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>m$<span style=" ">&#41;</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>+n$<br />
&nbsp;m$=<span style="color: #aaffff; font-weight: bold;">Left</span>$<span style=" ">&#40;</span>m$,<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>m$<span style=" ">&#41;</span><span style="color: #33ffdd;">-1</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Forever</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> ty+tysiz*<span style="color: #33ffdd;">2</span>&gt;ysiz <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp;cr=<span style="color: #aaffff; font-weight: bold;">ColorRed</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp;cg=<span style="color: #aaffff; font-weight: bold;">ColorGreen</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp;cb=<span style="color: #aaffff; font-weight: bold;">ColorBlue</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">CopyRect</span> <span style="color: #33ffdd;">0</span>,ysiz-ty,xsiz,ty,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Rect</span> <span style="color: #33ffdd;">0</span>,ty,xsiz,tysiz*<span style="color: #33ffdd;">2</span><br />
&nbsp;ty=ty*<span style="color: #33ffdd;">2</span>-ysiz<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Color</span> cr,cg,cb<br />
<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
<span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #33ffdd;">0</span>,ty,m$<br />
ty=ty+tysiz<br />
<br />
<span style="color: #aaffff; font-weight: bold;">If</span> n$&lt;&gt;<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> tprint n$<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Рекусривная функция поиска объекта в ветви данного по названию</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> findobj.element<span style=" ">&#40;</span>inwhat.element,what$<span style=" ">&#41;</span><br />
inwhat=inwhat\sub<br />
<span style="color: #aaffff; font-weight: bold;">While</span> inwhat&lt;&gt;Null<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> realname$<span style=" ">&#40;</span>inwhat,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>=what$ <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Return</span> inwhat<br />
&nbsp;<span style="color: #ffee00">;Проверка наличия элемента в ветви</span><br />
&nbsp;e.element=findobj<span style=" ">&#40;</span>inwhat,what$<span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> e&lt;&gt;Null <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Return</span> e<br />
&nbsp;inwhat=inwhat\nxt<br />
<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Функция нахождения следующего объекта в ветви inwhat (полезна для осуществления</span><br />
<span style="color: #ffee00">; перебора элементов ветви)</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> nextobj.element<span style=" ">&#40;</span>inwhat.element,current.element<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> current\sub=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">While</span> current\nxt=<span style="color: #aaffff; font-weight: bold;">Null</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> current\root=inwhat <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Return</span> <span style="color: #aaffff; font-weight: bold;">Null</span><br />
&nbsp; current=current\root<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Return</span> current\nxt<br />
<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Return</span> current\sub<br />
<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Функция поиска объекта с данным флагом в даной ветви</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> findobjwithflag.element<span style=" ">&#40;</span>inwhat.element,what$<span style=" ">&#41;</span><br />
e.element=inwhat\sub<br />
<span style="color: #aaffff; font-weight: bold;">While</span> e&lt;&gt;Null<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> flag<span style=" ">&#40;</span>e,what$<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Return</span> e<br />
&nbsp;e=nextobj<span style=" ">&#40;</span>inwhat,e<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Корректное перемещение объекта</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> moveobj<span style=" ">&#40;</span>inwhat.element,what.element,flag$=<span style="color: #00ff66;">&quot;&quot;</span><span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Убираются флаги местоположения</span><br />
remflag what,<span style="color: #00ff66;">&quot;На&quot;</span><br />
remflag what,<span style="color: #00ff66;">&quot;В&quot;</span><br />
remflag what,<span style="color: #00ff66;">&quot;Под&quot;</span><br />
remflag what,<span style="color: #00ff66;">&quot;Вис&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> flag$&lt;&gt;<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> addflag what,flag$<br />
einsertin inwhat,what<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Пропитывание объектов водой</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> water<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
src.element=loc\sub<br />
<br />
<span style="color: #aaffff; font-weight: bold;">While</span> src&lt;&gt;Null<br />
&nbsp;k=flag<span style=" ">&#40;</span>src,<span style="color: #00ff66;">&quot;Вода&quot;</span><span style=" ">&#41;</span><br />
&nbsp;dst.element=src\sub<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">While</span> dst&lt;&gt;Null<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> k <span style="color: #aaffff; font-weight: bold;">And</span> flag<span style=" ">&#40;</span>dst,<span style="color: #00ff66;">&quot;Сух&quot;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;remflag dst,<span style="color: #00ff66;">&quot;Сух&quot;</span><br />
&nbsp; &nbsp;addflag dst,<span style="color: #00ff66;">&quot;Мокр&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; dst=dst\nxt<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Wend</span> <br />
&nbsp;src=src\nxt<br />
<span style="color: #aaffff; font-weight: bold;">Wend</span> <br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<p>Программа плохо протестирована, возможны баги и неучтенные ситуации. Зато она хорошо иллюстрирует возможности изложенного подхода. Кстати - заметьте следующую вещь: изначально дверь в комнате закрыта, а в прихожей та же дверь открыта. Это сделано потому, что попасть в прихожую, не открыв дверь нельзя, а дверь в локации "прихожая" недоступна из локации "комната". Для кольцевых путей пришлось бы делать синхронизацию дверей.
</p><p>В принципе, система позволяет неограниченно усложнять структуру базы данных, вводить дополнительные команды и разрабатывать нетривиальные способы взаимодействий, без особой потери производительности. Хотя на данный момент, некоторые очень полезные возможности не внесены, этим мы займемся в следующей статье.
</p>
<div align="right"><a href="http://blitzetcetera.org/images/f/f4/TextAdventure.bb" class="internal" title="TextAdventure.bb">скачать исходный код</a></div>
<hr />
<p>Автор: <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Matt_Merkulov" title="Участник:Matt Merkulov">Матвей Меркулов</a> (E-mail: MattMerk@mail.ru, ICQ: 392-274-050)
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Демонический МАКС"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Демонический МАКС&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Демонический МАКС&amp;action=edit">править</a>]</span><span class="mw-headline">Демонический МАКС</span></h1>
</p>
<a name=".D0.9C.D0.BE.D0.B4.D0.B5.D0.BB.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D1.84.D0.B8.D0.B3.D1.83.D1.80.D1.8B_.D0.B2_3D_studio_max"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%94%D0%B5%D0%BC%D0%BE%D0%BD%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9_%D0%9C%D0%90%D0%9A%D0%A1&amp;action=edit&amp;section=1" title="Демонический МАКС">править</a>]</span> <span class="mw-headline">Моделирование фигуры в 3D studio max</span></h2>
<p>В статье "Максимальная энциклопедия" в общих чертах описывалось создание объектов, имеющих геометрическую форму. В этой статье я расскажу про создание аморфного объекта на примере толстого демона, который для нас любезно согласился побыть моделью&nbsp;:).
</p><p>Рекомендую все руководства по Мах воспринимать не как руководство к созданию модели, а как описание техники, с помощью которой эта модель создается. Вникнув в то, что изложено ниже, можно будет создавать практически любые модели.
</p>
<a name=".D0.9E.D1.81.D0.BD.D0.BE.D0.B2.D0.B0"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%94%D0%B5%D0%BC%D0%BE%D0%BD%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9_%D0%9C%D0%90%D0%9A%D0%A1&amp;action=edit&amp;section=2" title="Демонический МАКС">править</a>]</span> <span class="mw-headline">Основа</span></h2>
<p>В идеале перед моделированием нужно нарисовать будущий объект в профиль и анфас (этим обычно занимается концепт-художник). Обе полученные картинки желательно подогнать под одинаковое разрешение и сделать так, чтобы объект на них находился на одной высоте и был отражен в одинаковом масштабе. После этого нужно будет создать две плоскости, по полигону каждая и размером с разрешение (или кратно разрешению) соответствующей картинки (например, 800x600), разместить их под прямым углом друг к другу (пример смотри на скриншоте). Создаем две текстуры из картинок проекций, включив в редакторе материалов опцию Show Map in Viewport (кнопка под образцами) и наложив на эти плоскости. Теперь эти материалы отображаются в окнах проекций. Останется только включить отображение Smooth + Highlights, а на объекты, из которых создается модель, наложить текстуру с максимальной прозрачностью, чтобы за ней были видны наброски. При моделировании нужно постоянно подгонять объект так, чтобы он соответствовал отображенному на текстуре. Разумеется, это следует делать только если необходимо создать точную копию чего-либо. В этой статье я не ставил себе задачи создать идеальную копию живого существа, поэтому такой шаг опущу.
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:3DSMax2-01.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:3DSMax2-01.jpg" src="rsozx_mc.jpg" width="441" height="336" /></a></span></div></div>
<p>Приступим к созданию монстра. Первый шаг - построение максимально грубого каркаса будущего существа из минимального количества полигонов. Теоретически все можно сделать даже из одного куба, выдавливая по полигону, но лучше соорудить пусть и грубую, но основу, чтобы не получить потом лишних мучений.
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:3DSMax2-02.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:3DSMax2-02.jpg" src="148fpq6b.jpg" width="448" height="256" /></a></span></div></div>
<p>Повторим в своем проекте примерно то же самое, что показано на скриншоте. Все части тела - простые коробки с различным количеством сегментов. Демон - существо симметричное, поэтому его голову, шею, туловище и руки нужно выровнять относительно демонической оси. Ноги и ступни лучше в самом начале работы попарно объединить в группы, которые нужно будет выровнять относительно центра, после чего снять группировку. Главное - это обеспечить пересечение примитивов друг с другом, и тогда ни одна из частей тела не будет висеть в воздухе, и не будет вести самостоятельную деятельность. Также желательно избегать лишних пересечений граней: одна фигура должна пересекать другую по одному полигону, а не по нескольким. Масштаб можно не соблюдать четко, потому что в процессе создания выправить его будет несложно.
</p><p>После того, как каркас будет готов, необходимо поочередно объединить все примитивы в единую модель при помощи Boolean-Union, после чего превратить объект в редактируемую сетку и применить модификатор Mesh Smooth (сглаживание сетки).
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:3DSMax2-03.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:3DSMax2-03.jpg" src="148fpq6b-2.jpg" width="434" height="333" /></a></span></div></div>
<p>Тут есть одна тонкость. При работе с Boolean и со сглаживанием после присоединения к модели последнего (на тот момент) объекта или после его вырезания потребуется еще раз обратиться за помощью к кнопке Boolean. Если этого не сделать, то при сглаживании с помощью Mesh Smooth в месте последнего соединения, скорее всего, будут видны очень неприятные артефакты, которые практически невозможно удалить вручную. Сглаживать нужно именно редактируемую сетку, а не объект Boolean, иначе ничего хорошего не получится.
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:3DSMax2-04.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:3DSMax2-04.jpg" src="y7ktgxfl-2.jpg" width="438" height="336" /></a></span></div></div>
<p>На скриншоте показана одна из возможных неприятностей при выполнении операции Boolean. Подобные прелести в Мах иногда очень раздражают, особенно если не совсем понятно, как с ним бороться. По этому поводу еще один совет - чаще сохраняйся!
</p><p>После применения модификатора из грубого каркаса моментально родится аккуратно сглаженная модель, которая уже намного больше похожа на "живое" существо. Однако праздновать победу, конечно, рано. Все самое интересное еще впереди. 
</p><p>В настройках модификатора Mesh Smooth лучше выбрать Subdivision Method - Classic (хотя можно попробовать и другие), а Iterations поставить на двойку: если будет меньше, то модель получится недостаточно сглаженной, если больше - Мах начнет уже немного притормаживать, а потом создаст проблемы с окончательным редактированием, да и объект будет даже чересчур гладким. Кстати, попробовать увеличить Iterations, например, до семи-девяти -  отличный способ протестировать свой комп на производительность.
</p>
<a name=".D0.9F.D0.BE.D0.B4.D0.B3.D0.BE.D1.82.D0.BE.D0.B2.D0.BA.D0.B0_.D0.BA_.D1.80.D0.B5.D0.B4.D0.B0.D0.BA.D1.82.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D1.8E"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%94%D0%B5%D0%BC%D0%BE%D0%BD%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9_%D0%9C%D0%90%D0%9A%D0%A1&amp;action=edit&amp;section=3" title="Демонический МАКС">править</a>]</span> <span class="mw-headline">Подготовка к редактированию</span></h2>
<p>Вернёмся к редактированию исходного каркаса. В стеке модификаторов кликаем  по первому пункту - Editable Mesh, после чего в окнах проекции снова отобразится исходный каркас. Какие бы изменения с каркасом пока не происходили, нужно следить, чтобы модификатор Mesh Smooth всегда находился на верхней позиции стека. Обрати внимание на кнопку под стеком Show end result on/off toggle: если она нажата, то в окнах проекции отображается окончательный вариант модели с учетом всех модификаторов, если нет - выбранное только на этом уровне редактирования. Изменяя каркас и щелкая по этой кнопке, можно наблюдать за преображением сглаженной модели. Напомню, что демон должен стать полностью симметричным, следовательно, его совершенно не обязательно делать полностью: достаточно изготовить половину существа. Во время редактирования каркаса мы будем править только ее, а другую половину временно проигнорируем. Большая часть времени при создании модели уйдет именно на правку каркаса. Можно, конечно, уже сейчас превратить сглаженную модель в редактируемую сетку, но в таком случае редактирование будет невозможно или практически невозможно.
</p><p>При правке объекта мы будем пользоваться тремя основными приемами: выдавливание полигонов, сжатие полигонов (кнопка Bevel прямо под Extrude) и рассечение вершин (кнопка Chamfer под Extrude при редактировании на уровне вершин). Extrude уже описывали в первой статье, Bevel применяется к полигонам и действует аналогично масштабированию. Chamfer отвечает за вершины и умеет разбивать одну на несколько в зависимости от того, сколько ребер исходит из этой вершины, что обеспечивает сглаживание угла при ней.
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:3DSMax2-05.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:3DSMax2-05.jpg" src="--dvxy3g.jpg" width="398" height="336" /></a></span></div></div>
<p>Если ты вдруг доигрался и удалил нужные полигоны, а Undo нажать уже не получается, то на помощь к тебе придет модификатор Cap Holes, правда, почти не имеющий настроек и заделывающий дырки только на свое усмотрение. После применения этого модификатора лучше заново переконвертировать модель в редактируемую сетку, так как он не несет в себе никакой смысловой нагрузки.
</p>
<a name=".D0.9A.D1.80.D1.8B.D0.BB.D1.8C.D1.8F.2C_.D0.BD.D0.BE.D0.B3.D0.B8_.D0.B8_.D1.85.D0.B2.D0.BE.D1.81.D1.82.D1.8B"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%94%D0%B5%D0%BC%D0%BE%D0%BD%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9_%D0%9C%D0%90%D0%9A%D0%A1&amp;action=edit&amp;section=4" title="Демонический МАКС">править</a>]</span> <span class="mw-headline">Крылья, ноги и хвосты</span></h2>
<p>Для начала обеспечим демону правдоподобные верхние конечности. Пока то, что есть у него вместо лап, лапами назвать даже язык не поворачивается. Выдавливая и масштабируя крайний полигон лапы, нужно обозначить основные суставы и кисть. На очереди пальцы: приплюснем кисть. Большой палец можно отрастить несколько раз выдавив, сжав и подняв вверх полигон, который формирует ладошку. Чтобы сделать оставшиеся два пальца, нужно применить Chamfer к двум крайним передним вершинам лапы и два-три раза выдавить образовавшиеся полигоны. Чтобы клешня стала готовой, придется над ней изрядно потрудиться и отредактировать вершины. Добавим руке некоторую рельефность, то есть нарастим мускулатуру. Останется только придать лапе правильную форму, двигая и вращая составляющие ее вершины. В принципе, при изменении положения конечностей нужно учитывать сокращение мышц и движение сухожилий, но можно этого и не делать. После того, как лапе будет обеспечено необходимое положение, останется только окончательно исправить некоторые вершины, чтобы она выглядела естественно.
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:3DSMax2-06.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:3DSMax2-06.jpg" src="3fgwgk71.jpg" width="260" height="448" /></a></span></div></div>
<p>Приступим к туловищу. При создании модели придется довольно много перемещать вершины, чего в маленькой статье не опишешь. Поэтому редактируй туловище каркаса руководствуясь своим вкусом и сверяйся с тем, что происходит на сглаженной модели. Я лишь опишу пару сложных моментов. Во-первых, монстру необходимо сделать грудь, для чего пару раз выдавливаешь и сжимаешь полигоны, отвечающие за грудные мышцы. Чтобы демон не стал Памелой Андерсон, верхние угловые вершины следует объединить между собой при помощи Weld.
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:3DSMax2-07.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:3DSMax2-07.jpg" src="sbe1a2yq.jpg" width="436" height="336" /></a></span></div></div>
<p>Теперь настала пора выправить нижние конечности. Сначала отрастим когти, для чего нужно несколько раз выдавить и сжать полигоны, находящиеся на месте пальцев. Выдавливать сразу все три нельзя: сначала работаем с двумя крайними, а потом уже переходим к средним пальцам. Осталось сделать "задний" коготь и придать ноге рельефность. Чтобы сделать коленку, нужно просто немного выдавить и сжать соответствующий полигон.
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:3DSMax2-08.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:3DSMax2-08.jpg" src="dbx6q3zt.jpg" width="434" height="336" /></a></span></div></div>
<p>Перед моделированием головы лучше сначала вставить зубы, а потом уже подстраивать улыбку, которая обтягивала бы большие клыки. Я сделал клыки так: взял сплайн NGon с тремя сторонами, выдавил его, превратил в редактируемую сетку, а потом несколько раз выдавил и отмасштабировал последний полигон, да еще добавил завиток на конце и применил уже знакомый модификатор Mesh Smooth.
</p><p>Теперь в голове необходимо вырезать при помощи Boolean - Subtraction рот, для чего лучше взять коробку с двумя-тремя сегментами по ширине и высоте, чтобы в полости рта модели образовались дополнительные вершины. Рот нужно тщательно подгонять, чтобы он гармонично сочетался с зубами и чтобы не оставалось явно лишних отверстий. Форму черепа сделать уже совсем несложно. Можно также слегка выдавить подбородок и добавить пару рогов. Рога делаются таким же образом, как зубы.
<p>Осталось самое сложное - подарить существу какое-нибудь выражение лица. Именно положение глаз, бровей, губ и носа определяют то, каким будет существо: добрым, злым, жалобным, агрессивным, веселым, грустным и т.д. Если этому придавать большое значение, то, во-первых, придется значительно увеличить количество полигонов, выделенных для головы, а во-вторых, потратить намного больше времени на подгонку. В голове нужно вырезать цилиндрами небольшие отверстия для глаз и потом сделать небольшой нос. Сами глаза лучше сделать отдельными объектами из простых сфер, что позволит при необходимости без лишних усилий поворачивать глаза в нужную сторону, да и проще будет накладывать текстуру.
</p>
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:3DSMax2-09.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:3DSMax2-09.jpg" src="bs9a_fmr.jpg" width="435" height="336" /></a></span></div></div>
<a name=".D0.92.D1.82.D0.BE.D1.80.D0.B0.D1.8F_.D0.BF.D0.BE.D0.BB.D0.BE.D0.B2.D0.B8.D0.BD.D0.B0"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%94%D0%B5%D0%BC%D0%BE%D0%BD%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9_%D0%9C%D0%90%D0%9A%D0%A1&amp;action=edit&amp;section=5" title="Демонический МАКС">править</a>]</span> <span class="mw-headline">Вторая половина</span></h2>
<p>У нашего монстра пока готова только одна половина. План дальнейших действий таков: сначала удалим бракованную половину, потом скопируем нормальную, отразим ее и полученную копию склеим с готовой. Поехали. Во-первых, пора, наконец, превратить модель в редактируемую сетку, затем перейти к редактированию на уровне полигонов, выделить все полигоны модели и нажать Slice Рlаnе на закладке Modify. Появится желтая плоскость, которую нужно выровнять относительно центра существа (лучше вручную) и выставить ее перпендикулярно анфасу. После того, как плоскость станет ровной, настанет пора нажимать на Slice. В местах пересечения плоскости с гранями сетки образуются новые вершины. Удалим все полигоны из левой (или правой) недоделанной половины. Выбрав редактирование на уровне полигонов, выделим все полигоны, находящиеся по одну сторону, нажмем на клавиатуре "Delete", утвердительно ответим на вопрос: "Delete isolated vertices?". Иногда попадаются очень маленькие полигоны, которые не так просто заметить, поэтому после удаления стоит еще раз пробежаться глазами вдоль шва и удалить лишние полигоны, которые до этого оставались незамеченными.
</p><p>Настало время отразить половинку относительно оси. В этом нам поможет инструмент Mirror Selected Objects (он на панели инструментов). В его свойствах лучше выбрать Сору, чтобы лишний раз не возиться с копированием. Образовавшуюся вторую половинку требуется выровнять относительно первой, чтобы они точно совпадали и образовывали полную версию монстра (используем инструмент Align с параметрами Minimum - Maximum или наоборот). Если после выравнивания остается видной небольшая полоска пустоты по центру существа, значит, ты забыл удалить какие-то полигоны или случайно немного повернул демона. И, наконец, последний шаг - объединить две половинки в готовый объект. Выбрав любую половинку, нажмем кнопку Attach на закладке Modify и щелкнем по второй. При этом у модели в месте соединения появятся лишние двойные вершины, от которых можно избавиться следующим образом: выделить все вершины, выбрав редактирование на этом уровне, нажав Selected (Weld) и поставив очень маленькое значение, например, 0,01. Все вершины, находящиеся на минимальном расстоянии, автоматически создадут единое целое. Если все сделать аккуратно, то место соединения будет совершенно незаметным.
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:3DSMax2-11.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:3DSMax2-11.jpg" src="vpa_62be.jpg" width="330" height="448" /></a></span></div></div>
<p>Остается последний штрих, вернее даже не штрих, а так - косметическая правка. Внимательно осмотрим модель и поправим вершины в неудачных местах. Если до этого все было сделано внимательно, то таких мест должно быть всего несколько.
</p>
<a name=".D0.A2.D0.B5.D0.BA.D1.81.D1.82.D1.83.D1.80.D0.B0"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%94%D0%B5%D0%BC%D0%BE%D0%BD%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9_%D0%9C%D0%90%D0%9A%D0%A1&amp;action=edit&amp;section=6" title="Демонический МАКС">править</a>]</span> <span class="mw-headline">Текстура</span></h2>
<p>В случае демона с текстурой можно особо не заморачиваться: шкура у него практически однотонная, поэтому даже одноцветный материал вполне сойдет, только не нужно задавать никакого блеска и глянцевости, чтобы он не стал похож на куклу Барби. Если один цвет не устраивает, то можно найти или создать шкурку, например, динозавра (только обязательно красноватого цвета). Конечно, все это намного проще сделать при помощи Photoshop или любого другого двухмерного редактора. А метод проекции, как ни странно, на демоне лучше всего смотрится UVW Map - Box.
</p><p>Для зубов подойдет однотонный материал цвета слоновой кости. Единственная допустимая изюминка - капли крови на концах клыков, которые обеспечат монстру имидж истинно адского существа. Но для этого придется отдельно создать соответствующую текстуру.
</p><p>На глаза я наложил оранжевый материал с красным свечением, включив у материала опцию Self-Illumination и задав цвет, отличный от черного. Такие глаза будут очень интересно смотреться в темноте или при слабом освещении. Ах да, забыл рассказать, как делать освещение. Самый простой источник света - всенаправленный, который создается с помощью Create - Lights - Standard - Omni. После этого в окнах проекции появится пиктограмма, из которой будет изливаться свет. Чтобы отбрасывались тени, нужно включить опцию Shadows-On на закладке Modify, а чтобы увеличить или уменьшить яркость - изменить значение счетчика Multiplier или цвет рядом со счетчиком.
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:3DSMax2-10.jpg" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:3DSMax2-10.jpg" src="jyr1gw2x.jpg" width="448" height="230" /></a></span></div></div>
<a name=".D0.A0.D0.B0.D0.B7.D0.B1.D0.BE.D1.80_.D0.BF.D0.BE.D0.BB.D0.B5.D1.82.D0.BE.D0.B2"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%94%D0%B5%D0%BC%D0%BE%D0%BD%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9_%D0%9C%D0%90%D0%9A%D0%A1&amp;action=edit&amp;section=7" title="Демонический МАКС">править</a>]</span> <span class="mw-headline">Разбор полетов</span></h2>
<p>Чего плохого в нашем демоне кроме несоответствия нормам строгой морали&nbsp;:)? В нем слишком много полигонов, поэтому для импорта в игры он явно тяжеловат, да и править его в редактируемой сетке удовольствие не из приятных. Чтобы это исправить, придется оптимизировать модель, но это уже совсем другая история. 
</p>
<hr />
<p>Автор: Федор (fm) Галков (e-mail: fm@real.xakep.ru, сайт: <a href="http://www.podzemka.net/" class="external free" title="http://www.podzemka.net" rel="nofollow">http://www.podzemka.net</a>)<br />
OCR: Святослав (e-mail: zlum@xaker.ru)
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Страна советов - Max и не только"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Страна советов - Max и не только&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Страна советов - Max и не только&amp;action=edit">править</a>]</span><span class="mw-headline">Страна советов - Max и не только</span></h1>
<p>Часть Страны советов (касающаяся Макса) позаимствована из популярной книги "3DStudio Max 5" (к сожалению не помню автора).
</p>
</p>
<a name=".D0.A1.D0.BE.D0.B2.D0.B5.D1.82_4:_Maxstart.max"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A1%D1%82%D1%80%D0%B0%D0%BD%D0%B0_%D1%81%D0%BE%D0%B2%D0%B5%D1%82%D0%BE%D0%B2_-_Max_%D0%B8_%D0%BD%D0%B5_%D1%82%D0%BE%D0%BB%D1%8C%D0%BA%D0%BE&amp;action=edit&amp;section=1" title="Страна советов - Max и не только">править</a>]</span> <span class="mw-headline">Совет 4: Maxstart.max</span></h2>
<p>После запуска программы Мах (а также при выполнении команды Reset (Сброс) из падающего меню File (Файл)) происходит загрузка файла. Maxstart.MAX, расположенного в каталоге \Scenes. В любой новой сцене вам потребуется хотя бы одна камера и один осветитель, генерирующий падающие тени независимо от того, изучаете ли вы программу или делаете реальную работу. Поэтому создайте себе стартовый файл Maxstart.MAX, задав все предварительные установки. 
</p>
<a name=".D0.A1.D0.BE.D0.B2.D0.B5.D1.82_8:_.D0.9F.D1.80.D0.B5.D0.B4.D0.BE.D1.85.D1.80.D0.B0.D0.BD.D1.8F.D0.B9.D1.82.D0.B5.D1.81.D1.8C.21"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A1%D1%82%D1%80%D0%B0%D0%BD%D0%B0_%D1%81%D0%BE%D0%B2%D0%B5%D1%82%D0%BE%D0%B2_-_Max_%D0%B8_%D0%BD%D0%B5_%D1%82%D0%BE%D0%BB%D1%8C%D0%BA%D0%BE&amp;action=edit&amp;section=2" title="Страна советов - Max и не только">править</a>]</span> <span class="mw-headline">Совет 8: Предохраняйтесь!</span></h2>
<p>Несмотря на довольно устойчивую работу программы, при любых действиях пользователя существует небольшой процент команд и операций, после которых вероятно аварийное завершение текущего сеанса Мах. При таком исходе все изменения, сделанные пользователем, будут потеряны ... с момента последнего сохранения проекта на диск. Критичными могут быть Boolean (Булевые Операции) со сложными объектами, команды Render Scene (Визуализировать Сцену) и Make Preview (Выполнить Эскиз Анимации) и т.п. Перед запуском таких команд лучше сохранить изменения.
</p><p>Вдобавок существует специальная пара команд Hold (Сохранить Текущее Состояние) и Fetch (Восстановить Текущее Состояние), вызываемая из падающего меню Edit (Редактирование), а также системные настройки Auto Backup (Автоматическое Сохранение), находящиеся в одноименной группе закладки Files (Файлы) диалогового окна Preference Setting (Настройки Параметров). Флажок Enable (Включить) управляет режимом включения автосохранения, а счетчики Number of Autobak files (Число Версий Файлов) и Backup Interval (minutes) (Интервал Сохранения (минуты)) задают его основные параметры. 
</p>
<a name=".D0.A1.D0.BE.D0.B2.D0.B5.D1.82_13:_.D0.9E.D0.BF.D1.82.D0.B8.D0.BC.D0.B8.D0.B7.D0.B8.D1.80.D1.83.D0.B9.D1.82.D0.B5"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A1%D1%82%D1%80%D0%B0%D0%BD%D0%B0_%D1%81%D0%BE%D0%B2%D0%B5%D1%82%D0%BE%D0%B2_-_Max_%D0%B8_%D0%BD%D0%B5_%D1%82%D0%BE%D0%BB%D1%8C%D0%BA%D0%BE&amp;action=edit&amp;section=3" title="Страна советов - Max и не только">править</a>]</span> <span class="mw-headline">Совет 13: Оптимизируйте</span></h2>
<p>Некоторые модификаторы предназначены для сугубо служебных целей, и один из них - Optimize (Оптимизировать) - может быть очень полезен при работе со сложной геометрией трехмерной сцены. Свиток Parameters (Параметры) позволяет устанавливать настройки оптимизации объекта и сразу же контролировать степень реальной экономии программных ресурсов, которые скажутся на времени визуализации сцены или просто на общем быстродействии системы. Пара счетчиков Face Threshold (Критерий Граней) и Edge Threshold (Критерий Ребер) задает режим оптимизации, а статусная группа Last Optimize Status (Последний Результат Оптимизации) отображает величину этой оптимизации в виде соотношения числа вершин и граней до и после оптимизации.
</p><p>Особенно полезно при создании игровых моделей использовать линейку модификаторов MeshSmuth-&gt;Convert to Editable Mesh-&gt;Optimize, позволяющую получить золотую середину между числом полигонов и качеством модели. 
</p>
<a name=".D0.A1.D0.BE.D0.B2.D0.B5.D1.82_14:_.D0.A2.D0.B5.D0.BA.D1.81.D1.82.D1.83.D1.80.D1.8B_.D0.BF.D1.80.D0.BE.D1.82.D0.B8.D0.B2_.D0.BC.D0.BE.D0.B4.D0.B5.D0.BB.D0.B5.D0.B9"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A1%D1%82%D1%80%D0%B0%D0%BD%D0%B0_%D1%81%D0%BE%D0%B2%D0%B5%D1%82%D0%BE%D0%B2_-_Max_%D0%B8_%D0%BD%D0%B5_%D1%82%D0%BE%D0%BB%D1%8C%D0%BA%D0%BE&amp;action=edit&amp;section=4" title="Страна советов - Max и не только">править</a>]</span> <span class="mw-headline">Совет 14: Текстуры против моделей</span></h2>
<p>Всегда используйте карты текстур вместо геометрических моделей, насколько это возможно В самом деле, пока еще вычислительная мощь среднего настольного компьютеpa имеет пределы, и задумываться о работоспособности программы при обсчете сложных сцен приходится почти всем.
</p><p>Это особенно справедливо для игр, которые помимо работоспособности должны еще и "не тормозить". Кроме того визуализация текстурированных моделей происходит качественнее и не так сильно варьируется в зависимости от "железа" пользователя. Режим полноэкранного сглаживания значительно более эффективен для текстурированых моделей. 
</p><p>Тут некоторые товарищи утверждают, что наблюдается подмена понятий. Ничего подобного. Дело в том, что в DirectX используется техника визуализации, при которой в текстурированых моделях визуализируется только текстура. Это экономит ресурсы за счет отбрасывания необходимости "заливки" поверхности треугольников модели. А про то что вогнутый изврат октаэдра лучше заменить спрайтом - это и ежу понятно. 
</p>
<a name=".D0.A1.D0.BE.D0.B2.D0.B5.D1.82_17:_.D0.97.D0.B0.D0.BA.D1.80.D1.8B.D0.B2.D0.B0.D0.B9.D1.82.D0.B5_.D0.B4.D1.8B.D1.80.D1.8B"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A1%D1%82%D1%80%D0%B0%D0%BD%D0%B0_%D1%81%D0%BE%D0%B2%D0%B5%D1%82%D0%BE%D0%B2_-_Max_%D0%B8_%D0%BD%D0%B5_%D1%82%D0%BE%D0%BB%D1%8C%D0%BA%D0%BE&amp;action=edit&amp;section=5" title="Страна советов - Max и не только">править</a>]</span> <span class="mw-headline">Совет 17: Закрывайте дыры</span></h2>
<p>При создании некоторых объектов Лофтинга, составных объектов или просто в результате модифицирования сложной геометрии возникают ненужные отверстия и проемы. Существует способ быстро заполнить их граневой плоскостью и тем самым накрыть эти отверстия. Для этого служит модификатор Cap Holes (Накрыть Отверстия), набор параметров которого предельно прост. Флажки Smooth New Faces (Сглаживать Новые Грани) и Smooth With Old Faces (Сглаживать с Гранями Объекта) включают соответствующие режимы сглаживания граней, а флажок All New Edges Visible (Все Новые Грани Видимые) управляет видимостью создаваемых граней. В процессе применения этого модификатора Мах пытается соединить набором граней все открытые края модели и сформировать замкнутую поверхность. 
</p>
<a name=".D0.A1.D0.BE.D0.B2.D0.B5.D1.82_19:_.D0.A3.D0.BB.D1.83.D1.87.D1.88.D0.B0.D0.B9.D1.82.D0.B5_.D0.BA.D0.B0.D1.87.D0.B5.D1.81.D1.82.D0.B2.D0.BE"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A1%D1%82%D1%80%D0%B0%D0%BD%D0%B0_%D1%81%D0%BE%D0%B2%D0%B5%D1%82%D0%BE%D0%B2_-_Max_%D0%B8_%D0%BD%D0%B5_%D1%82%D0%BE%D0%BB%D1%8C%D0%BA%D0%BE&amp;action=edit&amp;section=6" title="Страна советов - Max и не только">править</a>]</span> <span class="mw-headline">Совет 19: Улучшайте качество</span></h2>
<p>Если модель уже создана и имеет острые ребра, ухудшающие ее внешний вид, то один из способов усложнения заключается в использовании модификатора MeshSmooth (Сглаживание Каркаса). Набор настроек этого инструмента довольно велик, поэтому остановимся только на основных из них. Пара счетчиков Strength (Сила) и Relax (Ослабление) управляет величиной сглаживания ребер каркаса, а счетчики Iterations (Число Повторений) и Smothness (Гладкость) задают параметры детальности и плавности результирующей поверхности.Для сохранения общего объема редактируемой модели иногда может быть очень желательна активизация режима Keep Faces Convex (Учитывать Выпуклости), а избежать неподходящего сглаживания ребер можно, включив режимы Separate by (Разделения по) Materials (Материалам) или Smoothing Groups (Группам Сглаживания). Очень многие библиотеки моделей, доступные для использования, имеют такой изъян, как острые края и недостаточная подробность формы, поэтому, используя описанное средство Мах, вы сможете значительно усложнить геометрию таких объектов и сделать их лучше.
...Но не забывайте про совет номер 13. 
</p>
<a name=".D0.A1.D0.BE.D0.B2.D0.B5.D1.82_36:_.D0.91.D1.83.D0.B4.D1.8C.D1.82.D0.B5_.D0.B5.D1.81.D1.82.D0.B5.D1.81.D1.82.D0.B2.D0.B5.D0.BD.D0.BD.D1.8B"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A1%D1%82%D1%80%D0%B0%D0%BD%D0%B0_%D1%81%D0%BE%D0%B2%D0%B5%D1%82%D0%BE%D0%B2_-_Max_%D0%B8_%D0%BD%D0%B5_%D1%82%D0%BE%D0%BB%D1%8C%D0%BA%D0%BE&amp;action=edit&amp;section=7" title="Страна советов - Max и не только">править</a>]</span> <span class="mw-headline">Совет 36: Будьте естественны</span></h2>
<p>Избегайте «открытых» цветов при создании природных материалов Чистый или «открытый» цвет в природе встретить очень трудно, так как почти все естественные материалы являются цветовой смесью различных пропорций. Это значит, что совсем не обязательно делать, например, небо -. голубым, траву - зеленой, а помидор - красным, используя стопроцентные значения этих цветов. Пытайтесь смешивать краски и варьировать оттенки при создании материалов и текстурных карт, от этого ваши «трехмерные картины» только выиграют. 
</p>
<a name=".D0.A1.D0.BE.D0.B2.D0.B5.D1.82_.D0.90:_.D0.93.D0.BB.D1.8E.D0.BA.D0.B8_.D1.81_.D1.84.D0.BE.D1.80.D0.BC.D0.BE.D0.B9"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A1%D1%82%D1%80%D0%B0%D0%BD%D0%B0_%D1%81%D0%BE%D0%B2%D0%B5%D1%82%D0%BE%D0%B2_-_Max_%D0%B8_%D0%BD%D0%B5_%D1%82%D0%BE%D0%BB%D1%8C%D0%BA%D0%BE&amp;action=edit&amp;section=8" title="Страна советов - Max и не только">править</a>]</span> <span class="mw-headline">Совет А: Глюки с формой</span></h2>
<p>Некотрые плагины для преобразования моделей в форматы Блиц работают некорректно. Например, элипсоид полученный неравномерным масштабированием из сферы и помятый модификаторами, после экспорта оказывается снова сферой. Или анимация симетричной модели полученной зеркалом творит нечто невообразимое. В таком случае неоценимую помощь окажет встроенная утирлита ResetXForm (Utilities -молоточек справа вверху ). Естественно анимацию она не исправит, но если использовать вовремя (зеркало+ResetXForm ), то все будет в порядке. Нужно сказать несколько добрых слов насчет плагина B3DPipeline - там с этим все в порядке. И несколько неприятных слов в сторону PandaX - там эту утилиту нужно применять постоянно. 
</p>
<a name=".D0.A1.D0.BE.D0.B2.D0.B5.D1.82_.D0.91:_.D0.A1.D1.82.D1.83.D0.B4.D0.B8.D1.8F_.D1.80.D0.B0.D0.B7.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D1.87.D0.B8.D0.BA.D0.B0"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A1%D1%82%D1%80%D0%B0%D0%BD%D0%B0_%D1%81%D0%BE%D0%B2%D0%B5%D1%82%D0%BE%D0%B2_-_Max_%D0%B8_%D0%BD%D0%B5_%D1%82%D0%BE%D0%BB%D1%8C%D0%BA%D0%BE&amp;action=edit&amp;section=9" title="Страна советов - Max и не только">править</a>]</span> <span class="mw-headline">Совет Б: Студия разработчика</span></h2>
<p>Каждый разработчик, магистр или начинающий (причем последний в первую очередь), должен иметь соответствующий инструментарий - своеобразную студию разработчика. Не последней оказывается проблема выбора. На мой взгляд продать первую игру (ну хотя бы удивить подругу) вполне реально при следующем наборе (Не касаясь "железа").
</p>
<ul><li>Руки растущие из нужого места.
</li><li>Blitz3D+Tokamak+ArkonODE+FlashToUI+VisualBlitz IDE.
</li><li>3DStudioMax 6(пока)+B3DPipeline+PandaX+Combustion(или Photoshop для понимающих в нем )
</li><li>MSVisualStudio 7.1+ -еще никто не жаловался на время потраченное на изучение.
</li><li>Right Hemisphere DeepExploration 3+ - просмотровщик, конвертер 3D, 2D и т. д.
</li><li>Sony SoundForge, CubasisVST и VSThost - для звукового сопровождения
</li><li>Macromedia Flash MX 7+ для GUI и раскрутки проекта
</li><li>На этапе обучения игровой физике будет полезен RadishWorks Cosmos Creator - вещь дорогая, но безумно симпатичная
</li><li>Документацию и обзоры на разных языках (мне очень нравятся: Help по Blitz3D, журнал Blitz Et Cetera... Буржуйский Blitzcoder, русский форум и MSDN - майкрософтовский кладезь премудрости)
</li></ul>
<p><br />
</p>
<a name=".D0.A1.D0.BE.D0.B2.D0.B5.D1.82_.D0.92:_.D0.A4.D1.83.D0.BD.D0.BA.D1.86.D0.B8.D0.B8_Windows"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A1%D1%82%D1%80%D0%B0%D0%BD%D0%B0_%D1%81%D0%BE%D0%B2%D0%B5%D1%82%D0%BE%D0%B2_-_Max_%D0%B8_%D0%BD%D0%B5_%D1%82%D0%BE%D0%BB%D1%8C%D0%BA%D0%BE&amp;action=edit&amp;section=10" title="Страна советов - Max и не только">править</a>]</span> <span class="mw-headline">Совет В: Функции Windows</span></h2>
<p>Кому-то это может показаться смешным, но для меня было откровением то, что из Blitz3D можно вызывать некоторые Windows-функции без написания DLL в С/С++. Для этого нужно лишь задекларировать их в любом текстовом файле с расширением .decls и поместить его в папку USERLIBS.
</p><p>Как пример, могу предложить декларацию функции MessageBox, позволяющей в оконном режиме вывести диалоговое окно с сообщением похожим на RuntimeError но с большим количеством настроек и не завершающим программу после выхода из диалога.
<p>Итак, создаем в папке USERLIBS текстовый файл со следующей декларацией:
</p>
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">.lib <span style="color: #00ff66;">&quot;user32.dll&quot;</span><br />
MsgBox%<span style=" ">&#40;</span>HWND%,Message$,DialogTitle$,Parameters%<span style=" ">&#41;</span>:<span style="color: #00ff66;">&quot;MessageBoxA&quot;</span></div>
<p>Сохраняем файл с расширением .decls. Всё! Теперь в Blitz3D можно использовать функцию MsgBox хотя бы вот так:  
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">a=MsgBox<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span>,<span style="color: #00ff66;">&quot;Ну жми чего-нибудь!&quot;</span>,<span style="color: #00ff66;">&quot;Заголовок окна&quot;</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<p><span style="color: #aaffff; font-weight: bold;">If</span> a=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">Print</span> <span style="color: #00ff66;">&quot;Вышли, нажав OK&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> a=<span style="color: #33ffdd;">2</span> <span style="color: #aaffff; font-weight: bold;">Print</span> <span style="color: #00ff66;">&quot;Вышли, нажав ОТМЕНА или закрыв диалог&quot;</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">WaitKey</span></div>
<p>HWND - это идентификатор окна, которому принадлежит диалог. В общем случае его можно получить Windows функцией GetActiveWindow(), но обычно подходит HWND=0
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">.lib <span style="color: #00ff66;">&quot;user32.dll&quot;</span><br />
GetHWND%<span style=" ">&#40;</span><span style=" ">&#41;</span>:<span style="color: #00ff66;">&quot;GetActiveWindow&quot;</span></div>
<p>Parameters - устанавливает набор элементов окна диалога и кое-какие настройки. Может быть суммой значений из следующих групп (допустимо использовать только по одному параметру из каждой группы):
</p><p>Группа 1 - Кнопки (числа после знака равенства обозначают возвращаемое значение после нажатия этой кнопки). 
</p>
<ul><li>0 - OK=1
</li><li>1 - OK=1 и Повтор=2 
</li><li>2 - Прервать=3, Повтор=4, Пропустить=5 
</li><li>3 - Да=6, Нет=7, Отмена=2 
</li><li>4 - Да=6, Нет=7 
</li><li>5 - Повтор=4, Отмена=2 
</li><li>6 - Отмена=2, Повторить=10, Продолжить=11 
</li><li>Группа 2 - Иконки (... и соответствующий звуковой сигнал) 
</li><li>16 - <a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Advices01.png" class="image" title="Изображение:Advices01.png"><img alt="Изображение:Advices01.png" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Advices01.png" src="izbxi7h0.png" width="32" height="32" /></a>
</li><li>32 - <a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Advices02.png" class="image" title="Изображение:Advices02.png"><img alt="Изображение:Advices02.png" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Advices02.png" src="yl_v2up6.png" width="32" height="32" /></a>
</li><li>48 - <a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Advices03.png" class="image" title="Изображение:Advices03.png"><img alt="Изображение:Advices03.png" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Advices03.png" src="-prxhvb1-2.png" width="32" height="32" /></a>
</li><li>64 - <a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Advices04.png" class="image" title="Изображение:Advices04.png"><img alt="Изображение:Advices04.png" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Advices04.png" src="v50aqnkz.png" width="32" height="32" /></a>
</li></ul>
<p>Группа 3 - Фокус ввода (кнопки по умолчанию). 
</p>
<ul><li>0 - Первая кнопка 
</li><li>256 - Вторая кнопка 
</li><li>512- Третья кнопка 
</li></ul>
<p>Группа 4 - Модальность. 
</p>
<ul><li>0 - Поверх окна приложения 
</li><li>4096 - Поверх всех окон (критическая ошибка) 
</li></ul>
<p>Группа 5 - Прочие (Можно использовать вместе). 
</p>
<ul><li>65536 - Диалоговое окно принимает фокус (устанавливайте этот флаг для отладки в полноэкранном режиме. Функцию нужно вызывать со скобками. Но все равно глюков не избежать.) 
</li><li>524288 - Текст сообщения и заголовка выравнивается по правому краю 
</li><li>1048576 - Окно наоборот (для арабов)
</li></ul>
<hr />
<p>Автор: <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Alrusdi" title="Участник:Alrusdi">Александр Альрушди</a> (e-mail: ork@indus.ru)
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Видеопост"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Видеопост&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Видеопост&amp;action=edit">править</a>]</span><span class="mw-headline">Видеопост</span></h1>
<p>Видеопост - это такая вещь для конечного рендеринга, где можно переключать камеры, ставить некоторые эффекты и сразу
экспортить всё в файл(например .avi). Находится он в верхнем меню (где Files, Edit и др.) / Rendering / Video Post. Вот появилось меню: слева - список, справа - шкала и линии. Сначала в списке есть только Queue - это весь процесс рендеринга. Линия напротив него будет изменяться в зависимости от времени рендеринга камер. Нужно нажать на кнопку add scene event и добавить вид или камеру.
</p>
</p><p>Для переключения камер: Добавим так же ещё одну камеру. Примечание: "Бегунки" - это квадраты вначале и в конце линии одной из камер. Просто я не знал, как их по-другому обозвать. Теперь нужно перетащить первый бегунок второй камеры, например, на половину. То же самое делаем со вторым бегунком первой камеры. Для рендеринга нужно нажать на кнопку с бегущим типом. Но если нужен авишник или другое видео, тогда необходимо добавить Image output image, там параметры.
</p><p>И если нужен transition, например появление одного кадра из другого, то нужно выделить две камеры и добавить Image Layer Event. Там в опциях можно выбрать transition'ы из Adobe Acrobat Premier, если он есть, а то вот у меня он на другом винте, а другой винт на полке, а ставить - лень; Самый нормальный из собственных 3dМаксовских - Cross Fade Transition. После добавления необходимо перетащить его линию в место соприкосновения линий камер, так чтобы один его кусок лежал над или под линией первой камеры, а другой соответственно над/под второй. Бегунки тоже передвинуть, они время транзишона показывают.
</p><p>Для эффектов: Add image filter event, в нём setup и выбираешь эффект. Для начала Lens Effect Glow / Ok. Потом тыкаешь на него в списке два раза / setup. Там в Properties выбираешь Source /  Alpha и Filter /  Edge. В Prefernces / Color / Gradient. В Inferno, чтобы оно работало, нужно выбрать цвет в Setting 'е, также как в Photoshop 'е каналы - red, green, blue. Примерно так же работают и другие эффекты Lens, с остальными, думаю, несложно разобраться. Единственное что тут ещё неплохого, кроме Lens есть - это Starfield, Fade и SimpleWipe. Поэксперементировав с разными можно добиться класного эффекта.
</p>
<hr />
<p>Автор: Дмитрий Садченко (e-mail: master1m@narod.ru)
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Хумор: Пёрлы на GameDev.ru"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Хумор: Пёрлы на GameDev.ru&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Хумор: Пёрлы на GameDev.ru&amp;action=edit">править</a>]</span><span class="mw-headline">Хумор: Пёрлы на GameDev.ru</span></h1>
<p>Хумор: Пёрлы на GameDev.ru
</p>
</p>
<ul><li>Я пернулся на отчизну и опять стал старым добрым Кащеем.
</li><li>Я в кучу клал. И в конце цикла все удалял.
</li><li>Одна из моих последних работ - голова моего знакомого. 
</li><li>Это хайку или 3 предложения серьёзного содержания?
</li><li>Рисую в одно место несколько полигонов.
</li><li>Те спецы, которые есть на сайте, обсуждают свои специфические проблемы немного в других местах.
</li><li>Мне в 94-м было всего 11 лет, я тогда и человеком то не был.
</li><li>Как сделать след от пилы на теле старушки?
</li><li>Потом без пушов и попов и (внимание) без лоадов идентити рисуешь випон.
</li><li>Слышали о fillrate-friendly AI? Это когда в FPS все от тебя прячутся, чтобы снизить fillrate.
</li><li>Это когда в интеллект монстров зашито &lt;не кучковаться&gt; вокруг главного героя.
</li><li>Как сделать огонь на OpenGL? Я делаю так, но у меня не огонь.
</li><li>Экран увеличивается, но не сама форма, а весь монитор!
</li><li>... любой человеческий организм в здравом уме ...
</li><li>Учти такую фишку, в DirectX левосторонняя система координат, в D3D - правосторонняя.
</li><li>Как с помощью GDI взломать DirectX из под OpenGL?
</li><li>Как сделать так, чтобы прога делала что-то (Исходник)? 
</li><li>Первый блин всегда похож на сферу (иногда бывает и куб). 
</li><li>А по улице с плакатом бегать как-то не очень. У нас на Камчатке никто этим никогда не занимался, то ли дело в Москве.
</li><li>У моего брата мозга гораздо меньше, поэтому он себе придумал Gogaren.
</li><li>К вам в фирму приходит клиент, и дело в том, что я не знаю как должен вести себя стул, когда к нему он подходит.
</li><li>Можно еще плавающий массив создать.
</li><li>Долбаюся с директ инпукт.
</li><li>Требования поставлены совершенно неграммотны.
</li><li>Вся наша жизнь слишком неравномерная игра, у полюсов так вообще плотность вершин фантастическая.
</li><li>Например я рисую крестик, а он игнорирует вогнутые точки!!!
</li><li>Могут быть глюки, они могут быть всегда, когда руки растут.
</li><li>Если людям хочется сделать всё чужими руками, то такие руки отрывать надо!
</li><li>Q:Дык есть тута AI-сты? A:Детей захотелось?
</li><li>Сколько байт в килобите? - 1024.
</li><li>Надо создать ответственного за ФАК.
</li><li>Насчет HDR есть парочка ссылок в gamedev.netовском ФАКе. Читать интересно, но сам не пробовал.
</li><li>if (tex1!=tex2) {SendError(&lt;ваши тупые текстуры загрузили эту(%s) хрень 2 раза&gt;,File1)};
</li></ul>
<ul><li>S: Карты деньги два ствола ваще афигенный... и ваще, мне все тарантиновские фильмы нравяца
<ul><li>КДДС не тарантиновый
</li><li>ну и фиг, они все америкосы одинаковые
</li><li>он английский!
</li><li> да? ну и фиг, буржуи.
</li></ul>
</li></ul>
<ul><li>Во... номер мобильный себе замутил, 03, там раньше какие-то лохи были.
</li><li>Q:Какая разница куришь ты или нет, всё равно конец один?A:Разница в длине конца.
</li><li>Оформление сайта пока не закончено, но у нас все еще спереди.
</li><li>Я щас на пять сек отрублюсь на пять минут.
</li><li>Вы еще вспомните про шарп и вам поплохеет.
</li><li>Спасибо, теперь я программер.
</li></ul>
<hr />
<p>Автор: ARKON<br />
Прислал: <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Alrusdi" title="Участник:Alrusdi">Александр Альрушди</a> (e-mail: ork@indus.ru)
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Конкурс! (выпуск 4)"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Конкурс! (выпуск 4)&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Конкурс! (выпуск 4)&amp;action=edit">править</a>]</span><span class="mw-headline">Конкурс! (выпуск 4)</span></h1>
</p>
<a name="Adventure_Fever"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9A%D0%BE%D0%BD%D0%BA%D1%83%D1%80%D1%81%21_%28%D0%B2%D1%8B%D0%BF%D1%83%D1%81%D0%BA_4%29&amp;action=edit&amp;section=1" title="Конкурс! (выпуск 4)">править</a>]</span> <span class="mw-headline">Adventure Fever</span></h2>
<p>Создайте свою текстовую адвентюру (воспользуйтесь алгоритмом из соответствующей статьи). Итоги будут подведены 20 августа. Вы можете присылать также работы на темы из предыдущего выпуска - они будут опубликованы.
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="В следующем выпуске (выпуск 4)"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:В следующем выпуске (выпуск 4)&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=В следующем выпуске (выпуск 4)&amp;action=edit">править</a>]</span><span class="mw-headline">В следующем выпуске (выпуск 4)</span></h1>
<p>Ориентировочный срок выхода 5-го номера журнала - август 2005г. Планируются статьи о создании изометрического движка, о более продвинутой системе хранения и манипуляций объектами игрового мира, а также туториал по моделированию в 3DSMax и MilkShape. Возможно, будет статья о адаптивной деградации типа морфинг.
</p>
</p>
<p align="right">
редактор журнала Матвей Меркулов (MattMerk@mail.ru, ICQ: 392-274-050)
</p>
<p><!-- 
Pre-expand include size: 348568 bytes
Post-expand include size: 288638 bytes
Template argument size: 247 bytes
Maximum: 2097152 bytes
-->
</p>
<!-- Saved in parser cache with key db1:pcache:idhash:607-0!1!0!!ru!2 and timestamp 20071112103429 -->
<div class="printfooter">
Получено с <a href="e1jffhoo.html">http://blitzetcetera.org/index.php/%D0%92%D1%8B%D0%BF%D1%83%D1%81%D0%BA_%E2%84%964_-_%D0%B8%D1%8E%D0%BD%D1%8C_2005</a></div>
			<!-- end content -->			<div class="visualClear"></div>				</td>				<td class="rightside">				</td>			</tr>		</table>		</div>	</div>		</div>	
		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
</div></body>
<!-- Mirrored from localhost/index.php/%D0%92%D1%8B%D0%BF%D1%83%D1%81%D0%BA_%E2%84%964_-_%D0%B8%D1%8E%D0%BD%D1%8C_2005 by HTTrack Website Copier/3.x [XR&CO'2007], Mon, 12 Nov 2007 11:20:32 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
</html>