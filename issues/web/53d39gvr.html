<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru" dir="ltr">	
<!-- Mirrored from localhost/index.php/%D0%92%D1%8B%D0%BF%D1%83%D1%81%D0%BA_%E2%84%962_-_%D1%84%D0%B5%D0%B2%D1%80%D0%B0%D0%BB%D1%8C_2005 by HTTrack Website Copier/3.x [XR&CO'2007], Mon, 12 Nov 2007 11:20:34 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
<head>		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />				<meta name="keywords" content="Выпуск №2 - февраль 2005,MANIAK dobrii,Matt Merkulov,Tolking" />
		<link rel="shortcut icon" href="http://blitzetcetera.org/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="http://blitzetcetera.org/opensearch_desc.php" title="Blitz Et Cetera (Русский)" />
		<title>Выпуск №2 - февраль 2005 — Blitz Et Cetera</title>		<style type="text/css" media="screen,projection">/*<![CDATA[*/ @import "bvih5rde.css?63"; /*]]>*/</style>		<link rel="stylesheet" type="text/css" media="print" href="gcxktlm6.css?63" />		<link rel="stylesheet" type="text/css" media="handheld" href="zumsslq_.css?63" />		<!--[if lt IE 5.5000]><style type="text/css">@import "/skins/OfflineNew/IE50Fixes.css?63";</style><![endif]-->		<!--[if IE 5.5000]><style type="text/css">@import "/skins/OfflineNew/IE55Fixes.css?63";</style><![endif]-->		<!--[if IE 6]><style type="text/css">@import "/skins/OfflineNew/IE60Fixes.css?63";</style><![endif]-->		<!--[if IE 7]><style type="text/css">@import "/skins/OfflineNew/IE70Fixes.css?63";</style><![endif]-->		<!--[if lt IE 7]><script type="text/javascript" src="/skins/common/IEFixes.js?63"></script>		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->		<script type= "text/javascript">/*<![CDATA[*/
var skin = "OfflineNew";
var stylepath = "/skins";
var wgArticlePath = "/index.php/$1";
var wgScriptPath = "";
var wgServer = "http://blitzetcetera.org/";
var wgCanonicalNamespace = "";
var wgCanonicalSpecialPageName = false;
var wgNamespaceNumber = 0;
var wgPageName = "Выпуск_№2_-_февраль_2005";
var wgTitle = "Выпуск №2 - февраль 2005";
var wgAction = "view";
var wgArticleId = "453";
var wgIsArticle = true;
var wgUserName = null;
var wgUserGroups = null;
var wgUserLanguage = "ru";
var wgContentLanguage = "ru";
var wgBreakFrames = false;
var wgCurRevisionId = "3639";
/*]]>*/</script>
		<script type="text/javascript" src="2nq-6cel.js?63"><!-- wikibits js --></script>		<script type="text/javascript" src="http://blitzetcetera.org/index.php?title=-&amp;action=raw&amp;gen=js"><!-- site js --></script>		<style type="text/css">/*<![CDATA[*/
@import "http://blitzetcetera.org/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://blitzetcetera.org/index.php?title=MediaWiki:OfflineNew.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://blitzetcetera.org/index.php?title=-&amp;action=raw&amp;gen=css&amp;maxage=18000";
/*]]>*/</style>		<!-- Head Scripts -->	</head><body  class="mediawiki ns-0 ltr page-Выпуск_№2_-_февраль_2005">	<div id="globalWrapper">	<div id="logocontainer">		<table align="center">		  <tr>				<td id="blitzetclogo">				</td>			</tr>		</table>	</div>	<div id="magbar">	Журнал о программированнии на языках Blitz3D, BlitzMax, BlitzPlus	</div>		<div id="column-content">	<div id="content">		<a name="top" id="top"></a>				<div id="bodyContent">		<table cellspacing=0 cellpadding=0 width=100%>			<tr>			  <td class="leftside">				</td>				<td class="sheetbody">					<h1 class="sheet">Выпуск №2 - февраль 2005</h1>			<h3 id="siteSub">Материал из Blitz Et Cetera.</h3>			<div id="contentSub"></div>			<!-- start content -->			<a name="Contents"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%92%D1%8B%D0%BF%D1%83%D1%81%D0%BA_%E2%84%962_-_%D1%84%D0%B5%D0%B2%D1%80%D0%B0%D0%BB%D1%8C_2005&amp;action=edit&amp;section=1" title="Править секцию: Contents">править</a>]</span> <span class="mw-headline">Contents</span></h2>
<ul><li>Вступление
<ul><li><a href="#Предисловие редактора (выпуск 2)">Предисловие редактора (выпуск 2)</a>
</li><li><a href="#Почта (выпуск 2)">Почта (выпуск 2)</a>
</li></ul>
</li><li>Обзор
<ul><li><a href="#Галерея: Silmarils">Галерея: Silmarils</a> - <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Matt_Merkulov" title="Участник:Matt Merkulov">Матвей Меркулов</a> 
</li></ul>
</li><li>Тонкости кодинга
<ul><li><a href="#Рекурсивное программирование">Рекурсивное программирование</a> - Ghost Dancer, перевел <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:MANIAK_dobrii" title="Участник:MANIAK dobrii">MANIAK dobrii</a> 
</li><li><a href="#Создай свой скринсейвер">Создай свой скринсейвер</a> - Grisu, перевел <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:MANIAK_dobrii" title="Участник:MANIAK dobrii">MANIAK dobrii</a> 
</li><li><a href="#Скорость команд в Blitz3D">Скорость команд в Blitz3D</a> - <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Matt_Merkulov" title="Участник:Matt Merkulov">Матвей Меркулов</a> 
</li></ul>
</li><li>Другой формат
<ul><li><a href="#Tokamak DLL">Tokamak DLL</a> - перевел Amir 
</li><li><a href="#Базы данных: формат DBF">Базы данных: формат DBF</a> - <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Matt_Merkulov" title="Участник:Matt Merkulov">Матвей Меркулов</a> 
</li></ul>
</li><li>Занимательная математика
<ul><li><a href="#Кубическая интерполяция">Кубическая интерполяция</a> - <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Matt_Merkulov" title="Участник:Matt Merkulov">Матвей Меркулов</a> 
</li><li><a href="#Четырехмерная геометрия">Четырехмерная геометрия</a> - <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Matt_Merkulov" title="Участник:Matt Merkulov">Матвей Меркулов</a> 
</li></ul>
</li><li>Разработки
<ul><li><a href="#Эксперименты с «Жизнью»">Эксперименты с «Жизнью»</a> - <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Matt_Merkulov" title="Участник:Matt Merkulov">Матвей Меркулов</a> 
</li><li><a href="#Виртуальный художник: деформация">Виртуальный художник: деформация</a> - <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Matt_Merkulov" title="Участник:Matt Merkulov">Матвей Меркулов</a> 
</li></ul>
</li><li>Свободный полет
<ul><li><a href="#Курс молодого бойца, часть 2: теоретическая подготовка">Курс молодого бойца, часть 2: теоретическая подготовка</a> - <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Tolking" title="Участник:Tolking">Роман Прядко</a> 
</li></ul>
</li><li>В заключение
<ul><li><a href="#В следующем выпуске (выпуск 2)">В следующем выпуске (выпуск 2)</a>
</li></ul>
</li></ul>
<p></td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Предисловие редактора (выпуск 2)"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Предисловие редактора (выпуск 2)&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Предисловие редактора (выпуск 2)&amp;action=edit">править</a>]</span><span class="mw-headline">Предисловие редактора (выпуск 2)</span></h1>
<p>Здравствуйте, господа читатели. Вот перед Вами второй выпуск журнала. Как видите, в нем целых 10 статей о программировании, из которых 6 написаны мной. Оказалось, что для того, чтобы написать статью, которая охватывает большинство аспектов темы более-менее полно, требуется больше времени и сил, чем я ожидал (поэтому я чертовски устал). Масса времени ушла на шлифовку html-кода. К тому же, я не особо люблю бороздить Интернет в поисках новостей, делать детальные описания программ и писать обзорные статьи (подозреваю, многие из Вас - тоже). В результате, второй номер получился несколько однобоким. В следующем выпуске, надеюсь, ситуация изменится - планирую уделять больше внимания другим темам.
</p>
</p><p>Sefirot предложил новый дизайн. Я встроил возможность выбора дизайнов также и в первый выпуск. Пока остается некоторая несовместимость с другими браузерами.
</p><p>Раздел "Новости" пока закрыт. Я покамест не в курсе происходящего в англоязычных комьюнити, а в русскоязычных новости пока ограничиваются скупыми аннотациями к проектам. Если у Вас есть чем поделиться, присылайте информацию о происходящих событиях в мире Blitz (в том числе и о Ваших планах). 
</p><p>Раздел "Обзоры" тоже отсутствует. Не хватает информации и желания ее искать. Однако, есть масса тем: обзор сайтов, библиотек, проектов, коммерческих и некоммерческих продуктов, а также фирм, производящих программы на Blitz.
</p><p>Как уже упоминалось, "Программирование" на первом месте: масса алгоритмов и программ. Неплохой вклад в этот выпуск внес MANIAK_dobrii, который продолжает заниматься переводом англоязычных статей. Amir перевел статью о физическом движке Tokamak.
</p><p>В "Свободном Полете" сегодня статья Романа Прядко, который продолжает свой масштабный труд, а также раздел "Галерея", где представлена фирма "Silmarils".
</p><p>В приложении к февральскому выпуску - замечательный учебник Скавена по Blitz3D
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Почта (выпуск 2)"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Почта (выпуск 2)&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Почта (выпуск 2)&amp;action=edit">править</a>]</span><span class="mw-headline">Почта (выпуск 2)</span></h1>
</p>
<a name=".D0.9F.D0.B8.D1.81.D1.8C.D0.BC.D0.BE_.D0.BE.D1.82_.D0.9A.D0.BE.D0.BD.D1.81.D1.82.D0.B0.D0.BD.D1.82.D0.B8.D0.BD.D0.B0_.D0.A7.D1.83.D1.80.D0.B8.D0.BB.D0.BE.D0.B2.D0.B0"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9F%D0%BE%D1%87%D1%82%D0%B0_%28%D0%B2%D1%8B%D0%BF%D1%83%D1%81%D0%BA_2%29&amp;action=edit&amp;section=1" title="Почта (выпуск 2)">править</a>]</span> <span class="mw-headline">Письмо от Константина Чурилова</span></h2>
<p>Привет.
</p><p>Очень классный получился выпуск. Красиво оформленный, хорошие статьи. Пару пожеланий&nbsp;:
</p>
<ul><li>В самом теле журнала разделять статьи, относящиеся к разным разделам.
</li><li>Четче названия статей определять. (например Виртуальный художник: палитра не совсем правильно отражает содержание)
</li></ul>
<p><br />
</p>
<hr />
<p>Привет
</p><p><br />
</p>
<ul><li>Без проблем! Думаю лучше всего будет сделать "разрывы" (прим.ред. - этим займусь немного позже).
</li><li>Да, тут я перепутал малость (привык с палитрой работать).
</li></ul>
<p><br />
С уважением,
&nbsp;Матвей Меркулов
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Галерея: Silmarils"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Галерея: Silmarils&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Галерея: Silmarils&amp;action=edit">править</a>]</span><span class="mw-headline">Галерея: Silmarils</span></h1>
<p>Сегодня я хочу рассказать о великолепной фирме Silmarils, основанной французами Мишелем Перноттом и Паскалем Эйнцвеллером.. Эти люди заслужили глубокое уважение многих игроманов (мое в том числе) за свои неоднократные революционные прорывы в области концепций и сюжета игр. Многие их разработки и по сей день являются уникальными. Silmarils всегда смело шагали в неизвестность, несмотря на риск оказаться непонятыми и лишиться прибыли. Название фирмы взято из Вселенной Толкиена, это три магических камня.
</p>
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Silmarils01.png" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Silmarils01.png" src="bg2dvj4l.png" width="320" height="200" /></a></span></div></div>
<p>Золотой Век Сильмариллов начался с выходом серии игр-"ходилок", где главный герой перемещался по экранам, сражался с врагами, использовал предметы, решал головоломки. Сначала были Targhan - о приключениях варвара, Colorado - про конкистадора, блуждающего в диких лесах Америки, Starblade - о пилоте звездолета, путешествующего по звездным мирам, и, наконец, блистательный Metal Mutant - футуристическая сага о миссии металлического трансформирующегося киборга. Все эти работы отличаются оригинальностью и неожиданными поворотами сюжета. Велик и разнообразен мир, по которому перемещается главный герой.
</p>
<center>
<p><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Silmarils02.png" class="image" title="Metal Mutant"><img alt="Metal Mutant" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Silmarils02.png" src="chb6mdf-.png" width="320" height="200" /></a>
<a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Silmarils03.png" class="image" title="Metal Mutant"><img alt="Metal Mutant" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Silmarils03.png" src="ry3ntk46.png" width="320" height="200" /></a>
<a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Silmarils04.png" class="image" title="Targhan"><img alt="Targhan" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Silmarils04.png" src="6pmu7etw.png" width="320" height="200" /></a>
</p><p><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Silmarils05.png" class="image" title="StarBlade"><img alt="StarBlade" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Silmarils05.png" src="chb6mdf-3.png" width="320" height="200" /></a>
<p><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Silmarils06.png" class="image" title="Colorado"><img alt="Colorado" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Silmarils06.png" src="59q6l4-a.png" width="320" height="200" /></a>
</p>
</p>
</center>
<p>Также, фирма приложила значительные усилия в создании ролевых игр. Часть из них, такие как Crystals Of Arborea и серия игр Ishar основаны на базе правил AD&amp;D, они также поражают игрока красотой, оригинальностью и разнообразием игрового мира. Но есть и еще игры, не имеющие аналогов. Это Arctic Baron, где действие происходит на обледенелой поверхности планеты Земля после глобального катаклизма. Вы - хозяин поезда - единственного надежного транспорта в этом новом мире. Нужно ездить между городами, торговать, оснащать поезд и выполнять миссии. Но самая, на мой взгляд, замечательная ролевая игра Сильмариллов - Robinson's Requiem. Пилот звездолета после крушения попадает на малоисследованную планету, где он должен выжить - найти источники пропитания, сшить себе одежду, сделать оружие для защиты от врагов, продвигаясь по трехмерным ландшафтам, соединенным пещерами. Но все не так просто - герой стал жертвой жестокой программы исследования новых миров и теперь его задача - собрать "сезамы" остальных исследователей, заброшенных на эту планету - персональные приборы, записывающие информацию об окружающем мире. Они смогут снять защиту с базы, охраняемой роботами, где находится спасительный звездолет. Практически все на этой планете представляет угрозу: стреляет, режет, колет копьями, кусается, пытается выклевать глаза, отравить, поломать кости, разорвать. Даже природа не на Вашей стороне - можно разбиться, упав с высоты, замерзнуть в ледяных пещерах, утонуть в болоте, умереть от жары, простая вода убьет вас, если ее не продезинфицировать. В общем, если заинтересуетесь - масса впечатлений обеспечена.
</p>
<center>
<p><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Silmarils07.jpg" class="image" title="Arctic Baron"><img alt="Arctic Baron" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Silmarils07.jpg" src="zuu02egc.jpg" width="220" height="170" /></a>
<a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Silmarils08.jpg" class="image" title="Asghan"><img alt="Asghan" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Silmarils08.jpg" src="_kcjdxrj.jpg" width="220" height="170" /></a>
<a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Silmarils09.jpg" class="image" title="Ishar 1"><img alt="Ishar 1" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Silmarils09.jpg" src="mo7ktyce.jpg" width="220" height="170" /></a>
<a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Silmarils10.jpg" class="image" title="Ishar 2"><img alt="Ishar 2" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Silmarils10.jpg" src="eyby7eit-2.jpg" width="220" height="170" /></a>
</p>
</center>
<p>Также фирма выпустила много игр других жанров.
</p>
<hr />
<p>Автор: <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Matt_Merkulov" title="Участник:Matt Merkulov">Матвей Меркулов</a> (E-mail: MattMerk@mail.ru, ICQ: 392-274-050)
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Рекурсивное программирование"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Рекурсивное программирование&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Рекурсивное программирование&amp;action=edit">править</a>]</span><span class="mw-headline">Рекурсивное программирование</span></h1>
<p>Предполагается, что ты уже понимаешь основные Блитзовские функции и программный поток.(Оператор If, циклы For...Next; While...Wend и т.п. )
</p>
</p>
<a name=".D0.A7.D1.82.D0.BE_.D1.82.D0.B0.D0.BA.D0.BE.D0.B5_.D1.80.D0.B5.D0.BA.D1.83.D1.80.D1.81.D0.B8.D1.8F.3F"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A0%D0%B5%D0%BA%D1%83%D1%80%D1%81%D0%B8%D0%B2%D0%BD%D0%BE%D0%B5_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5&amp;action=edit&amp;section=1" title="Рекурсивное программирование">править</a>]</span> <span class="mw-headline">Что такое рекурсия?</span></h2>
<p>Проще говоря, рекурсия - это когда функция вызывает саму себя, пока не произойдет какое-нибудь условие. С каждым новым вызовом, она будет менять один или более параметров, зависящих от их текущих значений. Ничего не понял??? Это дело проще всего объясняется простым примером&nbsp;:
</p>
<a name=".D0.9F.D1.80.D0.BE.D1.81.D1.82.D0.BE.D0.B9_.D0.BF.D1.80.D0.B8.D0.BC.D0.B5.D1.80_-_.D0.A4.D1.83.D0.BD.D0.BA.D1.86.D0.B8.D1.8F_.D1.84.D0.B0.D0.BA.D1.82.D0.BE.D1.80.D0.B8.D0.B0.D0.BB.D0.B0"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A0%D0%B5%D0%BA%D1%83%D1%80%D1%81%D0%B8%D0%B2%D0%BD%D0%BE%D0%B5_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5&amp;action=edit&amp;section=2" title="Рекурсивное программирование">править</a>]</span> <span class="mw-headline">Простой пример - Функция факториала</span></h2>
<p>Мы будем писать функцию, которая будет возвращать факториал определенного числа. Факториал числа (n), это про произведение всех целых чисел от 1 до n. Например: Факториал 5 = 1 x 2 x 3 x 4 x 5, что равно 120. Не беспокойся сильно об этом, ведь дело не в том, ЧТО мы делаем, а КАК мы это делаем. Если мы будем писать функцию факториала по стандартному пути, то у нас получится что-то вроде этого:  
</p>
<div class="bmx" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#01516B;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffff00; font-weight: bold;">Print</span> factorial<span style=" ">&#40;</span><span style="color: #FFFFFF;">5</span><span style=" ">&#41;</span><br />
<p><br />
<span style="color: #ffff00; font-weight: bold;">Function</span> factorial<span style=" ">&#40;</span>number<span style=" ">&#41;</span><br />
&nbsp;<span style="color: #ffff00; font-weight: bold;">For</span> n = <span style="color: #FFFFFF;">1</span> <span style="color: #ffff00; font-weight: bold;">To</span> number<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">If</span> n = <span style="color: #FFFFFF;">1</span> <span style="color: #ffff00; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;result = <span style="color: #FFFFFF;">1</span><br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">Else</span><br />
&nbsp; &nbsp;result = n * result<br />
&nbsp; <span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #ffff00; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #ffff00; font-weight: bold;">Return</span> result<br />
</p>
<span style="color: #ffff00; font-weight: bold;">End</span> <span style="color: #ffff00; font-weight: bold;">Function</span></div>
<p>Используя рекурсию, наш код будет выглядеть так:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Print</span> factorial<span style=" ">&#40;</span><span style="color: #33ffdd;">5</span><span style=" ">&#41;</span><br />
<p><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> factorial<span style=" ">&#40;</span>n<span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> n = <span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Return</span> <span style="color: #33ffdd;">1</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Return</span> n * factorial<span style=" ">&#40;</span>n - <span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<p>Большой разницы между двумя видами функций нет, зато это показывает технику рекурсии.
</p>
<a name=".D0.9D.D1.83_.D0.B8_.D0.BA.D0.B0.D0.BA_.D1.8D.D1.82.D0.BE_.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D0.B0.D0.B5.D1.82.3F"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A0%D0%B5%D0%BA%D1%83%D1%80%D1%81%D0%B8%D0%B2%D0%BD%D0%BE%D0%B5_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5&amp;action=edit&amp;section=3" title="Рекурсивное программирование">править</a>]</span> <span class="mw-headline">Ну и как это работает?</span></h3>
<p>Рекурсия просто заменила цикл For n=1 to number...Next . Если мы будем проверять, что происходит на каждом шагу, то мы увидим:
</p><p>возвращает значение 5 * factorial(4)
</p>
<p><dl><dd>factorial(4)  возвращает значение 4 * factorial(3)
<dl><dd>возвращает значение 3 * factorial(2)
<dl><dd>возвращает значение 2 * factorial(1)
<dl><dd>factorial(1)  просто возвращает 1 и больше не вызывает функцию factorial()
</dd></dl>
</dd></dl>
</dd></dl>
</dd></dl>
</p>
<p>Надеюсь, Ты начинаешь понимать процесс. Чтобы  разобраться со всем этим делом получше, можно проследить происходящее с зада на перед, так мы сможем узнать значения, которые получаются при каждом вызове функции и понять, как достигается конечный результат:
</p>
<p><dl><dd><dl><dd><dl><dd><dl><dd>factorial(1) = 1
</dd></dl>
</dd><dd>factorial(2)  = 2 x 1 = 2, 1 - это значение, полученное из factorial(1)
</dd></dl>
</dd><dd>factorial(3)  = 3 x 2 = 6, 2 - это значение, полученное из factorial(2)
</dd></dl>
</dd><dd>factorial(4)  = 4 x 6 = 24, 6 - это значение, полученное из factorial(3)
</dd></dl>
</p>
<p>factorial(5)  = 5 x 24 = 120, 24 - это значение, полученное из factorial(4)
</p>
<a name=".D0.91.D0.B5.D1.81.D0.BA.D0.BE.D0.BD.D0.B5.D1.87.D0.BD.D0.BE.D1.81.D1.82.D1.8C:_.D0.BD.D0.B5_.D0.BA.D0.B0.D1.82.D0.B8.D1.82.21"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A0%D0%B5%D0%BA%D1%83%D1%80%D1%81%D0%B8%D0%B2%D0%BD%D0%BE%D0%B5_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5&amp;action=edit&amp;section=4" title="Рекурсивное программирование">править</a>]</span> <span class="mw-headline">Бесконечность: не катит!</span></h2>
<p>В вышеприведенном примере ты заметил, что функция зовет себя, только если n  не равно 1 и, так как n всегда уменьшается, мы знаем, что будет конечное число вызовов. Однако если не впихнуть это условие, то функция будет звать себя бесконечное число раз и Blitz скажет тебе тихим и поставленным голосом: "Stack Overflow" .
</p><p>Советую всегда вставлять такие условия в рекурсивные функции, чтобы они звали себя максимальное количество раз(а не бесконечное). Это показано в следующем примере: 
</p>
<a name="A_.D0.9D.D0.B0.D0.B2.D0.BE.D1.80.D0.BE.D1.87.D0.B5.D0.BD.D0.BD.D1.8B.D0.B9_.D0.BF.D1.80.D0.B8.D0.BC.D0.B5.D1.80_-_.D0.9A.D0.BE.D0.B2.D0.B5.D1.80_.D0.A1.D0.B5.D1.80.D0.BF.D0.B8.D0.BD.D1.81.D0.BA.D0.BE.D0.B3.D0.BE.28Sierpinski.29"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A0%D0%B5%D0%BA%D1%83%D1%80%D1%81%D0%B8%D0%B2%D0%BD%D0%BE%D0%B5_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5&amp;action=edit&amp;section=5" title="Рекурсивное программирование">править</a>]</span> <span class="mw-headline">A Навороченный пример - Ковер Серпинского(Sierpinski)</span></h2>
<p>Мы изучили основы, пора бы забабахать что-нибудь поинтересней. Ковер Серпинского назван так в честь польского математика:
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Recursion01.gif" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Recursion01.gif" src="a48133mu.gif" width="304" height="304" /></a></span></div></div>
<p>"Чё за?" - спросишь ты, но не волнуйся, мы разобьем процесс создания этого чуда на простенькие кусочки и разберем каждый из них. 
</p>
<a name=".D0.A1.D1.85.D0.B5.D0.BC.D0.B0_.D0.BF.D0.BE.D1.81.D1.82.D1.80.D0.BE.D0.B5.D0.BD.D0.B8.D1.8F_.D0.BA.D0.BE.D0.B2.D1.80.D0.B0_.D0.A1.D0.B5.D1.80.D0.BF.D0.B8.D0.BD.D1.81.D0.BA.D0.BE.D0.B3.D0.BE."></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A0%D0%B5%D0%BA%D1%83%D1%80%D1%81%D0%B8%D0%B2%D0%BD%D0%BE%D0%B5_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5&amp;action=edit&amp;section=6" title="Рекурсивное программирование">править</a>]</span> <span class="mw-headline">Схема построения ковра Серпинского.</span></h3>
<ul><li>Шаг 1. Начнем с рисования белого, закрашенного квадрата размером с наш ковер.
</li><li>Шаг 2. Поделим этот квадрат на 9 равных квадратиков и закрасим средний черным цветом.
</li><li>Шаг 3. Повторим Шаг 2 для оставшихся восьми квадратиков. Каждая итерация (повторение) создаст 9 квадратиков поменьше вокруг "родителя".
</li></ul>
<p>Диаграмма внизу показывает 3 итерации. Заготовка растет экспоненциально на каждом уровне.
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Recursion02.gif" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Recursion02.gif" src="o_vezkpg.gif" width="304" height="119" /></a></span></div></div>
<ul><li>Итак, на первом куске диаграммы мы поделили квадрат на девять равных квадратов и закрасили центральный черным цветом
</li><li>После следующей итерации(2-ой кусок диаграммы) у нас появилось ещё 8 черных квадратиков вокруг здорового, полученного после первой итерации.
</li><li>Ну а после третей итерации(3-ий кусок диаграммы) появляется по 8 квадратиков для каждого из восьми квадратов, полученных после 2-ой итерации.
</li></ul>
<p>Надеюсь, ты понял, как это всё получается. Позырим теперь, как оно делается: А теперь КОД!
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffee00">;устанавливаем экран и высчитываем его центр</span><br />
<p><span style="color: #aaffff; font-weight: bold;">Const</span> screenWidth = <span style="color: #33ffdd;">800</span>, screenHeight = <span style="color: #33ffdd;">600</span><br />
<span style="color: #aaffff; font-weight: bold;">Graphics</span> screenWidth, screenHeight, <span style="color: #33ffdd;">16</span>, <span style="color: #33ffdd;">2</span><br />
centerX = screenWidth / <span style="color: #33ffdd;">2</span><br />
centerY = screenHeight / <span style="color: #33ffdd;">2</span><br />
<br />
<span style="color: #ffee00">;Задаем размер ковра и порог для рекурсивной фунуции</span><br />
<span style="color: #aaffff; font-weight: bold;">Const</span> carpetSize = <span style="color: #33ffdd;">600</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffee00">;задаем размер ковра</span><br />
<span style="color: #aaffff; font-weight: bold;">Const</span> threshold = <span style="color: #33ffdd;">4</span>&nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffee00">;задаем порог рекурсии</span><br />
<br />
<span style="color: #ffee00">;Рисуем белый квадрат посередине экрана, размером с ковер</span><br />
offset = carpetSize / <span style="color: #33ffdd;">2</span><br />
<span style="color: #aaffff; font-weight: bold;">Rect</span> centerX - offset, centerY - offset, carpetSize, carpetSize<br />
<br />
<span style="color: #ffee00">;ставим цвет рисования черным и приступаем к рекурсии...</span><br />
<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">0</span>, <span style="color: #33ffdd;">0</span>, <span style="color: #33ffdd;">0</span><br />
carpet<span style=" ">&#40;</span>centerX, centerY, carpetSize, threshold<span style=" ">&#41;</span><br />
<br />
<span style="color: #ffee00">;СЁ, готово! После нажатия на любую кнопку прога завершается </span><br />
<span style="color: #aaffff; font-weight: bold;">WaitKey</span><br />
<span style="color: #aaffff; font-weight: bold;">End</span><br />
<br />
<br />
&nbsp;<br />
<span style="color: #ffee00">;рекурсивная функция</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> carpet<span style=" ">&#40;</span>x, y, size, threshold<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; newSize = size / <span style="color: #33ffdd;">3</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffee00">;1/3 предыдущего размера</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; offset = newSize / <span style="color: #33ffdd;">2</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffee00">;новое значение отступа</span><br />
<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffee00">;рисуем черный квадрат в центре(это и есть &quot;родитель&quot;, центральный)</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Rect</span> x - offset, y - offset, newSize, newSize<br />
<br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> threshold &gt; <span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; newThreshold = threshold - <span style="color: #33ffdd;">1</span>&nbsp; &nbsp; <span style="color: #ffee00">;уменяшаем порог - не забудь про это!</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ffee00">;зовем функцию ковра 8 раз для каждого квадратика вокруг центрального </span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; carpet<span style=" ">&#40;</span>x - newSize, y - newSize, newSize, newThreshold<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; carpet<span style=" ">&#40;</span>x, y - newSize, newSize, newThreshold<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; carpet<span style=" ">&#40;</span>x + newSize, y - newSize, newSize, newThreshold<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; carpet<span style=" ">&#40;</span>x + newSize, y, newSize, newThreshold<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; carpet<span style=" ">&#40;</span>x + newSize, y + newSize, newSize, newThreshold<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; carpet<span style=" ">&#40;</span>x, y + newSize, newSize, newThreshold<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; carpet<span style=" ">&#40;</span>x - newSize, y + newSize, newSize, newThreshold<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; carpet<span style=" ">&#40;</span>x - newSize, y, newSize, newThreshold<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<a name=".D0.9A.D0.B0.D0.BA_.D0.BE.D0.BD.D0.BE_.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D0.B0.D0.B5.D1.82.3F"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A0%D0%B5%D0%BA%D1%83%D1%80%D1%81%D0%B8%D0%B2%D0%BD%D0%BE%D0%B5_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5&amp;action=edit&amp;section=7" title="Рекурсивное программирование">править</a>]</span> <span class="mw-headline">Как оно работает?</span></h3>
<p>Каждый раз, когда вызывается функция, рисуется новый квадрат и запрашивается 4 переменные: позиция по x&amp;y нового квадрата, его размер (это будет размер всего ковра, если функция вызывается первый раз) и текущий порог рекурсии.
</p>
<ul><li>Для начала функции надо поделить текущий квадрат (определяется параметром size) на 9 равных квадратов, чтобы закрасить центральный. Делается это делением size на 3. Т.к. мы знаем позицию центра, мы легко можем закрасить центральный квадрат. Обрати внимание, как значение offset используется при рисовании квадрата.
</li><li>После этого нужно проверить значение порога рекурсии.
</li><li>Если мы достигли порога (threshold = 0), то мы закончили. В обратном случае мы ставим новое значение порога. Затем просто зовем функцию 8 раз, используя новые значения size и threshold. Нам также необходимо определить новые значения x и y для оставшихся 8-ми квадратов.
</li></ul>
<a name=".D0.9E.D0.B3.D1.80.D0.B0.D0.BD.D0.B8.D1.87.D0.B5.D0.BD.D0.B8.D1.8F"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A0%D0%B5%D0%BA%D1%83%D1%80%D1%81%D0%B8%D0%B2%D0%BD%D0%BE%D0%B5_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5&amp;action=edit&amp;section=8" title="Рекурсивное программирование">править</a>]</span> <span class="mw-headline">Ограничения</span></h2>
<p>Как объяснялось выше, должно быть конечное число итераций рекурсивных функций, чтобы получалось то, что тебе нужно сделать. Я бы не рекомендовал ставить порог рекурсии более нескольких тысяч.
</p>
<a name=".D0.92.D1.8B.D0.B2.D0.BE.D0.B4.3F"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A0%D0%B5%D0%BA%D1%83%D1%80%D1%81%D0%B8%D0%B2%D0%BD%D0%BE%D0%B5_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5&amp;action=edit&amp;section=9" title="Рекурсивное программирование">править</a>]</span> <span class="mw-headline">Вывод?</span></h2>
<p>Как и у многих вещей в жизни, у рекурсии есть много преимуществ, но она не всегда является лучшим решением.  Некоторые люди советуют избегать всего этого, но я считаю, что рекурсия является лучшим решением для многих проблем. В конце концов, это тебе решать - юзать рекурсию или нет. Некоторые из нас юзают, а некоторые - нет.
</p><p>Хорошо провести время.:
</p>
<div align="right"><a href="http://blitzetcetera.org/images/f/fd/Recursion.zip" class="internal" title="Recursion.zip">скачать архив с файлами к статье</a></div>
<hr />
<p>Автор: Ghost Dancer (e-mail: ghost@aurora-soft.co.uk, сайт: <a href="http://www.aurora-soft.co.uk/" class="external free" title="http://www.aurora-soft.co.uk" rel="nofollow">http://www.aurora-soft.co.uk</a>)<br />
Дата создания: 8th February 2003г.<br />
Перевод: <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:MANIAK_dobrii" title="Участник:MANIAK dobrii">MANIAK dobrii</a> (e-mail: MANIAK_dobrii@list.ru, сайт: <a href="http://www.maniak-dobrii.nm.ru/" class="external free" title="http://www.maniak-dobrii.nm.ru/" rel="nofollow">http://www.maniak-dobrii.nm.ru/</a>)<br />
Дата перевода: 11 октября 2004г.
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Создай свой скринсейвер"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Создай свой скринсейвер&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Создай свой скринсейвер&amp;action=edit">править</a>]</span><span class="mw-headline">Создай свой скринсейвер</span></h1>
</p>
<a name=".D0.92.D0.B2.D0.B5.D0.B4.D0.B5.D0.BD.D0.B8.D0.B5"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%B9_%D1%81%D0%B2%D0%BE%D0%B9_%D1%81%D0%BA%D1%80%D0%B8%D0%BD%D1%81%D0%B5%D0%B9%D0%B2%D0%B5%D1%80&amp;action=edit&amp;section=1" title="Создай свой скринсейвер">править</a>]</span> <span class="mw-headline">Введение</span></h2>
<p>Скринсейверы - классная штука. Все знают, что это такое, так что я не буду объяснять тебе что они делают. Создается вопрос - "Могу ли я сделать скрину в Blitz3D??". Ответ - ДА!! Но есть пара аспектов, с которыми тебе придется познакомиться. Этот тьюториал научит тебя основам построения скринсейверов, и ты сможешь сам создать свой. 
</p><p>Версия дока: 1.04.
</p>
<a name=".D0.9E.D1.81.D0.BD.D0.BE.D0.B2.D1.8B"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%B9_%D1%81%D0%B2%D0%BE%D0%B9_%D1%81%D0%BA%D1%80%D0%B8%D0%BD%D1%81%D0%B5%D0%B9%D0%B2%D0%B5%D1%80&amp;action=edit&amp;section=2" title="Создай свой скринсейвер">править</a>]</span> <span class="mw-headline">Основы</span></h2>
<p>Чтобы твоя программа могла включаться как скринсейвер в Windows, она должна понимать параметры, которые Windows использует для контроля скринсейвера. Два самых важных параметра, которые наша прога должна понимать (первые два): 
</p>
<ul><li>/S - используется для включения самого скринсейвера
</li><li>/C - используется для запуска Окна Установок (Configuration Screen)
</li><li>/P - используется для запуска окна предпросмотра (Preview Window).(смотри секцию Известные проблемы)
</li></ul>
<p><br />
Если никакого параметра нет, то прога должна выключится, или получим ошибку. 
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">CommandLine</span>$<span style=" ">&#40;</span><span style=" ">&#41;</span> &lt;&gt; <span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #ffee00">; Если параметр есть то: </span><br />
<p>&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">Upper</span><span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Left</span>$<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">CommandLine</span>$<span style=" ">&#40;</span><span style=" ">&#41;</span>,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><span style=" ">&#41;</span> = <span style="color: #00ff66;">&quot;/C&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> Configure<span style=" ">&#40;</span><span style=" ">&#41;</span> <span style="color: #ffee00">; &nbsp;надо включать окно установок</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">Upper</span><span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Left</span>$<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">CommandLine</span>$<span style=" ">&#40;</span><span style=" ">&#41;</span>,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><span style=" ">&#41;</span> = <span style="color: #00ff66;">&quot;/S&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> Start<span style=" ">&#40;</span><span style=" ">&#41;</span> &nbsp;<span style="color: #ffee00">; &nbsp;или надо включать сам скринсейвер? &nbsp;</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">EndIf</span></div>
<p>Кроме того, если ты используешь внешние ресурсы (картинку из файла например), то тебе придется поменять рабочую директорию на ту, в которой лежит скринсейвер. Если так не сделать, то скрина вылетит с ошибкой!!    
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">ChangeDir</span> <span style="color: #aaffff; font-weight: bold;">SystemProperty</span>$<span style=" ">&#40;</span><span style="color: #00ff66;">&quot;appdir&quot;</span><span style=" ">&#41;</span></div>
<p>Наконец, нам нужно вставить маленькую паузу в главный цикл скринсейвера. В случае с Blit3D\2D, это обеспечивает другие процессы достаточным кол-вом времени CPU. Это Blitz Basic-овый эквивалент команде VB DoEvents .    
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Delay</span> <span style="color: #33ffdd;">1</span></div>
<p>Намек: Ты можешь нажать ctrl-alt-del  чтобы позырить скоко времени CPU занимает какой-либо процесс. Во время тестирования лучше закомментировать эту строку. Также (во время тестов), тебе потребуются дать проге параметры запуска(/s,/c), в зависимости от того что ты щас тестишь:) Сделать это можно так: в своем IDE найди опцию Program Command Line, включи её и выставь нужное значение. Иначе прога просто выключится! 
</p>
<a name=".D0.98.D0.B7.D0.B2.D0.B5.D1.81.D1.82.D0.BD.D1.8B.D0.B5_.D0.BF.D1.80.D0.BE.D0.B1.D0.BB.D0.B5.D0.BC.D1.8B"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%B9_%D1%81%D0%B2%D0%BE%D0%B9_%D1%81%D0%BA%D1%80%D0%B8%D0%BD%D1%81%D0%B5%D0%B9%D0%B2%D0%B5%D1%80&amp;action=edit&amp;section=3" title="Создай свой скринсейвер">править</a>]</span> <span class="mw-headline">Известные проблемы</span></h2>
<p>Невозможно отобразить препросмотр Скрины внутри Windows-овского окна препросмотра с  Blitz2D. Но всегда есть способы решения этой проблемы в B+ и Blitz3D. Eikon получил доступ к окну препросмотра в B+. Ты можешь скачать пример&amp;исходник <a href="http://www.blitzcoder.com/cgi-bin/showcase/showcase_showentry.pl?id=eikon02262004191002&amp;comments=no|здесь" class="external autonumber" title="http://www.blitzcoder.com/cgi-bin/showcase/showcase_showentry.pl?id=eikon02262004191002&amp;comments=no|здесь" rel="nofollow">[1]</a>.
Когда делаешь Скрину в Blitz3D или Blitz2D, маленькое черное окно появляется перед запуском скринсейвера, но... просто игнорируй его.&nbsp;:) Вот код, который покажет тебе примерную структуру скринсейвера. 
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffee00">; Тьюториал: Как создать скринсейвер.</span><br />
<p><span style="color: #ffee00">; Автор: Grisu</span><br />
<span style="color: #ffee00">; Перевод: MANIAK_dobrii</span><br />
<span style="color: #ffee00">; Версия: 1.00</span><br />
<br />
<span style="color: #ffee00">; Этот код служит шаблоном скринсейвера.</span><br />
<span style="color: #ffee00">;</span><br />
<span style="color: #ffee00">; 1. Просто вставь свой код в функции &quot;Configure()&quot; и &quot;Start()&quot;.</span><br />
<span style="color: #ffee00">;</span><br />
<span style="color: #ffee00">; 2. Скомпилируй прогу и поменяй расширение с &quot;.exe&quot; на &quot;.scr&quot;.</span><br />
<span style="color: #ffee00">;</span><br />
<span style="color: #ffee00">; 3. Положи свою скрину(&amp; файлы если есть) в корневую папку Windows(C:\Windows\ например)</span><br />
<br />
<span style="color: #ffee00">; Известные проблемы со скринами, написанными в blitz-е:</span><br />
<span style="color: #ffee00">;</span><br />
<span style="color: #ffee00">; - Невозможно показать препросмотр скрины в окне препросмотра скринсейвера Windows.</span><br />
<span style="color: #ffee00">;</span><br />
<span style="color: #ffee00">; - При запуске скрины, сначала появится маленькое черненькое окно.</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">AppTitle</span> <span style="color: #00ff66;">&quot;Screensaver Tutorial1&quot;</span> <span style="color: #ffee00">; Имя твоей скрины</span><br />
<br />
<span style="color: #ffee00">; ВАЖНО</span><br />
<span style="color: #ffee00">; Нужно чтобы запустить твою скрину под Windows!!!.</span><br />
<span style="color: #ffee00">; Она меняет процессную директорию на ту, где лежит скринсейвер.</span><br />
<span style="color: #ffee00">; Комментируй эту строку во время тестов, т.к. &quot;appdir&quot; Blitz-а это &quot;\bin&quot;.</span><br />
<span style="color: #ffee00">; иначе твоя скрина просто вылетит!!!&nbsp;:)</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">ChangeDir</span> <span style="color: #aaffff; font-weight: bold;">SystemProperty</span>$<span style=" ">&#40;</span><span style="color: #00ff66;">&quot;appdir&quot;</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #ffee00">; Смотрим, какие параметры нам дала Windows </span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">CommandLine</span>$<span style=" ">&#40;</span><span style=" ">&#41;</span> &lt;&gt; <span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #ffee00">; Если параметр есть то: </span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">Upper</span><span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Left</span>$<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">CommandLine</span>$<span style=" ">&#40;</span><span style=" ">&#41;</span>,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><span style=" ">&#41;</span> = <span style="color: #00ff66;">&quot;/C&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> Configure<span style=" ">&#40;</span><span style=" ">&#41;</span> <span style="color: #ffee00">; надо включать окно установок</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">Upper</span><span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Left</span>$<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">CommandLine</span>$<span style=" ">&#40;</span><span style=" ">&#41;</span>,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><span style=" ">&#41;</span> = <span style="color: #00ff66;">&quot;/S&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> Start<span style=" ">&#40;</span><span style=" ">&#41;</span> <span style="color: #ffee00">; или надо включать сам скринсейвер? </span><br />
<span style="color: #aaffff; font-weight: bold;">EndIf</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #ffee00">; Конец проги, bye bye(прим. автора:)(прим. пер.))</span><br />
<br />
<span style="color: #ffee00">; Вставляй сюда код окна установок.</span><br />
<span style="color: #ffee00">; Если нужно, то можно врубить внешнюю прогу. Например написанную на VB, Delphi или другом.</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> Configure<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #ffee00">; Показываем Опции, которые можно поменять, например Разрешение и уровень детализации...</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span> <span style="color: #ffee00">; конец Configure()</span><br />
<br />
<span style="color: #ffee00">; Вставляй сюда код самого скринсейвера.</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> Start<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
&nbsp;<span style="color: #ffee00">; Ставим GFX-режим и грузим ресурсы... (перед главным циклом!)</span><br />
<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">FlushKeys</span><span style=" ">&#40;</span><span style=" ">&#41;</span> <span style="color: #ffee00">; чистим буфер клавы</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">FlushMouse</span><span style=" ">&#40;</span><span style=" ">&#41;</span> <span style="color: #ffee00">; чистим буфер мыши </span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">MoveMouse</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span> <span style="color: #ffee00">; двигаем мышу в 0,0 для последующей проверки</span><br />
<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Repeat</span> <span style="color: #ffee00">; Начало главного цикла</span><br />
<br />
&nbsp; <span style="color: #ffee00">; Тут идет главный цикл!</span><br />
<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Delay</span> <span style="color: #33ffdd;">1</span> <span style="color: #ffee00">; не будем использовать все 100% CPU!</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Until</span> <span style="color: #aaffff; font-weight: bold;">GetMouse</span><span style=" ">&#40;</span><span style=" ">&#41;</span> &lt;&gt; <span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Or</span> <span style="color: #aaffff; font-weight: bold;">MouseX</span><span style=" ">&#40;</span><span style=" ">&#41;</span> &lt;&gt; <span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Or</span> <span style="color: #aaffff; font-weight: bold;">MouseY</span><span style=" ">&#40;</span><span style=" ">&#41;</span> &lt;&gt; <span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Or</span> <span style="color: #aaffff; font-weight: bold;">GetKey</span><span style=" ">&#40;</span><span style=" ">&#41;</span> &lt;&gt; <span style="color: #33ffdd;">0</span> <br />
&nbsp;<span style="color: #ffee00">; проверяем, дергает ли пользователь судорожно мышкой, или бьет по клаве&nbsp;:)</span><br />
<br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span> <span style="color: #ffee00">; конец Start()</span></div>
<p>Ты можешь легко модифицировать код как тебе надо. Просто вставь свой код в функции Start() и Configure() . 
</p>
<a name=".D0.9F.D1.80.D0.B8.D0.BC.D0.B5.D1.80"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%B9_%D1%81%D0%B2%D0%BE%D0%B9_%D1%81%D0%BA%D1%80%D0%B8%D0%BD%D1%81%D0%B5%D0%B9%D0%B2%D0%B5%D1%80&amp;action=edit&amp;section=4" title="Создай свой скринсейвер">править</a>]</span> <span class="mw-headline">Пример</span></h2>
<p>Пора проверить - работает ли наша скрина? Тут добавлено чуток кода, так что скрина будет что-нибудь делать.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #ffee00">; Тьюториал: Как создать скринсейвер.</span><br />
<p><span style="color: #ffee00">; Автор: Grisu</span><br />
<span style="color: #ffee00">; Перевод: MANIAK_dobrii</span><br />
<span style="color: #ffee00">; Версия: 1.00</span><br />
<br />
<br />
<span style="color: #ffee00">; Это код готового скринсейвера.</span><br />
<span style="color: #ffee00">;</span><br />
<span style="color: #ffee00">; 1. Просто вставь свой код в функции &quot;Configure()&quot; и &quot;Start()&quot;.</span><br />
<span style="color: #ffee00">;</span><br />
<span style="color: #ffee00">; 2. Скомпилируй прогу и поменяй расширение с &quot;.exe&quot; на &quot;.scr&quot;.</span><br />
<span style="color: #ffee00">;</span><br />
<span style="color: #ffee00">; 3. Положи свою скрину(&amp; файлы если есть) в корневую папку Windows(C:\Windows\ например)</span><br />
<br />
<br />
<span style="color: #ffee00">; Известные проблемы со скринами, написанными в blitz-е:</span><br />
<span style="color: #ffee00">;</span><br />
<span style="color: #ffee00">; - Невозможно показать препросмотр скрины в окне препросмотра скринсейвера Windows.</span><br />
<span style="color: #ffee00">;</span><br />
<span style="color: #ffee00">; - При запуске скрины, сначала появится маленькое черненькое окно.</span><br />
<br />
<br />
<span style="color: #aaffff; font-weight: bold;">Const</span> SCREENX=<span style="color: #33ffdd;">800</span> <span style="color: #ffee00">; 2 константы для установки разрешения</span><br />
<span style="color: #aaffff; font-weight: bold;">Const</span> SCREENY=<span style="color: #33ffdd;">600</span> <br />
<br />
<span style="color: #ffee00">; ВАЖНО</span><br />
<span style="color: #ffee00">; Нужно чтобы запустить твою скрину под Windows!!!.</span><br />
<span style="color: #ffee00">; Она меняет процессную дирикторию на ту, где лежит скринсейвер.</span><br />
<span style="color: #ffee00">; Комментирую эту строку во время тестов, т.к. &quot;appdir&quot; Blitz-а это &quot;\bin&quot;.</span><br />
<span style="color: #ffee00">; иначе твоя скрина просто вылетит!!!&nbsp;:)</span><br />
<br />
<span style="color: #ffee00">;ChangeDir SystemProperty$(&quot;appdir&quot;)</span><br />
<br />
<span style="color: #ffee00">; Смотрим, какие параметры нам дала Windows </span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">CommandLine</span>$<span style=" ">&#40;</span><span style=" ">&#41;</span> &lt;&gt; <span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #ffee00">; Если параметр есть то: </span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">Upper</span><span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Left</span>$<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">CommandLine</span>$<span style=" ">&#40;</span><span style=" ">&#41;</span>,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><span style=" ">&#41;</span> = <span style="color: #00ff66;">&quot;/C&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> Configure<span style=" ">&#40;</span><span style=" ">&#41;</span> <span style="color: #ffee00">; надо включать окно установок</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">Upper</span><span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Left</span>$<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">CommandLine</span>$<span style=" ">&#40;</span><span style=" ">&#41;</span>,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><span style=" ">&#41;</span> = <span style="color: #00ff66;">&quot;/S&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> Start<span style=" ">&#40;</span><span style=" ">&#41;</span> <span style="color: #ffee00">; или надо включать сам скринсейвер? </span><br />
<span style="color: #aaffff; font-weight: bold;">EndIf</span> <span style="color: #ffee00">; &lt;&gt; &quot;&quot;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #ffee00">; Конец проги, bye bye(прим. автора:)(прим. пер.))</span><br />
<br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> Configure<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #ffee00">; Вставляй сюда код окна установок.</span><br />
<span style="color: #ffee00">; Если нужно, то можно врубить внешнюю прогу. Например написанную на VB, Delphi или другом.</span><br />
<br />
&nbsp;<span style="color: #ffee00">; Просто чтобы показать, что окно установок включилось!</span><br />
<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">AppTitle</span> <span style="color: #00ff66;">&quot;Screensaver Options&quot;</span> <span style="color: #ffee00">; Меняем заголовок окна</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Graphics</span> <span style="color: #33ffdd;">640</span>,<span style="color: #33ffdd;">480</span>,<span style="color: #33ffdd;">16</span>,<span style="color: #33ffdd;">2</span> <span style="color: #ffee00">; ставим GFX режим</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">BackBuffer</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Repeat</span> <br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">10</span>, <span style="color: #00ff66;">&quot;Тьюториал Grisu по созданию скринсейверов&quot;</span> <br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">20</span>, <span style="color: #00ff66;">&quot;Перевел MANIAK_dobrii&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">30</span>, <span style="color: #00ff66;">&quot;-----------------------------------------&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">50</span>, <span style="color: #00ff66;">&quot;Это просто пример простейшего скринсейвера.&quot;</span> <br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">70</span>, <span style="color: #00ff66;">&quot;Так что тут нечего конфигурировать!&quot;</span> <br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">450</span>,<span style="color: #00ff66;">&quot;Нажми кнопку или пошируди мышой...&nbsp;:)&quot;</span> <br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Flip</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Delay</span> <span style="color: #33ffdd;">1</span> <span style="color: #ffee00">; не будем использовать все 100% CPU!</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Until</span> <span style="color: #aaffff; font-weight: bold;">GetKey</span><span style=" ">&#40;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Or</span> <span style="color: #aaffff; font-weight: bold;">WaitMouse</span><span style=" ">&#40;</span><span style=" ">&#41;</span> <br />
<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span> <span style="color: #ffee00">; конец Configure()</span><br />
<br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> Start<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #ffee00">; Вставляй сюда код самого скринсейвера.</span><br />
<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">AppTitle</span> <span style="color: #00ff66;">&quot;Screensaver Tutorial1&quot;</span> <span style="color: #ffee00">; The Name of your Screensaver</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Graphics</span> SCREENX,SCREENY,<span style="color: #33ffdd;">16</span>,<span style="color: #33ffdd;">1</span> <span style="color: #ffee00">; set GFX Mode</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">BackBuffer</span><span style=" ">&#40;</span><span style=" ">&#41;</span> <br />
<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">FlushKeys</span><span style=" ">&#40;</span><span style=" ">&#41;</span> <span style="color: #ffee00">; чистим буфер клавы</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">FlushMouse</span><span style=" ">&#40;</span><span style=" ">&#41;</span> <span style="color: #ffee00">; чистим буфер мыши </span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">MoveMouse</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span> <span style="color: #ffee00">; бвигаем мышу в 0,0 для последующей проверки</span><br />
<br />
&nbsp;Textout$=<span style="color: #00ff66;">&quot;Тьюториал Grisu по созданию скринсейверов&quot;</span> <span style="color: #ffee00">; Этот текст будет написан</span><br />
<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Repeat</span> <span style="color: #ffee00">; Начало главного цикла </span><br />
<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #aaffff; font-weight: bold;">Rand</span><span style=" ">&#40;</span><span style="color: #33ffdd;">255</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rand</span><span style=" ">&#40;</span><span style="color: #33ffdd;">255</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rand</span><span style=" ">&#40;</span><span style="color: #33ffdd;">255</span><span style=" ">&#41;</span> <br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Rect</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,SCREENX,SCREENY,<span style="color: #33ffdd;">1</span><br />
<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span> <br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> y=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> SCREENY <span style="color: #aaffff; font-weight: bold;">Step</span> <span style="color: #33ffdd;">2</span> <br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Rect</span> <span style="color: #33ffdd;">0</span>,y,SCREENX,<span style="color: #33ffdd;">1</span> <br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span> <br />
<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Rect</span> <span style="color: #33ffdd;">50</span>,<span style="color: #33ffdd;">50</span>,SCREENX<span style="color: #33ffdd;">-100</span>,SCREENY<span style="color: #33ffdd;">-100</span>,<span style="color: #33ffdd;">1</span> <span style="color: #ffee00">; Рисуем черный квадрат в центре</span><br />
<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span> <span style="color: #ffee00">; пишем текст</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Text</span> <span style=" ">&#40;</span>SCREENX-<span style="color: #aaffff; font-weight: bold;">StringWidth</span><span style=" ">&#40;</span>Textout$<span style=" ">&#41;</span><span style=" ">&#41;</span>/<span style="color: #33ffdd;">2</span>,SCREENY/<span style="color: #33ffdd;">2</span>, Textout$ <br />
<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Flip</span> <span style="color: #ffee00">; flip-аем буфферы</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Delay</span> <span style="color: #33ffdd;">1</span> <span style="color: #ffee00">; не будем использовать все 100% CPU!</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Until</span> <span style="color: #aaffff; font-weight: bold;">GetMouse</span><span style=" ">&#40;</span><span style=" ">&#41;</span> &lt;&gt; <span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Or</span> <span style="color: #aaffff; font-weight: bold;">MouseX</span><span style=" ">&#40;</span><span style=" ">&#41;</span> &lt;&gt; <span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Or</span> <span style="color: #aaffff; font-weight: bold;">MouseY</span><span style=" ">&#40;</span><span style=" ">&#41;</span> &lt;&gt; <span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Or</span> <span style="color: #aaffff; font-weight: bold;">GetKey</span><span style=" ">&#40;</span><span style=" ">&#41;</span> &lt;&gt; <span style="color: #33ffdd;">0</span><br />
&nbsp;<span style="color: #ffee00">; проверяем, дергает ли пользователь судорожно мышкой, или бьет по клаве&nbsp;:) </span><br />
<br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span> <span style="color: #ffee00">; конец Start()</span></div>
<p>Используй свой код! Когда будешь готов, то сделай следующее: 
</p>
<ul><li>Скомпилируй прогу
</li><li>Переименуй расширение из exe в scr.
</li><li>Положи скрину в корневую папку Windows, например: С:\Windows\ .
</li><li>Свойства: Экран / Заставка , выбери там свою скрину и проверь её.
</li><li>Или правый тык на файл и из pop-up выбирай Установить.
</li><li>Нажмешь Параметры - вылезет маленькое окно параметров.
</li><li>Нажмешь Просмотр -  запустишь скрину.
</li></ul>
<a name="Post_Scriptum"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%B9_%D1%81%D0%B2%D0%BE%D0%B9_%D1%81%D0%BA%D1%80%D0%B8%D0%BD%D1%81%D0%B5%D0%B9%D0%B2%D0%B5%D1%80&amp;action=edit&amp;section=5" title="Создай свой скринсейвер">править</a>]</span> <span class="mw-headline">Post Scriptum</span></h2>
<p>Вот и всё! Надеюсь, принесло пользу.   
</p><p>Спасибо за прочтение! Оригинал статьи лежит <a href="http://www.blitzbasement.net/tutorials/screensave.htm" class="external text" title="http://www.blitzbasement.net/tutorials/screensave.htm" rel="nofollow">здесь</a>.
</p>
<div align="right"><a href="http://blitzetcetera.org/images/0/0a/Screensaver.zip" class="internal" title="Screensaver.zip">скачать архив с файлами к статье</a></div>
<hr />
<p>Автор: Grisu (e-mail: s.sarbok@gmx.de)<br />
Перевод: <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:MANIAK_dobrii" title="Участник:MANIAK dobrii">MANIAK dobrii</a> (e-mail: MANIAK_dobrii@list.ru, сайт: <a href="http://www.maniak-dobrii.nm.ru/" class="external free" title="http://www.maniak-dobrii.nm.ru/" rel="nofollow">http://www.maniak-dobrii.nm.ru/</a>)<br />
Специальные спасибы: Krylar, Eikon, Eddie Blitzmaniac, Genexi2 &amp; SDF!
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Скорость команд в Blitz3D"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Скорость команд в Blitz3D&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Скорость команд в Blitz3D&amp;action=edit">править</a>]</span><span class="mw-headline">Скорость команд в Blitz3D</span></h1>
<p>Программа, которая здесь рассмотрена, относится к группе так называемых "бенчмарков", то есть тестеров возможностей системы. В данном случае поставлена цель сравнения скорости основных команд Blitz (операции с переменными и массивами, функции и типы) для определения, какие из них предпочтительнее в написании программ с максимальным быстродействием. В программе-тестере использован следующий алгоритм: случайным образом выбирается одна из тестируемых команд. Засекается время и команда повторяется заданное кол-во раз (константа cq) в цикле. Программа построена так, что каждая команда тестируется определенное кол-во раз (константа times). Значения времени складываются и делятся на обе константы. Полученное время в наносекундах (10<sup>-9</sup>с) печатается на экране и является приблизительной скоростью выполнения команды в цикле (в большинстве случаев, без учета обработки цикла и приравнивания).
</p>
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Type</span> T<br />
<p>&nbsp;<span style="color: #aaffff; font-weight: bold;">Field</span> i,f#,s$<br />
<span style="color: #aaffff; font-weight: bold;">End Type</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Const</span> tq=<span style="color: #33ffdd;">91</span>, cq=<span style="color: #33ffdd;">1000000</span>, times=<span style="color: #33ffdd;">10</span>, symq=<span style="color: #33ffdd;">20</span><br />
<span style="color: #aaffff; font-weight: bold;">Const</span> dtim#=<span style="color: #33ffdd;">1000000.0</span>/cq<br />
<br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> ns#<span style=" ">&#40;</span>tq<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> name$<span style=" ">&#40;</span>tq<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> tms<span style=" ">&#40;</span>tq<span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> im<span style=" ">&#40;</span>symq<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> fm#<span style=" ">&#40;</span>symq<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> sm$<span style=" ">&#40;</span>symq<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> typ.T<span style=" ">&#40;</span>cq<span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">SeedRnd</span> <span style="color: #aaffff; font-weight: bold;">MilliSecs</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> tq<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Read</span> name$<span style=" ">&#40;</span>n<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> times*tq<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp; num=<span style="color: #aaffff; font-weight: bold;">Rand</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span>,tq<span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Until</span> tms<span style=" ">&#40;</span>num<span style=" ">&#41;</span>&lt;times<br />
&nbsp;tms<span style=" ">&#40;</span>num<span style=" ">&#41;</span>=tms<span style=" ">&#40;</span>num<span style=" ">&#41;</span><span style="color: #33ffdd;">+1</span><br />
&nbsp;ns#<span style=" ">&#40;</span>num<span style=" ">&#41;</span>=ns#<span style=" ">&#40;</span>num<span style=" ">&#41;</span>+dtim#*benchmark<span style=" ">&#40;</span>name$<span style=" ">&#40;</span>num<span style=" ">&#41;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
n=<span style="color: #33ffdd;">1</span><br />
f=<span style="color: #aaffff; font-weight: bold;">WriteFile</span><span style=" ">&#40;</span><span style="color: #00ff66;">&quot;btable.htm&quot;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteLine</span> f,<span style="color: #00ff66;">&quot;&lt;TABLE&gt;&quot;</span><br />
m$=<span style="color: #00ff66;">&quot;&lt;TR&gt;&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">While</span> n&lt;=tq<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> x=<span style="color: #33ffdd;">900</span> <span style="color: #aaffff; font-weight: bold;">Or</span> n=<span style="color: #33ffdd;">2</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; x=<span style="color: #33ffdd;">0</span><br />
&nbsp; y=y<span style="color: #33ffdd;">+12</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">WriteLine</span> f,m$<br />
&nbsp; &nbsp; m$=<span style="color: #00ff66;">&quot;&lt;/TR&gt;&lt;TR&gt;&quot;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span> <br />
&nbsp;v#=ns#<span style=" ">&#40;</span>n<span style=" ">&#41;</span>/times<br />
&nbsp;m$=m$+<span style="color: #00ff66;">&quot;&lt;TD&gt;&quot;</span>+name$<span style=" ">&#40;</span>n<span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;: &quot;</span>+v#+<span style="color: #00ff66;">&quot; ns&lt;/TD&gt;&quot;</span><br />
&nbsp;x=x<span style="color: #33ffdd;">+300</span><br />
&nbsp;n=n<span style="color: #33ffdd;">+1</span><br />
<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteLine</span> f,m$+<span style="color: #00ff66;">&quot;&lt;/TR&gt;&lt;/TABLE&gt;&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">CloseFile</span> f<br />
<span style="color: #aaffff; font-weight: bold;">ExecFile</span> <span style="color: #00ff66;">&quot;btable.htm&quot;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;template&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;A=B&quot;</span>,<span style="color: #00ff66;">&quot;D#=E#&quot;</span>,<span style="color: #00ff66;">&quot;I.T=J.T&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;A=B+C&quot;</span>,<span style="color: #00ff66;">&quot;D#=E#+F#&quot;</span>,<span style="color: #00ff66;">&quot;I.T=New T&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;A=B-C&quot;</span>,<span style="color: #00ff66;">&quot;D#=E#-F#&quot;</span>,<span style="color: #00ff66;">&quot;Delete I.T&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;A=B*C&quot;</span>,<span style="color: #00ff66;">&quot;D#=E#*F#&quot;</span>,<span style="color: #00ff66;">&quot;I.T=Before J.T&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;A=B/C&quot;</span>,<span style="color: #00ff66;">&quot;D#=E#/F#&quot;</span>,<span style="color: #00ff66;">&quot;I.T=After J.T&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;A=B^P&quot;</span>,<span style="color: #00ff66;">&quot;D#=E#^F#&quot;</span>,<span style="color: #00ff66;">&quot;I.T=First T&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;A=Abs(B)&quot;</span>,<span style="color: #00ff66;">&quot;D#=Abs(E#)&quot;</span>,<span style="color: #00ff66;">&quot;I.T=Last T&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;A=Sgn(B)&quot;</span>,<span style="color: #00ff66;">&quot;D#=Sgn(E#)&quot;</span>,<span style="color: #00ff66;">&quot;Insert I.T Before J.T&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;A=Floor(E#)&quot;</span>,<span style="color: #00ff66;">&quot;D#=Sin(E#)&quot;</span>,<span style="color: #00ff66;">&quot;Insert I.T After J.T&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;A=Int(E#)&quot;</span>,<span style="color: #00ff66;">&quot;D#=Cos(E#)&quot;</span>,<span style="color: #00ff66;">&quot;For I.T=Each T&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;A=Ceil(E#)&quot;</span>,<span style="color: #00ff66;">&quot;D#=Tan(E#)&quot;</span>,<span style="color: #00ff66;">&quot;Delete Each T&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;A=B And C&quot;</span>,<span style="color: #00ff66;">&quot;D#=ASin(R#)&quot;</span>,<span style="color: #00ff66;">&quot;A=Handle(J.T)&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;A=B Or C&quot;</span>,<span style="color: #00ff66;">&quot;D#=ACos(R#)&quot;</span>,<span style="color: #00ff66;">&quot;I.T=Object(Handle)&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;A=B Xor C&quot;</span>,<span style="color: #00ff66;">&quot;D#=ATan(E#)&quot;</span>,<span style="color: #00ff66;">&quot;L$=M$&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;A=B Mod PP&quot;</span>,<span style="color: #00ff66;">&quot;D#=ATan2(E#,F#)&quot;</span>,<span style="color: #00ff66;">&quot;L$=M$+S$&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;A=B Shl PP&quot;</span>,<span style="color: #00ff66;">&quot;D#=Sqr(E#)&quot;</span>,<span style="color: #00ff66;">&quot;L$=Left$(M$,SQ)&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;A=B Sar PP&quot;</span>,<span style="color: #00ff66;">&quot;D#=Log(G#)&quot;</span>,<span style="color: #00ff66;">&quot;L$=Right$(M$,SQ)&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;A=Asc(S$)&quot;</span>,<span style="color: #00ff66;">&quot;D#=Log10(G#)&quot;</span>,<span style="color: #00ff66;">&quot;L$=Chr$(SYM)&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;A=Len(M$)&quot;</span>,<span style="color: #00ff66;">&quot;D#=Exp(O#)&quot;</span>,<span style="color: #00ff66;">&quot;L$=Mid$(M$,SPOS,SQ)&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;A=Instr(M$,S$)&quot;</span>,<span style="color: #00ff66;">&quot;&quot;</span>,<span style="color: #00ff66;">&quot;L$=String$(S$,SYMQ)&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;A=Rand()&quot;</span>,<span style="color: #00ff66;">&quot;D#=Rnd()&quot;</span>,<span style="color: #00ff66;">&quot;L$=Replace$(M$,S$,' ')&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;A=INTF(B)&quot;</span>,<span style="color: #00ff66;">&quot;D#=FLOATF#(E#)&quot;</span>,<span style="color: #00ff66;">&quot;L$=STRINGF$(M$)&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;A=im(spos)&quot;</span>,<span style="color: #00ff66;">&quot;D#=fm#(spos)&quot;</span>,<span style="color: #00ff66;">&quot;L$=sm$(spos)&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;A=J\i&quot;</span>,<span style="color: #00ff66;">&quot;D#=J\f#&quot;</span>,<span style="color: #00ff66;">&quot;L$=J\s$&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;PokeByte&quot;</span>,<span style="color: #00ff66;">&quot;PokeFloat&quot;</span>,<span style="color: #00ff66;">&quot;PokeInt&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;PeekByte&quot;</span>,<span style="color: #00ff66;">&quot;PeekFloat&quot;</span>,<span style="color: #00ff66;">&quot;PeekInt&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;A=D#&quot;</span>,<span style="color: #00ff66;">&quot;D#=S$&quot;</span>,<span style="color: #00ff66;">&quot;S$=A&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;D#=A&quot;</span>,<span style="color: #00ff66;">&quot;S$=D#&quot;</span>,<span style="color: #00ff66;">&quot;A=S$&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;IF B=C&quot;</span>,<span style="color: #00ff66;">&quot;IF E#=F#&quot;</span>,<span style="color: #00ff66;">&quot;IF I.T=J.T&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;IF B&gt;C&quot;</span>,<span style="color: #00ff66;">&quot;IF E#&gt;F#&quot;</span>,<span style="color: #00ff66;">&quot;IF M$=L$&quot;</span><br />
<br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> benchmark<span style=" ">&#40;</span>name$<span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">First</span> t=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq<br />
&nbsp; I.T=<span style="color: #aaffff; font-weight: bold;">New</span> T<br />
&nbsp; typ<span style=" ">&#40;</span>n<span style=" ">&#41;</span>=I<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
<br />
B=<span style="color: #aaffff; font-weight: bold;">Rand</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-2000000000</span>,<span style="color: #33ffdd;">2000000000</span><span style=" ">&#41;</span><br />
C=<span style="color: #aaffff; font-weight: bold;">Rand</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-2000000000</span>,<span style="color: #33ffdd;">2000000000</span><span style=" ">&#41;</span><br />
P=<span style="color: #aaffff; font-weight: bold;">Rand</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-20</span>,<span style="color: #33ffdd;">20</span><span style=" ">&#41;</span><br />
PP=<span style="color: #aaffff; font-weight: bold;">Rand</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span>,<span style="color: #33ffdd;">20</span><span style=" ">&#41;</span><br />
SYM=<span style="color: #aaffff; font-weight: bold;">Rand</span><span style=" ">&#40;</span><span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">255</span><span style=" ">&#41;</span><br />
E#=<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-2000000000</span>,<span style="color: #33ffdd;">2000000000</span><span style=" ">&#41;</span><br />
F#=<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-2000000000</span>,<span style="color: #33ffdd;">2000000000</span><span style=" ">&#41;</span><br />
G#=<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">2</span>,<span style="color: #33ffdd;">2000000000</span><span style=" ">&#41;</span><br />
O#=<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-20</span>,<span style="color: #33ffdd;">20</span><span style=" ">&#41;</span><br />
R#=<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
I.T=typ<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Rand</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span>,cq<span style=" ">&#41;</span><span style=" ">&#41;</span><br />
J.T=typ<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Rand</span><span style=" ">&#40;</span><span style="color: #33ffdd;">2</span>,cq<span style="color: #33ffdd;">-1</span><span style=" ">&#41;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> i=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Or</span> j=<span style="color: #aaffff; font-weight: bold;">Null</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Stop</span><br />
SPOS=<span style="color: #aaffff; font-weight: bold;">Rand</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span>,SYMQ<span style=" ">&#41;</span><br />
s$=<span style="color: #aaffff; font-weight: bold;">Chr</span>$<span style=" ">&#40;</span>sym<span style=" ">&#41;</span><br />
bnk=<span style="color: #aaffff; font-weight: bold;">CreateBank</span><span style=" ">&#40;</span>symq<span style="color: #33ffdd;">+4</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> SYMQ<br />
&nbsp;L$=<span style="color: #aaffff; font-weight: bold;">Chr</span>$<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Rand</span><span style=" ">&#40;</span><span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">255</span><span style=" ">&#41;</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> nn=SPOS <span style="color: #aaffff; font-weight: bold;">Then</span> S$=L$<br />
&nbsp;M$=M$+L$<br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">If</span> name$=<span style="color: #00ff66;">&quot;I.T=New T&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Delete</span> <span style="color: #aaffff; font-weight: bold;">Each</span> T<br />
<br />
k=<span style="color: #33ffdd;">1</span><br />
tim=<span style="color: #aaffff; font-weight: bold;">MilliSecs</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Select</span> name$<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;template&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:A=B:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=B&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:A=B:A=C:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;D#=E#&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:A=B:D#=E#:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=E#&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:A=B:A=E#:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;D#=B&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:A=B:D#=B:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=B+C&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:A=B+C:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;D#=E#+F#&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:D#=E#+F#:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=B-C&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:A=B-C:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;D#=E#-F#&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:D#=E#-F#:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=B*C&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:A=B*C:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;D#=E#*F#&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:D#=E#*F#:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=B/C&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:A=B/C:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;D#=E#/F#&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:D#=E#/F#:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=B^P&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq/<span style="color: #33ffdd;">10</span>:A=B^P:<span style="color: #aaffff; font-weight: bold;">Next</span>:k=<span style="color: #33ffdd;">10</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;D#=E#^F#&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq/<span style="color: #33ffdd;">10</span>:D#=E#^F#:<span style="color: #aaffff; font-weight: bold;">Next</span>:k=<span style="color: #33ffdd;">10</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=Floor(E#)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:A=<span style="color: #aaffff; font-weight: bold;">Floor</span><span style=" ">&#40;</span>E#<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=Int(E#)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:A=<span style="color: #aaffff; font-weight: bold;">Int</span><span style=" ">&#40;</span>E#<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=Ceil(E#)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:A=<span style="color: #aaffff; font-weight: bold;">Ceil</span><span style=" ">&#40;</span>E#<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=Abs(B)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:A=<span style="color: #aaffff; font-weight: bold;">Abs</span><span style=" ">&#40;</span>B<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;D#=Abs(E#)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:D#=<span style="color: #aaffff; font-weight: bold;">Abs</span><span style=" ">&#40;</span>E#<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=Sgn(B)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:A=<span style="color: #aaffff; font-weight: bold;">Sgn</span><span style=" ">&#40;</span>B<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;D#=Sgn(E#)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:D#=<span style="color: #aaffff; font-weight: bold;">Sgn</span><span style=" ">&#40;</span>E#<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=B Mod PP&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:A=B <span style="color: #aaffff; font-weight: bold;">Mod</span> PP:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=B And C&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:A=B <span style="color: #aaffff; font-weight: bold;">And</span> C:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=B Or C&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:A=B <span style="color: #aaffff; font-weight: bold;">Or</span> C:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=B Xor C&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:A=B <span style="color: #aaffff; font-weight: bold;">Xor</span> C:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=B Shl PP&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:A=B <span style="color: #aaffff; font-weight: bold;">Shl</span> PP:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=B Sar PP&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:A=B <span style="color: #aaffff; font-weight: bold;">Sar</span> PP:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;D#=Sin(E#)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:D#=<span style="color: #aaffff; font-weight: bold;">Sin</span><span style=" ">&#40;</span>E#<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;D#=Cos(E#)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:D#=<span style="color: #aaffff; font-weight: bold;">Cos</span><span style=" ">&#40;</span>E#<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;D#=Tan(E#)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:D#=<span style="color: #aaffff; font-weight: bold;">Tan</span><span style=" ">&#40;</span>E#<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;D#=ASin(R#)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:D#=<span style="color: #aaffff; font-weight: bold;">ASin</span><span style=" ">&#40;</span>R#<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;D#=ACos(R#)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:D#=<span style="color: #aaffff; font-weight: bold;">ACos</span><span style=" ">&#40;</span>R#<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;D#=ATan(E#)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:D#=<span style="color: #aaffff; font-weight: bold;">ATan</span><span style=" ">&#40;</span>E#<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;D#=ATan2(E#,F#)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:D#=<span style="color: #aaffff; font-weight: bold;">ATan2</span><span style=" ">&#40;</span>E#,F#<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=Rand()&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:A=<span style="color: #aaffff; font-weight: bold;">Rand</span><span style=" ">&#40;</span><span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;D#=Rnd()&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:D#=<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">0.0</span><span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=INTF(B)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:A=INTF<span style=" ">&#40;</span>B<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;D#=FLOATF#(E#)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:D#=FLOATF#<span style=" ">&#40;</span>E#<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;I.T=J.T&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:I.T=J.T:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;I.T=New T&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:I.T=<span style="color: #aaffff; font-weight: bold;">New</span> T:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;Delete I.T&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:<span style="color: #aaffff; font-weight: bold;">Delete</span> typ<span style=" ">&#40;</span>n<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;I.T=Before J.T&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:I.T=<span style="color: #aaffff; font-weight: bold;">Before</span> J.T:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;I.T=After J.T&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:I.T=<span style="color: #aaffff; font-weight: bold;">After</span> J.T:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;I.T=First T&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:I.T=<span style="color: #aaffff; font-weight: bold;">First</span> T:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;I.T=Last T&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:I.T=<span style="color: #aaffff; font-weight: bold;">Last</span> T:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;Insert I.T Before J.T&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:<span style="color: #aaffff; font-weight: bold;">Insert</span> I.T <span style="color: #aaffff; font-weight: bold;">Before</span> J.T:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;Insert I.T After J.T&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:<span style="color: #aaffff; font-weight: bold;">Insert</span> I.T <span style="color: #aaffff; font-weight: bold;">After</span> J.T:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;For I.T=Each T&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> I.T=<span style="color: #aaffff; font-weight: bold;">Each</span> T:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=Handle(J.T)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:A=Handle<span style=" ">&#40;</span>J.T<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;I.T=Object(Handle)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:I.T=Object.T<span style=" ">&#40;</span>Handle<span style=" ">&#40;</span>J.T<span style=" ">&#41;</span><span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;Delete Each T&quot;</span>:<span style="color: #aaffff; font-weight: bold;">Delete</span> <span style="color: #aaffff; font-weight: bold;">Each</span> T<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;L$=M$&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq/<span style="color: #33ffdd;">10</span>:L$=M$:<span style="color: #aaffff; font-weight: bold;">Next</span>:k=<span style="color: #33ffdd;">10</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;L$=M$+S$&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq/<span style="color: #33ffdd;">10</span>:L$=M$+S$:<span style="color: #aaffff; font-weight: bold;">Next</span>:k=<span style="color: #33ffdd;">10</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;L$=Mid$(M$,SPOS,SQ)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq/<span style="color: #33ffdd;">10</span>:L$=<span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span>M$,SPOS,SymQ<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span>:k=<span style="color: #33ffdd;">10</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;D#=Sqr(E#)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:D#=<span style="color: #aaffff; font-weight: bold;">Sqr</span><span style=" ">&#40;</span>G#<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;L$=Left$(M$,SQ)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq/<span style="color: #33ffdd;">10</span>:L$=<span style="color: #aaffff; font-weight: bold;">Left</span>$<span style=" ">&#40;</span>M$,SymQ<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span>:k=<span style="color: #33ffdd;">10</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;D#=Log(G#)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:D#=<span style="color: #aaffff; font-weight: bold;">Log</span><span style=" ">&#40;</span>G#<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;L$=Right$(M$,SQ)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq/<span style="color: #33ffdd;">10</span>:L$=<span style="color: #aaffff; font-weight: bold;">Right</span>$<span style=" ">&#40;</span>M$,SymQ<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span>:k=<span style="color: #33ffdd;">10</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=Asc(S$)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:A=<span style="color: #aaffff; font-weight: bold;">Asc</span><span style=" ">&#40;</span>S$<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;D#=Log10(G#)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:D#=<span style="color: #aaffff; font-weight: bold;">Log10</span><span style=" ">&#40;</span>G#<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;L$=String$(S$,SYMQ)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq/<span style="color: #33ffdd;">10</span>:L$=<span style="color: #aaffff; font-weight: bold;">String</span>$<span style=" ">&#40;</span>S$,SYMQ<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span>:k=<span style="color: #33ffdd;">10</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=Len(M$)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq/<span style="color: #33ffdd;">10</span>:A=<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>M$<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span>:k=<span style="color: #33ffdd;">10</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;D#=Exp(O#)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:D#=<span style="color: #aaffff; font-weight: bold;">Exp</span><span style=" ">&#40;</span>O#<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;L$=Chr$(SYM)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq/<span style="color: #33ffdd;">10</span>:L$=<span style="color: #aaffff; font-weight: bold;">Chr</span>$<span style=" ">&#40;</span>SYM<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span>:k=<span style="color: #33ffdd;">10</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=Instr(M$,S$)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq/<span style="color: #33ffdd;">10</span>:A=<span style="color: #aaffff; font-weight: bold;">Instr</span><span style=" ">&#40;</span>M$,S$<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span>:k=<span style="color: #33ffdd;">10</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;L$=Replace$(M$,S$,' ')&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq/<span style="color: #33ffdd;">10</span>:L$=<span style="color: #aaffff; font-weight: bold;">Replace</span>$<span style=" ">&#40;</span>M$,S$,<span style="color: #00ff66;">&quot; &quot;</span><span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span>:k=<span style="color: #33ffdd;">10</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;L$=STRINGF$(M$)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq/<span style="color: #33ffdd;">10</span>:L$=STRINGF$<span style=" ">&#40;</span>M$<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span>:k=<span style="color: #33ffdd;">10</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;PokeByte&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:<span style="color: #aaffff; font-weight: bold;">PokeByte</span><span style=" ">&#40;</span>bnk,spos,sym<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;PokeInt&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:<span style="color: #aaffff; font-weight: bold;">PokeInt</span><span style=" ">&#40;</span>bnk,spos,a<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;PokeFloat&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:<span style="color: #aaffff; font-weight: bold;">PokeFloat</span><span style=" ">&#40;</span>bnk,spos,e#<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;PeekByte&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:a=<span style="color: #aaffff; font-weight: bold;">PeekByte</span><span style=" ">&#40;</span>bnk,spos<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;PeekInt&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:a=<span style="color: #aaffff; font-weight: bold;">PeekInt</span><span style=" ">&#40;</span>bnk,spos<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;PeekFloat&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:d#=<span style="color: #aaffff; font-weight: bold;">PeekFloat</span><span style=" ">&#40;</span>bnk,spos<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=im(spos)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:a=im<span style=" ">&#40;</span>spos<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;D#=fm#(spos)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:d#=fm#<span style=" ">&#40;</span>spos<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;L$=sm$(spos)&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:l$=sm$<span style=" ">&#40;</span>spos<span style=" ">&#41;</span>:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=J\i&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:a=J\i:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;D#=J\f#&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:d#=J\f#:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;L$=J\s$&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:l$=J\s$:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=D#&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:A=D#:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;D#=S$&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:D#=S$:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;S$=A&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq/<span style="color: #33ffdd;">10</span>:S$=A:<span style="color: #aaffff; font-weight: bold;">Next</span>:k=<span style="color: #33ffdd;">10</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;D#=A&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:D#=A:<span style="color: #aaffff; font-weight: bold;">Next</span>:k=<span style="color: #33ffdd;">10</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;S$=D#&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq/<span style="color: #33ffdd;">10</span>:S$=D#:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;A=S$&quot;</span>:<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq:A=S$:<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;IF B=C&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> B=C <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;IF E#=F#&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> E#=F# <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;IF I.T=J.T&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> I.T=J.T <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;IF B&gt;C&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> B&gt;C <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;IF E#&gt;F#&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> E#&gt;F# <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #00ff66;">&quot;IF M$=L$&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> M$=L$ <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">End Select</span><br />
tim=<span style="color: #aaffff; font-weight: bold;">MilliSecs</span><span style=" ">&#40;</span><span style=" ">&#41;</span>-tim<br />
<br />
<span style="color: #aaffff; font-weight: bold;">If</span> name$=<span style="color: #00ff66;">&quot;I.T=New T&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp;i.t=<span style="color: #aaffff; font-weight: bold;">First</span> t<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> cq<br />
&nbsp; typ<span style=" ">&#40;</span>n<span style=" ">&#41;</span>=i<br />
&nbsp; i=<span style="color: #aaffff; font-weight: bold;">After</span> i<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Return</span> tim*k<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> INTF<span style=" ">&#40;</span>N<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Return</span> N<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> FLOATF#<span style=" ">&#40;</span>N#<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Return</span> N#<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> STRINGF$<span style=" ">&#40;</span>S$<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Return</span> S$<br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<p>Результаты тестов для Pentium 4, 2.8GHz:
</p>
<table border="2" align="center">
<tr>
<td> template: 2.2 ns
</td></tr>
<tr align="right">
<td> A=B: 2.2 ns
</td><td> D#=E#: 2.3 ns
</td><td> I.T=J.T: 10.4 ns
</td></tr>
<tr align="right">
<td> A=B+C: 2.2 ns
</td><td> D#=E#+F#: 5.9 ns
</td><td> I.T=New T: 49.6 ns
</td></tr>
<tr align="right">
<td> A=B-C: 2.6 ns
</td><td> D#=E#-F#: 6.2 ns
</td><td> Delete I.T: 53.3 ns
</td></tr>
<tr align="right">
<td> A=B*C: 2.1 ns
</td><td> D#=E#*F#: 6.3 ns
</td><td> I.T=Before J.T: 14.1 ns
</td></tr>
<tr align="right">
<td> A=B/C: 15.1 ns
</td><td> D#=E#/F#: 12.0 ns
</td><td> I.T=After J.T: 14.4 ns
</td></tr>
<tr align="right">
<td> A=B^P: 463.0 ns
</td><td> D#=E#^F#: 1287.0 ns
</td><td> I.T=First T: 14.4 ns
</td></tr>
<tr align="right">
<td> A=Abs(B): 5.2 ns
</td><td> D#=Abs(E#): 8.6 ns
</td><td> I.T=Last T: 14.3 ns
</td></tr>
<tr align="right">
<td> A=Sgn(B): 5.7 ns
</td><td> D#=Sgn(E#): 11.7 ns
</td><td> Insert I.T Before J.T: 12.1 ns
</td></tr>
<tr align="right">
<td> A=Floor(E#): 100.0 ns
</td><td> D#=Sin(E#): 69.9 ns
</td><td> Insert I.T After J.T: 13.3 ns
</td></tr>
<tr align="right">
<td> A=Int(E#): 4.9 ns
</td><td> D#=Cos(E#): 67.1 ns
</td><td> For I.T=Each T: 36.3 ns
</td></tr>
<tr align="right">
<td> A=Ceil(E#): 100.0 ns
</td><td> D#=Tan(E#): 99.2 ns
</td><td> Delete Each T: 51.8 ns
</td></tr>
<tr align="right">
<td> A=B And C: 2.4 ns
</td><td> D#=ASin(R#): 219.1 ns
</td><td> A=Handle(J.T): 15.7 ns
</td></tr>
<tr align="right">
<td> A=B Or C: 2.1 ns
</td><td> D#=ACos(R#): 223.8 ns
</td><td> I.T=Object(Handle): 40.6 ns
</td></tr>
<tr align="right">
<td> A=B Xor C: 2.7 ns
</td><td> D#=ATan(E#): 109.9 ns
</td><td> L$=M$: 126.0 ns
</td></tr>
<tr align="right">
<td> A=B Mod PP: 17.8 ns
</td><td> D#=ATan2(E#,F#): 85.3 ns
</td><td> L$=M$+S$: 546.0 ns
</td></tr>
<tr align="right">
<td> A=B Shl PP: 2.4 ns
</td><td> D#=Sqr(E#): 12.1 ns
</td><td> L$=Left$(M$,SQ): 191.0 ns
</td></tr>
<tr align="right">
<td> A=B Sar PP: 2.4 ns
</td><td> D#=Log(G#): 45.4 ns
</td><td> L$=Right$(M$,SQ): 187.0 ns
</td></tr>
<tr align="right">
<td> A=Asc(S$): 398.7 ns
</td><td> D#=Log10(G#): 45.4 ns
</td><td> L$=Chr$(SYM): 389.0 ns
</td></tr>
<tr align="right">
<td> A=Len(M$): 125.0 ns
</td><td> D#=Exp(O#): 76.9 ns
</td><td> L$=Mid$(M$,SPOS,SQ): 460.0 ns
</td></tr>
<tr align="right">
<td> A=Instr(M$,S$): 254.0 ns
</td><td>&nbsp;: 0.0 ns
</td><td> L$=String$(S$,SYMQ): 1303.0 ns
</td></tr>
<tr align="right">
<td> A=Rand(): 62.3 ns
</td><td> D#=Rnd(): 42.6 ns
</td><td> L$=Replace$(M$,S$,' '): 722.0 ns
</td></tr>
<tr align="right">
<td> A=INTF(B): 7.5 ns
</td><td> D#=FLOATF#(E#): 9.7 ns
</td><td> L$=STRINGF$(M$): 247.0 ns
</td></tr>
<tr align="right">
<td> A=im(spos): 2.9 ns
</td><td> D#=fm#(spos): 2.9 ns
</td><td> L$=sm$(spos): 101.2 ns
</td></tr>
<tr align="right">
<td> A=J\i: 2.8 ns
</td><td> D#=J\f#: 2.6 ns
</td><td> L$=J\s$: 102.3 ns
</td></tr>
<tr align="right">
<td> PokeByte: 9.6 ns
</td><td> PokeFloat: 9.2 ns
</td><td> PokeInt: 9.4 ns
</td></tr>
<tr align="right">
<td> PeekByte: 8.6 ns
</td><td> PeekFloat: 11.1 ns
</td><td> PeekInt: 8.5 ns
</td></tr>
<tr align="right">
<td> A=D#: 5.0 ns
</td><td> D#=S$: 212.9 ns
</td><td> S$=A: 498.0 ns
</td></tr>
<tr align="right">
<td> D#=A: 48.0 ns
</td><td> S$=D#: 210.5 ns
</td><td> A=S$: 136.5 ns
</td></tr>
<tr align="right">
<td> IF B=C: 2.4 ns
</td><td> IF E#=F#: 9.1 ns
</td><td> IF I.T=J.T: 8.4 ns
</td></tr>
<tr align="right">
<td> IF B&gt;C: 2.5 ns
</td><td> IF E#&gt;F#: 9.2 ns
</td><td> IF M$=L$: 264.3 ns
</td></tr></table>
<p>Однако, результаты часто отличаются (в частности, почему-то иногда пустой цикл обрабатывается дольше, чем цикл с командой). Тем не менее, сравнивать можно. Например, операции для целых чисел +, -, *, SHL, SHR, AND, OR, XOR являются самыми быстрыми (и, соответственно, предпочтительными). Возьмем их за эталон. Операции +, -, * для чисел с плавающей точкой медленнее в 2.5 раза. Деление медленнее раз в 4-6, причем деление чисел с плавающей точкой быстрее.  Примерно столько же времени занимает вычисление остатка (MOD), а возведение в степень вообще одна из самых медленных функций (в 150-500 раз медленнее эталона). Из часто используемых функций, наиболее быстрыми являются ABS, SGN, SQR. Раз в 4-10 медленнее RND, RAND, LOG, EXP, SIN, COS, TAN, ATAN, ATAN2 (ATAN2 быстрее, чем ATAN). ASIN и ACOS медленнее раз в 20. Стоит заметить, что INT быстрее, чем FLOOR и CEIL в 20 раз и всего в 2 раза медленнее эталона. Что же касается строк, операции с ними гораздо медленнее (раз в 50), чем с числами (то же относится и к функциям, оперирующим со строками). Вот преимущества структур данных:
</p>
<ul><li>Массив: высокая скорость операций.
</li><li>Типы: высокая скорость оперирования с полями элементов, средняя (в 2-3 раза ниже) скорость операций с элементами и низкая (в 10 раз ниже) скорость добавления / удаления элементов, зато динамический объем и удобство работы.
</li><li>Банки: средняя (к моему удивлению) скорость операций, неудобство в работе, но есть возможность быстрого перемещения больших объемов данных (в том числе из файла / в файл).
</li></ul>
<p>Как видим, кубок скорости принадлежит массивам. Вызов Function отнимает не так уж много времени, так что их использование не намного замедлит работу программы. Еще нужно отметить трату ресурсов при конверсии данных (особенно с участием строк).
</p><p>Исходя из результатов теста, можно сделать следующий вывод: в тех местах программы, где требуется максимизировать скорость исполнения команд, широко используйте целые числа и массивы, по возможности старайтесь избегать смешения типов переменных и применения медленных функций. Не используйте строки.
</p><p>Вот некоторые приемы:
</p>
<ul><li>Натуральную степень можно заменить умножением:
<ul><li>X<sup>2</sup> = X * X
</li><li>X<sup>3</sup> = X * X * X
</li><li>X<sup>9</sup> = XX * XX * XX (XX = X * X * X)
</li></ul>
</li></ul>
<ul><li>Если в функции используются дробные переменные, используйте только их, а также дробные константы:
<ul><li>r# = Sqr(4.0 * dx# * dx# + dy# * dy#) вместо r = Sqr(4 * dx# * dx# + dy * dy)
</li></ul>
</li></ul>
<ul><li>Избегайте функций FLOOR и CEIL:
<ul><li>Floor(x#) = Int(x# - 0.5)
</li><li>Ceil(x#) = Int(x# + 0.4999999)
</li></ul>
</li></ul>
<ul><li>Для тригонометрических и других медленных функции можно сделать предварительный расчет:
<ul><li>Dim isin#(359): For n=0 To 359: isin#(n)=Sin(n): Next
</li></ul>
</li></ul>
<hr />
<p>Автор: <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Matt_Merkulov" title="Участник:Matt Merkulov">Матвей Меркулов</a> (E-mail: MattMerk@mail.ru, ICQ: 392-274-050)
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Tokamak DLL"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Tokamak DLL&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Tokamak DLL&amp;action=edit">править</a>]</span><span class="mw-headline">Tokamak DLL</span></h1>
</p>
<a name=".D0.A7.D1.82.D0.BE_.D1.82.D0.B0.D0.BA.D0.BE.D0.B5_Blitz-Tokamak.3F"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Tokamak_DLL&amp;action=edit&amp;section=1" title="Tokamak DLL">править</a>]</span> <span class="mw-headline">Что такое Blitz-Tokamak?</span></h2>
<p>Blitz Tokamak это отличный врапер физической библиотеки Tokamak DLL, написанный Sweenie.
</p><p>Вы можете взять врапер <a href="http://www.freewebs.com/sweenie/" class="external text" title="http://www.freewebs.com/sweenie/" rel="nofollow">здесь</a> и Tokamak DLL <a href="http://www.tokamakphysics.com/" class="external text" title="http://www.tokamakphysics.com/" rel="nofollow">отсюда</a>.
</p><p>Все dll-ки положите в папку с system32 или в папку с программой (рекомендуется ложить в system32, и только при финальной сборке программы поместить dll в папку программы). 
</p>
<a name=".D0.A7.D1.82.D0.BE_.D0.BE.D0.B7.D0.BD.D0.B0.D1.87.D0.B0.D1.8E.D1.82_.D0.B2.D1.81.D0.B5_TOK.2A.2A.2A_.D0.BA.D0.BE.D0.BC.D0.B0.D0.BD.D0.B4.D1.8B:"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Tokamak_DLL&amp;action=edit&amp;section=2" title="Tokamak DLL">править</a>]</span> <span class="mw-headline">Что означают все TOK*** команды:</span></h2>
<p>Для начала все команды делятся на основные разделы:
</p>
<ul><li>TOKSIM - команды симулятора tokamak. Эти команды в основном устанавливают глобальные переменные симулятора.
</li><li>TOKRB - команды для жестких тел. Это вещи, которые нас окружают. Для их использования можно использовать только 3 примитива - box, cylinder, и sphere, но вы можете объединять их с помощью операций конъюнкций и делать более сложные объекты, такие как стул или стол.
</li><li>TOKAB - эти команды для движущихся тел. На них не действует физика, а двигать и вращать их должна ваша программа. Эти объекты создаются так же, как и жесткие тела - из примитивов. Используйте объекты этого типа для создания движущихся платформ, дверей, ловушек и т.п.
</li><li>TOKGEOM - эти команды предназначены для модификации параметров предыдущих двух групп.
</li><li>TOKJOINT - эти команды используются для создания шарниров, к которым присоединяются жесткие тела. Используйте их для создания тряпичных кукол, ловушек, оборудования и т.п.
</li></ul>
<p><br />
</p>
<a name=".D0.9A.D0.B0.D0.BA_.D0.BD.D0.B0.D0.BF.D0.B8.D1.81.D0.B0.D1.82.D1.8C_.D0.BF.D1.80.D0.BE.D0.B3.D1.80.D0.B0.D0.BC.D0.BC.D1.83_.D0.B8.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D1.83.D1.8E.D1.89.D1.83.D1.8E_tokamak.3F"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Tokamak_DLL&amp;action=edit&amp;section=3" title="Tokamak DLL">править</a>]</span> <span class="mw-headline">Как написать программу использующую tokamak?</span></h2>
<p>Первое что вы должны сделать это установить симулятор подобно этому:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">TOKSIM_CreateSimulator<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">-10</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span></div>
<p>Здесь мы включаем tokamak и устанавливаем вектор гравитации. В этом случае гравитация направлена вниз и равна 10. По умолчанию tokamak немного ограничен в количестве объектов и, думаю, полезно будет узнать несколько команд для настройки ограничений:
</p>
<ul><li>TOKSIM_SetRigidBodiesCount - максимальное количество жестких тел. По умолчанию 50. Далее в квадратных скобках.
</li><li>TOKSIM_SetAnimatedBodiesCount - максимальное количество движущихся тел.[50]
</li><li>TOKSIM_SetRigidParticleCount - количество жестких частиц.[50]
</li><li>TOKSIM_SetControllersCount - количество контроллеров.[50]
</li><li>TOKSIM_SetOverlappedPairsCount - Количество возможных перекрытых пар. По умолчанию 1225. Это будет максимум при количестве объектов равным 100. Если вы используете другое количество объектов воспользуйтесь формулой (TBodies*(TBodies-1))/2 где TBodies - количество объектов. Вы конечно можете установить меньшее значение для экономии памяти.
</li><li>TOKSIM_SetGeometriesCount - количество, использующееся в жестких и подвижных объектах.[50]
</li><li>TOKSIM_SetConstraintsCount - количество ограничений в симуляции.[100]
</li><li>TOKSIM_SetConstraintSetsCount - Номер ограничения, устанавливается в в симуляции. Если вы неопытный пользователь, то просто пропустите это.
</li><li>TOKSIM_SetConstraintBufferSize - размер буфера решающего устройства ограничения (понимайте как хотите я не понял).[2000]
</li><li>TOKSIM_SetStaticMeshNodesStartCount - количество узлов хранящих треугольники местности.
</li><li>TOKSIM_SetStaticMeshNodesGrowByCount - Вообщем не понял я что это, если кто знает скажите. Устал уже переводить&nbsp;:(....
</li></ul>
<p>Вот что мы пока имеем:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Const</span> Rigid_Bodies=<span style="color: #33ffdd;">100</span>,Animated_Bodies=<span style="color: #33ffdd;">5</span>,Rigid_Particles=<span style="color: #33ffdd;">0</span><br />
<p><br />
TOKSIM_SetRigidBodiesCount Rigid_Bodies<br />
TOKSIM_SetAnimatedBodiesCount Animated_Bodies<br />
TOKSIM_SetRigidParticleCount Rigid_Particles<br />
TOKSIM_SetControllersCount <span style="color: #33ffdd;">0</span><br />
TOKSIM_SetGeometriesCount Rigid_bodies+Animated_Bodies <span style="color: #ffee00">;Assuming each one</span><br />
<span style="color: #ffee00">;only has one geometry. Not true with more complex rigid bodies and animated bodies.</span><br />
<br />
</p>
TOKSIM_CreateSimulator<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">-10</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span></div>
<p>Мы установили здесь подходящие настройки. Здесь мы создаем сцену:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Graphics3D</span> <span style="color: #33ffdd;">800</span>,<span style="color: #33ffdd;">600</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">2</span><br />
<p><span style="color: #aaffff; font-weight: bold;">Const</span> fps=<span style="color: #33ffdd;">60</span><br />
<span style="color: #aaffff; font-weight: bold;">Global</span> cam = <span style="color: #aaffff; font-weight: bold;">CreateCamera</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> cam,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">-50</span><br />
l=<span style="color: #aaffff; font-weight: bold;">CreateLight</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
centerpoint=<span style="color: #aaffff; font-weight: bold;">CreatePivot</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
ground = <span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EntityColor</span> ground,<span style="color: #33ffdd;">5</span>,<span style="color: #33ffdd;">5</span>,<span style="color: #33ffdd;">55</span> <br />
<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> ground,<span style="color: #33ffdd;">50</span>,<span style="color: #33ffdd;">5</span>,<span style="color: #33ffdd;">50</span> <br />
</p>
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> ground,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">-5</span>,<span style="color: #33ffdd;">0</span></div>
<p>Так - теперь мы установим подвижное тело для земли. (Хотя в действительности мы ее двигать не будем)
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">abground = TOKAB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<p>TOKAB_AddBox<span style=" ">&#40;</span>abground,<span style="color: #33ffdd;">100.0</span>,<span style="color: #33ffdd;">10.0</span>,<span style="color: #33ffdd;">100.0</span><span style=" ">&#41;</span><br />
TOKAB_SetPosition<span style=" ">&#40;</span>abground,<span style="color: #33ffdd;">0.0</span>,<span style="color: #33ffdd;">-5.0</span>,<span style="color: #33ffdd;">0.0</span><span style=" ">&#41;</span><br />
<br />
TOKAB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span> - Создает подвижное тело и возвращает указатель на него.<br />
TOKAB_AddBox<span style=" ">&#40;</span>AnimatedBody,Width,Height,Depth<span style=" ">&#41;</span> - описывает параллелограмм вокруг созданного тела.<br />
</p>
TOKAB_SetPosition<span style=" ">&#40;</span>AnimatedBody, X, Y, Z<span style=" ">&#41;</span> - устанавливает позицию тела.</div>
<p>Вот код создания остальных стен:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">wall1 = <span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<p><span style="color: #aaffff; font-weight: bold;">EntityColor</span> wall1,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">55</span> <br />
<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> wall1,<span style="color: #33ffdd;">2</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">50</span> <br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> wall1,<span style="color: #33ffdd;">50</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
abwall1 = TOKAB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
TOKAB_AddBox<span style=" ">&#40;</span>abwall1,<span style="color: #33ffdd;">4.0</span>,<span style="color: #33ffdd;">20.0</span>,<span style="color: #33ffdd;">100.0</span><span style=" ">&#41;</span><br />
TOKAB_SetPosition<span style=" ">&#40;</span>abwall1,<span style="color: #33ffdd;">50.0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0.0</span><span style=" ">&#41;</span><br />
<br />
wall2 = <span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EntityColor</span> wall2,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">55</span> <br />
<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> wall2,<span style="color: #33ffdd;">2</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">50</span> <br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> wall2,<span style="color: #33ffdd;">-50</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
abwall2 = TOKAB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
TOKAB_AddBox<span style=" ">&#40;</span>abwall2,<span style="color: #33ffdd;">4.0</span>,<span style="color: #33ffdd;">20.0</span>,<span style="color: #33ffdd;">100.0</span><span style=" ">&#41;</span><br />
TOKAB_SetPosition<span style=" ">&#40;</span>abwall2,<span style="color: #33ffdd;">-50.0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0.0</span><span style=" ">&#41;</span><br />
<br />
wall3 = <span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EntityColor</span> wall3,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">55</span> <br />
<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> wall3,<span style="color: #33ffdd;">50</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">2</span> <br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> wall3,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">-50</span><br />
abwall3 = TOKAB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
TOKAB_AddBox<span style=" ">&#40;</span>abwall3,<span style="color: #33ffdd;">100.0</span>,<span style="color: #33ffdd;">20.0</span>,<span style="color: #33ffdd;">4.0</span><span style=" ">&#41;</span><br />
TOKAB_SetPosition<span style=" ">&#40;</span>abwall3,<span style="color: #33ffdd;">0.0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">-50.0</span><span style=" ">&#41;</span><br />
<br />
wall4 = <span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EntityColor</span> wall4,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">55</span> <br />
<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> wall4,<span style="color: #33ffdd;">50</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">2</span> <br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> wall4,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">50</span><br />
abwall4 = TOKAB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
TOKAB_AddBox<span style=" ">&#40;</span>abwall4,<span style="color: #33ffdd;">100.0</span>,<span style="color: #33ffdd;">20.0</span>,<span style="color: #33ffdd;">4.0</span><span style=" ">&#41;</span><br />
</p>
TOKAB_SetPosition<span style=" ">&#40;</span>abwall4,<span style="color: #33ffdd;">0.0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">50.0</span><span style=" ">&#41;</span></div>
<p>Сейчас мы создадим жесткие тела:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Dim</span> obj<span style=" ">&#40;</span>Rigid_Bodies<span style=" ">&#41;</span><br />
<p><span style="color: #aaffff; font-weight: bold;">Dim</span> rb<span style=" ">&#40;</span>Rigid_Bodies<span style=" ">&#41;</span><br />
<br />
i=<span style="color: #33ffdd;">1</span><br />
<br />
obj<span style=" ">&#40;</span>i<span style=" ">&#41;</span> = <span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> obj<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">2</span>,<span style="color: #33ffdd;">1</span>,<span style="color: #33ffdd;">1</span> <br />
rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span> = TOKRB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
TOKRB_AddBox rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">4.0</span>,<span style="color: #33ffdd;">2.0</span>,<span style="color: #33ffdd;">2.0</span><br />
TOKRB_SetPosition rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">0</span><br />
TOKRB_SetLinearDamping rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">0.001</span><br />
TOKRB_SetAngularDamping rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">0.02</span> <br />
TOKRB_SetMass rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">2.0</span><br />
</p>
TOKRB_SetBoxInertiaTensor rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">4.0</span>,<span style="color: #33ffdd;">2.0</span>,<span style="color: #33ffdd;">2.0</span>,<span style="color: #33ffdd;">2.0</span></div>
<p>В массиве мы сохраняем указатели на объекты созданные с помощью команды TOKRB_Create(). Команда TOKRB_AddBox добавляет коробку к объекту. Обратите внимание, что описываем для описания мы используем цифры большие чем в ScaleEntity - это связано с тем, что блитц создает куб размером не 1x1x1, а размером 2x2x2. 
Далее мы устанавливаем позицию объекта. TOKRB_SetLinearDamping и TOKRBAngularDamping устанавливает линейное и угловое торможение соответственно. TOKRB_SetMass - устанавливает массу объекта. TOKRB_SetBoxInertiaTensor - sets the inertia tensor of an object. If you only have one geometry in your mesh, use this command, except with the specified object. (Не смог понять - если кто знает, напишите мне). Если у вас была, например, сфера то использовать нужно было бы TOKRB_SetSphereInertiaTensor. Сейчас мы изменим предыдущий кусочек кода и создадим большое количество кубиков, расположенных и направленных случайно.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">For</span> i=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> Rigid_Bodies<br />
<p>obj<span style=" ">&#40;</span>i<span style=" ">&#41;</span> = <span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> obj<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">1</span>,<span style="color: #33ffdd;">1</span>,<span style="color: #33ffdd;">1</span> <br />
rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>=TOKRB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
TOKRB_AddBox rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">2.0</span>,<span style="color: #33ffdd;">2.0</span>,<span style="color: #33ffdd;">2.0</span><br />
TOKRB_SetPosition rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-40</span>,<span style="color: #33ffdd;">40</span><span style=" ">&#41;</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-40</span>,<span style="color: #33ffdd;">40</span><span style=" ">&#41;</span><br />
TOKRB_SetLinearDamping rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">0.001</span><br />
TOKRB_SetAngularDamping rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">0.02</span> <br />
TOKRB_SetMass rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">2.0</span><br />
TOKRB_SetBoxInertiaTensor rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">4.0</span>,<span style="color: #33ffdd;">2.0</span>,<span style="color: #33ffdd;">2.0</span>,<span style="color: #33ffdd;">2.0</span><br />
TOKRB_SetVelocity rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
TOKRB_SetTorque rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">Next</span></div>
<p>Команды TOKRB_SetVelocity и TOKRB_SetTorque устанавливают линейную и угловую скорость жесткого тела. Теперь мы напишем скелет основного цикла:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">While</span> <span style="color: #aaffff; font-weight: bold;">Not</span> <span style="color: #aaffff; font-weight: bold;">KeyHit</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<p><span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
elapsed=<span style="color: #aaffff; font-weight: bold;">MilliSecs</span><span style=" ">&#40;</span><span style=" ">&#41;</span>-time<br />
<span style="color: #aaffff; font-weight: bold;">Until</span> elapsed<br />
<br />
ticks=elapsed/period<br />
tween#=<span style="color: #aaffff; font-weight: bold;">Float</span><span style=" ">&#40;</span>elapsed <span style="color: #aaffff; font-weight: bold;">Mod</span> period<span style=" ">&#41;</span>/<span style="color: #aaffff; font-weight: bold;">Float</span><span style=" ">&#40;</span>period<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> k=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> ticks<br />
time=time+period<br />
<span style="color: #aaffff; font-weight: bold;">If</span> k=ticks <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">CaptureWorld</span><br />
<span style="color: #aaffff; font-weight: bold;">UpdateWorld</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
camx#=<span style="color: #aaffff; font-weight: bold;">Cos</span><span style=" ">&#40;</span>rot#<span style=" ">&#41;</span>*<span style="color: #33ffdd;">50</span><br />
camz#=<span style="color: #aaffff; font-weight: bold;">Sin</span><span style=" ">&#40;</span>rot#<span style=" ">&#41;</span>*<span style="color: #33ffdd;">50</span><br />
<br />
rot#=rot#<span style="color: #33ffdd;">+0.05</span>+<span style="color: #aaffff; font-weight: bold;">MouseXSpeed</span><span style=" ">&#40;</span><span style=" ">&#41;</span>/<span style="color: #33ffdd;">5.0</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">If</span> rot#&gt;<span style="color: #33ffdd;">360</span> <span style="color: #aaffff; font-weight: bold;">Then</span> rot#=<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> cam,camx#,<span style="color: #33ffdd;">40</span>,camz#<br />
<span style="color: #aaffff; font-weight: bold;">PointEntity</span> cam,centerpoint<br />
<br />
<span style="color: #aaffff; font-weight: bold;">RenderWorld</span> tween<br />
<span style="color: #aaffff; font-weight: bold;">Flip</span> <span style="color: #aaffff; font-weight: bold;">False</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">Wend</span></div>
<p>Тут, думаю, все понятно. К Tokamak это никакого отношения не имеет. А вот здесь уже появляется наш Tokamak:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">For</span> k=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> ticks<br />
<p>time=time+period<br />
<span style="color: #aaffff; font-weight: bold;">If</span> k=ticks <span style="color: #aaffff; font-weight: bold;">Then</span><br />
<span style="color: #aaffff; font-weight: bold;">CaptureWorld</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> i=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> Rigid_Bodies<br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> obj<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,TOKRB_GetX#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,TOKRB_GetY#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,TOKRB_GetZ#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span> <br />
<span style="color: #aaffff; font-weight: bold;">RotateEntity</span> obj<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,TOKRB_GetPitch#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,TOKRB_GetYaw#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,TOKRB_GetRoll#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">False</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">KeyDown</span><span style=" ">&#40;</span><span style="color: #33ffdd;">57</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
TOKRB_ApplyImpulse2 rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>-.<span style="color: #33ffdd;">3</span>,.<span style="color: #33ffdd;">3</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-1.5</span>,<span style="color: #33ffdd;">3.0</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>-.<span style="color: #33ffdd;">3</span>,.<span style="color: #33ffdd;">3</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>-.<span style="color: #33ffdd;">05</span>,.<span style="color: #33ffdd;">05</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>.<span style="color: #33ffdd;">05</span>,.<span style="color: #33ffdd;">05</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>-.<span style="color: #33ffdd;">05</span>,.<span style="color: #33ffdd;">05</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EndIf</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">EndIf</span> <br />
TOKSIM_Advance<span style=" ">&#40;</span><span style="color: #33ffdd;">1.5</span>/FPS,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">UpdateWorld</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">Next</span></div>
<p>Здесь мы изменили цикл предыдущего куска кода. Команда TOKSIM_Advance моделирует физику. Первый параметр является шагом времени - это может быть полезным для создания эффекта замедления. Второй параметр устанавливает число суб-шагов. От этого зависит точность обработки физики.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">PositionEntity</span> obj<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,TOKRB_GetX#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,TOKRB_GetY#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,TOKRB_GetZ#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span> <br />
<span style="color: #aaffff; font-weight: bold;">RotateEntity</span> obj<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,TOKRB_GetPitch#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,TOKRB_GetYaw#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,TOKRB_GetRoll#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">False</span></div>
<p>Вращает у устанавливает новое положение жестких тел.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">KeyDown</span><span style=" ">&#40;</span><span style="color: #33ffdd;">57</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
<p>TOKRB_ApplyImpulse2 rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>-.<span style="color: #33ffdd;">3</span>,.<span style="color: #33ffdd;">3</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-1.5</span>,<span style="color: #33ffdd;">3.0</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>-.<span style="color: #33ffdd;">3</span>,.<span style="color: #33ffdd;">3</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>-.<span style="color: #33ffdd;">05</span>,.<span style="color: #33ffdd;">05</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>.<span style="color: #33ffdd;">05</span>,.<span style="color: #33ffdd;">05</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>-.<span style="color: #33ffdd;">05</span>,.<span style="color: #33ffdd;">05</span><span style=" ">&#41;</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">EndIf</span></div>
<p>Здесь мы задали произвольное вращение и движение объектам. TOKRB_ApplyImpulse2 - устанавливает импульс движения и вращения объекта.
Наконец, мы уничтожаем симулятор и заканчиваем программу.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;">TOKSIM_DestroySimulator<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End</span></div>
<p>Вот вам полный код демки:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Const</span> Rigid_Bodies=<span style="color: #33ffdd;">100</span>,Animated_Bodies=<span style="color: #33ffdd;">5</span>,Rigid_Particles=<span style="color: #33ffdd;">0</span><br />
<p><br />
TOKSIM_SetRigidBodiesCount Rigid_Bodies<br />
TOKSIM_SetAnimatedBodiesCount Animated_Bodies<br />
TOKSIM_SetRigidParticleCount Rigid_Particles<br />
TOKSIM_SetControllersCount <span style="color: #33ffdd;">0</span><br />
TOKSIM_SetGeometriesCount Rigid_bodies+Animated_Bodies <span style="color: #ffee00">;Assuming each one</span><br />
<span style="color: #ffee00">;only has one geometry. Not true with more complex rigid bodies and animated bodies.</span><br />
<br />
TOKSIM_CreateSimulator<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">-10</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Graphics3D</span> <span style="color: #33ffdd;">800</span>,<span style="color: #33ffdd;">600</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">2</span><br />
<span style="color: #aaffff; font-weight: bold;">Const</span> FPS=<span style="color: #33ffdd;">60</span><br />
<span style="color: #aaffff; font-weight: bold;">Global</span> cam = <span style="color: #aaffff; font-weight: bold;">CreateCamera</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> cam,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">-50</span><br />
<br />
l=<span style="color: #aaffff; font-weight: bold;">CreateLight</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
centerpoint=<span style="color: #aaffff; font-weight: bold;">CreatePivot</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
ground = <span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EntityColor</span> ground,<span style="color: #33ffdd;">5</span>,<span style="color: #33ffdd;">5</span>,<span style="color: #33ffdd;">55</span> <br />
<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> ground,<span style="color: #33ffdd;">50</span>,<span style="color: #33ffdd;">5</span>,<span style="color: #33ffdd;">50</span> <br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> ground,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">-5</span>,<span style="color: #33ffdd;">0</span><br />
abground = TOKAB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
TOKAB_AddBox<span style=" ">&#40;</span>abground,<span style="color: #33ffdd;">100.0</span>,<span style="color: #33ffdd;">10.0</span>,<span style="color: #33ffdd;">100.0</span><span style=" ">&#41;</span><br />
TOKAB_SetPosition<span style=" ">&#40;</span>abground,<span style="color: #33ffdd;">0.0</span>,<span style="color: #33ffdd;">-5.0</span>,<span style="color: #33ffdd;">0.0</span><span style=" ">&#41;</span><br />
<br />
wall1 = <span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EntityColor</span> wall1,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">55</span> <br />
<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> wall1,<span style="color: #33ffdd;">2</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">50</span> <br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> wall1,<span style="color: #33ffdd;">50</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
abwall1 = TOKAB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
TOKAB_AddBox<span style=" ">&#40;</span>abwall1,<span style="color: #33ffdd;">4.0</span>,<span style="color: #33ffdd;">20.0</span>,<span style="color: #33ffdd;">100.0</span><span style=" ">&#41;</span><br />
TOKAB_SetPosition<span style=" ">&#40;</span>abwall1,<span style="color: #33ffdd;">50.0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0.0</span><span style=" ">&#41;</span><br />
<br />
wall2 = <span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EntityColor</span> wall2,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">55</span> <br />
<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> wall2,<span style="color: #33ffdd;">2</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">50</span> <br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> wall2,<span style="color: #33ffdd;">-50</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
abwall2 = TOKAB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
TOKAB_AddBox<span style=" ">&#40;</span>abwall2,<span style="color: #33ffdd;">4.0</span>,<span style="color: #33ffdd;">20.0</span>,<span style="color: #33ffdd;">100.0</span><span style=" ">&#41;</span><br />
TOKAB_SetPosition<span style=" ">&#40;</span>abwall2,<span style="color: #33ffdd;">-50.0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0.0</span><span style=" ">&#41;</span><br />
<br />
wall3 = <span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EntityColor</span> wall3,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">55</span> <br />
<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> wall3,<span style="color: #33ffdd;">50</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">2</span> <br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> wall3,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">-50</span><br />
abwall3 = TOKAB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
TOKAB_AddBox<span style=" ">&#40;</span>abwall3,<span style="color: #33ffdd;">100.0</span>,<span style="color: #33ffdd;">20.0</span>,<span style="color: #33ffdd;">4.0</span><span style=" ">&#41;</span><br />
TOKAB_SetPosition<span style=" ">&#40;</span>abwall3,<span style="color: #33ffdd;">0.0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">-50.0</span><span style=" ">&#41;</span><br />
<br />
wall4 = <span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EntityColor</span> wall4,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">25</span>,<span style="color: #33ffdd;">55</span> <br />
<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> wall4,<span style="color: #33ffdd;">50</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #33ffdd;">2</span> <br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> wall4,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">50</span><br />
abwall4 = TOKAB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
TOKAB_AddBox<span style=" ">&#40;</span>abwall4,<span style="color: #33ffdd;">100.0</span>,<span style="color: #33ffdd;">20.0</span>,<span style="color: #33ffdd;">4.0</span><span style=" ">&#41;</span><br />
TOKAB_SetPosition<span style=" ">&#40;</span>abwall4,<span style="color: #33ffdd;">0.0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">50.0</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> obj<span style=" ">&#40;</span>Rigid_Bodies<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> rb<span style=" ">&#40;</span>Rigid_Bodies<span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">For</span> i=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> Rigid_Bodies<br />
obj<span style=" ">&#40;</span>i<span style=" ">&#41;</span> = <span style="color: #aaffff; font-weight: bold;">CreateCube</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> obj<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">1</span>,<span style="color: #33ffdd;">1</span>,<span style="color: #33ffdd;">1</span> <br />
rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>=TOKRB_Create<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
TOKRB_AddBox rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">2.0</span>,<span style="color: #33ffdd;">2.0</span>,<span style="color: #33ffdd;">2.0</span><br />
TOKRB_SetPosition rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-40</span>,<span style="color: #33ffdd;">40</span><span style=" ">&#41;</span>,<span style="color: #33ffdd;">10</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-40</span>,<span style="color: #33ffdd;">40</span><span style=" ">&#41;</span><br />
TOKRB_SetLinearDamping rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">0.001</span><br />
TOKRB_SetAngularDamping rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">0.02</span> <br />
TOKRB_SetMass rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">2.0</span><br />
TOKRB_SetBoxInertiaTensor rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #33ffdd;">4.0</span>,<span style="color: #33ffdd;">2.0</span>,<span style="color: #33ffdd;">2.0</span>,<span style="color: #33ffdd;">2.0</span><br />
TOKRB_SetVelocity rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-10</span>,<span style="color: #33ffdd;">10</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-10</span>,<span style="color: #33ffdd;">10</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-10</span>,<span style="color: #33ffdd;">10</span><span style=" ">&#41;</span><br />
TOKRB_SetTorque rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-10</span>,<span style="color: #33ffdd;">10</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-10</span>,<span style="color: #33ffdd;">10</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-10</span>,<span style="color: #33ffdd;">10</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
period=<span style="color: #33ffdd;">1000</span>/FPS<br />
time=<span style="color: #aaffff; font-weight: bold;">MilliSecs</span><span style=" ">&#40;</span><span style=" ">&#41;</span>-period<br />
<br />
imptime=<span style="color: #aaffff; font-weight: bold;">MilliSecs</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">While</span> <span style="color: #aaffff; font-weight: bold;">Not</span> <span style="color: #aaffff; font-weight: bold;">KeyHit</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
elapsed=<span style="color: #aaffff; font-weight: bold;">MilliSecs</span><span style=" ">&#40;</span><span style=" ">&#41;</span>-time<br />
<span style="color: #aaffff; font-weight: bold;">Until</span> elapsed<br />
<br />
ticks=elapsed/period<br />
tween#=<span style="color: #aaffff; font-weight: bold;">Float</span><span style=" ">&#40;</span>elapsed <span style="color: #aaffff; font-weight: bold;">Mod</span> period<span style=" ">&#41;</span>/<span style="color: #aaffff; font-weight: bold;">Float</span><span style=" ">&#40;</span>period<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> k=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> ticks<br />
time=time+period<br />
<span style="color: #aaffff; font-weight: bold;">If</span> k=ticks <span style="color: #aaffff; font-weight: bold;">Then</span><br />
<span style="color: #aaffff; font-weight: bold;">CaptureWorld</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> i=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> Rigid_Bodies<br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> obj<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,TOKRB_GetX#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,TOKRB_GetY#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,TOKRB_GetZ#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span> <br />
<span style="color: #aaffff; font-weight: bold;">RotateEntity</span> obj<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,TOKRB_GetPitch#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,TOKRB_GetYaw#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,TOKRB_GetRoll#<span style=" ">&#40;</span>rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">False</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">KeyDown</span><span style=" ">&#40;</span><span style="color: #33ffdd;">57</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
TOKRB_ApplyImpulse2 rb<span style=" ">&#40;</span>i<span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>-.<span style="color: #33ffdd;">3</span>,.<span style="color: #33ffdd;">3</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-1.5</span>,<span style="color: #33ffdd;">3.0</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>-.<span style="color: #33ffdd;">3</span>,.<span style="color: #33ffdd;">3</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>-.<span style="color: #33ffdd;">05</span>,.<span style="color: #33ffdd;">05</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>.<span style="color: #33ffdd;">05</span>,.<span style="color: #33ffdd;">05</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span>-.<span style="color: #33ffdd;">05</span>,.<span style="color: #33ffdd;">05</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">EndIf</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">EndIf</span> <br />
TOKSIM_Advance<span style=" ">&#40;</span><span style="color: #33ffdd;">1.5</span>/FPS,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">UpdateWorld</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
camx#=<span style="color: #aaffff; font-weight: bold;">Cos</span><span style=" ">&#40;</span>rot#<span style=" ">&#41;</span>*<span style="color: #33ffdd;">50</span><br />
camz#=<span style="color: #aaffff; font-weight: bold;">Sin</span><span style=" ">&#40;</span>rot#<span style=" ">&#41;</span>*<span style="color: #33ffdd;">50</span><br />
<br />
rot#=rot#<span style="color: #33ffdd;">+0.05</span>+<span style="color: #aaffff; font-weight: bold;">MouseXSpeed</span><span style=" ">&#40;</span><span style=" ">&#41;</span>/<span style="color: #33ffdd;">5.0</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">If</span> rot#&gt;<span style="color: #33ffdd;">360</span> <span style="color: #aaffff; font-weight: bold;">Then</span> rot#=<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> cam,camx#,<span style="color: #33ffdd;">40</span>,camz#<br />
<span style="color: #aaffff; font-weight: bold;">PointEntity</span> cam,centerpoint<br />
<br />
<span style="color: #aaffff; font-weight: bold;">RenderWorld</span> tween<br />
<span style="color: #aaffff; font-weight: bold;">Flip</span> <span style="color: #aaffff; font-weight: bold;">False</span><br />
<span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<br />
TOKSIM_DestroySimulator<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">End</span></div>
<p>PS Данная статья является переводом статьи с blitzcoder.com. Если вы нашли какие то недочеты в статье или я что-то неправильно перевел то пишите мне на AmirL@mail.ru.
</p>
<hr />
<p>Перевод: Amir (e-mail: AmirL@mail.ru)
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Базы данных: формат DBF"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Базы данных: формат DBF&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Базы данных: формат DBF&amp;action=edit">править</a>]</span><span class="mw-headline">Базы данных: формат DBF</span></h1>
<p>Прежде всего, что такое база данных? В самом простом варианте - это таблица с определенным количеством строк и столбцов. Если взять отдельную строку и столбец, то на их пересечении находится ячейка с какими-нибудь данными. К примеру, обычный календарь на январь - это база данных с семью столбцами - днями недели и 5-6 строками - неделями месяца. В каждой ячейке содержится число, лежащее на пересечении строки соответствующей недели и столбца дня недели или нет ничего (для дней, относящихся к другому месяцу). Работа с базами данных в BlitzBasic затруднена, так как в нем отсутствуют соответствующие процедуры. В этой статье будет рассказано, как создать процедуры работы с базами вручную.
</p>
</p><p>Форматов баз данных много, но здесь будет рассмотрен самый простой из них - формат DBase (DBF). Простота его заключается в том, что все данные представлены в текстовом виде, поля и строки имеют фиксированную длину, а структура максимально проста. К тому же, самые распространенные программы, работающие с базами данных - Excel и Access понимают этот формат и могут конвертировать в него базы данных других форматов.
</p><p>Начинается DBF-файл с заголовка, длиной в 32 байта, структура которого выглядит так:
</p>
<table border="2">
<tr>
<td> Байты
</td><td> Описание
</td></tr>
<tr>
<td> 00
</td><td> Версия:
</td></tr>
<tr>
<td> 01-03
</td><td> Последнее изменение (ГГММДД)
</td></tr>
<tr>
<td> 04-07
</td><td> Число записей в файле
</td></tr>
<tr>
<td> 08-09
</td><td> Положение первой записи с данными
</td></tr>
<tr>
<td> 10-11
</td><td> Длина одной записи с данными (включая признак удаления)
</td></tr>
<tr>
<td> 12-31
</td><td> Зарезервированы
</td></tr></table>
<p>Далее идут подзаписи полей, то есть блоки, характеризующие каждый столбец таблицы. Длина каждого блока - также 32 байта, а структура такова:
</p>
<table border="2">
<tr>
<td> Байты
</td><td> Описание
</td></tr>
<tr>
<td> 00-10
</td><td> Название поля (максимально - 10 символов, если меньше 10, то дополняется пустым символом (код - 0))
</td></tr>
<tr>
<td> 11
</td><td> Тип данных: C - символьное, N - числовое, L - логическое, D - дата, F - с плавающей точкой
</td></tr>
<tr>
<td> 12-15
</td><td> Расположение поля внутри записи
</td></tr>
<tr>
<td> 16-17
</td><td> Длина поля (в байтах)
</td></tr>
<tr>
<td> 18-32
</td><td> Зарезервированы
</td></tr></table>
<p>Подзаписи полей завершаются символом с кодом 13, а затем идут, собственно, данные. Они начинаются с позиции, указываемой в записи  заголовка в байтах  08 - 09. Запись для каждой строки базы данных начинается с байта, содержащего признак удаления. Если в этот байт занесен пробел (код ASCII - 32), то запись не удалялась; если же в первом байте - звездочка  (код - 42),  то  запись удалена. За признаком удаления следуют данные.
</p><p>Средствами BlitzBasic мы можем напрямую считывать информацию из файла. К сожалению, в языке отсутствует возможность считывания n символов в строку, поэтому если необходимо считать данные из определенной ячейки, придется либо считывать поле побайтно из файла, добавляя символы в строковую переменную, либо считать все поле в банк и формировать переменную, считывая данные из него. Рассмотрим первый вариант.
</p><p>Итак, для начала необходима инициализация: открытие файла базы данных, определение символьной длины каждого поля и его позиции в строке, длины одной строки, количества строк и столбцов (в заголовке количество строк и позиции полей в строке могут быть указаны неправильно, поэтому рассчитываем их, исходя из имеющихся данных). Также нужно корректно закрыть базу и сделать процедуру чтения данных. В первом примере на экран выводится содержимое базы данных "<a href="http://blitzetcetera.org/images/7/73/DBF-DataBase.zip" class="internal" title="DBF-DataBase.zip">storage.dbf</a>". Это список продуктов: столбец 0 - название, столбец 1 - цена, столбец 2 - количество.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Graphics</span> <span style="color: #33ffdd;">640</span>,<span style="color: #33ffdd;">480</span><br />
<p><span style="color: #aaffff; font-weight: bold;">SetFont</span> <span style="color: #aaffff; font-weight: bold;">LoadFont</span><span style=" ">&#40;</span><span style="color: #00ff66;">&quot;Arial&quot;</span>,<span style="color: #33ffdd;">16</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #ffee00">;Максимальное количество столбцов</span><br />
<span style="color: #aaffff; font-weight: bold;">Const</span> maxdbf=<span style="color: #33ffdd;">100</span><br />
<span style="color: #ffee00">;Служебные переменные</span><br />
<span style="color: #aaffff; font-weight: bold;">Global</span> dbfile,fleng,stpos,rowq,colq<br />
<span style="color: #ffee00">;Массив для информации о столбцах</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> dbc<span style=" ">&#40;</span>maxdbf,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #ffee00">;Открытие базы данных</span><br />
opendb <span style="color: #00ff66;">&quot;storage.dbf&quot;</span><br />
<span style="color: #ffee00">;Вывод базы данных на экран</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> rowq<span style="color: #33ffdd;">-1</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Print</span> trimdbf$<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;: &quot;</span>+trimdbf$<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;$, &quot;</span>+trimdbf$<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;pcs.&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #ffee00">;Закрытие базы данных</span><br />
closedb<br />
<br />
<span style="color: #aaffff; font-weight: bold;">WaitKey</span><br />
<br />
<span style="color: #ffee00">;Функция открытия файла базы данных</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> opendb<span style=" ">&#40;</span>file$<span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Эта переменная будет хранить идентификатор файла</span><br />
dbfile=<span style="color: #aaffff; font-weight: bold;">OpenFile</span><span style=" ">&#40;</span>file$<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">SeekFile</span> dbfile,<span style="color: #33ffdd;">8</span><br />
<span style="color: #ffee00">;Начало блока данных</span><br />
stpos=<span style="color: #aaffff; font-weight: bold;">ReadShort</span><span style=" ">&#40;</span>dbfile<span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Длина записи с данными (одной строки)</span><br />
fleng=<span style="color: #aaffff; font-weight: bold;">ReadShort</span><span style=" ">&#40;</span>dbfile<span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Расчет количества строк</span><br />
rowq=<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">FileSize</span><span style=" ">&#40;</span>file$<span style=" ">&#41;</span>-stpos<span style=" ">&#41;</span>/fleng<br />
<br />
<span style="color: #ffee00">;Счетчик количества столбцов</span><br />
colq=<span style="color: #33ffdd;">0</span><br />
<span style="color: #ffee00">;Позиция первой подзаписи - 1</span><br />
dbc<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>=<span style="color: #33ffdd;">1</span><br />
<span style="color: #ffee00">;Цикл по всем подзаписям полей</span><br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp;<span style="color: #ffee00">;Адрес начала подзаписи</span><br />
&nbsp;fp=<span style="color: #33ffdd;">32</span>*<span style=" ">&#40;</span>colq<span style="color: #33ffdd;">+1</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #ffee00">;Выход, если встречен символ с кодом 13</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">SeekFile</span> dbfile,fp<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">ReadByte</span><span style=" ">&#40;</span>dbfile<span style=" ">&#41;</span>=<span style="color: #33ffdd;">13</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Exit</span> <br />
&nbsp;<span style="color: #ffee00">;Считывание длины поля (в символах)</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">SeekFile</span> dbfile,fp<span style="color: #33ffdd;">+16</span><br />
&nbsp;dbc<span style=" ">&#40;</span>colq,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>=<span style="color: #aaffff; font-weight: bold;">ReadShort</span><span style=" ">&#40;</span>dbfile<span style=" ">&#41;</span><br />
&nbsp;<span style="color: #ffee00">;Расчет позиции поля</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> colq&gt;<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span> dbc<span style=" ">&#40;</span>colq,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>=dbc<span style=" ">&#40;</span>colq<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>+dbc<span style=" ">&#40;</span>colq<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
&nbsp;colq=colq<span style="color: #33ffdd;">+1</span><br />
<span style="color: #aaffff; font-weight: bold;">Forever</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Функция закрытия файла базы данных</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> closedb<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">CloseFile</span> dbfile<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Функция считывания данных из ячейки</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> dbf$<span style=" ">&#40;</span>row,col<span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Определения адреса ячейки в файле</span><br />
<span style="color: #aaffff; font-weight: bold;">SeekFile</span> dbfile,stpos+fleng*row+dbc<span style=" ">&#40;</span>col,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Формирование символьной переменной с данными ячейки</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> dbc<span style=" ">&#40;</span>col,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
&nbsp;m$=m$+<span style="color: #aaffff; font-weight: bold;">Chr</span>$<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">ReadByte</span><span style=" ">&#40;</span>dbfile<span style=" ">&#41;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Return</span> m$<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Функция, удаляющая в строке пробелы слева и справа</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> trimdbf$<span style=" ">&#40;</span>row,col<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Return</span> <span style="color: #aaffff; font-weight: bold;">Trim</span>$<span style=" ">&#40;</span>dbf$<span style=" ">&#40;</span>row,col<span style=" ">&#41;</span><span style=" ">&#41;</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<p>Однако, обычно при работе с таблицами, они считываются или формируются построчно, так что лучше всего будет занести в банк всю строку и далее работать с ним. Добавим процедуру чтения / записи строки и изменения данных в строке, а также очистки строки (для этого можно использовать вспомогательный банк). Очистка нужна для того, чтобы при изменении данных в ячейках не оставался мусор от прежних данных. Здесь изменяется файл базы, поэтому лучше сделать копию и работать с ней. В этом примере цена изменяется с учетом скидки 12%, а количество товара увеличивается вдвое.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Const</span> maxdbf=<span style="color: #33ffdd;">100</span><br />
<p><span style="color: #aaffff; font-weight: bold;">Global</span> dbfile,fleng,stpos,rowq,colq,dbbank<br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> dbc<span style=" ">&#40;</span>maxdbf,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">CopyFile</span> <span style="color: #00ff66;">&quot;storage.dbf&quot;</span>,<span style="color: #00ff66;">&quot;storage2.dbf&quot;</span><br />
opendb <span style="color: #00ff66;">&quot;storage2.dbf&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> rowq<span style="color: #33ffdd;">-1</span><br />
&nbsp;readrow n<br />
&nbsp;v=readdbf<span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
&nbsp;writedbf <span style="color: #33ffdd;">1</span>,.<span style="color: #33ffdd;">88</span>*v<br />
&nbsp;v=readdbf<span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
&nbsp;writedbf <span style="color: #33ffdd;">2</span>,<span style="color: #33ffdd;">2</span>*v<br />
&nbsp;writerow n<br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
closedb<br />
<br />
opendb <span style="color: #00ff66;">&quot;storage2.dbf&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> rowq<span style="color: #33ffdd;">-1</span><br />
&nbsp;readrow n<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Print</span> trimdbf$<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;: &quot;</span>+trimdbf$<span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;$, &quot;</span>+trimdbf$<span style=" ">&#40;</span><span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;pcs.&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
closedb<br />
<br />
<span style="color: #aaffff; font-weight: bold;">WaitKey</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> opendb<span style=" ">&#40;</span>file$<span style=" ">&#41;</span><br />
dbfile=<span style="color: #aaffff; font-weight: bold;">OpenFile</span><span style=" ">&#40;</span>file$<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">SeekFile</span> dbfile,<span style="color: #33ffdd;">8</span><br />
stpos=<span style="color: #aaffff; font-weight: bold;">ReadShort</span><span style=" ">&#40;</span>dbfile<span style=" ">&#41;</span><br />
fleng=<span style="color: #aaffff; font-weight: bold;">ReadShort</span><span style=" ">&#40;</span>dbfile<span style=" ">&#41;</span><br />
rowq=<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">FileSize</span><span style=" ">&#40;</span>file$<span style=" ">&#41;</span>-stpos<span style=" ">&#41;</span>/fleng<br />
<br />
<span style="color: #ffee00">;Вспомогательный буфер для хранения строки</span><br />
dbbank=<span style="color: #aaffff; font-weight: bold;">CreateBank</span><span style=" ">&#40;</span>fleng<span style=" ">&#41;</span><br />
<br />
dbc<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>=<span style="color: #33ffdd;">1</span><br />
colq=<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp;fp=<span style="color: #33ffdd;">32</span>*<span style=" ">&#40;</span>colq<span style="color: #33ffdd;">+1</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">SeekFile</span> dbfile,fp<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">ReadByte</span><span style=" ">&#40;</span>dbfile<span style=" ">&#41;</span>=<span style="color: #33ffdd;">13</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Exit</span> <br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">SeekFile</span> dbfile,fp<span style="color: #33ffdd;">+16</span><br />
&nbsp;dbc<span style=" ">&#40;</span>colq,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>=<span style="color: #aaffff; font-weight: bold;">ReadShort</span><span style=" ">&#40;</span>dbfile<span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> colq&gt;<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span> dbc<span style=" ">&#40;</span>colq,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>=dbc<span style=" ">&#40;</span>colq<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>+dbc<span style=" ">&#40;</span>colq<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
&nbsp;colq=colq<span style="color: #33ffdd;">+1</span><br />
<span style="color: #aaffff; font-weight: bold;">Forever</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> closedb<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">CloseFile</span> dbfile<br />
<span style="color: #aaffff; font-weight: bold;">FreeBank</span> dbbank<br />
<span style="color: #aaffff; font-weight: bold;">FreeBank</span> dbbankc<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Функция чтения строки из файла в буфер</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> readrow<span style=" ">&#40;</span>row<span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Определения адреса строки в файле</span><br />
<span style="color: #aaffff; font-weight: bold;">SeekFile</span> dbfile,stpos+fleng*row<br />
<span style="color: #ffee00">;Чтение данных из файла в буфер строки</span><br />
<span style="color: #aaffff; font-weight: bold;">ReadBytes</span> dbbank,dbfile,<span style="color: #33ffdd;">0</span>,fleng<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Функция записи строки из буфера строки в файл</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> writerow<span style=" ">&#40;</span>row<span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Определения адреса строки в файле</span><br />
<span style="color: #aaffff; font-weight: bold;">SeekFile</span> dbfile,stpos+fleng*row<br />
<span style="color: #ffee00">;Запись данных из буфера строки в файл</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteBytes</span> dbbank,dbfile,<span style="color: #33ffdd;">0</span>,fleng<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Функция считывания данных из ячейки буфера строки</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> readdbf$<span style=" ">&#40;</span>col<span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Формирование символьной переменной с данными ячейки</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> dbc<span style=" ">&#40;</span>col,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><span style="color: #33ffdd;">-1</span><br />
&nbsp;m$=m$+<span style="color: #aaffff; font-weight: bold;">Chr</span>$<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">PeekByte</span><span style=" ">&#40;</span>dbbank,dbc<span style=" ">&#40;</span>col,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>+n<span style=" ">&#41;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Return</span> m$<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Функция записи данных в ячейку буфера строки</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> writedbf<span style=" ">&#40;</span>col,m$<span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Побайтовая запись из строковой переменной в буфер</span><br />
l=<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>m$<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> dbc<span style=" ">&#40;</span>col,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><span style="color: #33ffdd;">-1</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> n&lt;l <span style="color: #aaffff; font-weight: bold;">Then</span> v=<span style="color: #aaffff; font-weight: bold;">Asc</span><span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span>m$,n<span style="color: #33ffdd;">+1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Else</span> v=<span style="color: #33ffdd;">32</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">PokeByte</span> dbbank,n+dbc<span style=" ">&#40;</span>col,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>,v<br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Обрезка пробелов справа и слева</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> trimdbf$<span style=" ">&#40;</span>col<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Return</span> <span style="color: #aaffff; font-weight: bold;">Trim</span>$<span style=" ">&#40;</span>readdbf$<span style=" ">&#40;</span>col<span style=" ">&#41;</span><span style=" ">&#41;</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<p>Следующие процедуры помогут в создании новой базы данных. В примере, сначала загружаются данные из старой базы в память, сортируясь по имени, а затем создается новая база, в которой присутствует еще один столбец - цена всей партии данного продукта. В нее записываются отсортированные данные с вычисленными значениями нового столбца.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Type</span> baserow<br />
<p>&nbsp;<span style="color: #aaffff; font-weight: bold;">Field</span> name$<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Field</span> price#<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Field</span> quantity<br />
<span style="color: #aaffff; font-weight: bold;">End Type</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Const</span> maxdbf=<span style="color: #33ffdd;">100</span><br />
<span style="color: #aaffff; font-weight: bold;">Global</span> dbfile,fleng,stpos,rowq,colq,dbbank,dbbankc<br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> dbc<span style=" ">&#40;</span>maxdbf,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<br />
opendb <span style="color: #00ff66;">&quot;storage.dbf&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> rowq<span style="color: #33ffdd;">-1</span><br />
&nbsp;readrow n<br />
&nbsp;r.baserow=<span style="color: #aaffff; font-weight: bold;">New</span> baserow<br />
&nbsp;r\name$=readdbf<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span><span style=" ">&#41;</span><br />
&nbsp;r\price#=readdbf<span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
&nbsp;r\quantity=readdbf<span style=" ">&#40;</span><span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> r2.baserow=<span style="color: #aaffff; font-weight: bold;">Each</span> baserow<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> r2\name$&gt;r\name$ <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Insert</span> r <span style="color: #aaffff; font-weight: bold;">Before</span> r2:<span style="color: #aaffff; font-weight: bold;">Exit</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
closedb<br />
<br />
createdb <span style="color: #00ff66;">&quot;storage2.dbf&quot;</span><br />
addfield <span style="color: #00ff66;">&quot;NAME&quot;</span>,<span style="color: #33ffdd;">51</span><br />
addfield <span style="color: #00ff66;">&quot;PRICE($)&quot;</span>,<span style="color: #33ffdd;">9</span><br />
addfield <span style="color: #00ff66;">&quot;QUANTITY&quot;</span>,<span style="color: #33ffdd;">9</span><br />
addfield <span style="color: #00ff66;">&quot;TOTAL&quot;</span>,<span style="color: #33ffdd;">9</span><br />
closeheader<br />
<br />
<span style="color: #aaffff; font-weight: bold;">For</span> r=<span style="color: #aaffff; font-weight: bold;">Each</span> baserow<br />
&nbsp;clearbnk<br />
&nbsp;writedbf <span style="color: #33ffdd;">0</span>,r\name$<br />
&nbsp;writedbf <span style="color: #33ffdd;">1</span>,r\price#<br />
&nbsp;writedbf <span style="color: #33ffdd;">2</span>,r\quantity<br />
&nbsp;writedbf <span style="color: #33ffdd;">3</span>,r\quantity*r\price<br />
&nbsp;addrow<br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
closedb<br />
<br />
opendb <span style="color: #00ff66;">&quot;storage2.dbf&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> rowq<span style="color: #33ffdd;">-1</span><br />
&nbsp;readrow n<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Print</span> trimdbf$<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;: &quot;</span>+trimdbf$<span style=" ">&#40;</span><span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;pcs.&quot;</span>+trimdbf$<span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;$, total:&quot;</span>+trimdbf$<span style=" ">&#40;</span><span style="color: #33ffdd;">3</span><span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;$&quot;</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
closedb<br />
<br />
<span style="color: #aaffff; font-weight: bold;">WaitKey</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> opendb<span style=" ">&#40;</span>file$<span style=" ">&#41;</span><br />
dbfile=<span style="color: #aaffff; font-weight: bold;">OpenFile</span><span style=" ">&#40;</span>file$<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">SeekFile</span> dbfile,<span style="color: #33ffdd;">8</span><br />
stpos=<span style="color: #aaffff; font-weight: bold;">ReadShort</span><span style=" ">&#40;</span>dbfile<span style=" ">&#41;</span><br />
fleng=<span style="color: #aaffff; font-weight: bold;">ReadShort</span><span style=" ">&#40;</span>dbfile<span style=" ">&#41;</span><br />
rowq=<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">FileSize</span><span style=" ">&#40;</span>file$<span style=" ">&#41;</span>-stpos<span style=" ">&#41;</span>/fleng<br />
<br />
<span style="color: #ffee00">;Вспомогательный буфер для хранения строки</span><br />
dbbank=<span style="color: #aaffff; font-weight: bold;">CreateBank</span><span style=" ">&#40;</span>fleng<span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Создание и инициализация банк для очистки буфера</span><br />
dbbankc=<span style="color: #aaffff; font-weight: bold;">CreateBank</span><span style=" ">&#40;</span>fleng<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> fleng<span style="color: #33ffdd;">-1</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">PokeByte</span> dbbankc,n,<span style="color: #33ffdd;">32</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
dbc<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>=<span style="color: #33ffdd;">1</span><br />
colq=<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp;fp=<span style="color: #33ffdd;">32</span>*<span style=" ">&#40;</span>colq<span style="color: #33ffdd;">+1</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">SeekFile</span> dbfile,fp<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">ReadByte</span><span style=" ">&#40;</span>dbfile<span style=" ">&#41;</span>=<span style="color: #33ffdd;">13</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Exit</span> <br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">SeekFile</span> dbfile,fp<span style="color: #33ffdd;">+16</span><br />
&nbsp;dbc<span style=" ">&#40;</span>colq,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>=<span style="color: #aaffff; font-weight: bold;">ReadShort</span><span style=" ">&#40;</span>dbfile<span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> colq&gt;<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span> dbc<span style=" ">&#40;</span>colq,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>=dbc<span style=" ">&#40;</span>colq<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>+dbc<span style=" ">&#40;</span>colq<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
&nbsp;colq=colq<span style="color: #33ffdd;">+1</span><br />
<span style="color: #aaffff; font-weight: bold;">Forever</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> closedb<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Запись количества строк перед закрытием базы</span><br />
<span style="color: #aaffff; font-weight: bold;">SeekFile</span> dbfile,<span style="color: #33ffdd;">4</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteInt</span> dbfile,rowq<br />
<span style="color: #aaffff; font-weight: bold;">CloseFile</span> dbfile<br />
<span style="color: #aaffff; font-weight: bold;">FreeBank</span> dbbank<br />
<span style="color: #aaffff; font-weight: bold;">FreeBank</span> dbbankc<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> readrow<span style=" ">&#40;</span>row<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">SeekFile</span> dbfile,stpos+fleng*row<br />
<span style="color: #aaffff; font-weight: bold;">ReadBytes</span> dbbank,dbfile,<span style="color: #33ffdd;">0</span>,fleng<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> writerow<span style=" ">&#40;</span>row<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">SeekFile</span> dbfile,stpos+fleng*row<br />
<span style="color: #aaffff; font-weight: bold;">WriteBytes</span> dbbank,dbfile,<span style="color: #33ffdd;">0</span>,fleng<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> readdbf$<span style=" ">&#40;</span>col<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> dbc<span style=" ">&#40;</span>col,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><span style="color: #33ffdd;">-1</span><br />
&nbsp;m$=m$+<span style="color: #aaffff; font-weight: bold;">Chr</span>$<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">PeekByte</span><span style=" ">&#40;</span>dbbank,dbc<span style=" ">&#40;</span>col,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>+n<span style=" ">&#41;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Return</span> m$<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> writedbf<span style=" ">&#40;</span>col,m$<span style=" ">&#41;</span><br />
l=<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>m$<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> dbc<span style=" ">&#40;</span>col,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><span style="color: #33ffdd;">-1</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> n&lt;l <span style="color: #aaffff; font-weight: bold;">Then</span> v=<span style="color: #aaffff; font-weight: bold;">Asc</span><span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span>m$,n<span style="color: #33ffdd;">+1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Else</span> v=<span style="color: #33ffdd;">32</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">PokeByte</span> dbbank,n+dbc<span style=" ">&#40;</span>col,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>,v<br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> trimdbf$<span style=" ">&#40;</span>col<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Return</span> <span style="color: #aaffff; font-weight: bold;">Trim</span>$<span style=" ">&#40;</span>readdbf$<span style=" ">&#40;</span>col<span style=" ">&#41;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Функция создания новой базы данных</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> createdb<span style=" ">&#40;</span>file$<span style=" ">&#41;</span><br />
dbfile=<span style="color: #aaffff; font-weight: bold;">WriteFile</span><span style=" ">&#40;</span>file$<span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Номер версии DBase - 4, дата - первое января 2000г (можно любую)</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteInt</span> dbfile,<span style="color: #33ffdd;">3</span><span style="color: #33ffdd;">+1</span> <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">8</span><span style="color: #33ffdd;">+1</span> <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">16</span><br />
<span style="color: #ffee00">;Остальную часть заголовка пока обнулим</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">7</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">WriteInt</span> dbfile,<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
stpos=<span style="color: #33ffdd;">32</span><br />
fleng=<span style="color: #33ffdd;">1</span><br />
rowq=<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Добавление нового столбца</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> addfield<span style=" ">&#40;</span>name$,l<span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Запись имени поля</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">11</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">WriteByte</span> dbfile,<span style="color: #aaffff; font-weight: bold;">Asc</span><span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span>name$,n,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #ffee00">;Тип поля-символьное (C)</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteByte</span> dbfile,<span style="color: #33ffdd;">67</span><br />
<span style="color: #ffee00">;Запись позиции поля в строке</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteInt</span> dbfile,fleng<br />
f=<span style=" ">&#40;</span>stpos <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">5</span><span style=" ">&#41;</span><span style="color: #33ffdd;">-1</span><br />
dbc<span style=" ">&#40;</span>f,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>=fleng<br />
<span style="color: #ffee00">;Запись длины поля</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteShort</span> dbfile,l<br />
dbc<span style=" ">&#40;</span>f,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>=l<br />
<span style="color: #ffee00">;Остальные заполняются нулями</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">7</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">WriteShort</span> dbfile,<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
fleng=fleng+l<br />
stpos=stpos<span style="color: #33ffdd;">+32</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Функция, закрывающая заголовок</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> closeheader<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Символ конца заголовка</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteByte</span> dbfile,<span style="color: #33ffdd;">13</span><br />
<span style="color: #aaffff; font-weight: bold;">SeekFile</span> dbfile,<span style="color: #33ffdd;">8</span><br />
<span style="color: #ffee00">;Запись позиции начала данных</span><br />
stpos=stpos<span style="color: #33ffdd;">+1</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteShort</span> dbfile,stpos<br />
<span style="color: #ffee00">;Запись длины записи с данными</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteShort</span> dbfile,fleng<br />
<br />
<span style="color: #ffee00">;Подготовка банков</span><br />
dbbank=<span style="color: #aaffff; font-weight: bold;">CreateBank</span><span style=" ">&#40;</span>fleng<span style=" ">&#41;</span><br />
dbbankc=<span style="color: #aaffff; font-weight: bold;">CreateBank</span><span style=" ">&#40;</span>fleng<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> fleng<span style="color: #33ffdd;">-1</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">PokeByte</span> dbbankc,n,<span style="color: #33ffdd;">32</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Функция, добавляющая строку в базу данных</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> addrow<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">SeekFile</span> dbfile,stpos+fleng*rowq<br />
<span style="color: #aaffff; font-weight: bold;">WriteBytes</span> dbbank,dbfile,<span style="color: #33ffdd;">0</span>,fleng<br />
rowq=rowq<span style="color: #33ffdd;">+1</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Функция очистки буфера строки</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> clearbnk<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">CopyBank</span> dbbankc,<span style="color: #33ffdd;">0</span>,dbbank,<span style="color: #33ffdd;">0</span>,fleng<br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<p>Теперь еще один очень важный момент: в большинстве задач приходится открывать сразу несколько баз данных (например, две для чтения, одну для записи), поэтому в окончательный вариант библиотеки процедур нужно добавить возможность оперирования несколькими базами данных:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Const</span> maxdbf=<span style="color: #33ffdd;">100</span>, dbq=<span style="color: #33ffdd;">2</span><br />
<p><span style="color: #aaffff; font-weight: bold;">Dim</span> dbfile<span style=" ">&#40;</span>dbq<span style=" ">&#41;</span>,fleng<span style=" ">&#40;</span>dbq<span style=" ">&#41;</span>,stpos<span style=" ">&#40;</span>dbq<span style=" ">&#41;</span>,rowq<span style=" ">&#40;</span>dbq<span style=" ">&#41;</span>,colq<span style=" ">&#40;</span>dbq<span style=" ">&#41;</span>,dbbank<span style=" ">&#40;</span>dbq<span style=" ">&#41;</span>,dbbankc<span style=" ">&#40;</span>dbq<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> dbc<span style=" ">&#40;</span>dbq,maxdbf,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> opendb<span style=" ">&#40;</span>db,file$<span style=" ">&#41;</span><br />
f=<span style="color: #aaffff; font-weight: bold;">OpenFile</span><span style=" ">&#40;</span>file$<span style=" ">&#41;</span><br />
dbfile<span style=" ">&#40;</span>db<span style=" ">&#41;</span>=f<br />
<span style="color: #aaffff; font-weight: bold;">SeekFile</span> f,<span style="color: #33ffdd;">8</span><br />
stpos<span style=" ">&#40;</span>db<span style=" ">&#41;</span>=<span style="color: #aaffff; font-weight: bold;">ReadShort</span><span style=" ">&#40;</span>f<span style=" ">&#41;</span><br />
fleng<span style=" ">&#40;</span>db<span style=" ">&#41;</span>=<span style="color: #aaffff; font-weight: bold;">ReadShort</span><span style=" ">&#40;</span>f<span style=" ">&#41;</span><br />
rowq<span style=" ">&#40;</span>db<span style=" ">&#41;</span>=<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">FileSize</span><span style=" ">&#40;</span>file$<span style=" ">&#41;</span>-stpos<span style=" ">&#40;</span>db<span style=" ">&#41;</span><span style=" ">&#41;</span>/fleng<span style=" ">&#40;</span>db<span style=" ">&#41;</span><br />
<br />
dbbank<span style=" ">&#40;</span>db<span style=" ">&#41;</span>=<span style="color: #aaffff; font-weight: bold;">CreateBank</span><span style=" ">&#40;</span>fleng<span style=" ">&#40;</span>db<span style=" ">&#41;</span><span style=" ">&#41;</span><br />
dbbankc<span style=" ">&#40;</span>db<span style=" ">&#41;</span>=<span style="color: #aaffff; font-weight: bold;">CreateBank</span><span style=" ">&#40;</span>fleng<span style=" ">&#40;</span>db<span style=" ">&#41;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> fleng<span style=" ">&#40;</span>db<span style=" ">&#41;</span><span style="color: #33ffdd;">-1</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">PokeByte</span> dbbankc<span style=" ">&#40;</span>db<span style=" ">&#41;</span>,n,<span style="color: #33ffdd;">32</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
dbc<span style=" ">&#40;</span>db,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>=<span style="color: #33ffdd;">1</span><br />
cq=<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp;fp=<span style="color: #33ffdd;">32</span>*<span style=" ">&#40;</span>cq<span style="color: #33ffdd;">+1</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">SeekFile</span> f,fp<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">ReadByte</span><span style=" ">&#40;</span>f<span style=" ">&#41;</span>=<span style="color: #33ffdd;">13</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Exit</span> <br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">SeekFile</span> f,fp<span style="color: #33ffdd;">+16</span><br />
&nbsp;dbc<span style=" ">&#40;</span>db,cq,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>=<span style="color: #aaffff; font-weight: bold;">ReadShort</span><span style=" ">&#40;</span>f<span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> colq<span style=" ">&#40;</span>db<span style=" ">&#41;</span>&gt;<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span> dbc<span style=" ">&#40;</span>db,cq,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>=dbc<span style=" ">&#40;</span>db,cq<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>+dbc<span style=" ">&#40;</span>db,cq<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
&nbsp;cq=cq<span style="color: #33ffdd;">+1</span><br />
<span style="color: #aaffff; font-weight: bold;">Forever</span><br />
colq<span style=" ">&#40;</span>db<span style=" ">&#41;</span>=cq<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> closedb<span style=" ">&#40;</span>db<span style=" ">&#41;</span><br />
f=dbfile<span style=" ">&#40;</span>db<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">SeekFile</span> f,<span style="color: #33ffdd;">4</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteShort</span> f,rowq<span style=" ">&#40;</span>db<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">CloseFile</span> f<br />
<span style="color: #aaffff; font-weight: bold;">FreeBank</span> dbbank<span style=" ">&#40;</span>db<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">FreeBank</span> dbbankc<span style=" ">&#40;</span>db<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> readrow<span style=" ">&#40;</span>db,row<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">SeekFile</span> dbfile<span style=" ">&#40;</span>db<span style=" ">&#41;</span>,stpos<span style=" ">&#40;</span>db<span style=" ">&#41;</span>+fleng<span style=" ">&#40;</span>db<span style=" ">&#41;</span>*row<br />
<span style="color: #aaffff; font-weight: bold;">ReadBytes</span> dbbank<span style=" ">&#40;</span>db<span style=" ">&#41;</span>,dbfile<span style=" ">&#40;</span>db<span style=" ">&#41;</span>,<span style="color: #33ffdd;">0</span>,fleng<span style=" ">&#40;</span>db<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> writerow<span style=" ">&#40;</span>db,row<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">SeekFile</span> dbfile<span style=" ">&#40;</span>db<span style=" ">&#41;</span>,stpos<span style=" ">&#40;</span>db<span style=" ">&#41;</span>+fleng<span style=" ">&#40;</span>db<span style=" ">&#41;</span>*row<br />
<span style="color: #aaffff; font-weight: bold;">WriteBytes</span> dbbank<span style=" ">&#40;</span>db<span style=" ">&#41;</span>,dbfile<span style=" ">&#40;</span>db<span style=" ">&#41;</span>,<span style="color: #33ffdd;">0</span>,fleng<span style=" ">&#40;</span>db<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> readdbf$<span style=" ">&#40;</span>db,col<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> dbc<span style=" ">&#40;</span>db,col,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><span style="color: #33ffdd;">-1</span><br />
&nbsp;m$=m$+<span style="color: #aaffff; font-weight: bold;">Chr</span>$<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">PeekByte</span><span style=" ">&#40;</span>dbbank<span style=" ">&#40;</span>db<span style=" ">&#41;</span>,dbc<span style=" ">&#40;</span>db,col,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>+n<span style=" ">&#41;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Return</span> m$<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> writedbf<span style=" ">&#40;</span>db,col,m$<span style=" ">&#41;</span><br />
l=<span style="color: #aaffff; font-weight: bold;">Len</span><span style=" ">&#40;</span>m$<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> dbc<span style=" ">&#40;</span>db,col,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><span style="color: #33ffdd;">-1</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> n&lt;l <span style="color: #aaffff; font-weight: bold;">Then</span> v=<span style="color: #aaffff; font-weight: bold;">Asc</span><span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span>m$,n<span style="color: #33ffdd;">+1</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Else</span> v=<span style="color: #33ffdd;">32</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">PokeByte</span> dbbank<span style=" ">&#40;</span>db<span style=" ">&#41;</span>,n+dbc<span style=" ">&#40;</span>db,col,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>,v<br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> trimdbf$<span style=" ">&#40;</span>db,col<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Return</span> <span style="color: #aaffff; font-weight: bold;">Trim</span>$<span style=" ">&#40;</span>readdbf$<span style=" ">&#40;</span>db,col<span style=" ">&#41;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> createdb<span style=" ">&#40;</span>db,file$<span style=" ">&#41;</span><br />
dbfile<span style=" ">&#40;</span>db<span style=" ">&#41;</span>=<span style="color: #aaffff; font-weight: bold;">OpenFile</span><span style=" ">&#40;</span>file$<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteInt</span> dbfile<span style=" ">&#40;</span>db<span style=" ">&#41;</span>,<span style="color: #33ffdd;">3</span><span style="color: #33ffdd;">+1</span> <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">8</span><span style="color: #33ffdd;">+1</span> <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">16</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">7</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">WriteInt</span> dbfile<span style=" ">&#40;</span>db<span style=" ">&#41;</span>,<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
stpos<span style=" ">&#40;</span>db<span style=" ">&#41;</span>=<span style="color: #33ffdd;">32</span><br />
fleng<span style=" ">&#40;</span>db<span style=" ">&#41;</span>=<span style="color: #33ffdd;">1</span><br />
rowq<span style=" ">&#40;</span>db<span style=" ">&#41;</span>=<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> addfield<span style=" ">&#40;</span>db,name$,l<span style=" ">&#41;</span><br />
f=dbfile<span style=" ">&#40;</span>db<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">11</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">WriteByte</span> f,<span style="color: #aaffff; font-weight: bold;">Asc</span><span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Mid</span>$<span style=" ">&#40;</span>name$,n,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteByte</span> f,<span style="color: #33ffdd;">66</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteInt</span> f,fleng<span style=" ">&#40;</span>db<span style=" ">&#41;</span><br />
fld=<span style=" ">&#40;</span>stpos<span style=" ">&#40;</span>db<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">5</span><span style=" ">&#41;</span><span style="color: #33ffdd;">-1</span><br />
dbc<span style=" ">&#40;</span>db,fld,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>=fleng<span style=" ">&#40;</span>db<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteShort</span> f,l<br />
dbc<span style=" ">&#40;</span>db,fld,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>=l<br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">7</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">WriteShort</span> f,<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
fleng<span style=" ">&#40;</span>db<span style=" ">&#41;</span>=fleng<span style=" ">&#40;</span>db<span style=" ">&#41;</span>+l<br />
stpos<span style=" ">&#40;</span>db<span style=" ">&#41;</span>=stpos<span style=" ">&#40;</span>db<span style=" ">&#41;</span><span style="color: #33ffdd;">+32</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> closeheader<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
f=dbfile<span style=" ">&#40;</span>db<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteByte</span> f,<span style="color: #33ffdd;">13</span><br />
<span style="color: #aaffff; font-weight: bold;">SeekFile</span> f,<span style="color: #33ffdd;">8</span><br />
stpos<span style=" ">&#40;</span>db<span style=" ">&#41;</span>=stpos<span style=" ">&#40;</span>db<span style=" ">&#41;</span><span style="color: #33ffdd;">+1</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteShort</span> f,stpos<span style=" ">&#40;</span>db<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteShort</span> f,fleng<span style=" ">&#40;</span>db<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> addrow<span style=" ">&#40;</span>db<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">SeekFile</span> dbfile<span style=" ">&#40;</span>db<span style=" ">&#41;</span>,stpos<span style=" ">&#40;</span>db<span style=" ">&#41;</span>+fleng<span style=" ">&#40;</span>db<span style=" ">&#41;</span>*rowq<span style=" ">&#40;</span>db<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">WriteBytes</span> dbbank<span style=" ">&#40;</span>db<span style=" ">&#41;</span>,dbfile<span style=" ">&#40;</span>db<span style=" ">&#41;</span>,<span style="color: #33ffdd;">0</span>,fleng<span style=" ">&#40;</span>db<span style=" ">&#41;</span><br />
rowq<span style=" ">&#40;</span>db<span style=" ">&#41;</span>=rowq<span style=" ">&#40;</span>db<span style=" ">&#41;</span><span style="color: #33ffdd;">+1</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> clearbnk<span style=" ">&#40;</span>db<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">CopyBank</span> dbbankc<span style=" ">&#40;</span>db<span style=" ">&#41;</span>,<span style="color: #33ffdd;">0</span>,dbbank<span style=" ">&#40;</span>db<span style=" ">&#41;</span>,<span style="color: #33ffdd;">0</span>,fleng<span style=" ">&#40;</span>db<span style=" ">&#41;</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<div align="right"><a href="http://blitzetcetera.org/images/0/01/DBF.zip" class="internal" title="DBF.zip">скачать архив с файлами к статье</a></div>
<hr />
<p>Автор: <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Matt_Merkulov" title="Участник:Matt Merkulov">Матвей Меркулов</a> (E-mail: MattMerk@mail.ru, ICQ: 392-274-050)
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Кубическая интерполяция"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Кубическая интерполяция&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Кубическая интерполяция&amp;action=edit">править</a>]</span><span class="mw-headline">Кубическая интерполяция</span></h1>
</p>
<a name=".D0.9C.D0.B5.D1.82.D0.BE.D0.B4.D1.8B_.D0.B8.D0.BD.D1.82.D0.B5.D1.80.D0.BF.D0.BE.D0.BB.D1.8F.D1.86.D0.B8.D0.B8"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9A%D1%83%D0%B1%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D0%BF%D0%BE%D0%BB%D1%8F%D1%86%D0%B8%D1%8F&amp;action=edit&amp;section=1" title="Кубическая интерполяция">править</a>]</span> <span class="mw-headline">Методы интерполяции</span></h2>
<p>Интерполяцией называется процесс нахождения функции (в классическом случае - типа y = f(x)), график которой проходит через заданные точки (все они должны иметь различные координаты x). При этом, используют формулы исходя из целей и ресурсов: одни методы позволяют получить идеально плавную кривую, но требуют большого количества вычислений, которое значительно возрастает при увеличении количества точек, другие работают значительно быстрее, но результат более груб. Один из комплексных методов - метод Лагранжа. Пусть дан набор из n точек (x<sub>i</sub>, y<sub>i</sub>). Интерполирующая функция Лагранжа выглядит так:
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Interpolation01.gif" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Interpolation01.gif" src="hd9m4165.gif" width="426" height="58" /></a></span></div></div>
<p>Как видно, если подставить в нее одно из значений x<sub>i</sub>, то все слагаемые формулы будут равны 0, кроме одного, в котором все множители сократятся и останется  y<sub>i</sub>. Вот программа, демонстрирующая метод Лагранжа (кстати, виден еще один недостаток этого метода - график слишком "колеблется"):
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">SeedRnd</span> <span style="color: #aaffff; font-weight: bold;">MilliSecs</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<p><br />
<span style="color: #aaffff; font-weight: bold;">Const</span> i=<span style="color: #33ffdd;">10</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> c#<span style=" ">&#40;</span>i,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Graphics</span> <span style="color: #33ffdd;">800</span>,<span style="color: #33ffdd;">600</span>,<span style="color: #33ffdd;">16</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> j=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> i<br />
&nbsp;<span style="color: #ffee00">;Проверка на совпадение x-координат</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp; <span style="color: #ffee00">;Шаг, чтобы точки отстояли друг от друга</span><br />
&nbsp; x#=<span style="color: #33ffdd;">5</span>*<span style="color: #aaffff; font-weight: bold;">Rand</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span>,<span style="color: #33ffdd;">159</span><span style=" ">&#41;</span><br />
&nbsp; <span style="color: #ffee00">;Цикл по всем предыдущим точкам</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> k=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> j<span style="color: #33ffdd;">-1</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">;Если координаты совпадают - цикл прерывается</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> c#<span style=" ">&#40;</span>k,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>=x# <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Exit</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; <span style="color: #ffee00">;Если цикл не был прерван, то k=(j-1)+1=j, иначе задаем новое значение x</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> k=j <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Exit</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Forever</span><br />
&nbsp;c#<span style=" ">&#40;</span>j,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>=x#<br />
&nbsp;c#<span style=" ">&#40;</span>j,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>=<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">200</span>,<span style="color: #33ffdd;">400</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Oval</span> c#<span style=" ">&#40;</span>j,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span><span style="color: #33ffdd;">-5</span>,c#<span style=" ">&#40;</span>j,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><span style="color: #33ffdd;">-5</span>,<span style="color: #33ffdd;">11</span>,<span style="color: #33ffdd;">11</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> x#=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">799</span><br />
&nbsp;<span style="color: #ffee00">;Вычисление значения формулы</span><br />
&nbsp;y#=<span style="color: #33ffdd;">0</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> j=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> i<br />
&nbsp; m#=c#<span style=" ">&#40;</span>j,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> k=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> i<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> k&lt;&gt;j <span style="color: #aaffff; font-weight: bold;">Then</span> m#=m#*<span style=" ">&#40;</span>x#-c#<span style=" ">&#40;</span>k,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span><span style=" ">&#41;</span>/<span style=" ">&#40;</span>c#<span style=" ">&#40;</span>j,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>-c#<span style=" ">&#40;</span>k,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span><span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; y#=y#+m#<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
&nbsp;<span style="color: #ffee00">;Корректное построение части графика (иначе будут разрывы)</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> x#&gt;<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; y1#=y#<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> y1#&lt;<span style="color: #33ffdd;">-3</span> <span style="color: #aaffff; font-weight: bold;">Then</span> y1#=<span style="color: #33ffdd;">-3</span> <span style="color: #aaffff; font-weight: bold;">ElseIf</span> y1#&gt;<span style="color: #33ffdd;">602</span> <span style="color: #aaffff; font-weight: bold;">Then</span> y1#=<span style="color: #33ffdd;">602</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> y2#&lt;<span style="color: #33ffdd;">-3</span> <span style="color: #aaffff; font-weight: bold;">Then</span> y2#=<span style="color: #33ffdd;">-3</span> <span style="color: #aaffff; font-weight: bold;">ElseIf</span> y2#&gt;<span style="color: #33ffdd;">602</span> <span style="color: #aaffff; font-weight: bold;">Then</span> y2#=<span style="color: #33ffdd;">602</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> y2#&lt;y1# <span style="color: #aaffff; font-weight: bold;">Then</span> z#=y1#:y1#=y2#:y2#=z#<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> yy#=y1# <span style="color: #aaffff; font-weight: bold;">To</span> y2#<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Oval</span> x#<span style="color: #33ffdd;">-2</span>,yy#<span style="color: #33ffdd;">-2</span>,<span style="color: #33ffdd;">5</span>,<span style="color: #33ffdd;">5</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;y2#=y#<br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
</p>
<span style="color: #aaffff; font-weight: bold;">WaitKey</span></div>
<p>Чтобы упростить вычисления, ось x разбивают на отрезки так, чтобы каждый из них был ограничен x-координатами двух точек и не содержал в себе x-координат других точек. Затем для каждого отрезка находят интерполирующую функцию. Простейший вариант показан на рисунке:
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Interpolation02.gif" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Interpolation02.gif" src="eiepno96.gif" width="442" height="278" /></a></span></div></div>
<p>Полученная функция обладает минимумом требований: она соединяет заданные точки и только. Этого бывает достаточно, но, как видите, такая функция обладает явным недостатком - острыми углами. В этом случае, интерполирующая функция - линейная (вида y = kx + b),
</p><p>Трехмерная интерполирующая поверхность задается по схожим принципам. Хороший пример такой интерполяции - terrain в Blitz. Задаются только высоты точек на пересечении сетки, высоты всех остальных точек вычисляются по формуле (каждый квадрат этой сетки представлен двумя треугольниками) - в итоге из набора точек мы получаем поверхность.
</p>
<a name=".D0.9A.D1.83.D0.B1.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.B0.D1.8F_.D0.B8.D0.BD.D1.82.D0.B5.D1.80.D0.BF.D0.BE.D0.BB.D1.8F.D1.86.D0.B8.D1.8F"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9A%D1%83%D0%B1%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D0%BF%D0%BE%D0%BB%D1%8F%D1%86%D0%B8%D1%8F&amp;action=edit&amp;section=2" title="Кубическая интерполяция">править</a>]</span> <span class="mw-headline">Кубическая интерполяция</span></h2>
<p>Но, вернемся к двумерной функции: для того, чтобы избавиться от острых углов, смежные интерполирующие функции должны иметь в общих точках одинаковую производную (она определяет касательную к функции в этой точке). В итоге получается система из четырех уравнений:
</p>
<ul><li>f(x<sub>1</sub>) = y<sub>1</sub>
</li><li>f(x<sub>2</sub>) = y<sub>2</sub>
</li><li>f'(x<sub>1</sub>) = y<sub>1</sub>'
</li><li>f'(x<sub>2</sub>) = y<sub>2</sub>'
</li></ul>
<p>Чтобы функция могла быть определена для любых возможных значений, она должна иметь четыре параметра (по числу уравнений). Простейший вариант - кубический многочлен: y = ax<sup>3</sup> + bx<sup>2</sup> + cx + d. Путем введения вспомогательной формулы x' = x + x<sub>1</sub>, переменной x<sub>3</sub>=x<sub>2</sub>-x<sub>1</sub> и преобразований, получаем:
</p>
<ul><li>d = y<sub>1</sub>
</li><li>c = y<sub>1</sub>'
</li><li>b = (3y<sub>2</sub> - y<sub>2</sub>'x<sub>3</sub> - 2cx<sub>3</sub> - 3d) / x<sub>3</sub><sup>2</sup>
</li><li>a = (y<sub>2</sub>' - 2bx<sub>3</sub> - c) / 3x<sub>3</sub><sup>2</sup>
</li></ul>
<p>Производные можно выбирать следующим образом: проведем прямую через две точки, смежные с данной; касательная к кривой в этой точке будет параллельна этой прямой и, соответственно, иметь тот же коэффициент, равный производной. Коэффициент прямой - это k в уравнении прямой y = kx + b. Для прямой, проходящей через две заданные точки он будет равен (y<sub>2</sub> - y<sub>1</sub>) / (x<sub>2</sub> - x<sub>1</sub>). Естественно, x<sub>2</sub> &lt;&gt; x<sub>1</sub>.
</p><p>Одно условие: точки должны быть отсортированы по возрастанию координаты x. А вот программа построения интерполяционной кривой:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">SeedRnd</span> <span style="color: #aaffff; font-weight: bold;">MilliSecs</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<p><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> ptx#<span style=" ">&#40;</span><span style="color: #33ffdd;">81</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> pty#<span style=" ">&#40;</span><span style="color: #33ffdd;">81</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Graphics</span> <span style="color: #33ffdd;">800</span>,<span style="color: #33ffdd;">600</span><br />
<br />
<span style="color: #ffee00">;Создается цепь из точек</span><br />
x#=<span style="color: #33ffdd;">0</span><br />
y#=<span style="color: #33ffdd;">300</span><br />
<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp;q=q<span style="color: #33ffdd;">+1</span><br />
&nbsp;ptx#<span style=" ">&#40;</span>q<span style=" ">&#41;</span>=x#<br />
&nbsp;pty#<span style=" ">&#40;</span>q<span style=" ">&#41;</span>=y#<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Oval</span> x#<span style="color: #33ffdd;">-4</span>,y#<span style="color: #33ffdd;">-4</span>,<span style="color: #33ffdd;">9</span>,<span style="color: #33ffdd;">9</span><br />
&nbsp;x#=x#+<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">30</span>,<span style="color: #33ffdd;">100</span><span style=" ">&#41;</span><br />
&nbsp;y#=y#+<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">-100</span>,<span style="color: #33ffdd;">100</span><span style=" ">&#41;</span> <br />
<span style="color: #aaffff; font-weight: bold;">Until</span> x#&gt;=<span style="color: #33ffdd;">800</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span><br />
<span style="color: #ffee00">;Цикл по всем отрезкам (для крайней правой точки отрезка нет)</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> q<span style="color: #33ffdd;">-1</span><br />
&nbsp;d#=pty#<span style=" ">&#40;</span>n<span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; <span style="color: #ffee00">;Если берется начальный отрезок, то производная равна 0 (т.к. смежная точка</span><br />
&nbsp; <span style="color: #ffee00">; слева, необходимая для определения коэффициента отсутствует</span><br />
&nbsp; c#=<span style="color: #33ffdd;">0</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; <span style="color: #ffee00">;Вычисление коэффициента, равного производной N1 по формуле</span><br />
&nbsp; c#=<span style=" ">&#40;</span>pty#<span style=" ">&#40;</span>n<span style="color: #33ffdd;">+1</span><span style=" ">&#41;</span>-pty#<span style=" ">&#40;</span>n<span style="color: #33ffdd;">-1</span><span style=" ">&#41;</span><span style=" ">&#41;</span>/<span style=" ">&#40;</span>ptx#<span style=" ">&#40;</span>n<span style="color: #33ffdd;">+1</span><span style=" ">&#41;</span>-ptx#<span style=" ">&#40;</span>n<span style="color: #33ffdd;">-1</span><span style=" ">&#41;</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #ffee00">;Аналогично вычисляется производная N2</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> n=q <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; dy2#=<span style="color: #33ffdd;">0</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; dy2#=<span style=" ">&#40;</span>pty#<span style=" ">&#40;</span>n<span style="color: #33ffdd;">+2</span><span style=" ">&#41;</span>-pty#<span style=" ">&#40;</span>n<span style=" ">&#41;</span><span style=" ">&#41;</span>/<span style=" ">&#40;</span>ptx#<span style=" ">&#40;</span>n<span style="color: #33ffdd;">+2</span><span style=" ">&#41;</span>-ptx#<span style=" ">&#40;</span>n<span style=" ">&#41;</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #ffee00">;Вычисление остальных коэффициентов многочлена</span><br />
&nbsp;x3#=ptx#<span style=" ">&#40;</span>n<span style="color: #33ffdd;">+1</span><span style=" ">&#41;</span>-ptx#<span style=" ">&#40;</span>n<span style=" ">&#41;</span><br />
&nbsp;xx3#=x3#*x3#<br />
&nbsp;b#=<span style=" ">&#40;</span><span style="color: #33ffdd;">3</span>*pty#<span style=" ">&#40;</span>n<span style="color: #33ffdd;">+1</span><span style=" ">&#41;</span>-dy2#*x3#<span style="color: #33ffdd;">-2</span>*c#*x3#<span style="color: #33ffdd;">-3</span>*d#<span style=" ">&#41;</span>/xx3#<br />
&nbsp;a#=<span style=" ">&#40;</span>dy2#<span style="color: #33ffdd;">-2</span>*b#*x3#-c#<span style=" ">&#41;</span>/<span style=" ">&#40;</span><span style="color: #33ffdd;">3</span>*xx3#<span style=" ">&#41;</span><br />
&nbsp;<span style="color: #ffee00">;Построение отрезка кривой</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> x#=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> x3#<br />
&nbsp; xx#=x#*x#<br />
&nbsp; y#=a#*xx#*x#+b#*xx#+c#*x#+d#<br />
&nbsp; x1#=x#+ptx#<span style=" ">&#40;</span>n<span style=" ">&#41;</span> &nbsp;<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> x1#&gt;<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;y1#=y#<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> y1#&lt;<span style="color: #33ffdd;">-3</span> <span style="color: #aaffff; font-weight: bold;">Then</span> y1#=<span style="color: #33ffdd;">-3</span> <span style="color: #aaffff; font-weight: bold;">ElseIf</span> y1#&gt;<span style="color: #33ffdd;">602</span> <span style="color: #aaffff; font-weight: bold;">Then</span> y1#=<span style="color: #33ffdd;">602</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> y2#&lt;<span style="color: #33ffdd;">-3</span> <span style="color: #aaffff; font-weight: bold;">Then</span> y2#=<span style="color: #33ffdd;">-3</span> <span style="color: #aaffff; font-weight: bold;">ElseIf</span> y2#&gt;<span style="color: #33ffdd;">602</span> <span style="color: #aaffff; font-weight: bold;">Then</span> y2#=<span style="color: #33ffdd;">602</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> y2#&lt;y1# <span style="color: #aaffff; font-weight: bold;">Then</span> z#=y1#:y1#=y2#:y2#=z#<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> yy#=y1# <span style="color: #aaffff; font-weight: bold;">To</span> y2#<br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Rect</span> x1#<span style="color: #33ffdd;">-1</span>,yy#<span style="color: #33ffdd;">-1</span>,<span style="color: #33ffdd;">3</span>,<span style="color: #33ffdd;">3</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; y2#=y#<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">WaitKey</span></div>
<p>Интерполяция применяется не только для построения визуальных кривых и изогнутых поверхностей, но и для описания траекторий, то есть создания функций, где ось OX определяет время. В программе, приведенной ниже, объект, изображенный в виде круга, должен достигнуть заданных точек в определенное время и вернуться в начало. Для этого, зададим две интерполирующие функции x = f<sub>1</sub>(t) и y = f<sub>2</sub>(t) по принципу, изложенному выше:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">SeedRnd</span> <span style="color: #aaffff; font-weight: bold;">MilliSecs</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<p><br />
<span style="color: #aaffff; font-weight: bold;">Const</span> q=<span style="color: #33ffdd;">10</span><br />
<br />
<span style="color: #ffee00">;Так как координаты x и y обрабатываются одинаково, создаются массивы, где</span><br />
<span style="color: #ffee00">; хранятся эти координаты и коэффициенты для функций на текущем отрезке времени</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> ptc#<span style=" ">&#40;</span>q<span style="color: #33ffdd;">+2</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> a#<span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> b#<span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> c#<span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> d#<span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Массив для времени, в которое объект должен посетить заданную точку</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> tim<span style=" ">&#40;</span>q<span style="color: #33ffdd;">+2</span><span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Массив координат объекта</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> oc#<span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Graphics</span> <span style="color: #33ffdd;">800</span>,<span style="color: #33ffdd;">600</span><br />
<span style="color: #aaffff; font-weight: bold;">SetFont</span> <span style="color: #aaffff; font-weight: bold;">LoadFont</span> <span style=" ">&#40;</span><span style="color: #00ff66;">&quot;Arial&quot;</span>,<span style="color: #33ffdd;">16</span><span style=" ">&#41;</span><br />
<br />
x#=<span style="color: #33ffdd;">0</span><br />
y#=<span style="color: #33ffdd;">300</span><br />
<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> q<br />
&nbsp;x#=<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">50</span>,<span style="color: #33ffdd;">750</span><span style=" ">&#41;</span><br />
&nbsp;y#=<span style="color: #aaffff; font-weight: bold;">Rnd</span><span style=" ">&#40;</span><span style="color: #33ffdd;">50</span>,<span style="color: #33ffdd;">550</span><span style=" ">&#41;</span> <br />
&nbsp;ptc#<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>=x#<br />
&nbsp;ptc#<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>=y#<br />
&nbsp;tim<span style=" ">&#40;</span>n<span style=" ">&#41;</span>=t<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Oval</span> x#<span style="color: #33ffdd;">-4</span>,y#<span style="color: #33ffdd;">-4</span>,<span style="color: #33ffdd;">9</span>,<span style="color: #33ffdd;">9</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Text</span> x#,y#<span style="color: #33ffdd;">+4</span>,.<span style="color: #33ffdd;">001</span>*t+<span style="color: #00ff66;">&quot;s&quot;</span>,<span style="color: #aaffff; font-weight: bold;">True</span><br />
&nbsp;t=t+<span style="color: #aaffff; font-weight: bold;">Rand</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1000</span>,<span style="color: #33ffdd;">3000</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
<span style="color: #ffee00">;Задаются значения параметров крайних точек для обеспечения цикличности</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> nn=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">1</span><br />
&nbsp;ptc#<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span>,nn<span style=" ">&#41;</span>=ptc#<span style=" ">&#40;</span>q,nn<span style=" ">&#41;</span><br />
&nbsp;ptc#<span style=" ">&#40;</span>q<span style="color: #33ffdd;">+1</span>,nn<span style=" ">&#41;</span>=ptc#<span style=" ">&#40;</span><span style="color: #33ffdd;">1</span>,nn<span style=" ">&#41;</span><br />
&nbsp;ptc#<span style=" ">&#40;</span>q<span style="color: #33ffdd;">+2</span>,nn<span style=" ">&#41;</span>=ptc#<span style=" ">&#40;</span><span style="color: #33ffdd;">2</span>,nn<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
tim<span style=" ">&#40;</span>q<span style="color: #33ffdd;">+1</span><span style=" ">&#41;</span>=t<br />
tim<span style=" ">&#40;</span>q<span style="color: #33ffdd;">+2</span><span style=" ">&#41;</span>=t+tim<span style=" ">&#40;</span><span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><br />
tim<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>=tim<span style=" ">&#40;</span>q<span style=" ">&#41;</span>-t<br />
<br />
<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span><br />
<span style="color: #ffee00">;Сохраняем фон</span><br />
i=<span style="color: #aaffff; font-weight: bold;">CreateImage</span><span style=" ">&#40;</span><span style="color: #33ffdd;">800</span>,<span style="color: #33ffdd;">600</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">GrabImage</span> i,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">BackBuffer</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #ffee00">;Cчетчик времени устанавливается за пределами интервала цикла, чтобы</span><br />
<span style="color: #ffee00">; вычислить коэффициенты для начального отрезка времени, пройдя через условие</span><br />
t=t<span style="color: #33ffdd;">+1</span><br />
n=q<span style="color: #33ffdd;">+1</span><br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> t&gt;tim<span style=" ">&#40;</span>n<span style="color: #33ffdd;">+1</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; n=n<span style="color: #33ffdd;">+1</span><br />
&nbsp; <span style="color: #ffee00">;Если номер узла вышел за пределы массива - возврат на узел 1, обнуление</span><br />
&nbsp; <span style="color: #ffee00">; счетчика времени</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> n&gt;q <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;n=<span style="color: #33ffdd;">1</span><br />
&nbsp; &nbsp;ms=<span style="color: #33ffdd;">0</span><br />
&nbsp; &nbsp;tbeg=<span style="color: #aaffff; font-weight: bold;">MilliSecs</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> nn=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">1</span><br />
&nbsp; &nbsp;d#<span style=" ">&#40;</span>nn<span style=" ">&#41;</span>=ptc#<span style=" ">&#40;</span>n,nn<span style=" ">&#41;</span><br />
&nbsp; &nbsp;c#<span style=" ">&#40;</span>nn<span style=" ">&#41;</span>=<span style=" ">&#40;</span>ptc#<span style=" ">&#40;</span>n<span style="color: #33ffdd;">+1</span>,nn<span style=" ">&#41;</span>-ptc#<span style=" ">&#40;</span>n<span style="color: #33ffdd;">-1</span>,nn<span style=" ">&#41;</span><span style=" ">&#41;</span>/<span style=" ">&#40;</span>tim<span style=" ">&#40;</span>n<span style="color: #33ffdd;">+1</span><span style=" ">&#41;</span>-tim<span style=" ">&#40;</span>n<span style="color: #33ffdd;">-1</span><span style=" ">&#41;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp;dy2#=<span style=" ">&#40;</span>ptc#<span style=" ">&#40;</span>n<span style="color: #33ffdd;">+2</span>,nn<span style=" ">&#41;</span>-ptc#<span style=" ">&#40;</span>n,nn<span style=" ">&#41;</span><span style=" ">&#41;</span>/<span style=" ">&#40;</span>tim<span style=" ">&#40;</span>n<span style="color: #33ffdd;">+2</span><span style=" ">&#41;</span>-tim<span style=" ">&#40;</span>n<span style=" ">&#41;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp;x3#=tim<span style=" ">&#40;</span>n<span style="color: #33ffdd;">+1</span><span style=" ">&#41;</span>-tim<span style=" ">&#40;</span>n<span style=" ">&#41;</span><br />
&nbsp; &nbsp;xx3#=x3#*x3#<br />
&nbsp; &nbsp;b#<span style=" ">&#40;</span>nn<span style=" ">&#41;</span>=<span style=" ">&#40;</span><span style="color: #33ffdd;">3</span>*ptc#<span style=" ">&#40;</span>n<span style="color: #33ffdd;">+1</span>,nn<span style=" ">&#41;</span>-dy2#*x3#<span style="color: #33ffdd;">-2</span>*c#<span style=" ">&#40;</span>nn<span style=" ">&#41;</span>*x3#<span style="color: #33ffdd;">-3</span>*d#<span style=" ">&#40;</span>nn<span style=" ">&#41;</span><span style=" ">&#41;</span>/xx3#<br />
&nbsp; &nbsp;a#<span style=" ">&#40;</span>nn<span style=" ">&#41;</span>=<span style=" ">&#40;</span>dy2#<span style="color: #33ffdd;">-2</span>*b#<span style=" ">&#40;</span>nn<span style=" ">&#41;</span>*x3#-c#<span style=" ">&#40;</span>nn<span style=" ">&#41;</span><span style=" ">&#41;</span>/<span style=" ">&#40;</span><span style="color: #33ffdd;">3</span>*xx3#<span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
<br />
&nbsp;<span style="color: #ffee00">;Вычисление координат объекта</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> nn=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">1</span><br />
&nbsp; v#=t-tim<span style=" ">&#40;</span>n<span style=" ">&#41;</span><br />
&nbsp; vv#=v#*v#<br />
&nbsp; oc#<span style=" ">&#40;</span>nn<span style=" ">&#41;</span>=a#<span style=" ">&#40;</span>nn<span style=" ">&#41;</span>*vv#*v#+b#<span style=" ">&#40;</span>nn<span style=" ">&#41;</span>*vv#+c#<span style=" ">&#40;</span>nn<span style=" ">&#41;</span>*v#+d#<span style=" ">&#40;</span>nn<span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
&nbsp;<span style="color: #ffee00">;Отображение фона, объекта и текущего времени</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">DrawBlock</span> i,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Oval</span> oc#<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span><span style=" ">&#41;</span><span style="color: #33ffdd;">-9</span>,oc#<span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><span style="color: #33ffdd;">-9</span>,<span style="color: #33ffdd;">19</span>,<span style="color: #33ffdd;">19</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #00ff66;">&quot;Time:&quot;</span>+<span style=" ">&#40;</span>.<span style="color: #33ffdd;">001</span>*t<span style=" ">&#41;</span>+<span style="color: #00ff66;">&quot;s&quot;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Flip</span> <br />
<br />
&nbsp;t=<span style="color: #aaffff; font-weight: bold;">MilliSecs</span><span style=" ">&#40;</span><span style=" ">&#41;</span>-tbeg<br />
</p>
<span style="color: #aaffff; font-weight: bold;">Until</span> <span style="color: #aaffff; font-weight: bold;">KeyHit</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span></div>
<div align="right"><a href="http://blitzetcetera.org/images/4/40/Interpolation.zip" class="internal" title="Interpolation.zip">скачать архив с файлами к статье</a></div>
<hr />
<p>Автор: <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Matt_Merkulov" title="Участник:Matt Merkulov">Матвей Меркулов</a> (E-mail: MattMerk@mail.ru, ICQ: 392-274-050)
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Четырехмерная геометрия"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Четырехмерная геометрия&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Четырехмерная геометрия&amp;action=edit">править</a>]</span><span class="mw-headline">Четырехмерная геометрия</span></h1>
</p>
<a name=".D0.9D.D0.B5.D0.BA.D0.BE.D1.82.D0.BE.D1.80.D1.8B.D0.B5_.D0.BA.D0.BE.D0.BC.D0.B1.D0.B8.D0.BD.D0.B0.D1.82.D0.BE.D1.80.D0.BD.D1.8B.D0.B5_.D0.B7.D0.B0.D0.B4.D0.B0.D1.87.D0.B8"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A7%D0%B5%D1%82%D1%8B%D1%80%D0%B5%D1%85%D0%BC%D0%B5%D1%80%D0%BD%D0%B0%D1%8F_%D0%B3%D0%B5%D0%BE%D0%BC%D0%B5%D1%82%D1%80%D0%B8%D1%8F&amp;action=edit&amp;section=1" title="Четырехмерная геометрия">править</a>]</span> <span class="mw-headline">Некоторые комбинаторные задачи</span></h2>
<p>Задача 1. Даны m вопросов, на каждый из которых можно ответить одним из n вариантов. Сколько существует разных способов ответа на весь цикл вопросов (два варианта, в которых хотя бы на один вопрос даются разные ответы, различны)? Ответ: n<sup>m</sup>.
</p><p>Задача 2. Сколькими способами можно выбрать два из n элементов (порядок не учитывается)? Решение: сначала возьмем один из n элементов. Останется n-1, из них возьмем еще один. Всего таких пар, следовательно, будет n * (n - 1), но так как порядок не учитывается, то пары (a, b) и (b, a) считаются одним вариантом, поэтому полученное число нужно разделить на 2. Ответ: n * (n - 1) / 2
</p>
<a name=".D0.A2.D0.B5.D1.81.D1.81.D0.B5.D1.80.D0.B0.D0.BA.D1.82"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A7%D0%B5%D1%82%D1%8B%D1%80%D0%B5%D1%85%D0%BC%D0%B5%D1%80%D0%BD%D0%B0%D1%8F_%D0%B3%D0%B5%D0%BE%D0%BC%D0%B5%D1%82%D1%80%D0%B8%D1%8F&amp;action=edit&amp;section=2" title="Четырехмерная геометрия">править</a>]</span> <span class="mw-headline">Тессеракт</span></h2>
<p>Посмотрел я фильм "Куб 2: гиперкуб" (рекомендую - оригинальный научно-психологический триллер) и захотелось мне поэкспериментировать с четырехмерными объектами. Четырехмерное пространство довольно сложно для представления, но его можно спроецировать на трехмерное (а трехмерное, в свою очередь - на экран) и получить проекцию. Делается это просто - путем отсечения четвертой координаты. Теперь разберемся, что из себя представляют 4D-объекты. Для этого придется использовать аналогию. В нуль-мерном  пространстве существует только один объект - точка, в одномерном можно выделить уже два типа объектов - точки и отрезки, в двумерном добавляются многоугольники, а в трехмерном - объемные тела. Соответственно, в четвертом измерении появляются четырехмерные тела. Будем называть точки - вершинами, отрезки - ребрами, многоугольники - гранями. Сначала - самый простой объект -  тессеракт или гиперкуб. Так объяснил, что это такое, один из персонажей фильма - инженер Джерри: "Смотрите: первое измерение назовем длиной. Представим его простой линией. Два измерения - длина и ширина. Можно представить простым квадратом. Добавляем к нему еще одно измерение - получаем куб. У куба три измерения - длина, ширина, глубина. Теперь самое интересное: если добавить к этому кубу еще одно измерение - получим... получим тессеракт!". Вот квадрат и куб:
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:4DGeom01.gif" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:4DGeom01.gif" src="lkngy9c1.gif" width="521" height="182" /></a></span></div></div>
<p>Можно заметить, что координаты их вершин - это всевозможные комбинации вида (a, b) и (a, b, c), где a, b и c могут принимать значения 1 или -1, а ребра соединяют вершины, у которых все соответствующие координаты равны, кроме одной. Плоскости куба включают вершины, у которых две координаты могут отличаться, а одна оставшаяся - неизменна. Перенесем эти правила на гиперкуб: точка в четырехмерном пространстве имеет координаты (a, b, c, d). a, b, c, d имеют координаты 1 или -1. Всего - 2<sup>4</sup> = 16 вариантов - 16 вершин. Ребра: фиксируем переменную (4 варианта), остальным трем придаем всевозможные значения (2<sup>3</sup> = 8 вариантов) - итого 4 * 8 = 32 ребра. Плоскости: фиксируем 2 переменные (3 + 2 + 1 = 6 вариантов), оставшимся двум  придаем случайные значения  (2<sup>2</sup> = 4 варианта) - итого 6 * 4 = 24 плоскости. В первой программе спроецированный гиперкуб изображен с помощью частично прозрачных граней. Вращайте гиперкуб в четырехмерном пространстве клавишами 1-6, а его проекцию в трехмерном - клавишами 7-9.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Graphics3D</span> <span style="color: #33ffdd;">640</span>,<span style="color: #33ffdd;">480</span>,<span style="color: #33ffdd;">32</span><br />
<p><span style="color: #aaffff; font-weight: bold;">PositionEntity</span> <span style="color: #aaffff; font-weight: bold;">CreateCamera</span><span style=" ">&#40;</span><span style=" ">&#41;</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">-5</span><br />
<span style="color: #aaffff; font-weight: bold;">RotateEntity</span> <span style="color: #aaffff; font-weight: bold;">CreateLight</span><span style=" ">&#40;</span><span style=" ">&#41;</span>,<span style="color: #33ffdd;">45</span>,<span style="color: #33ffdd;">45</span>,<span style="color: #33ffdd;">0</span><br />
p=<span style="color: #aaffff; font-weight: bold;">CreatePivot</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Создание фигуры и поверхности</span><br />
m=<span style="color: #aaffff; font-weight: bold;">CreateMesh</span><span style=" ">&#40;</span>p<span style=" ">&#41;</span><br />
s=<span style="color: #aaffff; font-weight: bold;">CreateSurface</span><span style=" ">&#40;</span>m<span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Эффекты фигуры: отключение &quot;одностороности&quot; граней (16) + подсветка (1)</span><br />
<span style="color: #aaffff; font-weight: bold;">EntityFX</span> m,<span style="color: #33ffdd;">17</span><br />
<br />
<span style="color: #ffee00">;Создание текстуры для граней</span><br />
tex=<span style="color: #aaffff; font-weight: bold;">CreateTexture</span><span style=" ">&#40;</span><span style="color: #33ffdd;">8</span>,<span style="color: #33ffdd;">8</span>,<span style="color: #33ffdd;">14</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">TextureBuffer</span><span style=" ">&#40;</span>tex<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Rect</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">8</span>,<span style="color: #33ffdd;">8</span>,<span style="color: #33ffdd;">0</span><br />
<span style="color: #ffee00">;Установка позрачных пикселов (альфа=0)</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> x=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">6</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> y=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">6</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">WritePixel</span> x,y,<span style="color: #33ffdd;">0</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">EntityTexture</span> m,tex<br />
<br />
<span style="color: #ffee00">;Массив для координат вершин граней</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> v#<span style=" ">&#40;</span><span style="color: #33ffdd;">99</span>,<span style="color: #33ffdd;">4</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> r<span style=" ">&#40;</span><span style="color: #33ffdd;">5</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Фиксация двух координат</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n1=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">2</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> n2=n1<span style="color: #33ffdd;">+1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">3</span><br />
&nbsp; <span style="color: #ffee00">;Они также используются для определения плоскостей вращения</span><br />
&nbsp; r<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>=n1<br />
&nbsp; r<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>=n2<br />
&nbsp; n=n<span style="color: #33ffdd;">+1</span><br />
&nbsp; <span style="color: #ffee00">;Определение позиций двух оставшихся координат</span><br />
&nbsp; n3=<span style=" ">&#40;</span>n1*n2=<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>+<span style=" ">&#40;</span>n1+n2=<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
&nbsp; n4=<span style="color: #33ffdd;">6</span>-n1-n2-n3<br />
&nbsp; <span style="color: #ffee00">;Циклы для придания всех возможных значений этим координатам</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> sn1=<span style="color: #33ffdd;">-1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">Step</span> <span style="color: #33ffdd;">2</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> sn2=<span style="color: #33ffdd;">-1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">Step</span> <span style="color: #33ffdd;">2</span><br />
&nbsp; &nbsp; <span style="color: #ffee00">;Циклы для вершин граней</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> sn3=<span style="color: #33ffdd;">-1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">Step</span> <span style="color: #33ffdd;">2</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> sn4=<span style="color: #33ffdd;">-1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">Step</span> <span style="color: #33ffdd;">2</span><br />
&nbsp; &nbsp; &nbsp; v#<span style=" ">&#40;</span>nn,n1<span style=" ">&#41;</span>=sn1<br />
&nbsp; &nbsp; &nbsp; v#<span style=" ">&#40;</span>nn,n2<span style=" ">&#41;</span>=sn2<br />
&nbsp; &nbsp; &nbsp; v#<span style=" ">&#40;</span>nn,n3<span style=" ">&#41;</span>=sn3<br />
&nbsp; &nbsp; &nbsp; v#<span style=" ">&#40;</span>nn,n4<span style=" ">&#41;</span>=sn4<br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">AddVertex</span> s,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,sn3=<span style="color: #33ffdd;">1</span>,sn4=<span style="color: #33ffdd;">1</span><br />
&nbsp; &nbsp; &nbsp; nn=nn<span style="color: #33ffdd;">+1</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; &nbsp; <span style="color: #ffee00">;Добавление грани к фигуре</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">AddTriangle</span> s,nn<span style="color: #33ffdd;">-4</span>,nn<span style="color: #33ffdd;">-3</span>,nn<span style="color: #33ffdd;">-2</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">AddTriangle</span> s,nn<span style="color: #33ffdd;">-1</span>,nn<span style="color: #33ffdd;">-3</span>,nn<span style="color: #33ffdd;">-2</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span> &nbsp;<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
ang#=<span style="color: #33ffdd;">1</span><br />
sina#=<span style="color: #aaffff; font-weight: bold;">Sin</span><span style=" ">&#40;</span>ang#<span style=" ">&#41;</span><br />
cosa#=<span style="color: #aaffff; font-weight: bold;">Cos</span><span style=" ">&#40;</span>ang#<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
<br />
&nbsp;<span style="color: #ffee00">;Поворот тела (а точнее-вершин граней) вокруг плоскостей при нажатии клавиш 1-6</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> n3=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">5</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">KeyDown</span><span style=" ">&#40;</span>n3<span style="color: #33ffdd;">+2</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;n1=r<span style=" ">&#40;</span>n3,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp;n2=r<span style=" ">&#40;</span>n3,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> nn<span style="color: #33ffdd;">-1</span><br />
&nbsp; &nbsp; c1#=v<span style=" ">&#40;</span>n,n1<span style=" ">&#41;</span>*cosa#-v<span style=" ">&#40;</span>n,n2<span style=" ">&#41;</span>*sina#<br />
&nbsp; &nbsp; c2#=v<span style=" ">&#40;</span>n,n1<span style=" ">&#41;</span>*sina#+v<span style=" ">&#40;</span>n,n2<span style=" ">&#41;</span>*cosa#<br />
&nbsp; &nbsp; v<span style=" ">&#40;</span>n,n1<span style=" ">&#41;</span>=c1#<br />
&nbsp; &nbsp; v<span style=" ">&#40;</span>n,n2<span style=" ">&#41;</span>=c2#<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
&nbsp;<span style="color: #ffee00">;Поворот трехмерной проекции при нажатии клавиш 7-9</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> n3=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">2</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">KeyDown</span><span style=" ">&#40;</span>n3<span style="color: #33ffdd;">+8</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">TurnEntity</span> p,ang#*<span style=" ">&#40;</span>n3=<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>,ang#*<span style=" ">&#40;</span>n3=<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>,ang#*<span style=" ">&#40;</span>n3=<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
&nbsp;<span style="color: #ffee00">;Установка координат вершин граней</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> nn<span style="color: #33ffdd;">-1</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">VertexCoords</span> s,n,v<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>,v<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>,v<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">RenderWorld</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Flip</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">Until</span> <span style="color: #aaffff; font-weight: bold;">KeyHit</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span></div>
<p>Вторая программа демонстрирует проекцию гиперкуба, где ребра изображены цилиндрами, а вершины - сферами:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Graphics3D</span> <span style="color: #33ffdd;">640</span>,<span style="color: #33ffdd;">480</span>,<span style="color: #33ffdd;">32</span><br />
<p>p=<span style="color: #aaffff; font-weight: bold;">CreatePivot</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> <span style="color: #aaffff; font-weight: bold;">CreateCamera</span><span style=" ">&#40;</span>p<span style=" ">&#41;</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">-5</span><br />
<span style="color: #aaffff; font-weight: bold;">RotateEntity</span> <span style="color: #aaffff; font-weight: bold;">CreateLight</span><span style=" ">&#40;</span><span style=" ">&#41;</span>,<span style="color: #33ffdd;">45</span>,<span style="color: #33ffdd;">45</span>,<span style="color: #33ffdd;">0</span><br />
<br />
<span style="color: #ffee00">;Заполнение массива вершин. При этом, если номер каждой вершины представить в</span><br />
<span style="color: #ffee00">; двоичном исчислении, то каждый бит будет определять соответствующую</span><br />
<span style="color: #ffee00">; координату: если бит выключен, то координата равна -1, иначе - +1</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> v#<span style=" ">&#40;</span><span style="color: #33ffdd;">15</span>,<span style="color: #33ffdd;">4</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n1=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">15</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> n2=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">3</span><br />
&nbsp; v#<span style=" ">&#40;</span>n1,n2<span style=" ">&#41;</span>=<span style="color: #aaffff; font-weight: bold;">Sgn</span><span style=" ">&#40;</span>n1 <span style="color: #aaffff; font-weight: bold;">And</span> <span style=" ">&#40;</span><span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">Shl</span> n2<span style=" ">&#41;</span><span style=" ">&#41;</span>*<span style="color: #33ffdd;">2</span><span style="color: #33ffdd;">-1</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #ffee00">;Создание шаров, изображающих вершины</span><br />
&nbsp;v<span style=" ">&#40;</span>n1,<span style="color: #33ffdd;">4</span><span style=" ">&#41;</span>=<span style="color: #aaffff; font-weight: bold;">CreateSphere</span><span style=" ">&#40;</span><span style="color: #33ffdd;">10</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> v<span style=" ">&#40;</span>n1,<span style="color: #33ffdd;">4</span><span style=" ">&#41;</span>,.<span style="color: #33ffdd;">2</span>,.<span style="color: #33ffdd;">2</span>,.<span style="color: #33ffdd;">2</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
<span style="color: #ffee00">;Заполнение массива плоскостей вращения (всевозможные варианты пар осей)</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> r<span style=" ">&#40;</span><span style="color: #33ffdd;">5</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n1=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">2</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> n2=n1<span style="color: #33ffdd;">+1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">3</span><br />
&nbsp; r<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>=n1<br />
&nbsp; r<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>=n2<br />
&nbsp; n=n<span style="color: #33ffdd;">+1</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
<span style="color: #ffee00">;Массив адресов цилиндров - ребер</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> e<span style=" ">&#40;</span><span style="color: #33ffdd;">15</span>,<span style="color: #33ffdd;">3</span><span style=" ">&#41;</span><br />
<span style="color: #ffee00">;Вспомогательный вектор</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> d#<span style=" ">&#40;</span><span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #ffee00">;Предварительные вычисления</span><br />
ang#=<span style="color: #33ffdd;">1</span><br />
sina#=<span style="color: #aaffff; font-weight: bold;">Sin</span><span style=" ">&#40;</span>ang#<span style=" ">&#41;</span><br />
cosa#=<span style="color: #aaffff; font-weight: bold;">Cos</span><span style=" ">&#40;</span>ang#<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
<br />
&nbsp;<span style="color: #ffee00">;Поворот тела (а точнее-вершин) вокруг плоскостей при нажатии клавиш 1-6</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> n3=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">5</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">KeyDown</span><span style=" ">&#40;</span>n3<span style="color: #33ffdd;">+2</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;n1=r<span style=" ">&#40;</span>n3,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp;n2=r<span style=" ">&#40;</span>n3,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">15</span><br />
&nbsp; &nbsp; c1#=v<span style=" ">&#40;</span>n,n1<span style=" ">&#41;</span>*cosa#-v<span style=" ">&#40;</span>n,n2<span style=" ">&#41;</span>*sina#<br />
&nbsp; &nbsp; c2#=v<span style=" ">&#40;</span>n,n1<span style=" ">&#41;</span>*sina#+v<span style=" ">&#40;</span>n,n2<span style=" ">&#41;</span>*cosa#<br />
&nbsp; &nbsp; v<span style=" ">&#40;</span>n,n1<span style=" ">&#41;</span>=c1#<br />
&nbsp; &nbsp; v<span style=" ">&#40;</span>n,n2<span style=" ">&#41;</span>=c2#<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
&nbsp;<span style="color: #ffee00">;Создание ребер. Цикл по всем вершинам</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> n1=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">15</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">3</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">;Определение смежной вершины путем включения одного бита (то есть изменения</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">; одной из координат). При этом происходит отсечени дублирующих ребер: номер</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">; первой координаты должен быть меньше второй.</span><br />
&nbsp; &nbsp;n2=n1 <span style="color: #aaffff; font-weight: bold;">Or</span> <span style=" ">&#40;</span><span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">Shl</span> n<span style=" ">&#41;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> n1&lt;&gt;n2 <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; <span style="color: #ffee00">;Создание цилиндра-ребра (если еще не создано)</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> e<span style=" ">&#40;</span>n1,n<span style=" ">&#41;</span>=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span> e<span style=" ">&#40;</span>n1,n<span style=" ">&#41;</span>=<span style="color: #aaffff; font-weight: bold;">CreateCylinder</span><span style=" ">&#40;</span><span style="color: #33ffdd;">8</span>,<span style="color: #aaffff; font-weight: bold;">False</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; a=e<span style=" ">&#40;</span>n1,n<span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffee00">;Вычисление центра ребра и установка цилиндра в центр</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> n3=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">2</span><br />
&nbsp; &nbsp; &nbsp;d#<span style=" ">&#40;</span>n3<span style=" ">&#41;</span>=.<span style="color: #33ffdd;">5</span>*<span style=" ">&#40;</span>v<span style=" ">&#40;</span>n1,n3<span style=" ">&#41;</span>+v<span style=" ">&#40;</span>n2,n3<span style=" ">&#41;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">PositionEntity</span> a,d#<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>,d#<span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>,d#<span style=" ">&#40;</span><span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #ffee00">;Вычисления вектора ребра и выравнивание цилиндра по нему</span><br />
&nbsp; &nbsp; dd#=<span style="color: #33ffdd;">0</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> n3=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">2</span><br />
&nbsp; &nbsp; &nbsp;d#<span style=" ">&#40;</span>n3<span style=" ">&#41;</span>=v<span style=" ">&#40;</span>n1,n3<span style=" ">&#41;</span>-v<span style=" ">&#40;</span>n2,n3<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp;dd#=dd#+d#<span style=" ">&#40;</span>n3<span style=" ">&#41;</span>*d#<span style=" ">&#40;</span>n3<span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span> &nbsp; &nbsp; &nbsp;<br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">AlignToVector</span> a,d#<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>,d#<span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>,d#<span style=" ">&#40;</span><span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>,<span style="color: #33ffdd;">2</span><br />
&nbsp; &nbsp; <span style="color: #ffee00">;Масштабирование цилиндра по длине ребра</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> a,.<span style="color: #33ffdd;">1</span>,.<span style="color: #33ffdd;">5</span>*<span style="color: #aaffff; font-weight: bold;">Sqr</span><span style=" ">&#40;</span>dd#<span style=" ">&#41;</span>,.<span style="color: #33ffdd;">1</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> n3=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">2</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">KeyDown</span><span style=" ">&#40;</span>n3<span style="color: #33ffdd;">+8</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> &nbsp; <br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">TurnEntity</span> p,ang#*<span style=" ">&#40;</span>n3=<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>,ang#*<span style=" ">&#40;</span>n3=<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>,ang#*<span style=" ">&#40;</span>n3=<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
&nbsp;<span style="color: #ffee00">;Установка сфер</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">15</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">PositionEntity</span> v<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">4</span><span style=" ">&#41;</span>,v<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>,v<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>,v<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">RenderWorld</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Flip</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">Until</span> <span style="color: #aaffff; font-weight: bold;">KeyHit</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span></div>
<a name=".D0.A7.D0.B5.D1.82.D1.8B.D1.80.D0.B5.D1.85.D0.BC.D0.B5.D1.80.D0.BD.D1.8B.D0.B9_.D0.BE.D0.BA.D1.82.D0.B0.D1.8D.D0.B4.D1.80"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%A7%D0%B5%D1%82%D1%8B%D1%80%D0%B5%D1%85%D0%BC%D0%B5%D1%80%D0%BD%D0%B0%D1%8F_%D0%B3%D0%B5%D0%BE%D0%BC%D0%B5%D1%82%D1%80%D0%B8%D1%8F&amp;action=edit&amp;section=3" title="Четырехмерная геометрия">править</a>]</span> <span class="mw-headline">Четырехмерный октаэдр</span></h2>
<p>Можно выявить закономерности и в октаэдре:
</p>
<div class="center"><div class="floatnone"><span><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:4DGeom02.gif" class="image" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:4DGeom02.gif" src="h9zvxkxg.gif" width="488" height="204" /></a></span></div></div>
<p>Одна из координат каждой вершины равна 1 или -1, остальные - 0 (всего 3 * 2 = 6 вершин), ребра соединяют все вершины, кроме противоположной (то есть, той, у которой ненулевая координата находится на той же позиции) - 6 * 5 / 2 - 3 = 10 ребер (из всех возможных отрезков между вершинами исключаем 3, соединяющие противоположные вершины), а треугольные грани соединяют точки с разными положениями ненулевых координат 2<sup>3</sup> = 8. Переносим эти закономерности на четырехмерное пространство: 4 * 2 = 8 вершин, 8 * 7 / 2 - 4 = 24 ребра, 4 * 2<sup>3</sup> = 32 грани.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Graphics3D</span> <span style="color: #33ffdd;">640</span>,<span style="color: #33ffdd;">480</span>,<span style="color: #33ffdd;">32</span><br />
<p>p=<span style="color: #aaffff; font-weight: bold;">CreatePivot</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> <span style="color: #aaffff; font-weight: bold;">CreateCamera</span><span style=" ">&#40;</span>p<span style=" ">&#41;</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">-2.5</span><br />
<span style="color: #aaffff; font-weight: bold;">RotateEntity</span> <span style="color: #aaffff; font-weight: bold;">CreateLight</span><span style=" ">&#40;</span><span style=" ">&#41;</span>,<span style="color: #33ffdd;">45</span>,<span style="color: #33ffdd;">45</span>,<span style="color: #33ffdd;">0</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> v#<span style=" ">&#40;</span><span style="color: #33ffdd;">7</span>,<span style="color: #33ffdd;">4</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n1=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">7</span><br />
&nbsp;v#<span style=" ">&#40;</span>n1,n1 <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>=<span style=" ">&#40;</span>n1 <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">1</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">1</span><span style="color: #33ffdd;">-1</span><br />
&nbsp;v<span style=" ">&#40;</span>n1,<span style="color: #33ffdd;">4</span><span style=" ">&#41;</span>=<span style="color: #aaffff; font-weight: bold;">CreateSphere</span><span style=" ">&#40;</span><span style="color: #33ffdd;">10</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> v<span style=" ">&#40;</span>n1,<span style="color: #33ffdd;">4</span><span style=" ">&#41;</span>,.<span style="color: #33ffdd;">1</span>,.<span style="color: #33ffdd;">1</span>,.<span style="color: #33ffdd;">1</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> r<span style=" ">&#40;</span><span style="color: #33ffdd;">5</span>,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n1=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">2</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> n2=n1<span style="color: #33ffdd;">+1</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">3</span><br />
&nbsp; r<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>=n1<br />
&nbsp; r<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>=n2<br />
&nbsp; n=n<span style="color: #33ffdd;">+1</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> e<span style=" ">&#40;</span><span style="color: #33ffdd;">30</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> d#<span style=" ">&#40;</span><span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><br />
<br />
ang#=<span style="color: #33ffdd;">1</span><br />
sina#=<span style="color: #aaffff; font-weight: bold;">Sin</span><span style=" ">&#40;</span>ang#<span style=" ">&#41;</span><br />
cosa#=<span style="color: #aaffff; font-weight: bold;">Cos</span><span style=" ">&#40;</span>ang#<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> n3=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">5</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">KeyDown</span><span style=" ">&#40;</span>n3<span style="color: #33ffdd;">+2</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;n1=r<span style=" ">&#40;</span>n3,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp;n2=r<span style=" ">&#40;</span>n3,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">7</span><br />
&nbsp; &nbsp; c1#=v<span style=" ">&#40;</span>n,n1<span style=" ">&#41;</span>*cosa#-v<span style=" ">&#40;</span>n,n2<span style=" ">&#41;</span>*sina#<br />
&nbsp; &nbsp; c2#=v<span style=" ">&#40;</span>n,n1<span style=" ">&#41;</span>*sina#+v<span style=" ">&#40;</span>n,n2<span style=" ">&#41;</span>*cosa#<br />
&nbsp; &nbsp; v<span style=" ">&#40;</span>n,n1<span style=" ">&#41;</span>=c1#<br />
&nbsp; &nbsp; v<span style=" ">&#40;</span>n,n2<span style=" ">&#41;</span>=c2#<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
&nbsp;num=<span style="color: #33ffdd;">0</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> n1=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">7</span> &nbsp;<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> n2=n1<span style="color: #33ffdd;">+2</span>-<span style=" ">&#40;</span>n1 <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">1</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">7</span> &nbsp; <br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> e<span style=" ">&#40;</span>num<span style=" ">&#41;</span>=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span> e<span style=" ">&#40;</span>num<span style=" ">&#41;</span>=<span style="color: #aaffff; font-weight: bold;">CreateCylinder</span><span style=" ">&#40;</span><span style="color: #33ffdd;">8</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp;a=e<span style=" ">&#40;</span>num<span style=" ">&#41;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> n3=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">2</span><br />
&nbsp; &nbsp; d#<span style=" ">&#40;</span>n3<span style=" ">&#41;</span>=.<span style="color: #33ffdd;">5</span>*<span style=" ">&#40;</span>v<span style=" ">&#40;</span>n1,n3<span style=" ">&#41;</span>+v<span style=" ">&#40;</span>n2,n3<span style=" ">&#41;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span> &nbsp; &nbsp; &nbsp;<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">PositionEntity</span> a,d#<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>,d#<span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>,d#<span style=" ">&#40;</span><span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp;dd#=<span style="color: #33ffdd;">0</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> n3=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">2</span><br />
&nbsp; &nbsp; d#<span style=" ">&#40;</span>n3<span style=" ">&#41;</span>=v<span style=" ">&#40;</span>n1,n3<span style=" ">&#41;</span>-v<span style=" ">&#40;</span>n2,n3<span style=" ">&#41;</span><br />
&nbsp; &nbsp; dd#=dd#+d#<span style=" ">&#40;</span>n3<span style=" ">&#41;</span>*d#<span style=" ">&#40;</span>n3<span style=" ">&#41;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span> &nbsp; &nbsp; &nbsp;<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">ScaleEntity</span> a,.<span style="color: #33ffdd;">05</span>,.<span style="color: #33ffdd;">5</span>*<span style="color: #aaffff; font-weight: bold;">Sqr</span><span style=" ">&#40;</span>dd#<span style=" ">&#41;</span>,.<span style="color: #33ffdd;">05</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">AlignToVector</span> a,d#<span style=" ">&#40;</span><span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>,d#<span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>,d#<span style=" ">&#40;</span><span style="color: #33ffdd;">2</span><span style=" ">&#41;</span>,<span style="color: #33ffdd;">2</span> &nbsp; &nbsp;<br />
&nbsp; &nbsp;num=num<span style="color: #33ffdd;">+1</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> n3=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">2</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">KeyDown</span><span style=" ">&#40;</span>n3<span style="color: #33ffdd;">+8</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> &nbsp; <br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">TurnEntity</span> p,ang#*<span style=" ">&#40;</span>n3=<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>,ang#*<span style=" ">&#40;</span>n3=<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>,ang#*<span style=" ">&#40;</span>n3=<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">7</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">PositionEntity</span> v<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">4</span><span style=" ">&#41;</span>,v<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>,v<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>,v<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">RenderWorld</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Flip</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">Until</span> <span style="color: #aaffff; font-weight: bold;">KeyHit</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span></div>
<div align="right"><a href="http://blitzetcetera.org/images/8/8f/4D_Geometry.zip" class="internal" title="4D Geometry.zip">скачать архив с файлами к статье</a></div>
<hr />
<p>Автор: <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Matt_Merkulov" title="Участник:Matt Merkulov">Матвей Меркулов</a> (E-mail: MattMerk@mail.ru, ICQ: 392-274-050)
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Эксперименты с «Жизнью»"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Эксперименты с «Жизнью»&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Эксперименты с «Жизнью»&amp;action=edit">править</a>]</span><span class="mw-headline">Эксперименты с «Жизнью»</span></h1>
</p>
<a name=".D0.9C.D0.BE.D0.B4.D0.B8.D1.84.D0.B8.D0.BA.D0.B0.D1.86.D0.B8.D0.B8"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%AD%D0%BA%D1%81%D0%BF%D0%B5%D1%80%D0%B8%D0%BC%D0%B5%D0%BD%D1%82%D1%8B_%D1%81_%C2%AB%D0%96%D0%B8%D0%B7%D0%BD%D1%8C%D1%8E%C2%BB&amp;action=edit&amp;section=1" title="Эксперименты с «Жизнью»">править</a>]</span> <span class="mw-headline">Модификации</span></h2>
<p>Используется программа "жизни" из предыдущего выпуска.
</p><p>Можно легко сделать полезные cчетчики поколений и клеток.
</p><p>Ограничение поля: для того, чтобы планеры не прилетали с другой стороны и не вносили изменений в организм, можно сделать "мертвый прямоугольник", то есть зону по краям поля, где клетки не будут рождаться. Тогда планеры будут превращаться в блоки, достигнув границы. Определим границей линии x=0 и y=0.
</p><p>Детектор стабилизации: пульсирующие конфигурации, возникающие в процессе  развития случайно заполненной области, как правило, имеют период не выше трех. Поэтому, стабилизацию можно зафиксировать, если счетчик количества клеток принимает одно и то же значение через каждые два, три или шесть ходов несколько раз. В этом случае, очищаем буфера и задаем новую прямоугольную область.
</p><p>Поиск долгоживущих конфигураций: можно провести небольшое исследование: поиск небольших по размерам конфигураций с продолжительностью жизни более 2000 поколений. Будем заполнять случайным образом квадрат 7х7 клеток и смотреть, сколько он продержится. Рекордсменов будем записывать в текстовый файл.
</p><p>Редактирование организма: вместо того, чтобы писать сложный многофункциональный редактор, удобнее поступить следующим образом: редактировать организм, как растровую картинку, где белый пиксел - клетка, а черный - пустая ячейка, и обрабатывать этот файл в программе. Поместим организм в центре поля (используя размеры рисунка). Вот примеры:
</p>
<center><table class="gallery" cellspacing="0" cellpadding="0">
	<tr>
		<td><div class="gallerybox" style="width: 150px;">
			<div class="thumb" style="padding: 71px 0; width: 150px;"><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Life-Locomotive.png" title="Изображение:Life-Locomotive.png"><img src="8xb_3obv.png" width="120" height="3" alt="" /></a></div>
			<div class="gallerytext">
<p>"паровоз"<!-- 
Pre-expand include size: 126381 bytes
Post-expand include size: 70284 bytes
Template argument size: 189 bytes
Maximum: 2097152 bytes
-->
</p>
			</div>
		</div></td>
		<td><div class="gallerybox" style="width: 150px;">
			<div class="thumb" style="padding: 13px 0; width: 150px;"><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Life-Virus.png" title="Изображение:Life-Virus.png"><img src="ukyx2srm.png" width="93" height="120" alt="" /></a></div>
			<div class="gallerytext">
<p>"вирус"<!-- 
Pre-expand include size: 126381 bytes
Post-expand include size: 70284 bytes
Template argument size: 189 bytes
Maximum: 2097152 bytes
-->
</p>
			</div>
		</div></td>
	</tr>
</table></center>
<p>Изменение правил: это просто - меняем содержимое "массива правил". Для этого лучше написать более удобную процедуру. Попробуйте следующие варианты (взяты из программы MCell). В таблице даны количества соседей при рождении и смерти:
</p>
<table border="2" align="center">
<tr>
<td>
</td><td> 2х2
</td><td> Коралл
</td><td> Лабиринт
</td><td> Движение
</td><td> Стены городов
</td></tr>
<tr align="center">
<td> Рождение
</td><td> 36
</td><td> 3
</td><td> 3
</td><td> 013678
</td><td> 45678
</td></tr>
<tr align="center">
<td> Смерть
</td><td> 034678
</td><td> 0123
</td><td> 0678
</td><td> 368
</td><td> 01678
</td></tr></table>
<p>Периодический "взрыв": очень интересно наблюдать за развитием, если через определенное количество ходов изменять правила на один ход. В этом случае, уже остановившийся в развитии организм получает толчок и жизнь опять вспыхивает (неплохой вариант - сделать правила в этот ход "помягче"). Детектор стабилизации лучше отключить. 
</p>
<a name=".D0.9F.D1.80.D0.BE.D0.B3.D1.80.D0.B0.D0.BC.D0.BC.D0.B0"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%AD%D0%BA%D1%81%D0%BF%D0%B5%D1%80%D0%B8%D0%BC%D0%B5%D0%BD%D1%82%D1%8B_%D1%81_%C2%AB%D0%96%D0%B8%D0%B7%D0%BD%D1%8C%D1%8E%C2%BB&amp;action=edit&amp;section=2" title="Эксперименты с «Жизнью»">править</a>]</span> <span class="mw-headline">Программа</span></h2>
<p>Вот программа, в которой сочетаются все вышеперечисленные добавки. Пробуйте изменять константы:
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">SeedRnd</span> <span style="color: #aaffff; font-weight: bold;">MilliSecs</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<p><br />
<span style="color: #aaffff; font-weight: bold;">Const</span> xres=<span style="color: #33ffdd;">800</span>, yres=<span style="color: #33ffdd;">600</span>, fsiz=<span style="color: #33ffdd;">10</span>, cell=<span style="color: #33ffdd;">30</span><br />
<span style="color: #ffee00">;dst - флаг детектора стабилизации, dstperiod - наибольший распознаваемый период</span><br />
<span style="color: #ffee00">; конфигураций, dstpasses - кол-во проверок, rep - флаг повторений, bnd - флаг</span><br />
<span style="color: #ffee00">; ограничения поля, visible - отображение организма на экране, explo - режим</span><br />
<span style="color: #ffee00">; периодического &quot;взрыва&quot;, xper - частота &quot;взрыва&quot; в поколениях, loadorg$ -</span><br />
<span style="color: #ffee00">; - загрузка организма из файла, search - режим поиска долгожителей (0 - откл,</span><br />
<span style="color: #ffee00">; любое положительное число - минимальное кол-во поколений для записи в файл)</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Const</span> dstperiod=<span style="color: #33ffdd;">3</span>, dstpasses=<span style="color: #33ffdd;">5</span>, xper=<span style="color: #33ffdd;">256</span>, bnd=<span style="color: #33ffdd;">1</span>, visible=<span style="color: #33ffdd;">1</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Const</span> explo=<span style="color: #33ffdd;">1</span>, xrect=<span style="color: #33ffdd;">150</span>, yrect=<span style="color: #33ffdd;">100</span><br />
<span style="color: #ffee00">;Const dst=1, search=2000, xrect=7, yrect=7</span><br />
<span style="color: #ffee00">;Const dst=1, loadorg$=&quot;Life-Locomotive.png&quot;, xrect=0, yrect=0</span><br />
<span style="color: #ffee00">;Const dst=1, loadorg$=&quot;Life-Virus.png&quot;, xrect=0, yrect=0</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Const</span> fsiz0=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">Shl</span> fsiz,fsiz1=fsiz0<span style="color: #33ffdd;">-1</span>,fsiz2=<span style=" ">&#40;</span>fsiz0 <span style="color: #aaffff; font-weight: bold;">Shl</span> fsiz<span style=" ">&#41;</span>,fsiz3=fsiz2<span style="color: #33ffdd;">-1</span><br />
<span style="color: #aaffff; font-weight: bold;">Const</span> xc=<span style=" ">&#40;</span>fsiz0-xres<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">1</span>,yc=<span style=" ">&#40;</span>fsiz0-yres<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">1</span><br />
<span style="color: #aaffff; font-weight: bold;">Const</span> x1=<span style=" ">&#40;</span>xres-xrect<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">1</span>,x2=<span style=" ">&#40;</span><span style=" ">&#40;</span>xres+xrect<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><span style="color: #33ffdd;">-1</span><br />
<span style="color: #aaffff; font-weight: bold;">Const</span> y1=<span style=" ">&#40;</span>yres-yrect<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">1</span>,y2=<span style=" ">&#40;</span><span style=" ">&#40;</span>yres+yrect<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><span style="color: #33ffdd;">-1</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Global</span> ib, bnk, dbnk, dend, cellq<br />
<br />
<span style="color: #aaffff; font-weight: bold;">Graphics</span> xres,yres,<span style="color: #33ffdd;">32</span><br />
<span style="color: #aaffff; font-weight: bold;">SetFont</span> <span style="color: #aaffff; font-weight: bold;">LoadFont</span> <span style=" ">&#40;</span><span style="color: #00ff66;">&quot;Arial cyr&quot;</span>,<span style="color: #33ffdd;">14</span><span style=" ">&#41;</span><br />
<br />
buf=<span style="color: #aaffff; font-weight: bold;">CreateImage</span><span style=" ">&#40;</span>xres,yres<span style=" ">&#41;</span><br />
ib=<span style="color: #aaffff; font-weight: bold;">ImageBuffer</span><span style=" ">&#40;</span>buf<span style=" ">&#41;</span><br />
<br />
bnk=<span style="color: #aaffff; font-weight: bold;">CreateBank</span><span style=" ">&#40;</span>fsiz2<span style=" ">&#41;</span><br />
dbnk=<span style="color: #aaffff; font-weight: bold;">CreateBank</span><span style=" ">&#40;</span>fsiz2 <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">2</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> neig<span style=" ">&#40;</span><span style="color: #33ffdd;">8</span><span style=" ">&#41;</span><br />
k=-fsiz0<span style="color: #33ffdd;">-1</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">7</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> n=<span style="color: #33ffdd;">3</span> <span style="color: #aaffff; font-weight: bold;">Then</span> k=<span style="color: #33ffdd;">-1</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> n=<span style="color: #33ffdd;">5</span> <span style="color: #aaffff; font-weight: bold;">Then</span> k=fsiz0<span style="color: #33ffdd;">-1</span><br />
&nbsp;neig<span style=" ">&#40;</span>n<span style=" ">&#41;</span>=k<br />
&nbsp;k=k<span style="color: #33ffdd;">+1</span>+<span style=" ">&#40;</span>n=<span style="color: #33ffdd;">3</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> change<span style=" ">&#40;</span><span style="color: #33ffdd;">64</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">3</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Read</span> m$<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> nn=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">8</span><br />
&nbsp; change<span style=" ">&#40;</span>n*<span style="color: #33ffdd;">16</span>+nn<span style=" ">&#41;</span>=<span style="color: #aaffff; font-weight: bold;">Sgn</span><span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">Instr</span><span style=" ">&#40;</span>m$,nn<span style=" ">&#41;</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;3&quot;</span>,<span style="color: #00ff66;">&quot;0145678&quot;</span><span style="color: #ffee00">;основные правила</span><br />
<span style="color: #aaffff; font-weight: bold;">Data</span> <span style="color: #00ff66;">&quot;23&quot;</span>,<span style="color: #00ff66;">&quot;0245678&quot;</span><span style="color: #ffee00">;правила для &quot;взрыва&quot;</span><br />
<br />
<span style="color: #ffee00">;Массив для хранения сгенерированного организма</span><br />
<span style="color: #aaffff; font-weight: bold;">Dim</span> org<span style=" ">&#40;</span>xrect,yrect<span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">If</span> search <span style="color: #aaffff; font-weight: bold;">Then</span> f=<span style="color: #aaffff; font-weight: bold;">WriteFile</span><span style=" ">&#40;</span><span style="color: #00ff66;">&quot;longlife.txt&quot;</span><span style=" ">&#41;</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">LockBuffer</span> ib<br />
&nbsp;dend=<span style="color: #33ffdd;">-4</span><br />
<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> loadorg$=<span style="color: #00ff66;">&quot;&quot;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> x=x1 <span style="color: #aaffff; font-weight: bold;">To</span> x2<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> y=y1 <span style="color: #aaffff; font-weight: bold;">To</span> y2<br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">Rand</span><span style=" ">&#40;</span><span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">99</span><span style=" ">&#41;</span>&lt;cell <span style="color: #aaffff; font-weight: bold;">Then</span> putcell x,y: org<span style=" ">&#40;</span>x-x1,y-y1<span style=" ">&#41;</span>=<span style="color: #33ffdd;">1</span> <span style="color: #aaffff; font-weight: bold;">Else</span> org<span style=" ">&#40;</span>x-x1,y-y1<span style=" ">&#41;</span>=<span style="color: #33ffdd;">0</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; i=<span style="color: #aaffff; font-weight: bold;">LoadImage</span><span style=" ">&#40;</span>loadorg$<span style=" ">&#41;</span><br />
&nbsp; ii=<span style="color: #aaffff; font-weight: bold;">ImageBuffer</span><span style=" ">&#40;</span>i<span style=" ">&#41;</span><br />
&nbsp; xsiz=<span style="color: #aaffff; font-weight: bold;">ImageWidth</span><span style=" ">&#40;</span>i<span style=" ">&#41;</span><br />
&nbsp; ysiz=<span style="color: #aaffff; font-weight: bold;">ImageHeight</span><span style=" ">&#40;</span>i<span style=" ">&#41;</span><br />
&nbsp; xx=<span style=" ">&#40;</span>xres-xsiz<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">1</span><br />
&nbsp; yy=<span style=" ">&#40;</span>yres-ysiz<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">1</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> x=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> xsiz<span style="color: #33ffdd;">-1</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> y=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> ysiz<span style="color: #33ffdd;">-1</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">ReadPixel</span><span style=" ">&#40;</span>x,y,ii<span style=" ">&#41;</span>=<span style="color: #33ffdd;">-1</span> <span style="color: #aaffff; font-weight: bold;">Then</span> putcell x+xx,y+yy<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">FreeImage</span> i<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
<br />
&nbsp;<span style="color: #ffee00">;Вспомогательный массив детектора стабилизации: первое значение - кол-во клеток</span><br />
&nbsp;<span style="color: #ffee00">; на предыдущем этапе, второе - счетчик совпадений кол-ва клеток</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Dim</span> dstcq<span style=" ">&#40;</span>dstperiod,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">UnlockBuffer</span> ib<br />
<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> visible <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">;Чтобы исключить мерцание, печатаем текст не на экран, а в буфер</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">SetBuffer</span> ib<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Rect</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">100</span>,<span style="color: #33ffdd;">36</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Color</span> <span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span>,<span style="color: #33ffdd;">255</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span>,<span style="color: #00ff66;">&quot;FPS: &quot;</span><span style="color: #33ffdd;">+1000.0</span>/<span style=" ">&#40;</span><span style="color: #aaffff; font-weight: bold;">MilliSecs</span><span style=" ">&#40;</span><span style=" ">&#41;</span>-fps<span style=" ">&#41;</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">;Вывод кол-ва клеток и поколений на экран</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">12</span>,<span style="color: #00ff66;">&quot;Клеток: &quot;</span>+cellq<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Text</span> <span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">24</span>,<span style="color: #00ff66;">&quot;Поколение: &quot;</span>+gen<br />
<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">FrontBuffer</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">DrawBlock</span> buf,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<br />
&nbsp; <span style="color: #ffee00">;Счетчик поколений</span><br />
&nbsp; gen=gen<span style="color: #33ffdd;">+1</span><br />
&nbsp; <span style="color: #ffee00">;&quot;Взрыв&quot;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> explo <span style="color: #aaffff; font-weight: bold;">And</span> <span style=" ">&#40;</span>gen <span style="color: #aaffff; font-weight: bold;">Mod</span> xper<span style=" ">&#41;</span>=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span> add=<span style="color: #33ffdd;">32</span> <span style="color: #aaffff; font-weight: bold;">Else</span> add=<span style="color: #33ffdd;">0</span><br />
<br />
&nbsp; <span style="color: #ffee00">;Детектор стабилизации</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> dst <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp;<span style="color: #ffee00">;Цикл по всем периодам</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> n=<span style="color: #33ffdd;">2</span> <span style="color: #aaffff; font-weight: bold;">To</span> dstperiod<br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> gen <span style="color: #aaffff; font-weight: bold;">Mod</span> n=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> cellq=dstcq<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffee00">;Если кол-во клеток совпадает с прежним - увеличивается счетчик проверок</span><br />
&nbsp; &nbsp; &nbsp; dstcq<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>=dstcq<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><span style="color: #33ffdd;">+1</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffee00">;Если кол-во проверок достигло предела - организм стабилизировался,</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffee00">; включается флаг выхода</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> dstcq<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>=dstpasses <span style="color: #aaffff; font-weight: bold;">Then</span> ex=<span style="color: #33ffdd;">1</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffee00">;Если кол-во клеток отличается - счетчик обнуляется</span><br />
&nbsp; &nbsp; &nbsp; dstcq<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span>=cellq<br />
&nbsp; &nbsp; &nbsp; dstcq<span style=" ">&#40;</span>n,<span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>=<span style="color: #33ffdd;">0</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
<br />
&nbsp; <span style="color: #ffee00">;Если флаг выхода включен или нажата клавиша пробела - обнуляем его и выходим</span><br />
&nbsp; <span style="color: #ffee00">; из цикла развития</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> ex <span style="color: #aaffff; font-weight: bold;">Or</span> <span style="color: #aaffff; font-weight: bold;">KeyHit</span><span style=" ">&#40;</span><span style="color: #33ffdd;">57</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> ex=<span style="color: #33ffdd;">0</span>:<span style="color: #aaffff; font-weight: bold;">Exit</span><br />
&nbsp; fps=<span style="color: #aaffff; font-weight: bold;">MilliSecs</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">LockBuffer</span> ib<br />
<br />
&nbsp; n=<span style="color: #33ffdd;">0</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">While</span> n&lt;=dend<br />
&nbsp; &nbsp;pos=<span style="color: #aaffff; font-weight: bold;">PeekInt</span><span style=" ">&#40;</span>dbnk,n<span style=" ">&#41;</span><br />
&nbsp; &nbsp;k=<span style="color: #aaffff; font-weight: bold;">PeekByte</span><span style=" ">&#40;</span>bnk,pos<span style=" ">&#41;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> change<span style=" ">&#40;</span><span style=" ">&#40;</span>k <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">31</span><span style=" ">&#41;</span>+add<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">PokeByte</span> bnk,pos,k <span style="color: #aaffff; font-weight: bold;">Or</span> <span style="color: #33ffdd;">32</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> <span style=" ">&#40;</span>k <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">31</span><span style=" ">&#41;</span>=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">PokeInt</span> dbnk,n,<span style="color: #aaffff; font-weight: bold;">PeekInt</span><span style=" ">&#40;</span>dbnk,dend<span style=" ">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">PokeByte</span> bnk,pos,<span style="color: #33ffdd;">0</span><br />
&nbsp; &nbsp; dend=dend<span style="color: #33ffdd;">-4</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp; n=n<span style="color: #33ffdd;">+4</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Wend</span><br />
<br />
&nbsp; n=<span style="color: #33ffdd;">0</span><br />
&nbsp; dend2=dend<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">While</span> n&lt;=dend2<br />
&nbsp; &nbsp;pos=<span style="color: #aaffff; font-weight: bold;">PeekInt</span><span style=" ">&#40;</span>dbnk,n<span style=" ">&#41;</span><br />
&nbsp; &nbsp;k=<span style="color: #aaffff; font-weight: bold;">PeekByte</span><span style=" ">&#40;</span>bnk,pos<span style=" ">&#41;</span><br />
&nbsp;<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> k <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">32</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> bnd=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Or</span> <span style=" ">&#40;</span>pos&gt;fsiz1 <span style="color: #aaffff; font-weight: bold;">And</span> <span style=" ">&#40;</span>pos <span style="color: #aaffff; font-weight: bold;">And</span> fsiz1<span style=" ">&#41;</span>&gt;<span style="color: #33ffdd;">0</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp;v=<span style=" ">&#40;</span>k <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">16</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">4</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> visible <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp; x=<span style=" ">&#40;</span>pos <span style="color: #aaffff; font-weight: bold;">And</span> fsiz1<span style=" ">&#41;</span>-xc<br />
&nbsp; &nbsp; &nbsp; y=<span style=" ">&#40;</span>pos <span style="color: #aaffff; font-weight: bold;">Shr</span> fsiz<span style=" ">&#41;</span>-yc<br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> x&gt;=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">And</span> x&lt;xres <span style="color: #aaffff; font-weight: bold;">And</span> y&gt;=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">And</span> y&lt;yres <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">WritePixelFast</span> x,y,v<span style="color: #33ffdd;">-1</span>,ib<br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp; &nbsp;v=<span style="color: #33ffdd;">1</span>-<span style=" ">&#40;</span>v <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">1</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #ffee00">;Если ячейка очистилась, счетчик клеток уменьшается на 1, если заполнилась -</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #ffee00">; увеличивается на 1</span><br />
&nbsp; &nbsp; &nbsp;cellq=cellq+v<br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> nn=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">7</span><br />
&nbsp; &nbsp; &nbsp; addr=<span style=" ">&#40;</span>neig<span style=" ">&#40;</span>nn<span style=" ">&#41;</span>+pos<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">And</span> fsiz3<br />
&nbsp; &nbsp; &nbsp; p=<span style="color: #aaffff; font-weight: bold;">PeekByte</span><span style=" ">&#40;</span>bnk,addr<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> p=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;dend=dend<span style="color: #33ffdd;">+4</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">PokeInt</span> dbnk,dend,addr<br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">PokeByte</span> bnk,addr,<span style="color: #33ffdd;">65</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">PokeByte</span> bnk,addr,p+v<br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">PokeByte</span> bnk,pos,k <span style="color: #aaffff; font-weight: bold;">Xor</span> <span style="color: #33ffdd;">48</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp;n=n<span style="color: #33ffdd;">+4</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Wend</span> <br />
<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">KeyHit</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">End</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Forever</span><br />
<br />
&nbsp;<span style="color: #ffee00">;Запись долгожителя в файл </span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> search&gt;<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">And</span> search&lt;=gen <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">WriteLine</span> f,gen<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> x=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> xrect<span style="color: #33ffdd;">-1</span><br />
&nbsp; &nbsp;m$=<span style="color: #00ff66;">&quot;&quot;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> y=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> yrect<span style="color: #33ffdd;">-1</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> org<span style=" ">&#40;</span>x,y<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> m$=m$+<span style="color: #00ff66;">&quot;0&quot;</span> <span style="color: #aaffff; font-weight: bold;">Else</span> m$=m$+<span style="color: #00ff66;">&quot;-&quot;</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">WriteLine</span> f,m$<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">WriteLine</span> f,<span style="color: #00ff66;">&quot;&quot;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
<br />
&nbsp;<span style="color: #ffee00">;Перед генерацией нового организма очищается экран и буфер атрибутов, а также</span><br />
&nbsp;<span style="color: #ffee00">; обнуляются счетчики поколений, клеток и указатель массива &quot;интересных&quot;</span><br />
&nbsp;<span style="color: #ffee00">; ячеек</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">SetBuffer</span> ib<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Cls</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">SetBuffer</span> <span style="color: #aaffff; font-weight: bold;">FrontBuffer</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">FreeBank</span> bnk<br />
&nbsp;bnk=<span style="color: #aaffff; font-weight: bold;">CreateBank</span><span style=" ">&#40;</span>fsiz2<span style=" ">&#41;</span><br />
&nbsp;gen=<span style="color: #33ffdd;">0</span><br />
&nbsp;cellq=<span style="color: #33ffdd;">0</span><br />
<span style="color: #aaffff; font-weight: bold;">Forever</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> putcell<span style=" ">&#40;</span>x,y<span style=" ">&#41;</span><br />
pos=x+xc+<span style=" ">&#40;</span><span style=" ">&#40;</span>y+yc<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Shl</span> fsiz<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> nn=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">8</span><br />
&nbsp;addr=<span style=" ">&#40;</span>neig<span style=" ">&#40;</span>nn<span style=" ">&#41;</span>+pos<span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">And</span> fsiz3<br />
&nbsp;p=<span style="color: #aaffff; font-weight: bold;">PeekByte</span><span style=" ">&#40;</span>bnk,addr<span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> p=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; dend=dend<span style="color: #33ffdd;">+4</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">PokeInt</span> dbnk,dend,addr<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">PokeByte</span> bnk,addr,<span style="color: #33ffdd;">65</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">PokeByte</span> bnk,addr,p<span style="color: #33ffdd;">+1</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">PokeByte</span> bnk,pos,<span style="color: #aaffff; font-weight: bold;">PeekByte</span><span style=" ">&#40;</span>bnk,pos<span style=" ">&#41;</span> + <span style="color: #33ffdd;">15</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> visible <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">WritePixel</span> x,y,<span style="color: #33ffdd;">-1</span>,ib<br />
<span style="color: #ffee00">;Увеличение счетчика клеток на единицу</span><br />
cellq=cellq<span style="color: #33ffdd;">+1</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<div align="right"><a href="http://blitzetcetera.org/images/d/da/Life_Experiments.zip" class="internal" title="Life Experiments.zip">скачать архив с файлами к статье</a></div>
<hr />
<p>Автор: <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Matt_Merkulov" title="Участник:Matt Merkulov">Матвей Меркулов</a> (E-mail: MattMerk@mail.ru, ICQ: 392-274-050)
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Виртуальный художник: деформация"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Виртуальный художник: деформация&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Виртуальный художник: деформация&amp;action=edit">править</a>]</span><span class="mw-headline">Виртуальный художник: деформация</span></h1>
</p>
<a name=".D0.92.D0.B2.D0.B5.D0.B4.D0.B5.D0.BD.D0.B8.D0.B5_2"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%92%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9_%D1%85%D1%83%D0%B4%D0%BE%D0%B6%D0%BD%D0%B8%D0%BA:_%D0%B4%D0%B5%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D1%8F&amp;action=edit&amp;section=1" title="Виртуальный художник: деформация">править</a>]</span> <span class="mw-headline">Введение</span></h2>
<p>Деформация изображения заключается в том, что пиксел (x, y) закрашивается цветом пиксела (x', y'), координаты которого могут вычисляться каким угодно образом через исходные:
</p>
<ul><li>x' = f<sub>1</sub>(x, y)
</li><li>y' = f<sub>2</sub>(x, y)
</li></ul>
<p>Цвет пикселей, выходящих за пределы изображения, пусть будет черным. Простейшие трансформации - это сдвиг, масштабирование, поворот, отражения от прямой и точки, а также наклон. В общем виде формула этих преобразований выглядит так:
</p>
<ul><li>x' = a<sub>1</sub> * x + b<sub>1</sub> * y + c<sub>1</sub>
</li><li>y' = a<sub>2</sub> * x + b<sub>2</sub> * y + c<sub>2</sub>
</li></ul>
<a name=".D0.91.D0.B8.D0.BB.D0.B8.D0.BD.D0.B5.D0.B9.D0.BD.D0.B0.D1.8F_.D1.84.D0.B8.D0.BB.D1.8C.D1.82.D1.80.D0.B0.D1.86.D0.B8.D1.8F"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%92%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9_%D1%85%D1%83%D0%B4%D0%BE%D0%B6%D0%BD%D0%B8%D0%BA:_%D0%B4%D0%B5%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D1%8F&amp;action=edit&amp;section=2" title="Виртуальный художник: деформация">править</a>]</span> <span class="mw-headline">Билинейная фильтрация</span></h2>
<p>Как Вы могли заметить, трансформированные (особенно увеличенные) изображения выглядят довольно коряво, а именно, хорошо видны квадраты, представляющие пиксели, границы между ними режут глаз. Для борьбы с этим неприятным эффектом применяется метод билинейной фильтрации. При его использовании, координаты пиксела не округляются, как раньше (в итоге получался цвет ближайшего пиксела), дробная часть влияет на конечный цвет. Другими словами, между соседними пикселами получается плавный переход, чем ближе точка с дробными координатами, цвет которой нужно вычислить к точке, представляющей пиксел (ее координаты - целые), тем большее влияние цвет этого пиксела оказывает на конечный цвет. Принцип действия простейшего алгоритма таков: определяются соседние пикселы, ограничивающие точку. Затем берутся цвета двух верхних пикселов и смешиваются, соответственно коэффициентам (в пределах 0...1), определяемым координатой х (чем она дальше от координаты x цвета, тем его коэффициент меньше). Так же поступают и с нижними пикселами. Полученные два цвета смешиваются в зависимости от координаты y - полученный цвет и будет результатом.
</p>
<a name=".D0.A3.D0.B2.D0.B5.D0.BB.D0.B8.D1.87.D0.B5.D0.BD.D0.B8.D0.B5_.D1.82.D0.BE.D1.87.D0.BD.D0.BE.D1.81.D1.82.D0.B8"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%92%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9_%D1%85%D1%83%D0%B4%D0%BE%D0%B6%D0%BD%D0%B8%D0%BA:_%D0%B4%D0%B5%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D1%8F&amp;action=edit&amp;section=3" title="Виртуальный художник: деформация">править</a>]</span> <span class="mw-headline">Увеличение точности</span></h2>
<p>Еще один негативный эффект проявляется при уменьшении изображения - результат выглядит немного "блочным". Это происходит из-за того, что берется один пиксел из нескольких, остальные просто не берутся в расчет. Ситуацию можно улучшить, если кроме исходного пиксела с целыми координатами, находить также значения цвета для пикселов с дробными координатами вида (x+dx, y+dy), где 0 &lt; dx,dy &lt; 1, а затем брать среднее арифметическое:
</p>
<a name=".D0.94.D0.B5.D0.BC.D0.BE.D0.BD.D1.81.D1.82.D1.80.D0.B0.D1.86.D0.B8.D0.BE.D0.BD.D0.BD.D0.B0.D1.8F_.D0.BF.D1.80.D0.BE.D0.B3.D1.80.D0.B0.D0.BC.D0.BC.D0.B0"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%92%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9_%D1%85%D1%83%D0%B4%D0%BE%D0%B6%D0%BD%D0%B8%D0%BA:_%D0%B4%D0%B5%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D1%8F&amp;action=edit&amp;section=4" title="Виртуальный художник: деформация">править</a>]</span> <span class="mw-headline">Демонстрационная программа</span></h2>
<p>В данной программе демонстрируются вышеизложенные преобразования и эффекты. При некоторых преобразованиях билинейная фильтрация может не оказывать практически никакого эффекта, поэтому ее лучше отключить. Также можно подбирать оптимальную точность для отдельно взятого преобразования. Вот картинка (640x480 JPG):
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:182px;"><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Painter2.jpg" class="internal" title=""><img alt="" longdesc="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Painter2.jpg" class="thumbimage" src="nfkp-cl0.jpg" width="180" height="135" /></a>  <div class="thumbcaption"><div class="magnify" style="float:right"><a href="http://blitzetcetera.org/index.php/%D0%98%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5:Painter2.jpg" class="internal" title="Увеличить"><img src="gau13a4-.png" width="15" height="11" alt="" /></a></div></div></div></div></div>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Const</span> xsiz=<span style="color: #33ffdd;">640</span>,ysiz=<span style="color: #33ffdd;">480</span><br />
<p><span style="color: #aaffff; font-weight: bold;">Global</span> ib,x2#,y2#,r,g,b<br />
<br />
<span style="color: #ffee00">;Const fx=1,prec=1,bf=0;пикселизация</span><br />
<span style="color: #ffee00">;Const fx=2,prec=1,bf=0;блочность</span><br />
<br />
<span style="color: #ffee00">;Const fx=1, prec=1, bf=1</span><br />
<span style="color: #ffee00">;Const fx=2, prec=4, bf=0</span><br />
<span style="color: #ffee00">;Const fx=3, prec=2, bf=1</span><br />
<span style="color: #aaffff; font-weight: bold;">Const</span> fx=<span style="color: #33ffdd;">4</span>, prec=<span style="color: #33ffdd;">2</span>, bf=<span style="color: #33ffdd;">1</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Const</span> stp#=<span style="color: #33ffdd;">1.0</span>/prec, div=prec*prec<br />
<br />
<span style="color: #aaffff; font-weight: bold;">Graphics</span> xsiz,ysiz,<span style="color: #33ffdd;">32</span><br />
<br />
i=<span style="color: #aaffff; font-weight: bold;">LoadImage</span><span style=" ">&#40;</span><span style="color: #00ff66;">&quot;Painter2.jpg&quot;</span><span style=" ">&#41;</span><br />
ib=<span style="color: #aaffff; font-weight: bold;">ImageBuffer</span><span style=" ">&#40;</span>i<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> y#=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> ysiz<span style="color: #33ffdd;">-1</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> x#=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> xsiz<span style="color: #33ffdd;">-1</span><br />
&nbsp; r=<span style="color: #33ffdd;">0</span>:g=<span style="color: #33ffdd;">0</span>:b=<span style="color: #33ffdd;">0</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> xx#=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> .<span style="color: #33ffdd;">9999</span> <span style="color: #aaffff; font-weight: bold;">Step</span> stp#<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> yy#=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> .<span style="color: #33ffdd;">9999</span> <span style="color: #aaffff; font-weight: bold;">Step</span> stp#<br />
&nbsp; &nbsp; x2#=x#+xx#<br />
&nbsp; &nbsp; y2#=y#+yy#<br />
&nbsp; &nbsp; move <span style="color: #33ffdd;">-320</span>,<span style="color: #33ffdd;">-240</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Select</span> fx<br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">1</span><br />
&nbsp; &nbsp; &nbsp; scale .<span style="color: #33ffdd;">33</span>,.<span style="color: #33ffdd;">33</span><br />
&nbsp; &nbsp; &nbsp; move <span style="color: #33ffdd;">200</span>,<span style="color: #33ffdd;">100</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">2</span><br />
&nbsp; &nbsp; &nbsp; scale <span style="color: #33ffdd;">2</span>,<span style="color: #33ffdd;">3</span><br />
&nbsp; &nbsp; &nbsp; x2#=-x2#<span style="color: #ffee00">;отражение от оси OY</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">3</span><br />
&nbsp; &nbsp; &nbsp; rotate <span style="color: #33ffdd;">30</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">4</span><br />
&nbsp; &nbsp; &nbsp; scale <span style="color: #33ffdd;">2</span>,<span style="color: #33ffdd;">2</span><br />
&nbsp; &nbsp; &nbsp; rotate <span style="color: #33ffdd;">10</span><br />
&nbsp; &nbsp; &nbsp; bevel .<span style="color: #33ffdd;">4</span>,.<span style="color: #33ffdd;">4</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">End Select</span><br />
&nbsp; &nbsp; move <span style="color: #33ffdd;">320</span>,<span style="color: #33ffdd;">240</span><br />
&nbsp; &nbsp; pixelcol<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; r=r/div<br />
&nbsp; g=g/div<br />
&nbsp; b=b/div<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">WritePixel</span> x#,y#,r <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">16</span>+g <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">8</span>+b<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">WaitKey</span>:<span style="color: #aaffff; font-weight: bold;">End</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> pixelcol<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> x2#&lt;<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Or</span> x2#&gt;=xsiz <span style="color: #aaffff; font-weight: bold;">Or</span> y2#&lt;<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Or</span> y2#&gt;=ysiz <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Return</span><br />
xx=<span style="color: #aaffff; font-weight: bold;">Int</span><span style=" ">&#40;</span>x2#-.<span style="color: #33ffdd;">5</span><span style=" ">&#41;</span><br />
yy=<span style="color: #aaffff; font-weight: bold;">Int</span><span style=" ">&#40;</span>y2#-.<span style="color: #33ffdd;">5</span><span style=" ">&#41;</span><br />
p00=<span style="color: #aaffff; font-weight: bold;">ReadPixel</span><span style=" ">&#40;</span>xx,yy,ib<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> bf <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp;p01=<span style="color: #aaffff; font-weight: bold;">ReadPixel</span><span style=" ">&#40;</span>xx,yy<span style="color: #33ffdd;">+1</span>,ib<span style=" ">&#41;</span><br />
&nbsp;p10=<span style="color: #aaffff; font-weight: bold;">ReadPixel</span><span style=" ">&#40;</span>xx<span style="color: #33ffdd;">+1</span>,yy,ib<span style=" ">&#41;</span><br />
&nbsp;p11=<span style="color: #aaffff; font-weight: bold;">ReadPixel</span><span style=" ">&#40;</span>xx<span style="color: #33ffdd;">+1</span>,yy<span style="color: #33ffdd;">+1</span>,ib<span style=" ">&#41;</span><br />
&nbsp;dx2#=x2#-xx<br />
&nbsp;dx1#=<span style="color: #33ffdd;">1.0</span>-dx2#<br />
&nbsp;r1#=dx1#*<span style=" ">&#40;</span>p00 <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">16</span> <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span>+dx2#*<span style=" ">&#40;</span>p10 <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">16</span> <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span><br />
&nbsp;g1#=dx1#*<span style=" ">&#40;</span>p00 <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">8</span> <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span>+dx2#*<span style=" ">&#40;</span>p10 <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">8</span> <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span><br />
&nbsp;b1#=dx1#*<span style=" ">&#40;</span>p00 <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span>+dx2#*<span style=" ">&#40;</span>p10 <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span><br />
&nbsp;r2#=dx1#*<span style=" ">&#40;</span>p01 <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">16</span> <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span>+dx2#*<span style=" ">&#40;</span>p11 <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">16</span> <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span><br />
&nbsp;g2#=dx1#*<span style=" ">&#40;</span>p01 <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">8</span> <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span>+dx2#*<span style=" ">&#40;</span>p11 <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">8</span> <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span><br />
&nbsp;b2#=dx1#*<span style=" ">&#40;</span>p01 <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span>+dx2#*<span style=" ">&#40;</span>p11 <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span><br />
&nbsp;dx2#=y2#-yy<br />
&nbsp;dx1#=<span style="color: #33ffdd;">1.0</span>-dx2#<br />
&nbsp;r=r+<span style="color: #aaffff; font-weight: bold;">Int</span><span style=" ">&#40;</span>dx1#*r1#+dx2#*r2#<span style=" ">&#41;</span><br />
&nbsp;g=g+<span style="color: #aaffff; font-weight: bold;">Int</span><span style=" ">&#40;</span>dx1#*g1#+dx2#*g2#<span style=" ">&#41;</span><br />
&nbsp;b=b+<span style="color: #aaffff; font-weight: bold;">Int</span><span style=" ">&#40;</span>dx1#*b1#+dx2#*b2#<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp;r=r+<span style=" ">&#40;</span>p00 <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">16</span> <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span><br />
&nbsp;g=g+<span style=" ">&#40;</span>p00 <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">8</span> <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span><br />
&nbsp;b=b+<span style=" ">&#40;</span>p00 <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Сдвиг</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> move<span style=" ">&#40;</span>dx#,dy#<span style=" ">&#41;</span><br />
x2#=x2#+dx#<br />
y2#=y2#+dy#<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Масштабирование</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> scale<span style=" ">&#40;</span>mx#,my#<span style=" ">&#41;</span><br />
x2#=x2#*mx#<br />
y2#=y2#*my#<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Поворот</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> rotate<span style=" ">&#40;</span>ang#<span style=" ">&#41;</span><br />
xx2#=x2#<br />
x2#=x2#*<span style="color: #aaffff; font-weight: bold;">Cos</span><span style=" ">&#40;</span>ang#<span style=" ">&#41;</span>+y2#*<span style="color: #aaffff; font-weight: bold;">Sin</span><span style=" ">&#40;</span>ang#<span style=" ">&#41;</span><br />
y2#=y2#*<span style="color: #aaffff; font-weight: bold;">Cos</span><span style=" ">&#40;</span>ang#<span style=" ">&#41;</span>-xx2#*<span style="color: #aaffff; font-weight: bold;">Sin</span><span style=" ">&#40;</span>ang#<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Отражение от точки</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> mirrordot<span style=" ">&#40;</span>x#,y#<span style=" ">&#41;</span><br />
x2#=<span style="color: #33ffdd;">2</span>*x#-x2#<br />
y2#=<span style="color: #33ffdd;">2</span>*y#-y2#<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Отражение от прямой</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> mirrorline<span style=" ">&#40;</span>a#,b#,c#<span style=" ">&#41;</span><br />
c2#=a#*x2#-b*y2#<br />
k#=<span style="color: #33ffdd;">1.0</span>/<span style=" ">&#40;</span>a#*a#+b#*b#<span style=" ">&#41;</span><br />
x2#=<span style=" ">&#40;</span>-a#*c#-b#*c2#<span style=" ">&#41;</span>*k#<br />
y2#=<span style=" ">&#40;</span>a#*c2#-b#*c#<span style=" ">&#41;</span>*k#<br />
<span style="color: #aaffff; font-weight: bold;">End Function</span><br />
<br />
<span style="color: #ffee00">;Наклон</span><br />
<span style="color: #aaffff; font-weight: bold;">Function</span> bevel<span style=" ">&#40;</span>dx#,dy#<span style=" ">&#41;</span><br />
xx2#=x2#<br />
x2#=x2#+y2#*dx#<br />
y2#=y2#+xx2#*dy#<br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<a name=".D0.91.D0.BE.D0.BB.D0.B5.D0.B5_.D1.81.D0.BB.D0.BE.D0.B6.D0.BD.D1.8B.D0.B5_.D1.8D.D1.84.D1.84.D0.B5.D0.BA.D1.82.D1.8B"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%92%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9_%D1%85%D1%83%D0%B4%D0%BE%D0%B6%D0%BD%D0%B8%D0%BA:_%D0%B4%D0%B5%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D1%8F&amp;action=edit&amp;section=5" title="Виртуальный художник: деформация">править</a>]</span> <span class="mw-headline">Более сложные эффекты</span></h2>
<p>Используя более комплексные формулы, можно получить более интересные искажения: стягивание удаляет окружность с центром в данной точке и определенным радиусом за счет стягивания точек кольца вокруг нее с внешним радиусом вдвое больше; вихрь поворачивает точку вокруг центра изображения, на угол, зависящий от расстояния до центра; рябь получается сдвигом точек в зависимости от расстояния до центра.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Const</span> xsiz=<span style="color: #33ffdd;">640</span>,ysiz=<span style="color: #33ffdd;">480</span><br />
<p><span style="color: #aaffff; font-weight: bold;">Global</span> ib,x2#,y2#,r,g,b<br />
<br />
<span style="color: #aaffff; font-weight: bold;">Const</span> prec=<span style="color: #33ffdd;">1</span>, bf=<span style="color: #33ffdd;">0</span>, fx=<span style="color: #33ffdd;">1</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Const</span> stp#=<span style="color: #33ffdd;">1.0</span>/prec, div=prec*prec<br />
<br />
<span style="color: #aaffff; font-weight: bold;">Graphics</span> xsiz,ysiz,<span style="color: #33ffdd;">32</span><br />
<br />
i=<span style="color: #aaffff; font-weight: bold;">LoadImage</span><span style=" ">&#40;</span><span style="color: #00ff66;">&quot;Painter2.jpg&quot;</span><span style=" ">&#41;</span><br />
ib=<span style="color: #aaffff; font-weight: bold;">ImageBuffer</span><span style=" ">&#40;</span>i<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">For</span> y#=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> ysiz<span style="color: #33ffdd;">-1</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> x#=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> xsiz<span style="color: #33ffdd;">-1</span><br />
&nbsp; r=<span style="color: #33ffdd;">0</span>:g=<span style="color: #33ffdd;">0</span>:b=<span style="color: #33ffdd;">0</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> xx#=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> .<span style="color: #33ffdd;">9999</span> <span style="color: #aaffff; font-weight: bold;">Step</span> stp#<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> yy#=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> .<span style="color: #33ffdd;">9999</span> <span style="color: #aaffff; font-weight: bold;">Step</span> stp#<br />
&nbsp; &nbsp; x2#=x#+xx#<br />
&nbsp; &nbsp; y2#=y#+yy#<br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">Select</span> fx<br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">1</span><span style="color: #ffee00">;Cтягивание</span><br />
&nbsp; &nbsp; &nbsp; dx#=x2#<span style="color: #33ffdd;">-460.0</span><br />
&nbsp; &nbsp; &nbsp; dy#=y2#<span style="color: #33ffdd;">-360.0</span><br />
&nbsp; &nbsp; &nbsp; rad#=<span style="color: #aaffff; font-weight: bold;">Sqr</span><span style=" ">&#40;</span>dx#*dx#+dy#*dy#<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> rad#=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span> rad#=<span style="color: #33ffdd;">1</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">If</span> rad#&lt;<span style="color: #33ffdd;">100.0</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;x2#=dx#*<span style=" ">&#40;</span>.<span style="color: #33ffdd;">5</span><span style="color: #33ffdd;">+50.0</span>/rad#<span style=" ">&#41;</span><span style="color: #33ffdd;">+460.0</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;y2#=dy#*<span style=" ">&#40;</span>.<span style="color: #33ffdd;">5</span><span style="color: #33ffdd;">+50.0</span>/rad#<span style=" ">&#41;</span><span style="color: #33ffdd;">+360.0</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">2</span><span style="color: #ffee00">;Вихрь</span><br />
&nbsp; &nbsp; &nbsp; x2#=x2#<span style="color: #33ffdd;">-320.0</span><br />
&nbsp; &nbsp; &nbsp; y2#=y2#<span style="color: #33ffdd;">-240.0</span><br />
&nbsp; &nbsp; &nbsp; ang#=<span style="color: #aaffff; font-weight: bold;">Sqr</span><span style=" ">&#40;</span>x2#*x2#+y2#*y2#<span style=" ">&#41;</span>*.<span style="color: #33ffdd;">3</span><span style="color: #33ffdd;">-90</span><span style="color: #ffee00">;&quot;разворачивающийся&quot;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffee00">;ang#=360/(Sqr(x2#*x2#+y2#*y2#)*.05+1);&quot;сворачивающийся&quot;</span><br />
&nbsp; &nbsp; &nbsp; xx2#=x2#<br />
&nbsp; &nbsp; &nbsp; x2#=x2#*<span style="color: #aaffff; font-weight: bold;">Cos</span><span style=" ">&#40;</span>ang#<span style=" ">&#41;</span>+y2#*<span style="color: #aaffff; font-weight: bold;">Sin</span><span style=" ">&#40;</span>ang#<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; y2#=y2#*<span style="color: #aaffff; font-weight: bold;">Cos</span><span style=" ">&#40;</span>ang#<span style=" ">&#41;</span>-xx2#*<span style="color: #aaffff; font-weight: bold;">Sin</span><span style=" ">&#40;</span>ang#<span style=" ">&#41;</span><br />
&nbsp; &nbsp; &nbsp; x2#=x2#<span style="color: #33ffdd;">+320.0</span><br />
&nbsp; &nbsp; &nbsp; y2#=y2#<span style="color: #33ffdd;">+240.0</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Case</span> <span style="color: #33ffdd;">3</span><span style="color: #ffee00">;Рябь</span><br />
&nbsp; &nbsp; &nbsp; dx#=x2#<span style="color: #33ffdd;">-320.0</span><br />
&nbsp; &nbsp; &nbsp; dy#=y2#<span style="color: #33ffdd;">-240.0</span><br />
&nbsp; &nbsp; &nbsp; ang#=<span style="color: #aaffff; font-weight: bold;">Sqr</span><span style=" ">&#40;</span>dx#*dx#+dy#*dy#<span style=" ">&#41;</span>*<span style="color: #33ffdd;">4</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #ffee00">;x2#=x2#-Cos(ang#)*15</span><br />
&nbsp; &nbsp; &nbsp; y2#=y2#-<span style="color: #aaffff; font-weight: bold;">Sin</span><span style=" ">&#40;</span>ang#<span style=" ">&#41;</span>*<span style="color: #33ffdd;">15</span><br />
&nbsp; &nbsp; <span style="color: #aaffff; font-weight: bold;">End Select</span><br />
&nbsp; &nbsp; pixelcol<br />
&nbsp; &nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; r=r/div<br />
&nbsp; g=g/div<br />
&nbsp; b=b/div<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">WritePixel</span> x#,y#,r <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">16</span>+g <span style="color: #aaffff; font-weight: bold;">Shl</span> <span style="color: #33ffdd;">8</span>+b<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">WaitKey</span>:<span style="color: #aaffff; font-weight: bold;">End</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Function</span> pixelcol<span style=" ">&#40;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> x2#&lt;<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Or</span> x2#&gt;=xsiz <span style="color: #aaffff; font-weight: bold;">Or</span> y2#&lt;<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Or</span> y2#&gt;=ysiz <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Return</span><br />
xx=<span style="color: #aaffff; font-weight: bold;">Int</span><span style=" ">&#40;</span>x2#-.<span style="color: #33ffdd;">5</span><span style=" ">&#41;</span><br />
yy=<span style="color: #aaffff; font-weight: bold;">Int</span><span style=" ">&#40;</span>y2#-.<span style="color: #33ffdd;">5</span><span style=" ">&#41;</span><br />
p00=<span style="color: #aaffff; font-weight: bold;">ReadPixel</span><span style=" ">&#40;</span>xx,yy,ib<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">If</span> bf <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp;p01=<span style="color: #aaffff; font-weight: bold;">ReadPixel</span><span style=" ">&#40;</span>xx,yy<span style="color: #33ffdd;">+1</span>,ib<span style=" ">&#41;</span><br />
&nbsp;p10=<span style="color: #aaffff; font-weight: bold;">ReadPixel</span><span style=" ">&#40;</span>xx<span style="color: #33ffdd;">+1</span>,yy,ib<span style=" ">&#41;</span><br />
&nbsp;p11=<span style="color: #aaffff; font-weight: bold;">ReadPixel</span><span style=" ">&#40;</span>xx<span style="color: #33ffdd;">+1</span>,yy<span style="color: #33ffdd;">+1</span>,ib<span style=" ">&#41;</span><br />
&nbsp;dx2#=x2#-xx<br />
&nbsp;dx1#=<span style="color: #33ffdd;">1.0</span>-dx2#<br />
&nbsp;r1#=dx1#*<span style=" ">&#40;</span>p00 <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">16</span> <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span>+dx2#*<span style=" ">&#40;</span>p10 <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">16</span> <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span><br />
&nbsp;g1#=dx1#*<span style=" ">&#40;</span>p00 <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">8</span> <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span>+dx2#*<span style=" ">&#40;</span>p10 <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">8</span> <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span><br />
&nbsp;b1#=dx1#*<span style=" ">&#40;</span>p00 <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span>+dx2#*<span style=" ">&#40;</span>p10 <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span><br />
&nbsp;r2#=dx1#*<span style=" ">&#40;</span>p01 <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">16</span> <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span>+dx2#*<span style=" ">&#40;</span>p11 <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">16</span> <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span><br />
&nbsp;g2#=dx1#*<span style=" ">&#40;</span>p01 <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">8</span> <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span>+dx2#*<span style=" ">&#40;</span>p11 <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">8</span> <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span><br />
&nbsp;b2#=dx1#*<span style=" ">&#40;</span>p01 <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span>+dx2#*<span style=" ">&#40;</span>p11 <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span><br />
&nbsp;dx2#=y2#-yy<br />
&nbsp;dx1#=<span style="color: #33ffdd;">1.0</span>-dx2#<br />
&nbsp;r=r+<span style="color: #aaffff; font-weight: bold;">Int</span><span style=" ">&#40;</span>dx1#*r1#+dx2#*r2#<span style=" ">&#41;</span><br />
&nbsp;g=g+<span style="color: #aaffff; font-weight: bold;">Int</span><span style=" ">&#40;</span>dx1#*g1#+dx2#*g2#<span style=" ">&#41;</span><br />
&nbsp;b=b+<span style="color: #aaffff; font-weight: bold;">Int</span><span style=" ">&#40;</span>dx1#*b1#+dx2#*b2#<span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">Else</span><br />
&nbsp;r=r+<span style=" ">&#40;</span>p00 <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">16</span> <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span><br />
&nbsp;g=g+<span style=" ">&#40;</span>p00 <span style="color: #aaffff; font-weight: bold;">Shr</span> <span style="color: #33ffdd;">8</span> <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span><br />
&nbsp;b=b+<span style=" ">&#40;</span>p00 <span style="color: #aaffff; font-weight: bold;">And</span> <span style="color: #33ffdd;">255</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">End Function</span></div>
<a name=".D0.9F.D1.80.D0.BE.D0.B8.D0.B7.D0.B2.D0.BE.D0.BB.D1.8C.D0.BD.D0.B0.D1.8F_.D1.82.D1.80.D0.B0.D0.BD.D1.81.D1.84.D0.BE.D1.80.D0.BC.D0.B0.D1.86.D0.B8.D1.8F"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%92%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9_%D1%85%D1%83%D0%B4%D0%BE%D0%B6%D0%BD%D0%B8%D0%BA:_%D0%B4%D0%B5%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D1%8F&amp;action=edit&amp;section=6" title="Виртуальный художник: деформация">править</a>]</span> <span class="mw-headline">Произвольная трансформация</span></h2>
<p>В данной программе задаются точки на изображении и их конечная позиция на экране (нажмите левую кнопку мыши на исходной точке, передвиньте курсор в конечную и отпустите кнопку; правая кнопка мыши - применить трансформацию). Таким образом, задается сложная трансформация на основе расстояний от точек, с помошью которой можно делать шаржи. Закрепим точки по углам исходного изображения, чтобы деформации затронули только его внутреннюю часть.
</p>
<div class="bb" style="font-family: monospace;background-color:#FFFFFF;border:1px dashed #CCCCCC;padding:10px;background-color:#225588;color:#FFFFFF;border:1px solid #003040;padding:10px;"><span style="color: #aaffff; font-weight: bold;">Type</span> dot<br />
<p>&nbsp;<span style="color: #aaffff; font-weight: bold;">Field</span> x#,y#,dx#,dy#<br />
<span style="color: #aaffff; font-weight: bold;">End Type</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Graphics</span> <span style="color: #33ffdd;">640</span>,<span style="color: #33ffdd;">480</span>,<span style="color: #33ffdd;">32</span>,<span style="color: #33ffdd;">2</span><br />
<br />
i=<span style="color: #aaffff; font-weight: bold;">LoadImage</span><span style=" ">&#40;</span><span style="color: #00ff66;">&quot;Painter2.jpg&quot;</span><span style=" ">&#41;</span><br />
<span style="color: #aaffff; font-weight: bold;">DrawBlock</span> i,<span style="color: #33ffdd;">0</span>,<span style="color: #33ffdd;">0</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">For</span> x=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">639</span> <span style="color: #aaffff; font-weight: bold;">Step</span> <span style="color: #33ffdd;">639</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> y=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">479</span> <span style="color: #aaffff; font-weight: bold;">Step</span> <span style="color: #33ffdd;">479</span><br />
&nbsp; d.dot=<span style="color: #aaffff; font-weight: bold;">New</span> dot<br />
&nbsp; d\x=x<br />
&nbsp; d\y=y<br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">Repeat</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">MouseDown</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">And</span> md=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; md=<span style="color: #33ffdd;">1</span><br />
&nbsp; d.dot=<span style="color: #aaffff; font-weight: bold;">New</span> dot<br />
&nbsp; d\x=<span style="color: #aaffff; font-weight: bold;">MouseX</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; d\y=<span style="color: #aaffff; font-weight: bold;">MouseY</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">MouseDown</span><span style=" ">&#40;</span><span style="color: #33ffdd;">1</span><span style=" ">&#41;</span>=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">And</span> md <span style="color: #aaffff; font-weight: bold;">Then</span><br />
&nbsp; d\dx=d\x-<span style="color: #aaffff; font-weight: bold;">MouseX</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; d\dy=d\y-<span style="color: #aaffff; font-weight: bold;">MouseY</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Line</span> d\x,d\y,<span style="color: #aaffff; font-weight: bold;">MouseX</span><span style=" ">&#40;</span><span style=" ">&#41;</span>,<span style="color: #aaffff; font-weight: bold;">MouseY</span><span style=" ">&#40;</span><span style=" ">&#41;</span><br />
&nbsp; md=<span style="color: #33ffdd;">0</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">End</span> <span style="color: #aaffff; font-weight: bold;">If</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">If</span> <span style="color: #aaffff; font-weight: bold;">MouseDown</span><span style=" ">&#40;</span><span style="color: #33ffdd;">2</span><span style=" ">&#41;</span> <span style="color: #aaffff; font-weight: bold;">Then</span> <span style="color: #aaffff; font-weight: bold;">Exit</span><br />
<span style="color: #aaffff; font-weight: bold;">Forever</span><br />
<br />
<span style="color: #aaffff; font-weight: bold;">For</span> y=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">479</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">For</span> x=<span style="color: #33ffdd;">0</span> <span style="color: #aaffff; font-weight: bold;">To</span> <span style="color: #33ffdd;">639</span><br />
&nbsp; vx#=<span style="color: #33ffdd;">0</span><br />
&nbsp; vy#=<span style="color: #33ffdd;">0</span><br />
&nbsp; k#=<span style="color: #33ffdd;">0</span><br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">For</span> d=<span style="color: #aaffff; font-weight: bold;">Each</span> dot<br />
&nbsp; &nbsp;dx#=x-d\x<br />
&nbsp; &nbsp;dy#=y-d\y<br />
&nbsp; &nbsp;r#=<span style="color: #33ffdd;">1.0</span>/<span style=" ">&#40;</span>dx#*dx#+dy#*dy#+.<span style="color: #33ffdd;">001</span><span style=" ">&#41;</span><br />
&nbsp; &nbsp;vx#=vx#+r#*d\dx<br />
&nbsp; &nbsp;vy#=vy#+r#*d\dy<br />
&nbsp; &nbsp;k#=k#+r#<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">Next</span><br />
&nbsp; vx#=vx#/k#<br />
&nbsp; vy#=vy#/k#<br />
&nbsp; <span style="color: #aaffff; font-weight: bold;">WritePixel</span> x,y,<span style="color: #aaffff; font-weight: bold;">ReadPixel</span> <span style=" ">&#40;</span>x+vx#,y+vy#,<span style="color: #aaffff; font-weight: bold;">ImageBuffer</span><span style=" ">&#40;</span>i<span style=" ">&#41;</span><span style=" ">&#41;</span><br />
&nbsp;<span style="color: #aaffff; font-weight: bold;">Next</span><br />
<span style="color: #aaffff; font-weight: bold;">Next</span><br />
</p>
<span style="color: #aaffff; font-weight: bold;">WaitKey</span></div>
<div align="right"><a href="http://blitzetcetera.org/images/8/82/Virtual_Painter_-_Deformation.zip" class="internal" title="Virtual Painter - Deformation.zip">скачать архив с файлами к статье</a></div>
<hr />
<p>Автор: <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Matt_Merkulov" title="Участник:Matt Merkulov">Матвей Меркулов</a> (E-mail: MattMerk@mail.ru, ICQ: 392-274-050)
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="Курс молодого бойца, часть 2: теоретическая подготовка"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:Курс молодого бойца, часть 2: теоретическая подготовка&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=Курс молодого бойца, часть 2: теоретическая подготовка&amp;action=edit">править</a>]</span><span class="mw-headline">Курс молодого бойца, часть 2: теоретическая подготовка</span></h1>
</p>
<a name=".D0.92.D0.B2.D0.B5.D0.B4.D0.B5.D0.BD.D0.B8.D0.B5_3"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9A%D1%83%D1%80%D1%81_%D0%BC%D0%BE%D0%BB%D0%BE%D0%B4%D0%BE%D0%B3%D0%BE_%D0%B1%D0%BE%D0%B9%D1%86%D0%B0%2C_%D1%87%D0%B0%D1%81%D1%82%D1%8C_2:_%D1%82%D0%B5%D0%BE%D1%80%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BA%D0%B0&amp;action=edit&amp;section=1" title="Курс молодого бойца, часть 2: теоретическая подготовка">править</a>]</span> <span class="mw-headline">Введение</span></h2>
<p>В первом выпуске журнала была статья "Фазы создания игр", в которой описано, с чего нужно начать при создании игры. Написано верно, но мы создаем мега-игру, и нам всякие правила и рекомендации по созданию обычных игр не указ. Хотя со структурой игры не поспоришь. И игра и мега-игра состоит из одинаковых частей. 
Однако углубим и расширим знания, почерпнутые в прошлом номере. 
</p>
<ul><li>"Визуализация" -  это то, что отвечает за отображение виртуального мира на экране. Состоит из двух составляющих графического движка и графического контента (Медиа). Графический контент состоит из 3D моделей и картинок, которые будет показывать графический движок. Все красивости в игре зависят от медиа и только от медиа! Программист может лишь написать алгоритм, который будет есть минимум ресурсов, позволяя использовать навороченные модели и большие текстуры. Если игра тормозит, и программист не может ничего ускорить, значит упрощаем наши замечательные модели или апгрейтим компьютер. (В первую очередь видюху, системник подождет...) Ну и самое радикальное решение - меняем программиста.  От графического движка зависит, в каком формате могут быть картинки, текстуры, модели, какие эффекты можно сделать, скорость вывода графики.
</li><li>"Интерфейс пользователя" - бывает игровым и системным. В игровом - играют, в системном - настраивают параметры, сохраняют, загружают. Интерфейс настолько сильно связан с "системой ввода/вывода", что можно сказать, что это одна система.
</li><li>"Логика игры" - Это все что происходит в игре. Ее можно разделить на множество частей, причем эти части зависят от того, какой жанр игры вы выбрали, какая концепция визуализации и перемещения и еще множество переменных влияющих на эту подсистему. Выделю те, которые будут точно везде. "Работа с камерой", перемещение персонажа, физика, АИ, анимация и звук.
</li></ul>
<a name=".D0.92.D0.B8.D0.B7.D1.83.D0.B0.D0.BB.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D1.8F."></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9A%D1%83%D1%80%D1%81_%D0%BC%D0%BE%D0%BB%D0%BE%D0%B4%D0%BE%D0%B3%D0%BE_%D0%B1%D0%BE%D0%B9%D1%86%D0%B0%2C_%D1%87%D0%B0%D1%81%D1%82%D1%8C_2:_%D1%82%D0%B5%D0%BE%D1%80%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BA%D0%B0&amp;action=edit&amp;section=2" title="Курс молодого бойца, часть 2: теоретическая подготовка">править</a>]</span> <span class="mw-headline">Визуализация.</span></h2>
<p>Виртуальный мир (любой) состоит из трех видов объектов интерактивных, не интерактивных и эффектов. Интерактивные объекты могут быть игровыми объектами и персонажами. Не интерактивные - это локация (условно) и объекты на локации. Эффекты - это все то, что нафиг ненужно для игрового процесса, но красииииво и жрет столько ресурсов, что мама негорюй!!!  Само собой, минимальный набор крутого игродела - это два объекта "Персонаж" и "Локация", многие и вовсе обходятся только локацией. С нее и начнем.
</p>
<a name=".D0.9B.D0.BE.D0.BA.D0.B0.D1.86.D0.B8.D1.8F"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9A%D1%83%D1%80%D1%81_%D0%BC%D0%BE%D0%BB%D0%BE%D0%B4%D0%BE%D0%B3%D0%BE_%D0%B1%D0%BE%D0%B9%D1%86%D0%B0%2C_%D1%87%D0%B0%D1%81%D1%82%D1%8C_2:_%D1%82%D0%B5%D0%BE%D1%80%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BA%D0%B0&amp;action=edit&amp;section=3" title="Курс молодого бойца, часть 2: теоретическая подготовка">править</a>]</span> <span class="mw-headline">Локация</span></h2>
<p>Локация понятие весьма растяжимое. Начиная от плоского квадратика N на N: нет мало лучше M на M, и кончая сложной системой моделей. Именно локация задает настроение игре, создает ее атмосферу. Локации можно разделить на две принципиальные группы Ландшафты и Декорации. Ландшафты используются для создания открытых пространств, а Декорации для закрытых. Хотя это условность. Можно, например, сделать декорацию ландшафта. Принципиальная разница заключается в том, что Декорация создается в 3D редакторе, а Ландшафт (тем или иным способом) создается игровым движком. 
</p>
<a name=".D0.9B.D0.B0.D0.BD.D0.B4.D1.88.D0.B0.D1.84.D1.82"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9A%D1%83%D1%80%D1%81_%D0%BC%D0%BE%D0%BB%D0%BE%D0%B4%D0%BE%D0%B3%D0%BE_%D0%B1%D0%BE%D0%B9%D1%86%D0%B0%2C_%D1%87%D0%B0%D1%81%D1%82%D1%8C_2:_%D1%82%D0%B5%D0%BE%D1%80%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BA%D0%B0&amp;action=edit&amp;section=4" title="Курс молодого бойца, часть 2: теоретическая подготовка">править</a>]</span> <span class="mw-headline">Ландшафт</span></h2>
<p>Вот два способа, которые знаю я: 
</p><p>Первый - загрузка карты высот в сплайновую поверхность (LoadTerrain). Карта высот - черно-белая картинка, где черный цвет высота 0, а белый высота 1. Шаг между высотами = 1/255. Сплайновая поверхность - математическое явление, смысл которого заключается в том, что по отдельным точкам поверхности строится вся поверхность: Достоинство этого метода в том, что такая поверхность отображается быстро, что очень хорошо, но есть и изнанка - у Terrain нет "тела". Поэтому  его поверхность тяжело сделать разно-фактурной. Текстура натягивается  на всю поверхность Terrain. Т.е. если текстура - трава, то и вся поверхность будет травой. Можно сделать огромную текстуру, на которой нарисовать различные участки ландшафта различными текстурами, но огромная текстура сведет на нет выигрыш от использования Терана. Но есть такая штука - мультитекстурирование. На поверхность накладывается несколько текстур. Например, берем текстуру земли и текстуру на которой схематично нарисованы зоны зеленая (трава), белая (голая земля), черная (типа дорога). При наложении двух текстур мы увидим вполне понятную картину, добавить третьим слоем текстуру состоящую из беспорядочных точек (Нойсовая называется) и вообще классно, только травки, камушки (спецэффекты) добавим чтобы народ внимание на низкую детализацию не обращал: Для природы самое оно!  Можно, правда, сделать несколько экземпляров террана, наложить на каждый свою текстуру + карту прозрачности и посмотреть что получится, но мне кажется, будет изврат:
</p><p>Второй - загрузка карты высот в 3Д объект. Программно создаем квадратик 1х1 и его углы поднимаем в соответствии с картой высот. Положительная сторона этого дела заключается в том, что у нашего ландшафта появляется тело которое можно красить текстурами как заблагорассудится. Хочешь в этом месте травку нарисовать? Пожалуйста! Дорожка здесь идет? Нет проблем! Но за все приходится платить. Очень много съедается  ресурсов. Ландшафт 100х100 клеток скушает у вас 20000 треугольников. Естественно есть способы сделать, чтобы эти 20000 рисовались не сразу, но это не всегда помогает: Те кто умеет работать в 3D редакторе скажут: "Нафига козе баян? Я в Максе нарисую быстрее, качественнее и с лайтмапами (Редкий эффект такой, который мало ресурсов жрет)" Но этот способ со счетов не сбрасываем. Есть случаи, когда кроме этого у нас ничего не будет:
</p><p>Есть идея насчет третьего способа, но он непроверенный. Строить карту не по карте высот, а по карте изолиний, может получиться весьма хорошо. Недостаток, который вижу без проработки этого вопроса - это отсутствие софта для создания карт изолиний: Достоинство меньшее чем во втором случае кол-во полигонов. Есть тело, но не очень хорошая развертка модели:
</p>
<a name=".D0.94.D0.B5.D0.BA.D0.BE.D1.80.D0.B0.D1.86.D0.B8.D0.B8"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9A%D1%83%D1%80%D1%81_%D0%BC%D0%BE%D0%BB%D0%BE%D0%B4%D0%BE%D0%B3%D0%BE_%D0%B1%D0%BE%D0%B9%D1%86%D0%B0%2C_%D1%87%D0%B0%D1%81%D1%82%D1%8C_2:_%D1%82%D0%B5%D0%BE%D1%80%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BA%D0%B0&amp;action=edit&amp;section=5" title="Курс молодого бойца, часть 2: теоретическая подготовка">править</a>]</span> <span class="mw-headline">Декорации</span></h2>
<p>Декорации рисуются в 3Д редакторе. Они отличаются высокой детализацией, сложной геометрией, красивостью всякой и маленькой площадью, ну хорошо  - весьма ограниченной площадью. Минус - коридоры, залы, узкие улицы, коридоры, дворики, туннель, прибрежная полоса, каналы, горная дорога. Короче, быть игроку на коротком поводке. Шаг вправо, шаг влево расстрел все видящими вертолетами, мучительная боль от пересечения барьера: Хотя многие сочтут это достоинством. Создаются очень просто! Берется 3Д редактор и рисуется! Только у меня почему-то не получается: Наверное нужно редактор какой-то другой взять.&nbsp;;) Многие скажут: "Нет 3Д редактора кроме 3Дмакс и чарФХ пророк его.." Я скажу: "Ищите и обрящете:" Я пользуюсь Wings3D и после него не могу смотреть на 3Дмакс, Милк и прочие редакторы построенные на четырех оконном интерфейсе. Для создания уровней можно посмотреть редакторы для игровых движков, которые делают уровни в формате  bsp или написать свой.
</p>
<a name=".D0.9E.D0.B1.D1.8A.D0.B5.D0.BA.D1.82.D1.8B"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9A%D1%83%D1%80%D1%81_%D0%BC%D0%BE%D0%BB%D0%BE%D0%B4%D0%BE%D0%B3%D0%BE_%D0%B1%D0%BE%D0%B9%D1%86%D0%B0%2C_%D1%87%D0%B0%D1%81%D1%82%D1%8C_2:_%D1%82%D0%B5%D0%BE%D1%80%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BA%D0%B0&amp;action=edit&amp;section=6" title="Курс молодого бойца, часть 2: теоретическая подготовка">править</a>]</span> <span class="mw-headline">Объекты</span></h2>
<a name=".D0.9D.D0.B5_.D0.B8.D0.BD.D1.82.D0.B5.D1.80.D0.B0.D0.BA.D1.82.D0.B8.D0.B2.D0.BD.D1.8B.D0.B5_.D0.BE.D0.B1.D1.8A.D0.B5.D0.BA.D1.82.D1.8B"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9A%D1%83%D1%80%D1%81_%D0%BC%D0%BE%D0%BB%D0%BE%D0%B4%D0%BE%D0%B3%D0%BE_%D0%B1%D0%BE%D0%B9%D1%86%D0%B0%2C_%D1%87%D0%B0%D1%81%D1%82%D1%8C_2:_%D1%82%D0%B5%D0%BE%D1%80%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BA%D0%B0&amp;action=edit&amp;section=7" title="Курс молодого бойца, часть 2: теоретическая подготовка">править</a>]</span> <span class="mw-headline">Не интерактивные объекты</span></h3>
<p>Не интерактивные объекты это объекты, которыми нельзя манипулировать. Если у нас декорация, то как таковых не интерактивных объектов может не быть. Создатель может легко сделать их частью уровня: Обязательное условие - они материальны. На них можно залезть, сквозь них нельзя пройти: 
</p>
<a name=".D0.AD.D1.84.D1.84.D0.B5.D0.BA.D1.82.D1.8B"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9A%D1%83%D1%80%D1%81_%D0%BC%D0%BE%D0%BB%D0%BE%D0%B4%D0%BE%D0%B3%D0%BE_%D0%B1%D0%BE%D0%B9%D1%86%D0%B0%2C_%D1%87%D0%B0%D1%81%D1%82%D1%8C_2:_%D1%82%D0%B5%D0%BE%D1%80%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BA%D0%B0&amp;action=edit&amp;section=8" title="Курс молодого бойца, часть 2: теоретическая подготовка">править</a>]</span> <span class="mw-headline">Эффекты</span></h3>
<p>Эффекты это не материальные и не интерактивные объекты. Они применяются к интерактивным, не интерактивным объектам или локации. Тени, дым, колыхающиеся языки пламени - это эффекты. Трава, деревья могут быть эффектами, если они не интерактивны:
</p>
<a name=".D0.98.D0.BD.D1.82.D0.B5.D1.80.D0.B0.D0.BA.D1.82.D0.B8.D0.B2.D0.BD.D1.8B.D0.B5_.D0.BE.D0.B1.D1.8A.D0.B5.D0.BA.D1.82.D1.8B"></a><h3><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9A%D1%83%D1%80%D1%81_%D0%BC%D0%BE%D0%BB%D0%BE%D0%B4%D0%BE%D0%B3%D0%BE_%D0%B1%D0%BE%D0%B9%D1%86%D0%B0%2C_%D1%87%D0%B0%D1%81%D1%82%D1%8C_2:_%D1%82%D0%B5%D0%BE%D1%80%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BA%D0%B0&amp;action=edit&amp;section=9" title="Курс молодого бойца, часть 2: теоретическая подготовка">править</a>]</span> <span class="mw-headline">Интерактивные объекты</span></h3>
<p>И наконец самая большая головная боль - интерактивные объекты. Это объекты, которыми можно в игре манипулировать. Их можно использовать, брать, открывать, перемещать: С ними можно делать все что угодно. При условии, что вы сможете это закодировать.&nbsp;;)  Если интерактивный объект невидимый, то его называют "триггер". У интерактивных объектов в наличии два особо значимых  свойства: 1) Тип срабатывания - в каком случае объект реагирует на воздействие. Может срабатывать при приближении, прикасании, клике, ударе, по условию.  От любого события, какое сможете запрограммировать: 2)  Тип действия -  что происходит с объектом, когда он "срабатывает": Может открыть дверь, запустить механизм, ударить игрока, "сработать" другой триггер. Любое действие, какое вы сможете запрограммировать. 
</p><p>Для более детального понимания, какие объекты могут быть, что такое интерактивные объекты и как работать с триггерами предлагаю посмотреть RPG maker 2003. Правда, в нем представлена несколько иная картина. Я утверждаю, что если у интерактивного объекта нет графического представления - он триггер, а в RM считается, что если у триггера есть графическое представление, то он интерактивный объект. Но это не важно, результат одинаков.&nbsp;;)
</p>
<a name=".D0.98.D0.BD.D1.82.D0.B5.D1.80.D1.84.D0.B5.D0.B9.D1.81_.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D1.82.D0.B5.D0.BB.D1.8F"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9A%D1%83%D1%80%D1%81_%D0%BC%D0%BE%D0%BB%D0%BE%D0%B4%D0%BE%D0%B3%D0%BE_%D0%B1%D0%BE%D0%B9%D1%86%D0%B0%2C_%D1%87%D0%B0%D1%81%D1%82%D1%8C_2:_%D1%82%D0%B5%D0%BE%D1%80%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BA%D0%B0&amp;action=edit&amp;section=10" title="Курс молодого бойца, часть 2: теоретическая подготовка">править</a>]</span> <span class="mw-headline">Интерфейс пользователя</span></h2>
<p>Интерфейс пользователя обычно обзывают GUI. Как не удивительно, но эта часть такая же важная, как и визуализация. Именно через интерфейс игрок будет взаимодействовать с вашим миром. Формально к  GUI относятся кнопочки, поля ввода, ползунки, надписи, переключатели и прочие визуальные элементы: Но к GUI можно и нужно отнести управление персонажем, манипулирование с объектами. Ведь от удобства управления зависит, насколько быстро игрок погрузится в созданный вами мир. Кроме этого внешний вид панелек, кнопок, шрифтов недолжен расходится со стилем игры. Если у вас игра про древний мир, то странно будет увидеть оформление интерфейса в стиле хайтек: Но самое удивительное, что создание хорошего GUI у вас займет много времени, и нервов, и это не считая графического наполнения: Существует минимальный набор элементов которые должен уметь отображать GUI для игры: кнопки, картинки, текст, поле ввода. Если GUI поддерживает несколько окон, то вам с ним по пути надолго, если есть исходники, возможно навсегда: Часто возможности по созданию GUI являются частью движка, но часто и не являются. Сами принципы создания GUI довольно простые и имея немного опыта и желания всегда можно написать свой GUI чем мы с вами займемся если вы пробудите с нами достаточно долго.
</p>
<a name=".D0.9B.D0.BE.D0.B3.D0.B8.D0.BA.D0.B0_.D0.B8.D0.B3.D1.80.D1.8B"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9A%D1%83%D1%80%D1%81_%D0%BC%D0%BE%D0%BB%D0%BE%D0%B4%D0%BE%D0%B3%D0%BE_%D0%B1%D0%BE%D0%B9%D1%86%D0%B0%2C_%D1%87%D0%B0%D1%81%D1%82%D1%8C_2:_%D1%82%D0%B5%D0%BE%D1%80%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BA%D0%B0&amp;action=edit&amp;section=11" title="Курс молодого бойца, часть 2: теоретическая подготовка">править</a>]</span> <span class="mw-headline">Логика игры</span></h2>
<p>Логика игры это все вычисления, и действия связанные с игрой кроме непосредственно прорисовки мира. Это чистая и незамутненная вотчина программиста. Здесь не нужны таланты художника, модельера, композитора. Нужна строгая логика, знание языка программирования, хорошая алгоритмическая база. В этой части мертвые модели обретают жизнь, мир наполняется звуками и красками, кнопочки интерфейса нажимаются: Тысячи байт информации разрозненные и безжизненные превращаются в единый мир, подвластный программисту: Хотя программист и является самым низкооплачивамым  специалистом и игровой индустрии, и считается что в игре главное модели, графика, звук. Без программиста все модели, картинки и звуки так и останутся Media: Именно эта часть игры и является игрой (Игровым движком). Здесь создаются возможности игрового мира и все глюки. 
</p>
<a name=".D0.A0.D0.B0.D0.B1.D0.BE.D1.82.D0.B0_.D1.81_.D0.BA.D0.B0.D0.BC.D0.B5.D1.80.D0.BE.D0.B9"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9A%D1%83%D1%80%D1%81_%D0%BC%D0%BE%D0%BB%D0%BE%D0%B4%D0%BE%D0%B3%D0%BE_%D0%B1%D0%BE%D0%B9%D1%86%D0%B0%2C_%D1%87%D0%B0%D1%81%D1%82%D1%8C_2:_%D1%82%D0%B5%D0%BE%D1%80%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BA%D0%B0&amp;action=edit&amp;section=12" title="Курс молодого бойца, часть 2: теоретическая подготовка">править</a>]</span> <span class="mw-headline">Работа с камерой</span></h2>
<p>Для того чтобы видеть наш мир, нам нужно спроецировать его на экран монитора. Для этого и нужна "камера". Что значит работа с камерой? Камера - это наши глаза в виртуальном мире, и как в реальном, нам нужно изменять наш угол обзора. Т.к. не всегда  мы видим мир глазами персонажа, нужно организовывать слежение за глав. героем. В случае с видом от первого лица, управление камерой совмещается с управлением персонажем, но не исчезает!
</p>
<a name=".D0.9F.D0.B5.D1.80.D0.B5.D0.BC.D0.B5.D1.89.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D0.B5.D1.80.D1.81.D0.BE.D0.BD.D0.B0.D0.B6.D0.B0"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9A%D1%83%D1%80%D1%81_%D0%BC%D0%BE%D0%BB%D0%BE%D0%B4%D0%BE%D0%B3%D0%BE_%D0%B1%D0%BE%D0%B9%D1%86%D0%B0%2C_%D1%87%D0%B0%D1%81%D1%82%D1%8C_2:_%D1%82%D0%B5%D0%BE%D1%80%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BA%D0%B0&amp;action=edit&amp;section=13" title="Курс молодого бойца, часть 2: теоретическая подготовка">править</a>]</span> <span class="mw-headline">Перемещение персонажа</span></h2>
<p>В этой части программы описывается, как персонаж перемещается и взаимодействует с внешним миром. Больше и сказать нечего. Но сам этот блок очень многогранен, и его строение непредсказуемо и зависит от опыта программиста, расположения звезд и неизвестно чего еще: 
</p>
<a name=".D0.A4.D0.B8.D0.B7.D0.B8.D0.BA.D0.B0"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9A%D1%83%D1%80%D1%81_%D0%BC%D0%BE%D0%BB%D0%BE%D0%B4%D0%BE%D0%B3%D0%BE_%D0%B1%D0%BE%D0%B9%D1%86%D0%B0%2C_%D1%87%D0%B0%D1%81%D1%82%D1%8C_2:_%D1%82%D0%B5%D0%BE%D1%80%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BA%D0%B0&amp;action=edit&amp;section=14" title="Курс молодого бойца, часть 2: теоретическая подготовка">править</a>]</span> <span class="mw-headline">Физика</span></h2>
<p>Эта часть отвечает за физические свойства мира, притяжение, столкновения и т.д. Если подходить к делу скрупулезно (что бы как в жизни), то самостоятельно такую физику не напишешь, нужно использовать внешние физики, но следует знать, что если вы будете все объекты в мире включать в физическую модель, у вас будет слайд шоу! Сделать свою гравитацию вполне по силам создателю мега-игры. Это гораздо проще, чем использовать для этой цели внешнюю физику, там ведь нужно много изучать, да частенько доки на иностранном:
</p>
<a name=".D0.90.D0.98"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9A%D1%83%D1%80%D1%81_%D0%BC%D0%BE%D0%BB%D0%BE%D0%B4%D0%BE%D0%B3%D0%BE_%D0%B1%D0%BE%D0%B9%D1%86%D0%B0%2C_%D1%87%D0%B0%D1%81%D1%82%D1%8C_2:_%D1%82%D0%B5%D0%BE%D1%80%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BA%D0%B0&amp;action=edit&amp;section=15" title="Курс молодого бойца, часть 2: теоретическая подготовка">править</a>]</span> <span class="mw-headline">АИ</span></h2>
<p>Искусственный интеллект - очень громкое название. Эта часть программы описывает поведение окружающей среды: Благодаря АИ монстры ходят, ловушки срабатывают двери открываются: Хотя  можно отделить триггеры от НПС, и АИ сделать только для монстров, а на триггеры сделать отдельный блок. Обычно это та часть, которая превращает мега-игру в очень средненькую игру, если совсем не убивает:
</p>
<a name=".D0.90.D0.BD.D0.B8.D0.BC.D0.B0.D1.86.D0.B8.D1.8F_.D0.B8_.D0.B7.D0.B2.D1.83.D0.BA"></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9A%D1%83%D1%80%D1%81_%D0%BC%D0%BE%D0%BB%D0%BE%D0%B4%D0%BE%D0%B3%D0%BE_%D0%B1%D0%BE%D0%B9%D1%86%D0%B0%2C_%D1%87%D0%B0%D1%81%D1%82%D1%8C_2:_%D1%82%D0%B5%D0%BE%D1%80%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BA%D0%B0&amp;action=edit&amp;section=16" title="Курс молодого бойца, часть 2: теоретическая подготовка">править</a>]</span> <span class="mw-headline">Анимация и звук</span></h2>
<p>Этот блок хитрым образом связан почти со всеми блоками: И с GUI, и с перемещением персонажей, и с физикой, и с АИ: Анимация и звук идут параллельно. Задача этого блока своевременно менять анимацию и звуковое сопровождение объектов, элементов интерфейса:
</p>
<a name=".D0.A1.D1.82.D1.80.D0.BE.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B2.D1.81.D0.B5.D0.BB.D0.B5.D0.BD.D0.BD.D0.BE.D0.B9."></a><h2><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=%D0%9A%D1%83%D1%80%D1%81_%D0%BC%D0%BE%D0%BB%D0%BE%D0%B4%D0%BE%D0%B3%D0%BE_%D0%B1%D0%BE%D0%B9%D1%86%D0%B0%2C_%D1%87%D0%B0%D1%81%D1%82%D1%8C_2:_%D1%82%D0%B5%D0%BE%D1%80%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BA%D0%B0&amp;action=edit&amp;section=17" title="Курс молодого бойца, часть 2: теоретическая подготовка">править</a>]</span> <span class="mw-headline">Строение вселенной.</span></h2>
<p>Со строением игры немного разобрались, давайте разберемся со строением Виртуальной вселенной. Вселенная  имеет форму шара с радиусом 2^32 единиц, хотя есть мнение, что она имеет форму куба с такой стороной. Точных данных на этот счет нет: На периферии нашей вселенной наблюдаются сильные искажения пространства, что выражается в тряске и дерганье при движении и поворотах, взаимных проникновениях объектов, обусловленных ошибками при определении расстояния от камеры до треугольника т.к. Z-buffer работает на пределе своих возможностей. Z-buffer свойство вселенной прорисовывать дальние треугольники первыми: В этих условиях необходимо помнить, что без проблемное построение мира возможно только в центральной части вселенной. Но нужно знать, что микрокосмос не бесконечен и так же имеет размеры. При очень маленьких размерах так же наблюдается аномальное поведение  виртуальных объектов. Если наш мир - планета, то можно принять единицу - виртуальной вселенной равной 1 метру или 0.5 метра или 0.1 метра. Самое простое это 1:1.  Если ваш мир - вся вселенная, то у вас проблемы: Диаметр нашего Солнца 61392000000 метров, диаметр нашей виртуальной вселенной 4294967296 единиц. Если брать 1:1, то нашей вселенной не хватит чтобы отобразить наше светило. Мечтатели дальних странствий и реальных размеров, вы рано родились: Но не все потеряно. Если подойти к делу создания своего мира с головой, все возможно: Правда нужно сделать виртуальное пространство в нашей виртуальной вселенной, метрикой которого вы будете управлять: Но это сложно сделать создателю мега-игры, тут нужно технически.&nbsp;;) 
</p><p>Свет в нашей вселенной презирает преграды. Он распространяется легко и свободно, проходя через объекты, равномерно освещая их треугольники. Вернее их вершины. Типов источников света может быть три точечный, направленный, пятновой (типа фонарик): Всего может быть 8 источников света: Теней в нашей вселенной нет: Если вы где-то в виртуальном мире видели сотни ламп в коридорах и четкую тень которую отбрасывает персонаж, восхититесь мастерству людей которые создали такую иллюзию. Создав свет, объекты не начнут отбрасывать свет на все вокруг! Для того чтобы  персонаж начал отбрасывать тень нужно написать программу и научить компьютер рисовать тень. Для того чтобы сотни ламп осветили коридор, нужно аккуратно нарисовать освещение этого коридора:  А для этого нужно много знать и работать. Если вы хотите что-то сделать, и не знаете, как, то вам нужно сначала разобраться как ЭТО происходит в реальном мире. Если вы хотите сделать настоящую тень, то должны знать, как нарисовать эту тень в жизни, на листе бумаги. И конечно нужно искать информацию о создании интересующих вас возможностях. Многое придумано до вас. Можно и нужно воспользоваться накопленными знаниями.
</p><p>Для осознания следующей порции моего бреда вам понадобится изучить труды Матвея Меркулова. Я не хочу повторяться и описывать азы. Следующий раз мы начнем с гравитации и управления персонажем от первого лица.
</p>
<hr />
<p>Автор: <a href="http://blitzetcetera.org/index.php/%D0%A3%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%B8%D0%BA:Tolking" title="Участник:Tolking">Роман Прядко</a> (roman_tnp@mail.ru)
</td><td class="rightside"><table cellspacing=0 cellpadding=0><tr><td class="rightheader"></td></tr></table></td></tr><tr colspan="3" height="40"><td>&nbsp;</td></tr><tr><td class="leftside"><table cellspacing=0 cellpadding=0><tr><td class="leftheader"></td></tr></table></td><td class="sheetbody"><a name="В следующем выпуске (выпуск 2)"></a><h1><span class="editsection">[<a href="http://blitzetcetera.org/index.php?title=Обсуждение:В следующем выпуске (выпуск 2)&amp;action=edit">обсудить</a>] [<a href="http://blitzetcetera.org/index.php?title=В следующем выпуске (выпуск 2)&amp;action=edit">править</a>]</span><span class="mw-headline">В следующем выпуске (выпуск 2)</span></h1>
<p>Следующий номер будет содержать продолжения статей "Виртуальный художник","Игра "Жизнь", "Курс молодого бойца", новую статью о программировании - "Тела вращения", ну и конечно, все остальные статьи, что придут по почте. Планируются еще статьи о программировании и обзорная статья, а также что-нибудь касательно трехмерных редакторов. Выйдет следующий номер журнала ориентировочно в начале-середине апреля. Кстати, дней через 5, думаю, появится возможность подписки на журнал.
</p>
</p>
<hr />
<p>Присылайте статьи! Анонсируйте не только свои уже опубликованные статьи, но и написанные другими людьми, свободно распространяемые, если сочтете, что они подходят для журнала. Возможные темы: редактирование трехмерных моделей, описание трехмерных и двумерных движков, разных технологий, интервью с известными в мире Blitz людьми, советы по дизайну, созданию графики и музыки для игр. До скорого!
</p>
<p align="right">
редактор журнала Матвей Меркулов (MattMerk@mail.ru, ICQ: 392-274-050)
</p>
<p><!-- 
Pre-expand include size: 176095 bytes
Post-expand include size: 112182 bytes
Template argument size: 263 bytes
Maximum: 2097152 bytes
-->
</p>
<!-- Saved in parser cache with key db1:pcache:idhash:453-0!1!0!!ru!2 and timestamp 20071112102941 -->
<div class="printfooter">
Получено с <a href="53d39gvr.html">http://blitzetcetera.org/index.php/%D0%92%D1%8B%D0%BF%D1%83%D1%81%D0%BA_%E2%84%962_-_%D1%84%D0%B5%D0%B2%D1%80%D0%B0%D0%BB%D1%8C_2005</a></div>
			<!-- end content -->			<div class="visualClear"></div>				</td>				<td class="rightside">				</td>			</tr>		</table>		</div>	</div>		</div>	
		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
</div></body>
<!-- Mirrored from localhost/index.php/%D0%92%D1%8B%D0%BF%D1%83%D1%81%D0%BA_%E2%84%962_-_%D1%84%D0%B5%D0%B2%D1%80%D0%B0%D0%BB%D1%8C_2005 by HTTrack Website Copier/3.x [XR&CO'2007], Mon, 12 Nov 2007 11:20:35 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
</html>